---
title: パッケージ アプリケーションの問題のトラブルシューティング
description: トピックでは、1 層または 2 層〜 5 層の環境でパッケージを適用する際に発生する可能性がある問題のトラブルシューティングに役立つ情報を提供します。
author: manalidongre
manager: AnnBe
ms.date: 08/08/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: Operations
ms.custom: 107013
ms.assetid: 341a229f-d9c3-4678-b353-d08d5b2c1caf
ms.search.region: Global
ms.author: manado
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: Platform update 1
ms.openlocfilehash: fede0a915ef7ea2791983902b4da3f093b4c9ec2
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/02/2019
ms.locfileid: "1848117"
---
# <a name="troubleshoot-package-application-issues"></a>パッケージ アプリケーションの問題のトラブルシューティング

[!include [banner](../includes/banner.md)]

このトピックでは、1 層または 2 層〜 5 層の環境でパッケージを適用する際に発生する可能性がある問題のトラブルシューティングに役立つ詳細情報を提供します。 パッケージを適用する方法についての詳しい情報は、[適用可能パッケージ](apply-deployable-package-system.md) を参照してください。

## <a name="general-troubleshooting-and-diagnostics"></a>一般的なトラブルシューティングと診断
パッケージが正常に適用されていない場合は、2 つのオプションがあります。

- 失敗した操作を再試行します。
- ログを使用します。

### <a name="retry-the-failed-operation"></a>失敗した操作の再試行
パッケージ アプリケーションが失敗した場合、操作を再実行する必要があり、**経歴**を選択します。

### <a name="use-the-logs"></a>ログの使用
パッケージ アプリケーションが失敗すると、ログを使用する場合は、これらの手順に従います。

1. ログ ファイルをダウンロードして解凍します。
2. **AOS** や **BI** など、ステップが失敗したロールを選択します。
3. ステップが失敗した場合は仮想マシン (VM) を選択します。 この情報は **環境の更新** セクションの **コンピューター名** 列で見つけることができます。
4. VM ログで、問題が発生したステップに対応するフォルダーを選択します。 フォルダー名は、各フォルダーが対応するステップを識別します。 

    たとえば、ステップの実行中に問題が発生した場合、<strong>ExecuteRunbook\</strong>* フォルダーを選択します。 ステップ番号は、強調表示されたグローバル一意識別子 (GUID) の後の番号です。

## <a name="package-application-issues"></a>パッケージ アプリケーションの問題

### <a name="issue-the-package-that-was-applied-isnt-valid"></a>問題: 適用されたパッケージが有効ではありません

**説明**

適用されたパッケージは有効ではないため、サービスの状態は**失敗**になり**環境の更新**セクションには更新が表示されません。 パッケージが有効かどうかを確認するには、次の手順を実行します。

1. ログをダウンロードして解凍します。
2. Application Object Server (AOS) マシンのログに移動します。
3. **DownloadFilesAndSlipstreamTools xxx** および **GenerateRunbook xxx** フォルダーが存在することを確認します。
4. **GenerateRunbook-xxx フォルダ**を開いて、出力タイプのファイルを開きます。

    ファイルが見つからない、または runbook のステップを生成できなかったことを示すエラー メッセージまたは例外が見つかった場合は、無効なパッケージをアップロードしようとされます。

**操作**

**中止** を選択して現在のパッケージを中止し、新しいパッケージをアップロードしてからサービスのフローを再開します。

### <a name="issue-package-deployment-fails-even-though-no-steps-failed"></a>問題: 失敗したステップはありませんが、パッケージの展開に失敗します

**説明**

タイムアウトは、パッケージをマシンにダウンロードするときに発生します。 事前のサービス中に、Runbook で手順が完了する前にいくつかの手順を完了する必要があります。 事前サービスの一環として、パッケージはすべてのマシンにダウンロードする必要があります。 ダウンロードする時間は、環境が存在するデータ センターによって若干異なる場合があります。 30 分以内にダウンロードが実行されない場合は、サービス ステータスがエラーと見なされ停止されます。

**操作**

1. **再開** を選択し、問題を解決することができるかどうかを確認します。 この手順で動作しない場合は、手順 2 に進みます。
2. ログを**環境**ページからダウンロードします。
3. すべてのコンピューターへのパッケージのダウンロードに DownloadFilesAndSlipstreamTools フォルダーを含むログが含まれていることを確認します。
4. ログ ファイルを確認します。 パッケージのダウンロードが完了しなかったために、ログ ファイルの末尾に、「ファイルのダウンロードとスリップストリームが正常に完了しました」というテキストが表示されない場合、問題が発生しています。

### <a name="issue-package-deployment-fails-even-though-no-steps-failed"></a>問題: 失敗したステップはありませんが、パッケージの展開に失敗します

**説明**

パッケージをダウンロードするのに十分なディスク容量がありません。 すべてのマシンを検査します。 この問題は、すべてのマシンのサービスのドライブがいっぱいの場合に発生します。

この状況で**再開**を選択する場合、問題が解決されないことに注意してください。

スペースの問題により展開が失敗したことを確認するには、次の手順を実行します。

1. **DownloadFilesAndSlipstreamTools-xxx** フォルダーに移動します。
2. 出力ファイルを開いて、スペースの問題によりステップが失敗したかどうかを確認するエラー メッセージを表示します。

**操作**

トポロジの自動クリーンアップの一環として、30 日以上経過した %ServiceVolume%\\DeployablePackages の配置可能なパッケージは削除されます。 同じタイムラインは、サービス関連のログを削除するためにも使用されます。 通常、これらのログは C:\\Dynamics にあります。

ただし、dev/one-box マシンには、さらに柔軟性があります。 ServiceVolume およびログ ドライブの保持日数および最小ディスク容量はカスタマイズできます。

- **HKLM:\\ソフトウェア\\Microsoft\\Dynamics\\展開** レジストリ キーで、以下のキーを作成して、クリーンアップを実行するときにカスタマイズできます。 自動クリーンアップ タスクでは、これらの値が考慮されます。

    - **CutoffDaysForCleanup** - 古いパッケージとログが保持される日数。 既定値は **30** です。
    - **CutoffDiskSpaceLimitForPackages** - パッケージ フォルダーがあるサービス ボリューム ドライブ上 (ギガバイト単位 [GB]) の最小空きディスク容量。 たとえば、ディスク領域が 200 GB の場合、クリーンアップ タスクは日数に基づいてパッケージを削除します。
    - **CutoffDiskSpaceLimitForLogs** - ログのフォルダーがあるシステム ドライブの最小空きディスク容量 (GB 単位)。 たとえば、ディスク領域が 100 GB の場合、クリーンアップ タスクは日数に基づいてサービス関連のログを削除します。

### <a name="issue-a-step-failed-with-errors"></a>問題: ステップがエラーで失敗しました

**説明**

ステップは、次のいずれかの理由により、エラーで失敗する可能性があります。

- パッケージにカスタマイズの問題があるか、依存関係がありません。
- サービス スクリプトに問題があります。
- ステップが実行されたときに、ランダムなエラーが発生しました。

問題の内容を確認するには、次の手順を実行します。

1. ステップ・ログをダウンロードしてナビゲートします。
2. ステップの出力ファイルを開いて、エラーがないか確認してください。
3. 追加のログ ファイルがある場合は、エラーのログ ファイルを検査します。

**操作** 

1. ログをダウンロードします。
2. **ステップの再実行** を選択し、失敗したステップを再試行します。

ステップが再度失敗し、同じエラーが発生した場合は、ログに戻り、詳細情報を確認します。 

- カスタマイズに問題があること場合は、このパッケージを中止し、新しいパッケージを使用して再試行します。
- 問題の修正プログラムが問題検索にあるかどうかを参照してください。
- 次の手順の失敗が表示された場合は、データベース同期の問題が発生している可能性、またはレポート展開に失敗した可能性のいずれかです "サービス モデルの GlobalUpdate スクリプト: AOSService"
- DBSync.err ファイルを検索し、エラー内容を確認します。 DBSync.log ファイルを検査します。 DB 同期ステップ中の特定の失敗については、**一般的な DB 同期の失敗**セクションを検索します。

### <a name="issue-the-deployment-status-is-servicing-but-the-servicing-status-is-failed"></a>問題: 配置ステータスがサービスとなっていますが、サービス ステータスが失敗しました

**説明**

組み込みのメカニズムにより、システムは放棄する前に何度も再試行します。 次の準備手順は、複数回再試行することもできます。 

- マシンにパッケージをダウンロードします。
- サービス パッケージをスリップ ストリームします。
- Runbook の生成

**操作**

ログをダウンロードしてエラーを表示し、すべての再試行が終わる前にアクションを取ります。 再試行の仕組みが準備段階を超えない場合、**失敗**のステータスが表示された場合は、チケットを開いて Microsoft チームが問題をさらに調査できるようにします。 

### <a name="issue-the-dashboard-doesnt-open-after-package-deployment-is-completed"></a>問題: パッケージの展開が完了した後にダッシュボードが開きません

**説明**

パッケージの展開が完了した後にダッシュ ボードが開かない場合は、AOS コンピューターの開始時にランタイム エラーが発生している可能性があります。

**操作**

1. イベント ビューアーを起動します。
2. **アプリケーションとサービス ログ** > **Microsoft** > **Dynamics** > **Ax-SystemRuntime** > **エラーで操作フィルター**と移動し、エラーがあるかどうかを確認して、必要に応じてエラーを調査します。

## <a name="typical-database-synchronization-issues"></a>一般的なデータベース同期の問題
次の手順の失敗が表示された場合は、データベース同期の問題が発生している可能性があります: "サービス モデルの GlobalUpdate スクリプト: AOSService"

DBSync.err ファイルを検索し、エラーを検出し、および DBSync.log ファイルを検査するには、これらの手順に従います。

1. ステップ・ログをダウンロードしてナビゲートします。
2. ステップの出力ファイルを開いて、エラーがないか確認してください。
3. 追加のログ ファイルがある場合は、エラーのログを検査します。
4. 次のテーブルは、最も頻繁に表示されるエラーと、実行する必要のあるアクションを示しています。 **問題** 列には、dbsync.err ファイルに表示されるエラー メッセージが表示されます。 パーセント記号 (%) は、テーブル、フィールド、インデックスなどのメタデータの名前に置き換えできます。

    | 問題 | アクション |
    |-------|--------|
    | % テーブルでテーブル同期に失敗しました % 一意のインデックスを作成します % | この問題は通常、ユニークなインデックスが作成されたが、データが一意でない場合に発生します。 手順をもう一度実行する前に、データを修正します。 |
    | % アプリケーション構成の同期に失敗しました。% カスタム アクションの同期がエラーにより失敗しました。% | エラー メッセージと呼び出しスタック内の情報を表示して、問題の原因となるアプリケーション コードを決定します。 |
    | % 基になるクエリ&#39;&#39;のテーブルには見つかりません % | この問題は修正されました。 詳細については、KB 4018815 を参照してください。 |
    | % テーブルでテーブル同期が失敗しました % 変換フィールド % | エラー メッセージに従って、問題を修正し、ステップを再度実行します。 |
    | % 1 つ以上のオブジェクトがこの列にアクセスしているため失敗しました % | インデックスがメタデータにあるかどうかを確認します。 インデックスがメタデータ内にある場合は、この問題は SyncEngine 製品問題です。 インデックスがメタデータにない場合、ステップを再度実行する前に、SQL データベースからインデックスを削除します。 |
    | % 基になるデータ ソース&#39;&#39;テーブルから見つかりません % | この問題は修正されました。 詳細については、KB 4018815 を参照してください。 |
    | 「% テーブルの % テーブルへの同期が失敗しました」、そして、「% という名前のオブジェクトは既に存在しています %」のような errorMessage が表示されます | 内部 SqlDictionary テーブルおよび SQL スキーマが同期されていません。この状態に到達する方法を理解するのに十分な情報がログにありません。 |
    | % テーブルでテーブル同期が失敗しました % 各テーブルの列名は一意である必要があります % | テーブルの SqlDictionary エントリが破損しており、フィールドがありません。 この状態にどのように達したかを理解するには、ログに十分な情報がありません。 |
    | % 列の名前「LOAD\_」は、ターゲット テーブルまたはビューに存在しません。 インデックスの作成% | この問題は、SyncEngine の問題のようです。 Microsoft サポートにチケットを作成します。 |
    | 「VENDREQUESTPROFILEQUESTIONNAIRE.I\_1301PROFILEQUESTIONNAIRE」インデックスは存在しないか、アクセス許可がないため削除することはできません。 | この問題は、SyncEngine の問題のようです。 Microsoft サポートにチケットを作成します。 |
    | % インデックス「I\_65750INDEX1」の長さ 2046 バイトのインデックス エントリは、非クラスター化インデックスの最大長 1700 バイトを超えています % | 手順をもう一度実行する前に、インデックスを変更します。 |
    | % 付近に正しくない構文があります % | この問題は、SyncEngine の問題です。 Microsoft サポートにチケットを作成します。 |
    | 「TEMPDB.DBO.T\_TRVREQUISITIONLINE\_C4C3569DD5A14CDABAE71A341743FB61」におけるデータベースまたはサーバーの名前の参照は、このバージョンの SQL Server ではサポートされていません | この問題は、SyncEngine の問題です。 Microsoft サポートにチケットを作成します。 |
    | % エラー: タイムアウトが発生しました。  pool.% から接続を取得するまでに経過したタイムアウト時間。 | ステップを再試行します。 |
    | データベースの実行に失敗しました: 無効な列名「DEFAULTDIMENSION」。 VIEW の作成 | この問題は、SyncEngine の問題のようです。 Microsoft サポートにチケットを作成します。 |
    | データベースの実行に失敗しました: 無効なオブジェクトの名前「PMBI\_DEPROJECTTIMESHEET」。 VIEW の作成 | この問題は、SyncEngine の問題のようです。 Microsoft サポートにチケットを作成します。 |
    | % プロバイダー: 名前付きパイプ プロバイダー、エラー: 40: - SQL Server への接続を開けませんでした %  | Platform Update 3 でこの問題を修正されている必要があります。 ステップを再試行します。 |
