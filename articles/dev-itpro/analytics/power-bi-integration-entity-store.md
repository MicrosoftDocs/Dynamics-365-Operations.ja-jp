---
title: "エンティティ格納と Power BI の統合"
description: "エンティティ格納は、Microsoft Dynamics 365 for Finance and Operations に含まれている運用データ ストアです。 このトピックでは、エンティティ ストアで Power BI を Finance and Operations と統合する方法について説明します。"
author: MilindaV2
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
ms.search.form: BIMeasurementDeployManagementEntityStore
audience: IT Pro
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 265974
ms.assetid: 434b5d9f-9877-4769-ad96-d4e8d460a7fa
ms.search.region: Global
ms.author: milindav
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: Platform update 1
ms.translationtype: HT
ms.sourcegitcommit: 821d8927211d7ac3e479848c7e7bef9f650d4340
ms.openlocfilehash: 07f2052a318ed401372f9395a6d3a35c36eb45ca
ms.contentlocale: ja-jp
ms.lasthandoff: 08/13/2018

---

# <a name="power-bi-integration-with-entity-store"></a><span data-ttu-id="4fae7-104">エンティティ格納と Power BI の統合</span><span class="sxs-lookup"><span data-stu-id="4fae7-104">Power BI integration with Entity store</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="4fae7-105">エンティティ格納は、Microsoft Dynamics 365 for Finance and Operations に含まれている運用データ ストアです。</span><span class="sxs-lookup"><span data-stu-id="4fae7-105">Entity store is an operational data store that is included with Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="4fae7-106">このトピックでは、エンティティ ストアで Power BI を Finance and Operations と統合する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="4fae7-106">This topic describes how Entity store enables Power BI integration with Finance and Operations.</span></span>

<span data-ttu-id="4fae7-107">エンティティ格納は、Microsoft Dynamics 365 for Finance and Operations に含まれている運用データ ストアです。</span><span class="sxs-lookup"><span data-stu-id="4fae7-107">Entity store is an operational data store that is included with Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="4fae7-108">エンティティ格納の機能は、Microsoft Dynamics AX プラットフォーム更新プログラム 1 (2016 年 5 月) リリースで導入されました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-108">The Entity store feature was introduced in the Microsoft Dynamics AX platform update 1 (May 2016) release.</span></span> <span data-ttu-id="4fae7-109">この機能を使用すると、管理者またはパワーユーザーは、レポートおよび分析用の専用データストアで測定値を公開できます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-109">This feature lets an administrator or power user stage aggregate measurements in a dedicated data store for reporting and analytics.</span></span> <span data-ttu-id="4fae7-110">(集計の測定は、エンティティを使用してモデル化されたスター スキーマです)。このデータ ストアをエンティティ格納と呼びます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-110">(Aggregate measurements are a star schema that is modeled by using entities.) We call this data store Entity store.</span></span> <span data-ttu-id="4fae7-111">レポート用に最適化されたデータベースです。</span><span class="sxs-lookup"><span data-stu-id="4fae7-111">It’s a database that is optimized for reporting purposes.</span></span> <span data-ttu-id="4fae7-112">エンティティ格納では、Microsoft SQL Server に組み込まれたメモリ内の集合縦棒ストア インデックス (CCI) 機能を使用して、レポートとクエリを最適化します。</span><span class="sxs-lookup"><span data-stu-id="4fae7-112">Entity store uses the in-memory, clustered columnstore index (CCI) functionality that is built into Microsoft SQL Server to optimize reporting and queries.</span></span> <span data-ttu-id="4fae7-113">顧客は、Microsoft Power BI の DirectQuery モデルをエンティティ格納と共に使用し、大量のデータに対して大量のほぼリアルタイムの分析レポートを有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-113">Customers can use Microsoft Power BI DirectQuery models together with Entity store to enable high-volume, near-real-time analytical reporting over large volumes of data.</span></span>

## <a name="power-bi-directquery-mode"></a><span data-ttu-id="4fae7-114">Power BI DirectQuery モード</span><span class="sxs-lookup"><span data-stu-id="4fae7-114">Power BI DirectQuery mode</span></span>
<span data-ttu-id="4fae7-115">Microsoft Dynamics AX の 2016 年 2 月のリリースでは、データ エンティティ (集計データのエンティティと、詳細または通常のデータ エンティティの両方) で公開される OData エンドポイントを使用して Power BI レポートを作成することができました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-115">In the February 2016 release of Microsoft Dynamics AX, you could create Power BI reports by using OData endpoints that are exposed via data entities (both aggregate data entities and detailed or regular data entities).</span></span> <span data-ttu-id="4fae7-116">この方法は引き続き Dynamics 365 for Operations でサポートされていますが、エンティティ格納でも Power Users は Power BI DirectQuery レポートを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-116">Although this approach is still supported in Dynamics 365 for Operations, Entity store also lets power users create Power BI DirectQuery reports.</span></span>

<span data-ttu-id="4fae7-117">[![DirectQuery モード](./media/entity-store-architecture-1024x587.jpg)](./media/entity-store-architecture.jpg)</span><span class="sxs-lookup"><span data-stu-id="4fae7-117">[![DirectQuery mode](./media/entity-store-architecture-1024x587.jpg)](./media/entity-store-architecture.jpg)</span></span>

<span data-ttu-id="4fae7-118">前の図に示すように、DirectQuery はエンティティ格納で直接レポートを実行するレポート モードです。</span><span class="sxs-lookup"><span data-stu-id="4fae7-118">As the preceding illustration shows, DirectQuery is a reporting mode that runs reports directly on Entity store.</span></span> <span data-ttu-id="4fae7-119">このレポート モードでは、データは Power BI のキャッシュにステージングされません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-119">In this reporting mode, data isn't staged in Power BI caches.</span></span> <span data-ttu-id="4fae7-120">このモードでは、2 つの直接的な利点があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-120">This mode provides two immediate benefits:</span></span>

- <span data-ttu-id="4fae7-121">大量のデータに対して Power BI レポートを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-121">You can create Power BI reports over large data volumes.</span></span>
- <span data-ttu-id="4fae7-122">レポートは、Power BI を使って更新する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-122">Reports don't have to be updated by using Power BI.</span></span> <span data-ttu-id="4fae7-123">エンティティ格納が更新されると、レポートに最新のデータが反映されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-123">When Entity store is updated, reports reflect the latest data.</span></span>

<span data-ttu-id="4fae7-124">また、Power BI サービスにキャッシュされるデータがないため、データは、Dynamics 365 for Finance and Operations の環境から離れません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-124">Additionally, data doesn't leave your Dynamics 365 for Finance and Operations environment, because no data is cached in the Power BI service.</span></span>

## <a name="stage-aggregate-measurements-in-entity-store"></a><span data-ttu-id="4fae7-125">エンティティ格納における集計測定のステージング</span><span class="sxs-lookup"><span data-stu-id="4fae7-125">Stage aggregate measurements in Entity store</span></span>
<span data-ttu-id="4fae7-126">集計測定は分析シナリオのためにモデル化されたスター スキーマです。</span><span class="sxs-lookup"><span data-stu-id="4fae7-126">Aggregate measurements are a star schema that is modeled for analytical scenarios.</span></span> <span data-ttu-id="4fae7-127">2016 年 2 月のリリースでは、リアルタイムなメモリ内集計の測定が有効になりました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-127">In the February 2016 release, we enabled real-time, in-memory aggregate measurements.</span></span> <span data-ttu-id="4fae7-128">リアルタイムの集計測定を使用することにより、データのリアルタイム操作に対応する埋め込みチャートおよび主要業績評価指標 (KPI) を有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-128">By using real-time aggregate measurements, you can enable embedded charts and key performance indicators (KPIs) that react to real-time operations on data.</span></span> <span data-ttu-id="4fae7-129">詳細については、[メモリ内リアルタイム集計モデルによる SSAS キューブの置換](../migration-upgrade/in-memory-real-time-aggregate-models.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4fae7-129">For information, see [In-memory, real-time aggregate models replace SSAS cubes](../migration-upgrade/in-memory-real-time-aggregate-models.md).</span></span> <span data-ttu-id="4fae7-130">リアルタイム集計測定は、インメモリの非クラスター化縦棒ストア インデックス (NCCI) の技術を活用します。</span><span class="sxs-lookup"><span data-stu-id="4fae7-130">Real-time aggregate measurements take advantage of the in-memory, non-clustered columnstore index (NCCI) technology.</span></span> <span data-ttu-id="4fae7-131">リアルタイムの集計の測定で作成されたビジュアルおよび集計計算に数秒以内のトランザクションが反映されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-131">Visuals and aggregate calculations that are built over real-time aggregate measurements reflect transactions within seconds.</span></span> <span data-ttu-id="4fae7-132">プラットフォーム更新プログラム 1 (2016 年 5 月) のリリースでは、エンティティ格納でステージングできる集計測定を有効にしました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-132">In the platform update 1 (May 2016) release, we enabled aggregate measurements that can be staged in Entity store.</span></span> <span data-ttu-id="4fae7-133">エンティティ ストアで実施された集計測定は、Power BI を使用して大量のデータを調べる必要がある、ほぼリアルタイムの分析シナリオで使用できます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-133">Aggregate measurements that are staged in Entity store can be used for near-real-time analytical scenarios where large volumes of data must be explored by using Power BI.</span></span> <span data-ttu-id="4fae7-134">開発者は、[モデリングおよび集計データを使用して](model-aggregate-data.md) 集計の測定でリアルタイム分析をモデル化する方法について学びました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-134">As a developer, you learned how to model an aggregate measurement for real-time analytics in [Modeling and using aggregate data](model-aggregate-data.md).</span></span> <span data-ttu-id="4fae7-135">プラットフォーム更新プログラム 1 (2016 年 5 月) のリリースでは、エンティティ格納でステージングできる集計測定をモデル化する機能も追加しました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-135">In the platform update 1 (May 2016) release, we also added the capability to model aggregate measurements that can be staged in Entity store.</span></span> <span data-ttu-id="4fae7-136">Microsoft Visual Studio で、**StagedEntityStore** を集計の測定の用途プロパティとして指定します。</span><span class="sxs-lookup"><span data-stu-id="4fae7-136">In Microsoft Visual Studio, you can specify **StagedEntityStore** as the usage property of an aggregate measurement.</span></span> <span data-ttu-id="4fae7-137">この新しいプロパティは、2016 年 5 月で追加されました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-137">This new property was added in May 2016.</span></span> <span data-ttu-id="4fae7-138">以前は、**InMemoryRealTime** は用途プロパティとして使用できました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-138">Previously, **InMemoryRealTime** was available as the usage property.</span></span>

<span data-ttu-id="4fae7-139">[![Visual Studio にある新しい StagedEntityStore の使用プロパティ](https://msdnshared.blob.core.windows.net/media/2016/06/New-usage-property-in-VS-300x242.png)](https://msdnshared.blob.core.windows.net/media/2016/06/New-usage-property-in-VS.png)</span><span class="sxs-lookup"><span data-stu-id="4fae7-139">[![New StagedEntityStore usage property in Visual Studio](https://msdnshared.blob.core.windows.net/media/2016/06/New-usage-property-in-VS-300x242.png)](https://msdnshared.blob.core.windows.net/media/2016/06/New-usage-property-in-VS.png)</span></span>

<span data-ttu-id="4fae7-140">ただし、ステージングできるように集計測定をモデル化するのはなぜかと疑問に思われるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-140">However, you might wonder why you would model an aggregate measurement so that it can be staged?</span></span> <span data-ttu-id="4fae7-141">メモリ内リアルタイム集計測定を常に使用しないのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="4fae7-141">Why wouldn’t you use in-memory real-time aggregate measurements all the time?</span></span> <span data-ttu-id="4fae7-142">**StagedEntityStore** パターンを使用する理由はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-142">There are several reasons for using the **StagedEntityStore** pattern:</span></span>

- <span data-ttu-id="4fae7-143">調査して分析する必要がある、大量のデータが存在する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-143">There might be large amounts of data that must be explored and analyzed.</span></span>
- <span data-ttu-id="4fae7-144">コード アップグレード プロセスの一部として Microsoft Dynamics AX 2012 R3 から Dynamics 365 for Finance and Operations に移行する解析プロジェクト (つまり、キューブ) を所持する場合があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-144">You might have Analysis projects (that is, cubes) that you migrated from Microsoft Dynamics AX 2012 R3 as part of the code upgrade process to Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="4fae7-145">スキーマには複雑なビューと結合が存在するため、クエリ応答時間は埋め込まれたビジュアルには受け入れられない場合があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-145">Because of the complex views and joins that are present in the schema, query response times might not be acceptable for embedded visuals.</span></span> <span data-ttu-id="4fae7-146">ただし、NCCI テクノロジーを直ちに活用するためにビジュアルをリファクタリングする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-146">However, you might not want to refactor the visuals to take advantage of NCCI technology immediately.</span></span>
- <span data-ttu-id="4fae7-147">運用データベースのスキーマとは異なり、エンティティ ストアのスキーマは特にレポートのためにモデル化されています。</span><span class="sxs-lookup"><span data-stu-id="4fae7-147">Unlike the operational database schema, the schema in Entity store is modeled specifically for reporting.</span></span> <span data-ttu-id="4fae7-148">したがって、エンティティ ストアのスキーマから新しいレポートを作成する方がはるかに簡単です。</span><span class="sxs-lookup"><span data-stu-id="4fae7-148">Therefore, it's much easier to build new reports from the schema in Entity store.</span></span>
- <span data-ttu-id="4fae7-149">自分のシナリオが、操作の数秒以内での分析データの更新を必要としない場合があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-149">Your scenario might not require that analytical data be updated within seconds of an operation.</span></span> <span data-ttu-id="4fae7-150">データ検索を有効にするために構築されているほとんどの Power BI レポートは、このカテゴリに分類されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-150">Most Power BI reports that are built to enable data exploration fall into this category.</span></span> <span data-ttu-id="4fae7-151">約 10 分でデータをリフレッシュすることがシナリオで許容される場合は、段階的なパターンを使用する場合があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-151">If data freshness of approximately 10 minutes is acceptable for your scenario, you might want to use the staged pattern.</span></span>

<span data-ttu-id="4fae7-152">上記の理由のいずれかによってユーザーの状況がカバーされる場合、エンティティ店舗で集計測定を実行し、Power BI 統合に対して使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-152">If one of the preceding reasons covers your situation, you should stage your aggregate measurement in Entity store and it use for Power BI integration.</span></span>

## <a name="update-entity-store"></a><span data-ttu-id="4fae7-153">エンティティ店舗の更新</span><span class="sxs-lookup"><span data-stu-id="4fae7-153">Update Entity store</span></span>
<span data-ttu-id="4fae7-154">クライアントで、**エンティティ格納**ページは**システム管理** &gt; **設定** &gt; **エンティティ格納**で表示できます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-154">In the client, you can find the **Entity Store** page at **Systems administration** &gt; **Setup** &gt; **Entity Store**.</span></span>

<span data-ttu-id="4fae7-155">[![エンティティ格納ページ](./media/entity-store-form-1024x548.jpg)](./media/entity-store-form.jpg)</span><span class="sxs-lookup"><span data-stu-id="4fae7-155">[![Entity Store page](./media/entity-store-form-1024x548.jpg)](./media/entity-store-form.jpg)</span></span>

<span data-ttu-id="4fae7-156">このページには、集計の測定の一覧が含まれています。</span><span class="sxs-lookup"><span data-stu-id="4fae7-156">This page includes a list of aggregate measurements.</span></span> <span data-ttu-id="4fae7-157">これらの集計測定はエンティティ格納内で実施することができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-157">You can stage any of these aggregate measurements in Entity store.</span></span> <span data-ttu-id="4fae7-158">開発者で、アプリケーション オブジェクト ツリー (AOT) で使用できる集計測定に関する知識があれば、なぜ一部の集計測定値がここに表示されないのか疑問に思われるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-158">If you're a developer and are familiar with the aggregate measurements that are available in the Application Object Tree (AOT), you might wonder why some aggregate measurements aren't shown here.</span></span> <span data-ttu-id="4fae7-159">AX 2012 R3 (つまり、アップグレード プロセスの一部として移行された SQL Server Analysis Service プロジェクト) から移行した測定値を集計する場合は、開発者が用途プロパティを **StagedEntityStore** に変更するまで展開できません。</span><span class="sxs-lookup"><span data-stu-id="4fae7-159">If you have aggregate measurements that you migrated from AX 2012 R3 (that is, SQL Server Analysis Services projects that were migrated as part of the upgrade process), they can't be deployed until a developer changes the usage property to **StagedEntityStore**.</span></span> <span data-ttu-id="4fae7-160">この動作は意図的です。</span><span class="sxs-lookup"><span data-stu-id="4fae7-160">This behavior is intentional.</span></span> <span data-ttu-id="4fae7-161">集計の測定に影響を与える一般的なアップグレードの問題のいくつかを取り込むことを目的とする、ベスト プラクティスの警告とエラーを有効にしました。</span><span class="sxs-lookup"><span data-stu-id="4fae7-161">We have enabled best practice warnings and errors that are intended to capture some of the common upgrade issues that affect aggregate measurements.</span></span> <span data-ttu-id="4fae7-162">ほぼリアルタイムな (NCCI) モードを使用する場合は、ベスト プラクティスのエラーや警告を修正する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-162">You should fix best practice errors and warnings if you plan to use near-real-time (NCCI) mode.</span></span> <span data-ttu-id="4fae7-163">2016 年 5 月の更新時点で、管理者は**エンティティ格納**ページで**更新**をクリックして定期更新をスケジュールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-163">As of the May 2016 update, the administrator must schedule a periodic update by clicking **Refresh** on the **Entity Store** page.</span></span> <span data-ttu-id="4fae7-164">**更新** ボタンを使用すると、以下の図に示すように、1 回限りの更新 (つまり、デモ) または定期的な更新のスケジュールを実行することができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-164">You can use the **Refresh** button for a one-time update (that is, demo) or to schedule periodic updates, as shown in the following illustration.</span></span>

<span data-ttu-id="4fae7-165">[![ダイアログ ボックスの更新構成](./media/retail-cube-refresh-1024x548.jpg)](./media/retail-cube-refresh.jpg)</span><span class="sxs-lookup"><span data-stu-id="4fae7-165">[![Configure refresh dialog box](./media/retail-cube-refresh-1024x548.jpg)](./media/retail-cube-refresh.jpg)</span></span>

<span data-ttu-id="4fae7-166">バッチ フレームワークはスケジューリングに使用されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-166">The batch framework is used for scheduling.</span></span> <span data-ttu-id="4fae7-167">したがって、更新ジョブは、バッチ フレームワークの機能を使用して監視、負荷分散、優先順位付けを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-167">Therefore, refresh jobs can be monitored, load balanced, and prioritized by using the capabilities of the batch framework.</span></span> <span data-ttu-id="4fae7-168">2016 年 5 月更新時点では、完全な更新プログラムのみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-168">As of the May 2016 update, we support only full updates.</span></span> <span data-ttu-id="4fae7-169">ただし、まもなく差分更新が有効化されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-169">However, we will enable incremental updates soon.</span></span> <span data-ttu-id="4fae7-170">最終的には、将来の更新プログラムにおいて、システムが実際の使用パターンに基づくエンティティ格納が更新されます。</span><span class="sxs-lookup"><span data-stu-id="4fae7-170">Eventually, in a future update, the system will update Entity store based on actual usage patterns.</span></span> <span data-ttu-id="4fae7-171">したがって、管理者は **更新のコンフィギュレーション** ダイアログ ボックスを例外としてのみ使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4fae7-171">Therefore, as an administrator, you will have to use the **Configure refresh** dialog box only as an exception.</span></span>

