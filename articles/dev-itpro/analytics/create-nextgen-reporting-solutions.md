---
title: レポート ソリューションの作成
description: このチュートリアルでは、データをエクスポートしてレポートを作成する方法、定義済みのビューを展開してチャートにナビゲーションを追加する方法、フリーフォームのレポート デザイナーを使用する方法、およびパラメータの操作方法をカスタマイズする方法について説明します。
author: TJVass
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Developer
ms.reviewer: robinr
ms.search.scope: Operations
ms.custom: 21551
ms.assetid: 2e1c96f8-46c9-428e-bb3d-6791f2a954ef
ms.search.region: Global
ms.author: tjvass
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 4e5ff0918ad7154c5c9c2cda85e861ec241f7529
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/15/2019
ms.locfileid: "1548639"
---
# <a name="create-reporting-solutions"></a>レポート ソリューションの作成

[!include [banner](../includes/banner.md)]

このチュートリアルでは、データをエクスポートしてレポートを作成する方法、定義済みのビューを展開してチャートにナビゲーションを追加する方法、フリーフォームのレポート デザイナーを使用する方法、およびパラメータの操作方法をカスタマイズする方法について説明します。

## <a name="prerequisites"></a>必要条件

このチュートリアルでは、ユーザーは、Microsoft Dynamics 365 for Finance and Operations 環境にアクセスし、インスタンスの管理者としてプロビジョニングされる必要があります。

## <a name="key-concepts"></a>重要な概念
- Finance and Operations でレポートを作成および使用するさまざまな方法を説明する
- フォームおよびワークスペースの埋め込みの集計レポートへの対話機能の追加
- フレームワーク拡張を使用して、SSRS ベースのビジネス文書のパラメーター エクスペリエンスをカスタマイズする
- Microsoft Excel を含む外部のツールを使用してレポートを作成するリスト ページのデータをエクスポートする
- Visual Studio 2015 で強化された開発ツールを使用して最新のレポート デザインを作成する

## <a name="whats-new-in-reporting"></a>レポートの新機能とは
- AX フォームおよびレポートへの埋め込みレポート ドリルスルー ナビゲーション
- 埋め込みレポートのドリルダウン リンクを使用したレポート間の移動
- ユーザー設定の印刷設定のサポートを含む複数のドキュメント ルーティング サービスの拡張機能
- 導入されたドキュメント ブランド管理の管理ツール
- 埋め込みチャート コントロールを通じて使用可能な追加の視覚エフェクト
- レポート本文の日付と金額は、「日付、時刻、および数字の形式」のユーザー設定に基づいて書式設定されます
- ネットワーク印刷監視フォーム
- VS クエリ選択ツールを通じてサポートする必要があるテーブル拡張

## <a name="what-is-a-report-in-the-finance-and-operations"></a>Finance and Operation で「レポート」とは何ですか ?
レポートは、単に構造化されたデータ セットの表示として定義することができます。 これには、表形式のレイアウトで提示されたトランザクション データと集約情報の高度なグラフィカル ビューが含まれます。 この広範な定義を考慮するために、Finance and Operations では、複雑なビジネス要件を満たすレポートを作成するためのツールをいくつか提供しています。 ERP におけるレポートの一般的なアプリケーションは次のとおりです。

- 転記処理の一部としてトランザクション ドキュメントのアーカイブと作成をしています
- 製造から倉庫管理、販売へとオーダーを追跡するための梱包明細の生成
- 主要業績評価測定の監視およびデータの傾向を提示
- フィルター処理された検索を通じたクライアントのナビゲーション
- 顧客および従業員に高度なブランド ドキュメントを配布
- 企業の状態を明確に示し方法でデータを抽出

開発者にとって最も難しいのは、顧客の要件を考慮して、*適切な*ビジネス インテリジェンスの視覚化ツールを選択することです。 これを行うには、レポート作成に使用できるツールを使用して、提供される機能を理解することが重要です。 Finance and Operations では、次の基本的なレポート要件をサポートするためのツールがあります。

- **Excel 統合** – Microsoft Excel を使用したデータ管理と分析が可能
- **埋め込み分析** – グラフやグリッドなどのネイティブ コントロールを使用してワークスペースに集計データを追加する
- **レポート サービス** – SSRS ベースのソリューションを使用して精度が必要なビジネス ドキュメントを作成します
- **Power BI 統合** – どこからでもアクセスできるレポートの作成と共有
- **Management Reporter** – 財務諸表を作成するユーザーを支援するように設計されています。

次のテーブルを使用して、これらのレポート ツールの基本特性を比較できます。

| 工具                | 作成者     | ターゲット     | データ                         | 消耗       | デザイナー  |
|---------------------|------------|------------|------------------------------|-------------------|-----------|
| Excel               | Power User | Power User | トランザクションの                | 外部品目番号          | 自由書式 |
| 組み込み型 BI         | 開発者  | すべてのユーザー  | 集約                   | 内部          | モデル化済み   |
| SSRS レポート         | 開発者  | すべてのユーザー  | トランザクションと集計 | 内部/外部 | 自由書式 |
| Power BI            | Power User | すべてのユーザー  | 集約                   | 内部/外部 | 自由書式 |
| Management Reporter | Power User | Power User | トランザクションの                | 外部品目番号          | モデル化済み   |

## <a name="create-a-report-using-list-pages"></a>リスト ページを使用してレポートを作成する
このセクションでは、エンティティの詳細フォームに表示される Finance and Operations のデータをエクスポートするプロセスについて説明します。 ここで、Finance and Operations の各フォームが、Excel の権限を使用して管理および分析するデータのソースとして表示される方法について示します。

### <a name="create-an-analysis-report-based-on-all-rentals-in-fleet-management-that-are-marked-as-complete"></a>完了とマークされているフリート管理のすべてのレンタルに基づいて分析レポートを作成する

1. Internet Explorer を開き、Finance and Operations インスタンスの基本 URLに移動してサインインします。

    1. クラウド環境では、ベース URL は LCS から取得されます。
    2. ローカル VM の、基準 URL は https://usnconeboxax1aos.cloud.onebox.dynamics.comです

2. ダッシュ ボードで、右にスクロールし、**予約管理**タイルをクリックします。
3. **概要** セクションで、**すべてのレンタル** タイルをクリックします。
4. メイン グリッドの横にあるフィルター アイコンをクリックして、**フィルター**ウィンドウを展開します。
5. **フィルター フィールドの追加**をクリックし、次にドロップダウン リストの**ステータス**をクリックします。
6. 状態フィルター フィールドの**完了**を入力し、**適用**をクリックします。
7. ページの操作バーを展開し、**Office で開く**をクリックして、次に**レンタル**を選択します。

    [![FMRentals エクスポート](./media/fmrentals-export.png)](./media/fmrentals-export.png) 

    データをエクスポートした後、Excel ツールのパワーと柔軟性を使用して、プレゼンテーション、または追加の分析のレポートを作成できます。 Excel で作成したセルフサービス レポートの例を次に示します。

    [![FMRentals 分析](./media/fmrentals-analysis-1024x775.png)](./media/fmrentals-analysis.png)

8. ブラウザー セッションおよびエクスポートされた Excel ファイルを閉じます。

### <a name="advantages-of-list-pages"></a>リスト ページのメリット

- 外部レポートおよび Excel のような分析ツールを使用する、トランザクション ビジネス データにアクセスするための柔軟性のあるソース
- エンドユーザーが開発者を必要とせずに、必要なデータ セットをモデル化できるよう許可します。
- リアルタイムのビジネス情報への直接アクセス

## <a name="expand-predefined-views-and-add-navigation-to-charts"></a>定義済みのビューを展開し、グラフへのナビゲーションを追加
ビジネス インテリジェンスは組織のすべてのレベルで役に立ちます。 埋め込みコントロールを使用して、ターゲット ペルソナに基づいて最も関連性の高い情報を提供します。 Microsoft Dynamics 365 for Finance and Operations のネイティブ コントロールは、集計データと対話する直観的かつ便利な方法をユーザーに提供し、十分な情報を得たうえでの意思決定を可能にします。

### <a name="create-development-project"></a>開発プロジェクトの作成

1. デスクトップで、**Visual Studio 2015** ショートカットを右クリックして、**管理者として実行**を選択して開発環境を開きます。
2. ツール バーで、**表示**をクリックし、**アプリケーション エクスプローラー**を選択します。
3. **フリート管理**モジュールで、**アプリケーション エクスプローラー**を使用して **FMReservationsReport** フォームを検索します。
4. **アプリケーション エクスプローラーの**検索結果で、**FMReservationsReport** フォームを右クリックしてから、**新しいプロジェクトに追加**を選択します。
5. **Finance and Operations プロジェクト** テンプレートを選択し、**OK** をクリックしてプロジェクトを作成します。
6. **ソリューション エクスプローラー**で **FMReservationsReport** メニュー項目を右クリックしてから、**スタートアップ オブジェクトとして設定**を選択します。
7. Ctrl+Shift+B キーを押して、プロジェクトを保存およびビルドします。
8. Ctrl + F5 キーを押して、レポートを含むフォームを読み込みます。

    [![FMCustomer アクティビティ](./media/fmcustomer-activity-300x224.png)](./media/fmcustomer-activity.png) 

この時点で、集計データの事前に定義されたグラフのビジュアル化のコレクションがあります。 コントロールは、ホバー テキスト、シリーズ フィルタリング、タッチ拡張などの基本的な対話型機能を提供します。 ただし、より良いユーザー対話が要求されるのは、多くの場合適切なことです。

### <a name="change-the-default-chart-type-for-the-visualization"></a>視覚化のための既定のグラフ タイプの変更

1. ブラウザー セッションを終了して、Visual Studio プロジェクトに戻ります。
2. **アプリケーション エクスプローラー**を開いて、**FMReservationsByCustPart** フォームを右クリックしてから、**プロジェクトに追加**を選択します。
3. **FMReservationsByCustPart** フォーム デザイナーを開きます。
4. **ReservationsByCust** グラフ定義の**シリーズ** コレクションへのアクセス。
5. **SysBuildChatMeasure1** シリーズ定義を選択
6. **プロパティ** ウィンドウで**外観**セクションを検索します。
7. **グラフ タイプ**の値を更新し、**Pie** を選択します。
8. Ctrl+Shift+B キーを押して、プロジェクトを保存およびリビルドします。
9. Ctrl + F5 キーを押してレポートを実行します。

**顧客別引当** ビューは、顧客間のレンタル活動を比較するタスクを簡略化するため、円グラフを使用して集計データ セットを視覚化するようになりました。 

[![FMCustomer アクティビティ 2](./media/fmcustomer-activity-2-1024x733.png)](./media/fmcustomer-activity-2.png) 

追加の機能を以下に示します。

- モデル化されたプロパティを使用したコンテキスト ドリル スルー ナビゲーションの定義
- X++ フォーム ロジックを使用したドリルスルー リンクの管理

### <a name="advantages-of-embedded-aggregate-visualizations"></a>埋め込み集計視覚エフェクトのメリット

- 組織のあらゆるレベルで、情報に基づく意思決定を促進するためにシンプルで直感的に設計されています
- コンシューマーのニーズに合わせて調整された、事前に定義されたビュー
- ユーザーがデータの主要業績評価のトレンドを認識できるよう補強する

## <a name="using-the-freeform-report-designer"></a>自由形式レポート デザイナーの使用
SSRS は、引き続き ERP アプリケーションの高度なビジネス ドキュメント ソリューションを作成するためのプラットフォームです。 ホストされたサービスは、統合されたパラメーター経験を持つ大量かつ高度なトランザクション レポート用に設計されています。 Document Printing & Distribution Services によってサポートされており、これらのソリューションは電子メール、印刷、アーカイブ、およびバルク配分向けの正確なドキュメントを作成するのに最適です。

### <a name="open-the-precision-designer"></a>Precision Designer を開く

1. ブラウザー セッションを終了して、Visual Studio プロジェクトに戻ります。
2. 有効なプロジェクトを閉じるには、**ファイル** &gt; **ソリューションを閉じる**をクリックします。
3. **アプリケーション エクスプ ローラー**を使用して、**FMRentalsByCust** という名前のオブジェクトを検索します。
4. **アプリケーション エクスプローラーの**検索結果で、**クラス**、**出力メニュー項目**、および **FMRentalsByCustomer** レポートをすべて選択します。
5. 右クリックし、**新しいプロジェクトに追加** を選択します。
6. **Dynamics 365** テンプレートを選択し、**OK** をクリックしてプロジェクトを作成します。
7. **ソリューション エクスプローラー**で、**FMRentalsByCustomer** レポートをダブルクリックしてデザイナーを開きます。
8. デザイナー定義のリストを表示するには、デザイナーの**デザイナー**コレクションを展開します。
9. 精密なデザイナーを使いレポート定義を表示するには、**Report** デザインをダブルクリックします。

[![レポート デザイナー](./media/report-designer-1024x665.png)](./media/report-designer.png) 

上図は、Visual Studio 2015 Precision Designer を使用して表示される FMRentalsByCustomer レポート デザイン定義のスクリーン ショットです。 Precision Designer には、レポートのコンテンツおよびレイアウトをカスタマイズできる組み込みツールが備わった、自由書式デザイン サーフェイスが用意されています。 また、埋め込み VB コードを活用して、実行時デザイン操作を作成し、ユーザーとの対話をサポートすることができます。 統合されたツールとして、開発者は、AX EDT に基づいてレポート本文のデータをフォーマットするために、AX ラベルとパブリック API を参照することができます。 MSDN には、SSRS 書式設定機能に関連する豊富な開発者ドキュメントが用意されています。 有効 SSRS レポートを設計する基本的な方法については、[Reporting Services レポート (SSRS)](https://msdn.microsoft.com/en-us/library/bb522712.aspx) を参照してください。

## <a name="customizing-the-parameter-experience"></a>パラメータ経験のカスタマイズ
レポート フレームワークは、モデル化されたソリューションを使用して対処できない要件を持つ先進的なソリューションを促進するため、サービスの拡張機能を通じて柔軟性を提供します。 VS デザイナーを使用して、基本的なパラメーターの書式設定、グループ化、入力の検証を追加します。 X++ ベースのデータ コントラクト検証はより高度なシナリオで使用可能です。 ユーザー インターフェイス (UI) ビルダ クラスを追加して、レポートを実行する前にセッション入力を促すパラメータ ウィンドウをカスタマイズすることを検討してください。 これらのカスタム拡張機能は、次の機能に有効です。

- ダイアログ フィールド イベントのオーバーライド
- レポート パラメーター インラインの検証
- ダイアログ フィールドにカスタマイズされた参照の追加
- ダイアログ管理のレイアウトの変更
- 画像を含むカスタム コントロールの追加

### <a name="defining-parameters-defaulting-using-code"></a>コードを使用してパラメータを既定設定を定義する

1. **ソリューション エクスプローラー**で、**FMRentalsByCustUIBuilder** クラスをダブルクリックしてデザイナーを開きます。
2. クラス**構築**メソッドを検索して、次のように初期化コードを更新します

    ```
    public void build()
    {
        Dialog dialogLocal = this.dialog();
        contract = this.dataContractObject() as FMRentalsByCustContract;// associate dialog field with data contract method
        this.addDialogField(methodStr(FMRentalsByCustContract, parmCustGroupId), contract);dialogLocal.addGroup("@SYS41297");
        fromDateField = this.addDialogField(methodStr(FMRentalsByCustContract, parmFromDate), contract);
        toDateField = this.addDialogField(methodStr(FMRentalsByCustContract, parmToDate), contract);// set the default date range values
        fromDateField.value(today() - 365);
        toDateField.value(today());
    }
    ```

3. Ctrl+Shift+B キーを押して、プロジェクトを保存およびリビルドします。
4. Ctrl + F5 キーを押してレポートを実行します。

[![FMRentalsByCust コントロール](./media/fmrentalsbycust-controls-1024x691.png)](./media/fmrentalsbycust-controls.png) 

上記のパラメーター初期化コードは、今日の日付に関連したレポート実行の既定値を設定します。 フレームワークのレポート パラメーターの既定処理をオーバーライドするには UIBuilder クラスを使用します。 追加の拡張機能のシナリオがサポートされています。

- コントローラー クラスを使用したセッション コンテキストに基づいてクエリ範囲を自動的に設定する
- 共有メニュー項目を使用して実行時にレポートのデザインを選択する
- ビジネス ロジックを使用したレポートのデータ コントラクトの値の変更

> [!NOTE]
> この例では、RDP ベースのレポートを使用する UIBuilder 拡張子を示しています。 UIBuilder 拡張子を含むクエリ基準の例は、**FMCustomerList** レポートを表示します。

## <a name="using-vb-code-to-manage-running-balances"></a>VB コードを使用して実行中の残高の管理
レポート フレームワークは、モデル化されたソリューションを使用して対処できない要件を持つ先進的なソリューションを促進するため、サービスの拡張機能を通じて柔軟性を提供します。 VS デザイナーを使用して、基本的なパラメーターの書式設定、グループ化、入力の検証を追加します。 X++ ベースのデータ コントラクト検証はより高度なシナリオで使用可能です。 ユーザー インターフェイス (UI) ビルダ クラスを追加して、レポートを実行する前にセッション入力を促すパラメータ ウィンドウをカスタマイズすることを検討してください。 これらのカスタム拡張機能は、次の機能に有効です。

- ダイアログ フィールド イベントのオーバーライド
- レポート パラメーター インラインの検証
- ダイアログ フィールドにカスタマイズされた参照の追加
- ダイアログ管理のレイアウトの変更
- 画像を含むカスタム コントロールの追加

### <a name="import-the-section-resources"></a>セクション リソースをインポートします。

1. ブラウザー セッションを終了して、Visual Studio プロジェクトに戻ります。
2. ツールバーで、**DYNAMICS AX** をクリックして、**プロジェクトのインポート…** を選択します。
3. ファイル名ウィンドウで、C:\\FmLab\\Lab10-3 を参照して、**FMRentalDetailsReport.axpp** を選択してから**開く**をクリックします。
4. プロジェクト ファイルの場所テキスト ボックスに、C:\\FmLab\\Lab10-3 と入力します。
5. **現在のソリューション** オプション ボタンをオンにします。
6. **OK** をクリックして閉じます。 プロジェクトがインポートされてを開くまで待機します。
7. **ソリューション エクスプローラー**で新しいプロジェクトを選択して右クリックしてから、**スタートアップ オブジェクトとして設定**を選択します。
8. **ソリューション エクスプローラー**で **FMRentalDetails** メニュー項目を右クリックしてから、**スタートアップ オブジェクトとして設定**を選択します。
9. ソリューション エクスプローラーでプロジェクトを選択し、右クリックしてから **レポートの展開** を選択します。
10. Ctrl + F5 キーを押してレポートを表示します。

[![FMRentalDetails レポート](./media/fmrentaldetails-report.png)](./media/fmrentaldetails-report.png) 

このレポートでは、埋め込み VB スクリプトを使用して、実行中の合計を追跡し、前のページの残高を有効なページで参照できるようにします。 レポートの VB コードを検査するには、Precision Designer でレポート デザインを読み込み、**レポート プロパティ** にアクセスし、**コード** セクションを選択します。 ここで、レポートのヘッダーおよびフッター内で実行されているバランスを表すレポート デザインによって参照されるいくつかの機能が表示されます。

### <a name="advantages-of-ssrs-reports"></a>SSRS レポートのメリット

- 電子メール サポート、バッチによるスケジュール実行、および印刷アーカイブを含む組み込みのバック オフィス ドキュメント管理機能
- Finance and Operations フォームやその他のレポートへドリルダウン ナビゲーション可能なパラメーター化されたビュー
- 地方自治体が規制するビジネス慣行に準拠した正確なドキュメントの作成に使用
