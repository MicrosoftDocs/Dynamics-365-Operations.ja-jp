---
title: 受信したドキュメントへの ER コンフィギュレーションのデザイン
description: この手順では、着信電子ドキュメントを解析するために電子申告 (ER) コンフィギュレーションをデザインする方法について説明します。
author: NickSelin
manager: AnnBe
ms.date: 12/12/2017
ms.topic: business-process
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Operations
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 23004930d2377a3d647435b53b6809cd500f44ac
ms.sourcegitcommit: 45f8cea6ac75bd2f4187380546a201c056072c59
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/12/2019
ms.locfileid: "1741358"
---
# <a name="design-er-configurations-to-parse-incoming-documents"></a>受信したドキュメントへの ER コンフィギュレーションのデザイン

[!include [task guide banner](../../includes/task-guide-banner.md)]

この手順では、着信電子ドキュメントを解析するために電子申告 (ER) コンフィギュレーションをデザインする方法について説明します。 この手順では、サンプル会社 Litware, Inc. 用に作成した必要な ER コンフィギュレーションをインポートし、それを使用して受信電子ドキュメントを解析します。 この手順にあるステップを完了するには、まず「ER コンフィギュレーション プロバイダーの作成および有効なプロバイダーとしてのマーク付け」にある手順を完了する必要があります。

この手順は、「システム管理者」または「電子レポート開発者」ロールが割り当てられているユーザー用に作成されています。 

これらのステップは、任意のデータ セットを使用して完了することができます。 始める前に、トピック「受信ドキュメントを解析してアプリケーション データを更新」 (https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/analytics/parse-incoming-electronic-documents) に一覧表示されたファイルをダウンロードして保存します。 ファイルは次のものです: EFSTA model.xml、EFSTA format.xml、Response1.xml、Response2.xml、Response3.xml、Response4.xml。

1. [組織管理] > [ワークスペース] > [電子申告] の順に移動します。
    * サンプル会社 Litware, Inc. のコンフィギュレーション プロバイダーが使用可能であり、アクティブとしてマークされていることを確認します。 このコンフィギュレーション プロバイダーが表示されない場合は、「コンフィギュレーション プロバイダーの作成および有効なプロバイダーとしてのマーク付け」という手順のステップを完了する必要があります。  
2. [コンフィギュレーションをレポートする] をクリックします。
    * 次のシナリオは、XML 形式で受取電子申告の解析の機能を表示するために使用されます: ERP アプリケーション (Dynamics 365 for Finance and Operations) は Web サービス (http://efsta.org/ EFSTA 会計サービスなど) からデータを要求し、それぞれに応じたアプリケーション データを更新するために着信を解析します。 解析する最も効率的な方法として、XML 形式の受取予定文書の構造が異なっていても、単一の ER 形式が使用されます。   

## <a name="import-and-review-er-configurations"></a>インポート、および ER 構成の確認
受取ファイルの詳細を保存するように設計されたサンプル データ モデルを含む ER モデル構成をインポートします。  
1. [交換] をクリックします。
2. [XML ファイルから読み込む] をクリックします。
    * [参照] をクリックして、EFSTA model.xml ファイルを選択します。  
3. [OK] をクリックします。
4. ツリーで、[EFSTA モデル] を選択します。
5. [デザイナー] をクリックします。
    * インポートされたデータ モデルの構造を確認します。 enumType 列挙型は次のタイプのサービス応答を認識するように定義されています: トランザクションの送信に関する確認を取得、最後に送信されたトランザクションに関する情報の取得、およびサポートされていない応答タイプの認識。   
6. ツリーで、[応答] を展開します。
    * ルート品目「応答」は、それぞれに応じたアプリケーション データを更新するために、サポートされたサービスの応答からどのような種類のデータを受け取らなければならないかを指定するために定義されることに注意してください。   
7. ページを閉じます。
    * ER データ モデルにデータを保管するために受取文書をどのように解析するかを指定する ER 形式構成をインポートします。   
8. [交換] をクリックします。
9. [XML ファイルから読み込む] をクリックします。
    * [参照] をクリックして、EFSTA format.xml ファイルを選択します。  
10. [OK] をクリックします。
11. ツリーで、「EFSTA モデル」を展開します。
12. ツリーで、[EFSTA モデル\EFSTA 形式] を選択します。
13. [デザイナー] をクリックします。
14. [展開] / [折りたたみ] をクリックします。
    * CASE 形式の要素はルートとして使用され、3 つの入れ子になったファイル要素を含んでいることに注意してください。つまり、この形式はいくつかの形式の着信ファイルを解析するように設計されています。  
15. ツリーで、[応答\トランザクションの完了\TraC] を選択します。
    * 送信済みのトランザクションに関する応答が、「TraC」ルート要素から始まることに注意してください。   
16. ツリーで、[応答\最後のトランザクション要求\Tra] を選択します。
    * 最後の送信済みのトランザクションに関する応答が、「Tra」ルート要素から始まることに注意してください。   
17. ツリーで、[応答\予期しない応答\テキスト] を選択します。
    * 上記とは異なる他の任意のタイプの応答を識別するために、入れ子になったテキスト要素を持つ 3 番目のファイルの要素が追加されました。   
18. [形式をモデルにマップ] をクリックします。
    * このモデル マッピングには、データ モデルのアイテムを使用して解析された着信ドキュメントの詳細を格納するデータ フローの定義が含まれています。  
19. [デザイナー] をクリックします。
20. ツリーで、「形式」を展開します。
21. ツリーで、[形式\応答: ケース (応答)] を選択します。
    * 「フォーマット」データ ソースの構造を確認します。 すべての 3 つの応答タイプが個別に提供されることに注意してください。   
22. ツリーで、[形式\応答: ケース (反応)\aType] を選択します。
    * データ ソース品目「aType」は応答タイプを示すために追加され、データ モデル品目「タイプ」にバインドされています。  
23. [検証] タブをクリックします。
24. ツリーで、[タイプ = 形式。応答。aType] を選択します。
    * ER 検証は、トランザクションの送信に関する確認、または最後に送信されたトランザクションに関する情報 (サポートされていない応答の場合) の応答構造が一致しない場合、状況をユーザーに通知するよう構成されていることに注意してください。   
25. ページを閉じます。

## <a name="run-model-mapping-of-er-format-configured-for-parsing-incoming-files"></a>着信ファイルの解析用に構成された ER 形式のモデル マッピングを実行します。
構成された ER 形式が着信サービスの応答を解析する方法を確認するためにテスト目的で作成されたモデル マッピングを実行します。 このステップでは、異なる XML ファイルを使用して、異なるタイプの Web サービス応答をシミュレーションします。   
1. Web ブラウザーなどの xml リーダーで Response1.xml ファイルを開きます。 このファイルには完了したトランザクションに関する確認の詳細が含まれています (「TraC」はルート要素です)。   
2. [実行] をクリックします。
    * [参照] をクリックして、Response1.xml ファイルを選択します。  
3. [OK] をクリックします。
    * 生成された出荷を確認します。 応答タイプは正しく認識され、解析されたことに注意してください (ERModelEnumDataSourceHandler#EFSTA モデル #enumType#C は、トランザクション完了の場合を意味します)。   
    * XML リーダーで Response2.xml ファイルを開きます。 最後に送信したトランザクションに関する情報が含まれています (「Tra」はルート要素です)。   
4. [実行] をクリックします。
    * [参照] をクリックして、Response2.xml ファイルを選択します。  
5. [OK] をクリックします。
    * 生成された出荷を確認します。 応答タイプは正しく認識され、解析されたことに注意してください (ERModelEnumDataSourceHandler#EFSTA モデル #enumType#R は、システムの再起動の場合を意味します)。   
    * XML リーダーで Response3.xml ファイルを開きます。 このファイルは TraZ ルート品目から開始、およびこの構造は ER 形式を使用して構成されていないことに注意してください。   
6. [実行] をクリックします。
    * [参照] をクリックして、Response3.xml ファイルを選択します。  
7. [OK] をクリックします。
    * 生成された出荷を確認します。 応答タイプは、サポートされていない状態として正しく認識されたことに注意してください (ERModelEnumDataSourceHandler#EFSTA モデル #enumType#U)。 対応するメッセージが (ER 検証設定に従って) 情報ログに追加されており、ほとんどのデータ モデルは入力されていません。   
    * XML リーダーで Response4.xml ファイルを開きます。 このファイルの構造は、ルート要素「TraC」の入れ子になった要素の順序を除いて、正常に解析された Response1.xml とほぼ同じであることに注意してください。   
8. [実行] をクリックします。
    * [参照] をクリックして、Response4.xml ファイルを選択します。  
9. [OK] をクリックします。
    * 生成された出荷を確認します。 応答タイプは、サポートされていない状態として正しく認識されたことに注意してください (ERModelEnumDataSourceHandler#EFSTA モデル #enumType#U))。 対応するメッセージが情報ログに追加されており、ほとんどのデータ モデルは入力されていません。 これは、この ER 形式の現在の設定が、着信ファイルのルート品目の、入れ子になった要素の特定の順序を前提としているためです。   
10. ページを閉じます。
11. ツリーで、[応答\トランザクションの完了\TraC] を選択します。
12. 入れ子になった要素のフィールドの解析では、「任意」を選択します。
    * [入れ子になった要素の順序を解析] フィールドで [任意] を選択すると、このルート XML 品目の入れ子になった要素の任意の順番が許可されます。  
13. [保存] をクリックします。
14. [形式をモデルにマップ] をクリックします。
15. [実行] をクリックします。
    * [参照] をクリックして、Response4.xml ファイルを選択します。  
16. [OK] をクリックします。
    * 生成された出荷を確認します。 応答タイプが今、 Response1.xml ファイルと同じものであると正しく認識されたことに注意してください。  

