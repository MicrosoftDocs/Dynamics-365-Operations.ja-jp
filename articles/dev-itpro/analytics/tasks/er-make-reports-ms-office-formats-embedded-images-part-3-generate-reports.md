--- 
title: "画像が埋め込まれた Microsoft Office 形式のレポートを生成する"
description: "次のステップでは、「システム管理者」または「電子申告開発者」ロールのユーザーが、電子申告 (ER) のコンフィギュレーションを設計し、埋め込み画像を含む MS Office 形式 (Excel および Word) で電子ドキュメントを生成する方法を説明します。"
author: NickSelin
manager: AnnBe
ms.date: 06/13/2017
ms.topic: business-process
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
audience: Application User
ms.reviewer: kfend
ms.search.scope: Operations
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: a8b5a5af5108744406a3d2fb84d7151baea2481b
ms.openlocfilehash: e2ab89857f4bf4844123508837c8faa504bc8839
ms.contentlocale: ja-jp
ms.lasthandoff: 04/13/2018

---
# <a name="generate-reports-in-microsoft-office-formats-with-embedded-images"></a>画像が埋め込まれた Microsoft Office 形式のレポートを生成する

[!INCLUDE [task guide banner](../../includes/task-guide-banner.md)]

次のステップでは、「システム管理者」または「電子申告開発者」ロールのユーザーが、電子申告 (ER) のコンフィギュレーションを設計し、埋め込み画像を含む MS Office 形式 (Excel および Word) で電子ドキュメントを生成する方法を説明します。

この例では、サンプル会社「Litware, Inc.」用に作成した ER コンフィギュレーションを使用します。  これらのステップを完了するには、まず、「ER 埋め込み画像付きで MS Office 形式のレポートを作成する (パート 2: コンフィギュレーションの確認)」タスク ガイドにあるステップを完了する必要があります。 これらのステップは「USMF」会社で実行できます。


## <a name="run-format-with-initial-model-mapping"></a>初期モデル マッピングを使用して形式を実行する
1. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
2. クイック フィルターを使用して、値が「USMF OPER」である [銀行口座] フィールドをフィルター処理します。
3. アクション ペインで、[設定] をクリックします。
4. [小切手] をクリックします。
5. [印刷テスト] をクリックします。
    * テスト目的で形式を実行します。  
6. [譲渡性小切手フォーマット] フィールドで、[はい] を選択します。
7. [OK] をクリックします。
    * 作成した出荷を確認します。 なお、会社のロゴは権限者の署名にもレポートにも表示されます。 署名画像は、選択した銀行口座に関連付けられた小切手のレイアウト レコードの「コンテナー」データ型のフィールドから取得されます。  
8. [コピー] セクションを展開します。
9. [編集] をクリックします。
10. [透かし] フィールドで、[無効として透かしを印刷] を入力します。
    * 透かしレイアウトの設定を変更して、Excel 図形要素の生成ドキュメントに透かしのテキストを表示します。  
11. [印刷テスト] をクリックします。
12. [OK] をクリックします。
    * 作成した出荷を確認します。 なお、選択オプションに従って、作成済みのレポートに透かしが表示されます。  
13. ページを閉じます。
14. [アクション] ウィンドウで [支払の管理] をクリックします。
15. [小切手] をクリックします。
16. [フィルターの表示] をクリックします。
17. 次のフィルターを適用します。"次の値のいずれか" フィルター演算子を使用して、[小切手番号] フィールドで "381","385","389" のフィルター値を入力。
18. リストで、すべての行をマークします。
19. [小切手のコピーの印刷] をクリックします。
    * 形式を実行して、選択した小切手を再印刷します。  
    * 作成した出荷を確認します。 選択した小切手が再印刷されていることに注意してください。 会社のロゴとラベルは、事前に印刷されたフォームに表示されているので印刷されません。  

## <a name="modify-the-mapping-of-the-imported-data-model"></a>インポート済データ モデルのマッピングを変更する
1. ページを閉じます。
2. ページを閉じます。
3. [組織管理] > [電子申告] > [コンフィギュレーション] に移動します。
4. ツリーで、「小切手のモデル」を選択します。
5. [デザイナー] をクリックします。
6. [モデルからデータ ソースへのマップ] をクリックします。
7. [デザイナー] をクリックします。
    * 選択した銀行口座に関連付けられている小切手レイアウト レコードに関連付けれたファイルから署名画像を取得するためのデータ モデルの署名品目のバインディングは変更されます。  
8. [詳細の表示] をオフにします。
9. ツリーで、「レイアウト」を展開します。
10. ツリーで、「レイアウト\署名」を展開します。
11. ツリーで、「レイアウト\署名\image = chequesaccount.'<Relations'.BankChequeLayout.Signature1Bmp」を選択します。
12. ツリーで、「chequesaccount」を展開します。
13. ツリーで、「chequesaccount\<Relations」を展開します。
14. ツリーで、「chequesaccount\<Relations\BankChequeLayout」を展開します。
15. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations」を展開します。
16. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations\<Documents」を展開します。
17. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations\<Documents\getFileContentAsContainer()」を選択します。
18. [バインド] をクリックします。
19. [保存] をクリックします。
20. ページを閉じます。
21. ページを閉じます。
22. ページを閉じます。
23. ページを閉じます。

## <a name="run-format-using-the-adjusted-model-mapping"></a>調整済モデル マッピングを使用して形式を実行する
1. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
2. クイック フィルターを使用して、レコードを見つけます。 たとえば、「USMF OPER」という値を含む [銀行口座] フィールドをフィルターします。
3. アクション ペインで、[設定] をクリックします。
4. [小切手] をクリックします。
5. [印刷テスト] をクリックします。
6. [OK] をクリックします。
    * 作成した出荷を確認します。 ドキュメント管理添付ファイルからの画像が権限者の署名として表示されることに注意してください。  

## <a name="use-ms-word-document-as-a-template-in-the-imported-format"></a>インポートされた形式で MS Word ドキュメントをテンプレートとして使用する
1. ページを閉じます。
2. ページを閉じます。
3. [組織管理] > [電子申告] > [コンフィギュレーション] に移動します。
4. ツリーで、「小切手のモデル」を展開します。
5. ツリーで、「小切手のモデル\小切手の印刷形式」を選択します。
6. [デザイナー] をクリックします。
7. [添付ファイル] クリックします。
8. [削除] をクリックします。
9. [はい] をクリックします。
10. [新規] をクリックします。
11. [ファイル] をクリックします。
    * [参照] をクリックし、事前にダウンロードした「小切手テンプレート Word.docx」ファイルを選択します。  
12. ページを閉じます。
13. [テンプレート] フィールドで、値を入力または選択します。
14. [保存] をクリックします。
15. ページを閉じます。
16. [編集] をクリックします。
17. [ドラフトの実行] フィールドで、[はい] を選択します。
18. ページを閉じます。
19. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
20. クイック フィルターを使用して、値が「USMF OPER」である [銀行口座] フィールドをフィルター処理します。
21. [小切手] をクリックします。
22. [印刷テスト] をクリックします。
23. [OK] をクリックします。
    * 作成した出荷を確認します。 出力は、会社のロゴ、権限者の署名および透かしの選択テキストを表示する埋め込み画像付きの MS Word ドキュメントとして生成されたことに注意してください。  


