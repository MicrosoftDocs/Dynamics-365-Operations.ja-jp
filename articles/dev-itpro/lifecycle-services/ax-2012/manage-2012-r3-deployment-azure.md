---
title: Azure 上での AX 2012 R3 の 配置管理
description: このトピックでは、Microsoft Azure での Microsoft Dynamics AX 2012 R3 の配置および管理の方法について説明します。
author: kfend
manager: AnnBe
ms.date: 10/26/2017
ms.topic: article
ms.prod: dynamics-ax-2012
ms.service: ''
ms.technology: ''
audience: Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: AX 2012
ms.custom: 18491
ms.assetid: 04d5d43f-07da-4a81-adce-50e214133b94
ms.search.region: Global
ms.author: kfend
ms.search.validFrom: ''
ms.dyn365.ops.version: 2012
ms.openlocfilehash: 0c503216bd92df68b35a310de9443677828987c0
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/02/2019
ms.locfileid: "1850537"
---
# <a name="manage-ax-2012-r3-deployments-on-azure"></a>Azure 上での AX 2012 R3 の 配置管理

[!include [banner](../../includes/banner.md)]

## <a name="how-do-i-log-on-to-a-virtual-machine"></a>仮想マシンにどのようにログオンしますか。

AX 2012 R3 環境内の仮想マシンにログオンするには、次の手順を実行します。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  プロジェクトを開きます。
3.  **クラウド ホスト環境**をクリックします。
4.  ログオンする仮想マシンを含む環境を選択します。
5.  ページの右側にスクロールします。
6.  **配置ステータス** セクションで、ログオンする仮想マシンのリンクをクリックします。
7.  ページの下部にある**開く**をクリックして、仮想マシンの .rdp ファイルを開きます。
8.  資格情報を求めるメッセージが表示されたら、適切なユーザー名とパスワードを入力します。 この環境の管理者アカウントの一覧については、**クラウド ホスト環境**ページを参照してください。

## <a name="how-do-i-change-the-size-of-a-virtual-machine"></a>仮想マシンのサイズをどのように変更しますか。
仮想マシンのサイズを変更する場合は、次の手順を実行します。

1.  [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
2.  左のナビゲーション ウィンドウで、**仮想マシン**をクリックします。 **仮想マシン** ページが表示されます。
3.  **場所**列の情報を表示し、サイズを変更する仮想マシンを識別します。
4.  仮想マシンの名前をクリックします。 **&lt;コンピューター名&gt;** ページが表示されます。
5.  **構成**をクリックします。
6.  **仮想マシンのサイズ**リストから仮想マシンのサイズを選択します。
7.  ページの下部にある**保存**をクリックします。

## <a name="how-do-i-print-from-a-virtual-machine"></a>どのように仮想マシンから印刷しますか。
仮想マシンを使用するときは、ローカル プリンターにドキュメントを印刷することができます。 次の手順では、仮想マシンをローカル プリンターに接続する方法について説明します。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  プロジェクトを開きます。
3.  **クラウド ホスト環境**をクリックします。 **クラウド ホスト環境** ページが表示されます。
4.  環境を選択します。
5.  環境に関する詳細を表示するためにページの右側にスクロールします。
6.  ログオンする仮想マシンのリンクをクリックします。
7.  ページの下部にある**保存** &gt; **名前を付けて保存**をクリックして .rdp ファイルを保存します。 .rdp ファイルを保存する場所を参照します。
8.  .rdp ファイルを保存した場所に移動します。 その後、.rdp ファイルを右クリックし、**編集** を選択します。
9.  **リモート デスクトップ接続** ウィンドウが表示されます。 次の操作を行います。
    1.  **ローカル リソース** タブをクリックします。
    2.  **プリンター** チェック ボックスをオンにします。
    3.  **接続** をクリックします。

10. 資格情報を求めるメッセージが表示されたら、適切なユーザー名とパスワード (**クラウドによってホストされた環境** ページにある) を入力します。

印刷を選択するとき、ドキュメントはローカル プリンターに送信されます。

## <a name="can-i-add-a-virtual-machine-to-an-environment-thats-already-been-deployed"></a>既に展開されている環境に仮想マシンを追加できますか。
仮想マシンは Azure 上に展開した AX 2012 R3 環境に対して追加 (または削除) することができます。 仮想マシンを追加するには、次の手順を実行します。 

> [!NOTE]
> このセクションで説明する機能は、デモ環境や 2014 年 8 月以前に導入された環境には配置されません。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  プロジェクトを開きます。
3.  **クラウド ホスト環境**をクリックします。 **クラウド ホスト環境** ページが表示されます。
4.  仮想マシンを追加する環境を選択します。
5.  フォームの先頭の近くにある編集 (鉛筆) アイコンをクリックします。
6.  環境に追加する仮想マシンの数を示します。 次に、それらの仮想マシンのサイズを指定します。
    -   この環境で各仮想マシンにインストールされているソフトウェアの詳細については、「[Azure での Microsoft Dynamics AX 2012 R3 配置の計画](plan-2012-r3-deployment-azure.md)」を参照してください。
    -   仮想マシンに関するサイズおよび価格決定の詳細については、[仮想マシンの価格決定の詳細](http://azure.microsoft.com/pricing/details/virtual-machines/) を参照してください。

7.  ライセンスの条項を確認するには、**ソフトウェア ライセンス条項**をクリックします。 次に、チェック ボックスを選択して、条件に同意することを示します。
8.  **次へ** をクリックします。
9.  **展開**をクリックして、追加の仮想マシンを展開する準備が整ったことを確認します。

配置には数時間かかる場合があります。 配置が完了すると、**クラウド ホスト環境** ページの **配置ステータス** 列に **配置済み** が表示されます。 これを確認するためにブラウザーを最新の情報に更新することが必要な場合があります。 配置に失敗すると、すぐにエラー メッセージが表示される場合があります。 配置プロセスでエラーが後に発生する場合に、エラーの詳細がページの右側の詳細ペインに表示されます。

## <a name="how-do-i-shut-down-an-environment"></a>環境をどのようにシャットダウンしますか。
Azure に展開した AX 2012 R3 環境をシャット ダウンする場合は、次の手順を実行します。 環境をシャット ダウンしたとき、その環境はまだ存在します。ただし、その環境内では仮想マシンは実行されません。 仮想マシンが実行されていないときは、それに対して課金されません。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  プロジェクトを選択します。
3.  **クラウド ホスト環境**をクリックします。
4.  シャットダウンする環境を選択します。
5.  フォームの先頭の近くにある一時停止 (||) アイコンをクリックします。
6.  **はい**をクリックして環境をシャットダウンすることを確認します。

この環境が停止されると、配置ステータス列に **停止済** が表示されます。 これを確認するためにブラウザーを最新の情報に更新することが必要な場合があります。 

> [!NOTE]
> **クラウド ホスト環境**ページから環境を停止し、Azure 管理ポータルを使用してその環境内の仮想マシン再起動すると、その環境に関する詳細は**クラウド ホスト環境**ページで利用できなくなります。 たとえば、環境で仮想マシンへのリンク、または環境で使用されるアカウントのユーザー名とパスワードは表示されません。 この問題を解決するには、次のセクションの手順を実行して環境を再起動します。 
>
> 以前は、クラウド ホスト環境に静的 IP アドレスが不足していました。 VM が再起動されると、新しい IP アドレスが割り当てられ、その結果、DNS 設定が無効になります。 この問題のため、環境が停止されたときに SQL と RDS の層をシャットダウンしませんでした。 すべての IP アドレスを静的に設定することにより、環境を停止/開始する際に問題が発生しないようにします。 環境を停止すると、すべての層がシャットダウンされるようになりました。 実稼働環境で実際に使用される高可用性トポロジで使用される停止/開始機能を期待していません。ただし、実稼働配置に移行する前に、高可用性トポロジをテストするときに、この機能が使用されることを予測しています。

## <a name="how-do-i-restart-an-environment"></a>環境をどのように再起動しますか。
シャット ダウンされた AX 2012 R3 環境を再起動する場合は、次の手順を実行します。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  プロジェクトを選択します。
3.  **クラウド ホスト環境**をクリックします。
4.  再起動する環境を選択します。 この環境には、現在、**配置ステータス**列に、**停止済**のステータスがあります。
5.  フォームの先頭の近くにある開始 (三角) アイコンをクリックします。
6.  **はい**をクリックして環境を再起動することを確認します。

この環境が再起動されると、**配置ステータス** 列に **配置済み** が表示されます。 これを確認するためにブラウザーを最新の情報に更新することが必要な場合があります。 

> [!NOTE]
> 以前は、クラウド ホスト環境に静的 IP アドレスが不足していました。 VM が再起動されると、新しい IP アドレスが割り当てられ、その結果、DNS 設定が無効になります。 この問題のため、環境が停止されたときに SQL と RDS の層をシャットダウンしませんでした。 すべての IP アドレスを静的に設定することにより、環境を停止/開始する際に問題が発生しないようにします。 環境を停止すると、すべての層がシャットダウンされるようになりました。 実稼働環境で実際に使用される高可用性トポロジで使用される停止/開始機能を期待していません。ただし、実稼働配置に移行する前に、高可用性トポロジをテストするときに、この機能が使用されることを予測しています。

## <a name="how-do-i-delete-an-environment"></a>環境をどのように削除しますか。
クラウド ホスト環境ツールで環境を配置するとき、仮想マシン、仮想ネットワーク、ストレージ アカウント、およびデータベースのセットが、Azure サブスクリプションに配置されます。 環境を削除すると、それらのリソースが削除されます。 現時点では、Lifecycle Services によってデータ バックアップ サービスが自動的に提供されるわけではありません。 したがって、環境を削除する前に、重要なデータのバックアップと保護に適切な処置を講じてください。 環境を削除するには、プロジェクトの所有者 (最高特権ロール) または環境の所有者でなければなりません。

- **割り当て解除** - このオプションは、配置された各環境の詳細ページに表示され、環境を削除する最初の手順です。 このフェーズでは、すべての VM リソースを停止および割り当て解除します (したがって、使用料はありません)。 ネットワーク、VIPS、エンドポイント、ストレージ、およびデータベースなどの他のリソースは影響を受けません。 **割り当て解除**をクリックすると、続行するかどうかの確認が行われます。 プロセスを続行すると、環境のステータスは、VM リソースを解除中に **Deallocating** に変更されます。 このプロセスでは、環境の規模に応じて時間がかかります。 完了すると、環境のステータスが**保留中の削除**に変更します。 この時点で**割り当て解除**を間違って選択した場合は、何も失われたり変更されたりせずに環境を回復できます。 環境を回復するには、詳細ページの上部にある **開始** をクリックします。
- **削除** - このオプションを選択すると、環境に配置されているすべての Azure リソースが完全に削除され、Lifecycle Services プロジェクトから環境への参照が削除されます。 **削除**をクリックすると、続行するかどうかの確認が行われ、続行する場合、削除しようとしているプロジェクトの名前を入力する必要があります。 正確な名前は、大文字と小文字を正確に入力して処理する必要があります。 一度入力すると、この環境のすべての Azure リソースが削除されている間に、環境のステータスが**削除**に変更されます。

環境を配置した場合、既存の Active Directory/仮想ネットワークに追加される可能性があることに留意してください。 環境を削除しても、クラウド ホスト環境ツールが展開しなかったリソースは削除されません。 

> [!NOTE]
> Lifecycle Services プロジェクトが Azure サブスクリプションに接続していると、サブスクリプションにストレージ アカウントが作成されます。 このストレージ アカウントは、そのプロジェクトから展開されたすべての環境に関連付けられた VHD およびスクリプト コンポーネントのキャッシュとして機能します。 場合によっては、ストレージ アカウントに含まれる VHD とスクリプトは環境間で共有されます。 結果として、割り当て解除/削除操作はこの共有ストレージ アカウントに影響しません。 Azure Premium Storage での配置が実行されると、これらの VM および関連付けられているディスク専用の追加のストレージ アカウントが作成されます。 この環境が削除されると、ストレージ アカウントに格納されているリソースが削除されます。ただし、ストレージ アカウント自体は、プロジェクト レベルのリソースであるため削除されません。

## <a name="how-do-i-delete-a-lifecycle-services-project-and-its-azure-artifacts"></a>Lifecycle Services プロジェクトとその Azure コンポーネントをどのように削除しますか。
プロジェクトから AX 2012 R3 環境を展開したときに作成されたすべての Azure アーティファクトを含む Lifecycle Services プロジェクトを削除するには、次の手順を実行します。

### <a name="1-identify-the-storage-account-that-is-associated-with-the-project"></a>1. プロジェクトに関連付けられているストレージ アカウントを特定する

削除したい Lifecycle Services プロジェクトに関連付けられている Azure ストレージ アカウントを識別するのには、次の手順を実行します。 この手順でストレージ アカウントを削除しませんが、ストレージ アカウントの GUID を識別します。 この GUID は、削除が必要な他の関連する Azure コンポーネントを特定するのに役立ちます。

1. [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
2. 左のナビゲーション ウィンドウで、**仮想マシン**をクリックします。 **仮想マシン** ページが表示されます。
3. <strong>名前</strong>および<strong>場所</strong>の列の情報を使用して、プロジェクトの AX 2012 R3 環境に関連付けられている仮想マシンを特定します。 プロジェクトには複数の仮想マシンが関連付けられている場合がありますが、必要なのは選択するだけです。 <strong>注記: **適切な仮想マシンを見つけたかどうかを確認するには、このページに表示されている名前と、[Lifecycle Services](https://lcs.dynamics.com/en/) の**クラウド ホスト環境</strong>ページに一覧表示されている仮想マシンの名前を比較してください。
4. 仮想マシンの名前の横にある矢印をクリックします。
5. ページ上部の**ダッシュボード**をクリックします。
6. ページの **ディスク** セクションまで下にスクロールします。
7. <strong>VHD</strong> 列にある情報を表示します。 GUID をご確認下さい。 このGUIDは、他の関連するコンポーネントの特定に役立ちます。 URL は、次のようになります。 

```https://dyn&lt;GUID&gt;.blob.core.windows.net/dynamicsdeployments... 
```

### <a name="2-delete-the-environments-in-the-project"></a>2. プロジェクトで環境を削除する

プロジェクトに存在する AX 2012 R3 環境を削除します。 手順については、このトピックのセクション、環境をどのように削除しますか? を参照してください。

### <a name="3-delete-the-image-files-that-were-used-to-create-virtual-machines"></a>3. 仮想マシンを作成するために使用されたイメージ ファイルを削除する

イメージ ファイルを削除するには、次の手順を実行します。 これらの画像ファイルは、Lifecycle Services プロジェクトで AX 2012 R3 環境用の仮想マシンを作成するために使用されました。 **注:** このプロジェクトから配置される唯一の環境のタイプが AX 2012 R3 デモ環境であった場合、削除するイメージ ファイルがない可能性があります。

1.  [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
2.  左のナビゲーション ウィンドウで、**仮想マシン**をクリックします。 **仮想マシン** ページが表示されます。
3.  ページ上部の**イメージ**をクリックします。
4.  **名** 列をクリックしてイメージのリストを並べ替えます。
5.  以前に識別したストレージ アカウントの名前が GUID で始まるすべての画像ファイルについては、以下の手順を実行します。
    1.  その行のステータス フィールドをクリックすることで、イメージ ファイルの行を選択します。 
        > [!NOTE]
        > その行の**名前**フィールドでクリックしないよう注意してください。 その場合は、別のページが表示されます。
    2.  ページの下部にある**削除**をクリックします。
    3.  **関連する VHD の削除** オプションを選択します。

### <a name="4-delete-vhd-files-from-the-storage-account"></a>4. ストレージ アカウントから VHD ファイルを削除する

各 Lifecycle Services プロジェクトに関連付けられたストレージ アカウントに保存されるコンポーネントがいくつかあります。 最大のファイルは、Lifecycle Services プロジェクトの AX 2012 R3 環境用の仮想マシンを作成するために使用された VHD ファイルの*コピー*です。 (これらは、前の手順で削除した VHD ファイルのコピーです。) VHD ファイルが含まれている場合は、ストレージ アカウントを削除することはできません。 ストレージ アカウントから VHD ファイルを削除するには、次の手順を完了します。

1.  [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
2.  左のナビゲーション ウィンドウで、**ストレージ**をクリックします。 **ストレージ** ページが表示されます。
3.  **名**列の情報を表示し、プロジェクトと関連付けられているストレージ アカウントを識別します。
4.  ストレージ アカウントの名前の横にある矢印をクリックします。
5.  ページ上部の**コンテナー**をクリックします。
6.  配置カタログ コンテナの横にある矢印をクリックします。 コンテナー内のファイルの一覧が表示されます。
7.  リスト内の各 .vhd ファイルで、次の手順を実行します。
    1.  .vhd ファイルの行を選択します。
    2.  ページの下部にある**削除**をクリックします。 
        > [!NOTE]
        > 一覧の PowerShell ファイルを削除する必要はありません。 これらは、次の手順でストレージ アカウントを削除すると自動的に削除されます。

### <a name="5-delete-the-storage-account"></a>5. ストレージ アカウントを削除する

Lifecycle Services プロジェクトに関連付けられているストレージ アカウントを削除するのには、次の手順を実行します。

1.  [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
2.  左のナビゲーション ウィンドウで、**ストレージ**をクリックします。 **ストレージ** ページが表示されます。
3.  **名**列の情報を表示し、プロジェクトと関連付けられているストレージ アカウントを識別します。
4.  行の **ステータス** フィールドをクリックすることで、ストレージ アカウントの行を選択します。
5.  ページの下部にある**削除**をクリックします。

### <a name="6-delete-the-management-certificate"></a>6. 管理証明書を削除

Lifecycle Services プロジェクトに関連付けられている管理証明書を削除するのには、次の手順を実行します。

1.  最初にプロジェクトを Azure サブスクリプションに接続したときにダウンロードした管理証明書を検索します。 既定では、管理証明書はコンピューターのダウンロード フォルダーに保存され、**LifecycleServicesDeployment.cer** という名前が付きます。 コンピューターの管理証明書が見つからない場合、次の手順に従うことで、再度それをダウンロードできます。
    1.  Lifecycle Services にログオンします。
    2.  プロジェクトを開きます。
    3.  **クラウド ホスト環境**をクリックします。
    4.  **Microsoft Azure 設定**をクリックします。 Microsoft Azure 設定パネルが画面の横に表示されます。
    5.  **次へ** をクリックします。
    6.  **ダウンロード**をクリックして管理証明書をダウンロードします。

2.  管理証明書 (.cer) ファイルをダブルクリックし、**開く**をクリックします。 **証明書** ウィンドウが表示されます。
3.  **一般**タブで、**発行先**フィールドに名前を記入します。 証明書は、**DynamicsDeployment\_&lt;GUID&gt;** に発行されます
4.  [Azure 管理ポータル](https://manage.windowsazure.com/)にログオンします。
5.  左のナビゲーション ウィンドウで、**設定**をクリックします。 **設定** ページが表示されます。
6.  ページ上部の**管理証明書**をクリックします。 証明書の一覧が表示されます。
7.  **名**列の情報を表示し、削除する管理証明書を識別します。 このページの名前は、手順 3 で特定した名前と一致します。
8.  その管理証明書の行を選択し、ページの下部にある **削除** をクリックします。

### <a name="7-delete-the-project"></a>7. プロジェクトの削除

Lifecycle Services プロジェクトを削除するには、次の手順を実行します。

1.  [Lifecycle Services](https://lcs.dynamics.com/en/) にログオンします。
2.  **すべてのプロジェクト**をクリックします。 **プロジェクト** 一覧のページが表示されます。 **注記:** プロジェクトが 1 つしかない場合は、そのプロジェクトが開きます。 Lifecycle Services の戻るアイコンをクリックして、**プロジェクト** リスト ページを表示します。
3.  削除するプロジェクトの行を選択します。
4.  ページの下部にある**削除**をクリックします。

## <a name="how-is-the-azure-internal-load-balancer-used"></a>Azure 内部ロード バランサはどのように使用されますか。
テストおよび高可用性環境では、クライアント コンポーネントの RPC (2712) と WCF ポート (8101、8201) に関して Azure 内部ロード バランサー (ILB) が利用されます。 これにより、インスタンスがダウンした場合の高可用性を実現できます。 Azure にはポーリング メソッドがあり既定では 15 秒おきにチェックされ、2 つのエラーの後、ILB からそのノードを削除します。 Windows ホスト ファイル (C:\Windows\System32\driver\setchosts) を介して Microsoft Dynamics AXが ILB を利用する方法。 エントリは仮想名 (AOSLoadBalancer) で作成され IP アドレスが割り当てられます (10.1.1.4)。 そこからは、Microsoft Dynamics AX 2012 のコンフィギュレーションが、AOSLoadBalancer に設定されます。 Azure PowerShell スクリプトを使用して、ILB は各 AOS インスタンスに対して 2712、8101、および 8201 に設定されます。 (Lifecycle Services の編集ボタンを使用して) 新しい AOS インスタンスを追加するときに、追加する新しい AOS インスタンスを組み込むためにこれらの PowerShell スクリプトが実行されることに留意してください。

## <a name="how-do-i-set-up-remote-desktop-access-via-corpnet-connected-users"></a>CORPNET 接続されたユーザー経由でモート デスクトップ アクセスを設定するにはどうすればよいですか。
ユーザーが Azure 仮想ネットワークへのトンネル アクセスを介してリモート デスクトップを使用するには、展開でリモート デスクトップ サービス (RDS) を構成し、有効にする必要があります。 Lifecycle Services を使用して RDS が配置されると、配置された RDS 接続ブローカー VM に対して Azure 内部ロード バランサー エンドポイントが作成されます。

1.  Lifecycle Services によって作成された Azure 内部ロード バランサー エンドポイントは、Lifecycle Services の クラウド ホスト環境ページの詳細ウィンドウにあります。 具体的には、"RDS ファーム アクセス" リンクによって指定されたエンドポイント ドメインです。 RDSFarm\#\#\#\#\#.domain.com のように表示されます。
2.  ブラウザーで [http://manage.windowsazure.com](http://manage.windowsazure.com/) を開き、サブスクリプションにログインすることで、このドメインに作成された IP アドレスを取得します。 **クラウド サービス**を開き、RDS マシンに関連付けられているクラウド サービス名をクリックします。 内部 IP である RDS\* VM IP を検索します (例: 10.1.3.4) (ポート 3389)。 これは、RDSFarm \#\#\#.domain.com アドレスに関連付けられている Azure 内部ロード バランサのIPです。
3.  そのドメイン名/IP/ロード バランサーに到達するために、会社のネットワークのユーザーに適切なルーティングおよび DNS エントリを設定します。 その場合、ユーザーは会社のネットワークからリモート デスクトップ アクセスを使用することができます。
