---
title: "データのインポート/エクスポート フレームワーク (DIXF) を使用するデータの移行"
description: "このトピックでは、Microsoft Dynamics AX 2012 のデータ インポート/エクスポート フレームワークを使用してデータを移行する方法について説明します。"
author: kfend
manager: AnnBe
ms.date: 11/13/2017
ms.topic: article
ms.prod: dynamics-ax-2012
ms.service: 
ms.technology: 
audience: Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: AX 2012
ms.custom: 13341
ms.assetid: 6f49739f-2690-4bad-8afc-3310274315fa
ms.search.region: Global
ms.author: kfend
ms.search.validFrom: 
ms.dyn365.ops.version: 2012
ms.translationtype: HT
ms.sourcegitcommit: e782d33f3748524491dace28008cd9148ae70529
ms.openlocfilehash: c49d28bb35426fa09c3f10cf30593dcc4a9ff3ab
ms.contentlocale: ja-jp
ms.lasthandoff: 08/09/2018

---

# <a name="migrate-data-by-using-the-data-importexport-framework-dixf"></a>データのインポート/エクスポート フレームワーク (DIXF) を使用するデータの移行

[!include [banner](../../includes/banner.md)]

 このトピックでは、Microsoft Dynamics AX 2012 のデータ インポート/エクスポート フレームワークを使用してデータを移行する方法について説明します。

**注記:** このトピックには、Microsoft Dynamics AX 2012 R2 累積更新プログラム 7 以降で追加または変更された機能に関する情報が含まれています。 この情報は、AX 2012 R3 にも適用されます。 このトピックには次のプロセスが含まれています。

-   使用する Microsoft Dynamics AX エンティティを決定する
-   データのインポート/エクスポート フレームワークの使用:
    -   ソース データ形式を定義する
    -   処理するグループに追加するエンティティを識別します。
    -   新しいターゲット エンティティの作成
    -   エンティティのターゲット マッピングの変更
    -   処理グループの定義
    -   オプション: エンティティのステージング マッピングにソースを変更します。
    -   オプション: エンティティのステージングからソースへのマッピングを変更します。
    -   処理グループのセキュリティの定義
    -   処理する前にプレビュー エラー
    -   エクスポート データの処理
    -   インポート データの処理

## <a name="plan-to-migrate-data"></a>データ移行の計画
データのインポートは、通常は数回の反復を必要とする複雑なプロセスです。 インポート プロセスには、次の一般的な手順が含まれます。

1.  インポートする必要がある既存システムのデータを特定します。
2.  既存のシステムのデータをクリーンアップすることを検討してください。 たとえば、古いレコードを削除またはアーカイブするかどうか、現在のデータベースに重複レコードが含まれているかどうか、および番号付けスキームを変更するかどうかを決定します。
3.  データを既存のシステムから移動する必要がある Microsoft Dynamics AX 内の関連するデータ構造に慣れてください。 **注記:** 場合によっては、他のシステムにある 1 つのテーブルのデータを Microsoft Dynamics AX の複数のテーブルに移動する必要があります。
4.  インポートする必要があるデータに使用する適切なツールと手法を決定します。 使用できるツールの一覧については、[データのインポート、エクスポート、および移行の計画](http://technet.microsoft.com/library/a05289fb-0f8f-4563-be3c-7c840bfea7e1(AX.60).aspx) を参照してください。
5.  Microsoft Dynamics AX 環境のテストを準備します。 データをインポートする前に、マスター レコードに必要な構成を実行する必要があります。
6.  データをインポートする前に、既存のシステムと Microsoft Dynamics AX 環境のバックアップを作成します。
7.  必要なデータのすべてのタイプの試用インポートを実行します。 **注記:** 最初にインポートを実行するときにエラーが発生することがあります。 発生したエラーを確認して必要な修正プログラムを作成し、インポートを再度実行します。

別の ERP システムから Microsoft Dynamics AX に移動する場合は、マスターおよび参照データをインポートする必要があります。 **注記:** トランザクション データまたは履歴データを Microsoft Dynamics AX にインポートしないようにお勧めします。 代わりに、これらのトランザクションを閉じることができる場合、インポートする前にすべての未処理トランザクションを閉じます。 レポートとコンプライアンスの目的で前のトランザクション データが含まれているデータベースを管理します。 通常、データのエクスポートはそれほど複雑ではありませんが、計画が必要な場合があります。 エクスポート プロセスには、次の一般的な手順が含まれます。

1.  エクスポートする必要がある既存システムのデータを特定します。
2.  既存のシステムのデータをクリーンアップすることを検討してください。 たとえば、古いレコードを削除またはアーカイブするかどうか、現在のデータベースに重複レコードが含まれているかどうか、および番号付けスキームを変更するかどうかを決定します。
3.  データをエクスポートする必要があるシステム内の関連するデータ構造に慣れてください。
4.  エクスポート形式を決定します。 他の種類のシステムにデータを移動する場合に、データを別の Microsoft Dynamics AX インスタンスまたはファイルに移動する場合は、形式を AX にすることができます。
5.  エクスポート前にステージング テーブルでデータを変換またはクリーニングする必要があるかどうかを判断します。

### <a name="determine-which-microsoft-dynamics-ax-entities-to-use"></a>使用する Microsoft Dynamics AX エンティティを決定する

データのインポート/エクスポート フレームワークを含む、事前に定義されたターゲット エンティティの一覧については、[データのインポート/エクスポート フレームワークのエンティティ (DIXF、DMF)](entities-dixf.md) を参照してください。 各エンティティは、エンティティ クラス、ステージング テーブル、およびターゲット テーブルに関連する必要があります。 事前定義されたエンティティについては、これらの値が事前設定されています。

-   ステージング テーブルは、このエンティティがインポート プロシージャに使用されるときに変換される前に、データが書き込まれるテーブルです。
-   エンティティ クラスは、X++ 変換ロジックが格納される場所です。 エンティティ クラスのコピーを作成して変換ロジックを変更することができます。
-   ターゲット テーブルは、エクスポート手順のためにデータが取り出されるテーブル、または完全に変更されたデータがインポート手順のために書き込まれるテーブルです。

<strong>重要: **ステージング テーブル スキーマからターゲット テーブル スキーマへのマッピングは自動的に生成されます。ターゲットの Microsoft Dynamics AX システムをカスタマイズしていない限り、ステージングからターゲットへのマッピングを変更する必要はありません。各ターゲット エンティティの詳細については、**データ インポート/エクスポート フレームワーク</strong> &gt; <strong>設定</strong> &gt; <strong>ターゲット エンティティ</strong>で情報を確認できます。 既定の対象のエンティティが、目的に対応しない場合、システムに既に存在するエンティティを使用して新しいターゲット エンティティを作成できます。 適切なシステムに既に存在するエンティティがない場合は、ユーザー定義のエンティティを作成できます。 カスタム エンティティを作成する方法の詳細については、[データのインポート/エクスポート フレームワークのカスタム ターゲット エンティティを作成する (DIXF、DMF)](create-custom-target-entity-dixf.md) を参照してください。

## <a name="using-the-data-importexport-framework"></a>データのインポート/エクスポート フレームワークの使用
このセクションでは、データ インポート/エクスポート フレームワークを使用してデータをインポートまたはエクスポートする方法について説明します。 このセクションには次のサブセクションが含まれます。

-   ソース データ形式を定義する
-   処理するグループに追加するエンティティを識別します。
-   新しいターゲット エンティティの作成
-   エンティティのターゲット マッピングの変更
-   処理グループの定義
-   オプション: エンティティのステージング マッピングにソースを変更します。
-   オプション: エンティティのステージングからソースへのマッピングを変更します。
-   処理グループのセキュリティの定義
-   処理する前にプレビュー エラー
-   エクスポート データの処理
-   インポート データの処理

### <a name="define-your-source-data-formats"></a>ソース データ形式を定義する

エクスポートまたはインポートするデータのソース データ形式を作成する必要があります。 Microsoft Dynamics AX との間で移行する予定のデータを確認します。 そのデータがファイル内にあるか、Open Database Connectivity (ODBC) 接続を介してアクセスできるデータ格納場所にあるか、または既存の AX 2012 インストールにあるかどうかを判断します。 移行するデータの種類ごとにソース データ形式を作成します。

#### <a name="configure-a-source-data-format-for-data-from-a-csv-or-fixed-width-file"></a>CSV または固定幅ファイルからのデータのソース データ形式をコンフィギュレーションする

ファイルについては、データがコンマ区切り値、固定幅ファイル、Microsoft Excel ファイルまたは XML ファイルで構成される一覧から取得されるかどうかを定義する必要があります。 ソース ファイルには、列の既定値を含めることができます。

1.  **データのインポート/エクスポート フレームワーク**&gt;**設定**&gt;**ソース データ形式**を開きます。
2.  **新規**をクリックし、ソースの名前と説明を指定します。
3.  タイプが **ファイル** であることを確認します。
4.  区切りまたは固定幅ファイルを使用している場合は、**一般**タブで次のオプションの値を選択します。
    <table>
    <colgroup>
    <col width="50%" />
    <col width="50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th>オプション</th>
    <th>説明</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><strong>ファイル形式</strong></td>
    <td><strong>区切り記号</strong> または <strong>固定長</strong> を選択します。 区切り記号形式は、フィールドを区切るために特定の文字を使用します。 固定長の形式は、各フィールドの特定の文字数を取置きします。 <strong>注記:</strong> データ形式ではなく、各エンティティのフィールドの幅が定義されます。</td>
    </tr>
    <tr class="even">
    <td><strong>先頭行のヘッダー</strong></td>
    <td>データ ファイルの最初の行にヘッダー情報が含まれている場合は、このオプションをオンにします。 固定幅形式については、ヘッダー行がある場合、ヘッダー行で値を定義する文字の区切り記号を指定できます。</td>
    </tr>
    <tr class="odd">
    <td><strong>行区切り</strong></td>
    <td>行の区切り記号を選択します。
    <table>
    <thead>
    <tr class="header">
    <th>先頭値</th>
    <th>説明</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td>{CR}{LF}</td>
    <td>ヘッダー行はキャリッジ リターン/改行の組み合わせで区切られます。</td>
    </tr>
    <tr class="even">
    <td>{CR}</td>
    <td>ヘッダー行はキャリッジ リターンで区切られます。</td>
    </tr>
    <tr class="odd">
    <td>{LF}</td>
    <td>ヘッダー行は改行で区切られます。</td>
    </tr>
    <tr class="even">
    <td>セミコロン {;}</td>
    <td>ヘッダー行はセミコロンで区切られます。</td>
    </tr>
    <tr class="odd">
    <td>コロン {:}</td>
    <td>ヘッダー行はコロンで区切られます。</td>
    </tr>
    <tr class="even">
    <td>コンマ {,}</td>
    <td>ヘッダー行はコンマで区切られます。</td>
    </tr>
    <tr class="odd">
    <td>タブ {t}</td>
    <td>ヘッダー行はタブで区切られます。</td>
    </tr>
    <tr class="even">
    <td>縦棒 {|}</td>
    <td>ヘッダー行は縦棒で区切られます。</td>
    </tr>
    </tbody>
    </table></td>
    </tr>
    <tr class="even">
    <td><strong>列区切り</strong></td>
    <td>列の区切り記号を選択します。 使用可能な値の一覧については、行の区切り記号パラメーターの説明を参照してください。</td>
    </tr>
    <tr class="odd">
    <td><strong>テキスト修飾子</strong></td>
    <td>行のテキスト値に、行または列の区切り記号として使用する文字が含まれている場合に、使用される区切り記号を入力します。 たとえば、組織名がコンマを含んでいても、列の区切りとしてコンマを使用している場合、テキストの値に対して使用する別の区切りを入力する必要があります。 この例では、二重引用符 (&quot;) を使用したいと考える場合があります。</td>
    </tr>
    <tr class="even">
    <td><strong>行をスキップ</strong></td>
    <td>まだ処理されていないエラーを含む行をそのままにして処理を続行するには、このオプションを選択します。 このオプションが選択された場合、エラーがログに記録されます。</td>
    </tr>
    </tbody>
    </table>

5.  地域設定の以下の一般的なパラメーターを設定します。

    | オプション              | 説明                                                                                              |
    |---------------------|----------------------------------------------------------------------------------------------------------|
    | **コード ページ**       | Unicode 以外のテキスト用のコード ページを指定します。                                                              |
    | **Unicode**         | Unicode を使用するにはこのオプションを選択します。                                                                       |
    | **言語ロケール** | 注文および日付形式に言語固有の情報を提供するためのロケールを指定します。 |

6.  複数の値の区切り記号には、次の一般的なパラメーターを設定します。

    | パラメーター                    | 説明                                                                                                                                                                 |
    |------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **複数値の区切り** | オプション: 電子メール アドレス、電話番号、または URL など、1 つのレコードに関連付けられている複数の値を含むフィールドに使用する区切り記号を入力します。 |

7.  **アプリケーション**をクリックし、**分析コード**および**名前の順序**にパラメータ値を設定します。
8.  分析コードの以下の一般的なパラメーターを設定します。

    | パラメーター                       | 説明                                                                                                                                                        |
    |---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **分析コード**              | オプション: ソース ファイルに含まれている財務分析コードの一覧を指定します。 財務分析コードは、Microsoft Dynamics AX から取得されます。 |
    | **勘定科目表の区切り記号** | 財務分析コード値の間の区切り記号。                                                                                                                  |
    | **分析コード形式**            | 選択した財務分析コードと区切り記号に基づく、分析コードの定義済みの形式。                                                         |

9.  名前の順序の次の値を設定します。

    | パラメーター         | 説明                                                                      |
    |-------------------|----------------------------------------------------------------------------------|
    | **名前の順序** | 移行中に作成される当事者の既定の名前の順序を指定します。 |

10. フォームを閉じます。

#### <a name="configure-a-source-data-format-for-data-from-an-xml-file"></a>XML ファイルからのデータのソース データ形式をコンフィギュレーションする

このセクションでは、XML ファイルからデータのソースデータ フォーマットを作成する方法について説明します。

1.  **データのインポート/エクスポート フレームワーク**&gt;**設定**&gt;**ソース データ形式**を開きます。
2.  **新規**をクリックし、ソースの名前と説明を指定します。
3.  タイプが **XML** であることを確認します。
4.  **一般**タブで、次のオプションの値を選択します。
    1.  **ファイル形式**フィールドで、**XML** を選択します。
    2.  **言語ロケール** フィールドで、言語ロケールを選択します。
    3.  オプション: **複数値の区切り** で、電子メール アドレス、電話番号、または URL など、1 つのレコードに関連付けられている複数の値を含むフィールドを区切るために使用するロール区切り記号を選択します。

5.  **アプリケーション**をクリックし、**分析コード**および**名前の順序**にパラメータ値を設定します。
6.  分析コードの以下の一般的なパラメーターを設定します。

    | パラメーター                       | 説明                                                                                                                                                        |
    |---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **分析コード**              | オプション: ソース ファイルに含まれている財務分析コードの一覧を指定します。 財務分析コードは、Microsoft Dynamics AX から取得されます。 |
    | **勘定科目表の区切り記号** | 財務分析コード値の間の区切り記号。                                                                                                                  |
    | **分析コード形式**            | 選択した財務分析コードと区切り記号に基づく、分析コードの定義済みの形式。                                                         |

7.  名前の順序の次の値を設定します。

    | パラメーター         | 説明                                                                      |
    |-------------------|----------------------------------------------------------------------------------|
    | **名前の順序** | 移行中に作成される当事者の既定の名前の順序を指定します。 |

8.  フォームを閉じます。

#### <a name="configure-a-source-data-format-for-data-from-an-excel-file"></a>CSV または Excel ファイルからのデータのソース データ形式をコンフィギュレーションする

このセクションでは、Excel ファイルからデータのソースデータ フォーマットを作成する方法について説明します。

1.  **データのインポート/エクスポート フレームワーク**&gt;**設定**&gt;**ソース データ形式**を開きます。
2.  **新規**をクリックし、ソースの名前と説明を指定します。
3.  タイプが **Excel** であることを確認します。
4.  **一般**タブで、次のオプションの値を選択します。
    1.  **ファイル形式**フィールドで、**Excel** を選択します。
    2.  **言語ロケール** フィールドで、言語ロケールを選択します。
    3.  オプション: **複数値の区切り** で、電子メール アドレス、電話番号、または URL など、1 つのレコードに関連付けられている複数の値を含むフィールドを区切るために使用するロール区切り記号を選択します。

5.  **アプリケーション**をクリックし、**分析コード**および**名前の順序**にパラメータ値を設定します。
6.  分析コードの以下の一般的なパラメーターを設定します。

    | パラメーター                       | 説明                                                                                                                                                        |
    |---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **分析コード**              | オプション: ソース ファイルに含まれている財務分析コードの一覧を指定します。 財務分析コードは、Microsoft Dynamics AX から取得されます。 |
    | **勘定科目表の区切り記号** | 財務分析コード値の間の区切り記号。                                                                                                                  |
    | **分析コード形式**            | 選択した財務分析コードと区切り記号に基づく、分析コードの定義済みの形式。                                                         |

7.  名前の順序の次の値を設定します。

    | パラメーター         | 説明                                                                      |
    |-------------------|----------------------------------------------------------------------------------|
    | **名前の順序** | 移行中に作成される当事者の既定の名前の順序を指定します。 |

8.  フォームを閉じます。

#### <a name="configure-a-source-data-format-for-data-from-an-odbc-connection"></a>ODBC 接続からのデータのソース データ形式をコンフィギュレーションする

このセクションでは、ODBC 接続からのデータのソース データ フォーマットを設定する方法について説明します。

1.  **データのインポート/エクスポート フレームワーク** &gt; **設定** &gt; **ソース データ形式**を開きます。
2.  **新規** をクリックします。
3.  **型**をクリックし、**ODBC** を選択します。
4.  データのインポート/エクスポート フレームワークは、データ ソース名 (DSN) の種類を使用して ODBC に接続します。 **DSN** セクションで、接続に使用している DSN の種類と DSN が保管されている場所を定義します。 ODBC 接続に DSN をまだ定義していない場合、使用する DSN の種類を指定します。 DSN の詳細については、[ODBC データ ソースの管理を使用する](http://go.microsoft.com/fwlink/?LinkId=269895) を参照してください。
    -   **ユーザー DSN** – このタイプは、DSN を作成した担当者のみ使用できます。
    -   **システム DSN** – このタイプは、コンピューターのすべてのユーザーが使用できます。
    -   **ファイル DSN** – このタイプを使用して、データ プロバイダーに接続できます。 ファイル DSN は、同じドライバーがインストールされているユーザーによって共有できます。

5.  **検証**をクリックして、データのインポート/エクスポート フレームワークが使用するアカウントが DSN に接続できることを確認します。 データのインポート/エクスポート フレームワーク サービス アカウントが接続できる場合は、検証アイコンが緑色になります。
6.  フォームを閉じます。

#### <a name="configure-a-source-data-format-for-data-from-microsoft-dynamics-ax"></a>Microsoft Dynamics AX からのデータのソース データ形式のコンフィギュレーション

このセクションでは、Microsoft Dynamics AX のデータのソースデータ形式を構成する方法について説明します。

1.  **データのインポート/エクスポート フレームワーク** &gt; **設定** &gt; **ソース データ形式**を開きます。
2.  **新規** をクリックします。
3.  **型**をクリックし、**AX** を選択します。
4.  **分析コード** および **名前の順序** のパラメーターの値を設定する必要があります。 分析コードの以下の一般的なパラメーターを設定します。

    | パラメーター                       | 説明                                                                                                                                                        |
    |---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **分析コード**              | オプション: ソース ファイルに含まれている財務分析コードの一覧を指定します。 財務分析コードは、Microsoft Dynamics AX から取得されます。 |
    | **勘定科目表の区切り記号** | 財務分析コード値の間の区切り記号。                                                                                                                  |
    | **分析コード形式**            | 選択した財務分析コードと区切り記号に基づく、分析コードの定義済みの形式。                                                         |

5.  名前の順序の次の値を設定します。

    | パラメーター         | 説明                                                                      |
    |-------------------|----------------------------------------------------------------------------------|
    | **名前の順序** | 移行中に作成される当事者の既定の名前の順序を指定します。 |

6.  フォームを閉じます。

### <a name="identify-entities-to-add-to-a-processing-group"></a>処理するグループに追加するエンティティを識別します。

処理グループに含まれるエンティティはまとめて処理されます。 処理グループ内に、次の種類のエンティティを含める必要があります。

-   同時に処理する必要がある関連するエンティティ
-   その処理が特定のシーケンスで実行されることを要求するエンティティ

一緒に移行を希望するエンティティ例には、**顧客**および**顧客住所**が含まれます。

### <a name="create-a-new-target-entity"></a>新しいターゲット エンティティの作成

移行するデータは既定のターゲット エンティティのいずれかに対応していない場合は、新しいエンティティを作成することができます。 作成できるエンティティには、次の 3 種類があります。

-   **エンティティ** - ステージング テーブルとターゲット テーブルに 1 つのエンティティをマップします。
-   **テーブル** – ステージング テーブルまたはビジネス ロジックを使用せずに、ソースからターゲットの Microsoft Dynamics AX テーブルに直接データをインポートできます。 テーブル エンティティについては、エンティティの他のタイプとは異なり、データは 1 つのソース テーブルから複数のターゲット テーブルにプッシュすることはできません。 テーブル エンティティは、ソースからターゲットへの 1 対 1 のマッピングをする必要があります。 テーブル エンティティは、変更が必要なく、対象のテーブルに簡単にマップされる比較的単純な参照データでのみ使用する必要があります。
-   **複合エンティティ** - 関連する複数のエンティティで構成される 1 つのエンティティを作成できます。 複合エンティティの例としては、販売注文のエンティティと販売明細行のエンティティの組み合わせです。 1 つのファイル内の複数の関連テーブルからのデータを含むソースからインポートするときは、複合エンティティを使用します。 複合エンティティは、ファイルのデータ ソースだけがサポートされます。

新しいターゲット エンティティを追加するには、次の手順を実行します。

1.  **データのインポート/エクスポート フレームワーク** &gt; **設定** &gt; **ターゲット エンティティ**を開きます。
2.  **新規** をクリックします。
3.  **エンティティ タイプ** フィールドで、追加するエンティティのタイプを選択します。
    -   エンティティ タイプのエンティティについては、最初の**エンティティ**フィールドでエンティティを選択し、**アプリケーション モジュール**フィールドでエンティティが属するアプリケーション モジュールを選択し、それから 2 番目の**エンティティ**フィールドで一意の名前を提供します。 他のフィールドには自動的に入力されます。
    -   テーブル タイプのエンティティについては、**アプリケーション モジュール**フィールドでエンティティが属するアプリケーション モジュールを選択し、2 番目の**エンティティ**フィールドで一意の名前を提供し、それから**ステージング テーブル**フィールドでターゲット テーブルを特定します。 **エンティティ クラス**および**ターゲット エンティティ**のフィールドを空白のままにします。
    -   複合エンティティ タイプのエンティティについては、**アプリケーション モジュール**フィールドでエンティティが属するアプリケーション モジュールを選択し、2 番目の**エンティティ**フィールドで一意の名前を提供します。 **ステージング テーブル**、**エンティティ クラス**、**ターゲット エンティティ**のフィールドを空白のままにします。 複合エンティティを構成するエンティティを識別するには**子エンティティ**をクリックします。 複合データの一部の対象となるシステムで、各エンティティに 1 つの子エンティティを追加します。 たとえば、販売ヘッダー データおよび販売明細行品目データの両方を含む、複合の販売情報をインポートしています。 この場合、**DMFSalesTableEntity** の子エンティティ 1 つと **DMFSalesLineEntity** の子エンティティ 1 つを追加します。
        1.  **ターゲット エンティティ** フォームで、**新規**をクリックして最初の子エンティティを追加します。
        2.  **アプリケーション モジュール** フィールドで、エンティティが属するアプリケーション モジュールを選択します。 2 番目の**エンティティ** フィールドで、固有の名前を入力します。 関連する **ステージング** テーブル、**エンティティ** クラス、および複合データの一部のターゲット エンティティに属する **ターゲット** エンティティの値を選択します。
        3.  複合データのすべてのターゲットに子エンティティを追加するまで、手順 1 と 2 を繰り返します。 次に、**閉じる** をクリックします。

        各複合エンティティ内のすべての子エンティティは **RowID** フィールドを含める必要があります。 既定では、データのインポート/エクスポート フレームワークの以下のエンティティには **RowID** フィールドがあり、複合エンティティで使用することができます。**DMFSalesTableEntity**、**DMFSalesLineEntity**、**DMFPurchTableEntity**、**DMFPurchLineEntity**、**DMFBOMEntity**、および **DMFBOMVersionEntity**。

### <a name="modify-an-entitys-target-mapping"></a>エンティティのターゲット マッピングの変更

エンティティ内のフィールドが処理されるシーケンスを変更することができます。 また、**validateField** メソッドまたは **modifiedField** メソッドを呼び出すフィールドを有効にすると、フィールドが処理されるときにビジネス ロジックをチェックすることができます。 **重要:** フィールド メソッドの**検証の呼び出し**、またはフィールド メソッド値の**変更の呼び出し**を設定しても、メソッドが実行されるとは限りません。 これらの値は、実行するメソッドのみを*有効にします*。 ただし、処理グループの設定は、メソッドが特定の工程に対して実際に実行されるかどうかを特定します。

1.  **データのインポート/エクスポート フレームワーク**&gt;**設定**&gt;**ターゲット エンティティ**を開きます。
2.  変更するターゲット エンティティを選択し、**ターゲット マッピングを変更** をクリックします。 **ターゲットにステージングをマップ** フォームが開きます。 既定の **マッピングの視覚化ビュー** には、ステージング フィールド、関数 (変換を含むエンティティ クラス)、およびターゲット エンティティに関連付けられたターゲット フィールドが表示されます。
3.  **マッピング詳細**をクリックします。
4.  フィールドが処理される順序を変更するには、**シーケンス**を変更します。
5.  **validateField** メソッドでビジネス ロジックと一緒にフィールドを実行できるようにするには、**Call validate Field method** を選択します。
6.  **modifiedField** メソッドでビジネス ロジックと一緒にフィールドを実行できるようにするには、**Call modified Field method** を選択します。
7.  **保存**をクリックし、**閉じる**をクリックします。

### <a name="define-a-processing-group"></a>処理グループの定義

データをインポートするときは、ファイルベースのデータ ソースを使用するエンティティのサンプル データ ファイルを持っていることをお勧めします。 サンプル ファイルがまだない場合は、処理グループにエンティティを追加するときに作成することができます。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 **新規**をクリックして新しい処理グループを作成し、名前と説明を入力します。
2.  処理グループを選択し、**エンティティ** をクリックしてエンティティを追加します。
    -   インポートのエンティティを追加し、エンティティがこれらのデータ ソースを使用し、サンプル データを持っている場合は、これらの手順に従います。
        1.  **新規** をクリックします。 **エンティティ** リストでエンティティを選択します。
        2.  **ソース データ形式**フィールドで、ソース ファイルの形式を選択します。
        3.  **サンプル ファイルのパス** フィールドに、サンプル ファイルの場所を入力します。
        4.  オプション: ソース ファイルが Excel 形式の場合、**サンプル ファイルのパス** フィールドで、サンプルのデータを含むワークシートを指定します。
    -   インポートのエンティティを追加し、エンティティがこれらのデータ ソースを使用していますが、サンプル データを持っていない場合は、これらの手順に従います。
        1.  **新規** をクリックします。 **エンティティ** リストでエンティティを選択します。
        2.  **ソース データ形式**フィールドで、ソース ファイルの形式を選択します。
        3.  固定長形式を使用する場合は、**ファイル形式を指定する**をクリックします。 その他のファイルに基づく形式を使用する場合は、**生成ソース ファイル**をクリックします。
        4.  ウィザードの 2 番目のページで、データ ソース ファイルに含める必要があるフィールドを選択します。 XML データ ソースを使用している場合、**XML 型**フィールドで、**XML** または **XSD** を選択します。 **サンプル ファイルの生成**をクリックします。
        5.  XML データ ソースを使用し、XSD XML タイプを選択すると、スキーマ ファイルが生成されますが、開かず、パスが表示されます。 それ以外の場合、ソースのデータ形式に応じてサンプル ファイルはメモ帳または Excel で開かれ、適切な構造が含められます。 サンプル データを追加します。 サンプルファイルを保存するには、**ファイル**&gt;**名前を付けて保存** をクリックし、ファイルを任意の場所に保存します。
        6.  **完了** をクリックしてウィザードを閉じます。
        7.  **サンプル ファイルのパス** フィールドに、今作成したサンプル ファイルの場所を入力します。
    -   ファイルへのエクスポートのためにエンティティを追加する場合は、これらの手順に従います。
        1.  **新規** をクリックします。 **エンティティ リスト**でエンティティを選択します。
        2.  **ソース データ形式**フィールドで、ソース ファイルの形式を選択します。
        3.  **サンプル ファイルのパス** フィールドに、サンプル ファイルの場所を入力します。 このファイルは、エクスポートしたデータの形式を決定するために使用されます。 ファイルの構造のみ使用されます。 ファイルに含まれるすべてのデータは無視されます。
    -   ODBC のデータ ソースを使用するインポート用のエンティティを追加する場合は、次の手順に従います。
        1.  **新規** をクリックします。 **エンティティ** リストでエンティティを選択します。
        2.  **ソース データ形式**フィールドで、ソース ファイルの形式を選択します。
        3.  **サンプル ファイルのパス** フィールドに、SQL クエリを入力してデータ ソースから目的のデータを選択します。 たとえば、別のデータベースから顧客データを取得するには、**選択\* 顧客から**を入力します。
    -   Microsoft Dynamics AX のデータ ソースを使用するインポートまたはエクスポート用のエンティティを追加する場合は、次の手順に従います。
        1.  **新規** をクリックします。 **エンティティ** リストでエンティティを選択します。
        2.  **ソース データ形式**フィールドで、ソース ファイルの形式を選択します。

3.  **ソース マッピングの生成**をクリックします。
4.  オプション: これらのメソッドで実行するデータ変換ロジックを有効にするエンティティで、**サンプル ファイルのパス** を選びます。
5.  オプション: データ検証を有効にするエンティティで、**サンプル ファイルのパス** を選びます。
6.  オプション: エンティティが処理される順序を変更するには、シーケンス値を変更します。 通常、あるエンティティが別のエンティティに依存する場合にのみ、処理順序を変更します。 たとえば、顧客は、顧客住所の前に処理される必要があります。
7.  終了したら、**閉じる** をクリックします。

### <a name="optional-change-the-source-to-staging-mapping-for-an-entity"></a>オプション: エンティティのソースからステージングへのマッピングを変更します。

エンティティを処理グループに関連付けた後、エンティティがステージング テーブルに正しくマップされていることを検証する必要があります。 必要に応じて変更を行います。 通常、次の変更がソースからステージングへのマッピングに行われます。

-   データのインポート時に、新しい列の値として既定の文字列または番号を追加します。
-   インポート中に値を変換します。

#### <a name="add-default-strings-and-numbers-during-the-source-to-staging-mapping"></a>ソースからステージングへのマッピング中の既定の文字列と番号の追加

1.  **データのインポート エクスポート フレームワーク**&gt;**共通**&gt;**処理グループ**&gt;**エンティティ**を開きます。 **ソース マッピングの変更**をクリックします。 既定のマッピング視覚化ビューでは、どのソース フィールドがどのステージング フィールドにマッピングされているかをすばやく確認できます。
2.  **マッピング詳細**をクリックします。
3.  **ソース フィールド**のフィールドで、フィールドを選択してから、フィールドに適用されるステージング フィールドを選択します。
4.  フィールドの既定値を追加するには、次の手順を実行します。
    1.  フィールドの **自動既定値設定** を選択します。
    2.  **既定値**をクリックします。
    3.  **ステージング値**フィールドに、値を入力してから **OK** をクリックします。

5.  定義した番号シーケンスに基づいてフィールドの値を自動的に生成するには、そのフィールドに対して **自動生成** を選択します。 また、値のグループに番号を割り当てるために使用する基準をセットするため、クエリを使用することができます。 **クエリ基準**をクリックし、数字を割り当てることができるグループを作成するために使用するフィールドを選択してから、**クエリ基準**フォームを閉じます。
6.  **ソースをステージングにマップ** フォームを閉じます。

#### <a name="convert-values-during-source-to-staging-mapping"></a>ソースからステージングへのマッピング中に値を変換する

1.  **データのインポート エクスポート フレームワーク**&gt;**共通**&gt;**処理グループ**&gt;**エンティティ**を開きます。 **ソース マッピングの変更**をクリックします。
2.  **マッピング詳細**をクリックします。
3.  **ソース フィールド**のフィールドで、フィールドを選択してから、フィールドに適用されるステージング フィールドを選択します。
4.  **換算**をクリックします。
5.  **変換値の定義**フォームの**ソース値**および**ステージング値**フィールドに値を入力してから、**閉じる**をクリックします。
6.  **ソースをステージングにマップ** フォームを閉じます。

### <a name="optional-change-the-staging-to-target-mapping-for-an-entity"></a>オプション: エンティティのステージングからソースへのマッピングを変更します。

既定では、ステージングからターゲットへのマッピングが生成されます。 ステージングからターゲットへのマッピングが正しくない場合、**マップ詳細**フォームで手動でアップデートできます。

### <a name="define-security-for-processing-groups"></a>処理グループのセキュリティの定義

処理グループを実行することができるユーザーまたはロールを定義する、処理グループのセキュリティを設定することができます。 すべての会社ではなく、単一の会社のために作業する処理グループを設定することができます。 また、削除せずに、処理グループを実行されないように無効にすることもできます。 グループを処理するためのセキュリティを設定する必要はありません。 ただし、既定では、すべてのユーザーは処理グループ内のデータにアクセスできます。

#### <a name="set-security-for-a-processing-group"></a>処理グループのセキュリティを設定

1.  処理グループを作成した後、**データのインポート/エクスポート フレームワーク** &gt; **設定** &gt; **処理グループのロールの設定**を開きます。
2.  **新規**をクリックし、セキュリティを設定します。
3.  次のフィールドの値を入力します。
    1.  **処理グループを適用**フィールドで、**すべて**を選択してすべての処理グループにセキュリティを適用するか、**テーブル**を選択して 1 つの処理グループにセキュリティを適用します。
    2.  **処理グループ**の**テーブル**を選択した場合は、セキュリティ保護するために処理グループを選択します。
    3.  オプション: 特定のエンティティをセキュリティで保護するには、**エンティティ** フィールドでエンティティを選択します。 このオプションは、同じプロセス グループ内のエンティティに対して異なるレベルのセキュリティを必要とする場合に便利です。
    4.  **アクセスを許可**フィールドで、ロール、ユーザー、またはすべてのユーザーにアクセスを許可するかどうかを選択します。
    5.  ロール別にアクセスを許可することを選択した場合は、**ロール名**フィールドで、処理グループへのアクセスを許可するロールを選択します。
    6.  ユーザー別にアクセスを許可することを選択した場合は、**ユーザー名**フィールドで、処理グループを実行するためのアクセスを許可するユーザーを選択します。

4.  **閉じる** をクリックして変更を保存します。

#### <a name="disable-a-processing-group"></a>処理グループを無効にする

1.  **データのインポート エクスポート フレームワーク**&gt;**設定**&gt;**処理グループのロールの設定**を開きます。
2.  処理グループを選択し、**無効化** をクリックして **閉じる** をクリックします。

#### <a name="set-a-processing-group-to-run-against-a-single-company"></a>1 つの会社に対して実行する処理グループを設定

既定では、すべての処理グループはすべての会社に対して実行できます。 1 つの会社で実行されるように処理グループを制限するには、次の手順を実行します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。
2.  処理グループを選択し、メニューを展開して **会社** をクリックします。
3.  **会社**フォームで、最初の行を選択し、**削除**をクリックしてから、**新規**をクリックします。
4.  処理グループを制限する会社を選択し、**閉じる** をクリックします。

### <a name="preview-errors-before-processing"></a>処理する前にプレビュー エラー

ソースからステージングにデータをコピーするジョブを実行する前に、プロセスをプレビューしてエラーが生成されるかどうかを判断できます。

1.  **データのインポート エクスポート フレームワーク**&gt;**共通**&gt;**処理グループ**&gt;**エンティティ**を開きます。
2.  **処理グループのエンティティの選択**フォームで、**ソース ファイルのプレビュー**をクリックします。 **プレビュー** フィールドには、処理可能な行が一覧表示されます。 情報ログは、エラーのある行の番号を表示します。
3.  エラーを表示するには、Infolog の **ログ** をクリックするか、**処理グループのエンティティを選択** フォームで **エラー詳細をプレビュー** をクリックします。 **ログ テキスト** フィールドは、処理できなかったすべての行を一覧表示します。

### <a name="process-export-data"></a>エクスポート データの処理

他の Microsoft Dynamics AX インスタンスで使用することができるように、データをエクスポートすることができます。 または、別のシステムにインポートできるようにデータをフラット ファイルにエクスポートできます。 また、処理グループをエクスポート、または処理グループからのステージング データをエクスポートすることができます。

#### <a name="export-to-microsoft-dynamics-ax"></a>Microsoft Dynamics AX をエクスポート

データを Microsoft Dynamics AX にエクスポートするには、次の手順を実行します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 使用する処理グループを選択します。 プロセス グループには、ソース データ形式タイプが **AX** であるエンティティのみが含まれている必要があります。
2.  **ステージング データの取得**をクリックします。
3.  **ステージング データ ジョブに対するジョブ ID の作成**フォームで、**OK** をクリックします。
4.  **ステージング データ実行**フォームで、**実行**をクリックします。
5.  **ステージング** フォームで、変更が必要なジョブの実行パラメーターを変更してから **OK** をクリックします。
6.  **AX にエクスポート**をクリックします。
7.  **エクスポート オプション** フォームに、作成する .dat ファイルのパスと名前を入力してから **OK** をクリックします。

#### <a name="export-to-a-file"></a>ファイルにエクスポート

データをファイルにエクスポートするには、次の手順を実行します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 **新規**をクリックして、新しい処理グループを作成します。
2.  新しい処理グループを選択し、**エンティティ** をクリックします。
3.  **処理グループのエンティティの選択**フォームで、テキスト ファイルのソース データの形式タイプがあるエンティティを追加します。
4.  **サンプル ファイルのパス** フィールドに、サンプル ファイルの場所を入力します。 このファイルは、エクスポートしたデータの形式を決定するために使用されます。 ファイルの構造のみ使用されます。 ファイルに含まれるすべてのデータは無視されます。 このファイルの形式は、エクスポートする Microsoft Dynamics AX データの構造と一致する必要があります。 **注記:** データのインポート/エクスポート フレームワークで提供されるデモファイルは、サンプルファイルとして使用できます。 たとえば、**バーコード設定エンティティ**をファイルにエクスポートするには、データ ファイルのエクスポート用にフォーマットを提供する **BarcodeSetupEntity.txt** ファイルを使用できます。 デモ ファイルの詳細については、[データのインポート/エクスポート フレームワークのデモ ファイル (DIXF、DMF)](demo-files-dixf.md) を参照してください。
5.  **ソース マッピングの生成**をクリックします。
6.  必要に応じて他のエンティティを追加するには、手順 3 ～ 5 を繰り返します。 終了したら、**閉じる** をクリックします。
7.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 Microsoft Dynamics AX データを提供する必要がある処理グループを選択します。 処理グループ内のすべてのエンティティは他の処理グループで作成したファイル形式にマップする必要があり、ソース データ形式が **AX** タイプである必要があります。
8.  **ステージング データの取得**をクリックします。
9.  **ステージング データ ジョブに対するジョブ ID の作成**フォームで、ジョブ ID を記録してから **OK** をクリックします。
10. **ステージング データ実行**フォームで、**実行**をクリックします。
11. **ステージング** フォームで、変更するジョブの実行パラメーターを変更してから **OK** をクリックします。
12. **ファイルにエクスポート**をクリックします。
13. **ステージング データ ジョブに対するジョブ ID の作成**フォームで、ステージング データ ジョブのジョブ ID を選択してから **OK** をクリックします。
14. **エンティティ エクスポートの詳細**フォームの**処理グループ** フィールドで、テキスト ファイル形式が含まれる処理グループを選択します。 (この手順のステップ 1 ～ 6 でこの処理グループを作成しました。)
15. **実行** をクリックします。
16. **フラット ファイルにエクスポート** フォームで、変更するジョブの実行パラメーターを変更し、**OK** をクリックします。

#### <a name="export-a-processing-group"></a>処理グループをエキスポート

複数の環境でデータのインポート/エクスポート フレームワークを実行する場合は、処理グループをエクスポートする必要があります。 処理グループをエクスポートするときは、グループ内のエンティティ、エンティティに対して設定したマッピング、およびステージング データをエクスポートします。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。
2.  処理グループを選択し、**AX にエクスポート** をクリックします。
3.  **エクスポート オプション** フォームに、作成する .dat ファイルのパスと名前を入力してから **OK** をクリックします。

#### <a name="export-staging-data"></a>ステージング データをエキスポート

複数の環境でデータのインポート/エクスポート フレームワークを実行する場合は、ステージング データをエクスポートする必要があります。 ステージング データをエクスポートするときは、別の環境にインポートできるステージング データのファイルを作成します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。
2.  処理グループを選択します。
3.  **実行履歴**、および**ステージング データの表示**をクリックしてから、**ファイルにエクスポート**をクリックします。
4.  **フラット ファイルにエクスポート** フォームの**一般**タブで、処理グループを選択します。 **バッチ**タブで、変更するジョブの実行パラメーターを変更し、**OK** をクリックします。

### <a name="process-import-data"></a>インポート データの処理

このセクションでは、データをソースからステージングにコピーしてから、ステージングからターゲットにコピーすることによって、データをインポートする方法について説明します。

#### <a name="copy-data-from-source-to-staging"></a>ソースからステージングにデータをコピー

ソースからステージングである処理グループに、同時にデータをコピーすることができます。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 使用する処理グループを選択します。
2.  **ステージング データの取得**をクリックします。 **ステージング データ ジョブに対するジョブ ID の作成** ダイアログ ボックスが開きます。
3.  既定では、ジョブに対する ID が生成されます。 必要に応じて、IDを変更して説明を追加することができます。 **OK** をクリックします。 **ステージング データ実行** ダイアログ ボックスが開きます。
4.  **エンティティの詳細** に、サンプル データだけでなくすべてのソース データを含むファイルのパスを入力します。
5.  **実行** をクリックします。 **ソースからステージングにデータを取得**ダイアログ ボックスで、**バッチ処理**を選択してジョブをバッチの一部として実行するか、**OK** をクリックしてすぐにジョブを実行します。 ソース データはステージング テーブルにコピーされます。

#### <a name="validate-the-data-in-staging"></a>ステージングのデータの検証

ジョブの実行が終了した後は、以下の手順に従ってステージングのデータを検証します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 **実行履歴**をクリックし、次に実行されたジョブを選択します。
2.  **ステージング データの表示**をクリックします。
3.  ソース ファイルと一致することを検証するステージング データを確認します。
4.  **検証**をクリックして、関連するすべての参照データが正しくシステムに存在することを確認します。
5.  オプション: 変更が必要な場合はステージング データを変更します。

#### <a name="process-data-from-staging-to-target"></a>ステージングからターゲットにデータを処理

ステージングからターゲットである処理グループに、同時にデータをコピーすることができます。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。 使用する処理グループを選択します。
2.  **データをターゲットにコピー**をクリックします。 **実行するジョブ ID を選択** ダイアログ ボックスが開きます。
3.  ジョブを選択します。 既定では、処理グループはすべての行に対して実行されます。 行を制限するには、**Run for** フィールドで、**条件** を選択し、ジョブを実行する行を選択します。 **前のエラーがある行**、**ユーザーが選択した行**、または両方を選択することができます。
4.  **OK** をクリックします。 **ターゲット データ実行** フォームが開きます。
5.  パフォーマンスを向上させるには、**バッチ タスク数** フィールドを設定することを検討してください。 レコードの総数は、指定された数のバッチ タスクに分割され、リソースが使用可能であれば、それらのタスクが同時に実行されます。
6.  ジョブをすぐに実行するには、**実行** をクリックします。 ジョブをバッチの一部として実行するには、**バッチ処理** をクリックします。 データはターゲット エンティティにコピーされます。

#### <a name="validate-the-data-in-target"></a>ターゲットのデータの検証

ジョブの実行が終了した後は、以下の手順に従ってターゲット内のデータを検証します。

1.  **データのインポート エクスポート フレームワーク**&gt; **共通**&gt;**処理グループ**を開きます。
2.  **実行履歴**をクリックし、ジョブのステータスをレビューします。

#### <a name="clean-up-staging-data"></a>ステージング データのクリーンアップ

データの移行が完了したら、ステージング テーブルをクリーン アップする必要があります。 **データのインポート エクスポート フレームワーク**&gt;**定期処理**&gt;**ステージング クリーンアップ**を開いて不要になったデータを識別します。




