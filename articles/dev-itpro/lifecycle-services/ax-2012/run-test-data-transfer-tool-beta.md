---
title: テスト データ転送ツール (ベータ) の実行
description: このトピックでは、Microsoft Dynamics AX でデータ転送ツールのテストを実行する方法について説明します。
author: kfend
manager: AnnBe
ms.date: 11/13/2017
ms.topic: article
ms.prod: dynamics-ax-2012
ms.service: ''
ms.technology: ''
audience: Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: AX 2012
ms.custom: 17571
ms.assetid: f98591d7-f3ba-416c-982b-350823f16dad
ms.search.region: Global
ms.author: kfend
ms.search.validFrom: ''
ms.dyn365.ops.version: 2012
ms.openlocfilehash: ce39c8e14565bcc3babf3051cf5d8caf0d92accf
ms.sourcegitcommit: 0f530e5f72a40f383868957a6b5cb0e446e4c795
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/29/2019
ms.locfileid: "369982"
---
# <a name="run-the-test-data-transfer-tool-beta"></a>テスト データ転送ツール (ベータ) の実行

[!include [banner](../../includes/banner.md)]

<a name="security-and-permissions"></a>セキュリティおよびアクセス許可
------------------------

テスト データ転送ツール (ベータ) には、Microsoft SQL Server アクセス許可のみが必要です。

> [!WARNING]
> テスト データ転送ツール (ベータ) では、Microsoft Dynamics AX に組み込まれているセキュリティ メカニズムはまったく認識されません。

**SELECT** ステートメントを SQL Server Management Studio で実行する権限がある場合、または SQL Server 一括コピー ツール (bcp) を使用してデータをエクスポートする権限がある場合は、テスト データ転送ツール (ベータ) を使用してデータをエクスポートするために必要なアクセス許可が与えられます。 エクスポート時には、次の SQL Server のアクセス許可が必要です。

-   テーブル、インデックス、および sysdatabases を読み取るための sys スキーマへの読み取りのアクセス許可
-   ModelElements ビューへの読み取りアクセス許可
-   SQLDictionary テーブルへの読み取りアクセス許可
-   ElementType テーブルへの読み取りアクセス許可
-   ModelElement テーブルへの読み取りアクセス許可
-   エクスポート先テーブルの読み取りアクセス許可

SQL Server Management Studio の **SELECT** ステートメントおよび **BULK INSERT** ステートメントを実行する権限がある場合は、ツールを使用してデータをインポートするために必要なアクセス許可が与えられています。 インポート時には、次の SQL Server のアクセス許可が必要です。

-   テーブル、インデックス、および sysdatabases を読み取るための sys スキーマへの読み取りのアクセス許可
-   ModelElements ビューへの読み取りアクセス許可
-   SQLDictionary テーブルへの読み取りアクセス許可
-   ElementType テーブルへの読み取りアクセス許可
-   ModelElement テーブルへの読み取りアクセス許可
-   SYSTEMSEQUENCES テーブルの読み取り/書き込みアクセス許可
-   インポート先テーブルのアクセス許可を記述
-   インポートするテーブルで **ALTER INDEX** を実行するアクセス許可。データが固有のインデックス制約に違反し、インデックスを自動的に無効化する場合。
-   \[インポート\]ディレクトリにある SQL コマンドに対する適切なアクセス許可

## <a name="run-the-tool"></a>ツールを実行
bcp ユーティリティがコマンド プロンプト パスに含まれるように、SQL Server クライアント ツールがインストールされているシステムからテスト データ転送ツール (beta) を実行する必要があります。 このツールは、インポート中にデータベースをホストしているコンピューターから直接実行する必要があります。 テスト データ転送ツール (ベータ) を実行するには、次の手順を実行します。
1.  Microsoft Dynamics AX Application Object Server (AOS) のインスタンスを停止します。
2.  テスト データ転送ツール (ベータ) を実行します (DP.exe)。 実行するアクションを記述する引数を含めます。

ツールの実行では、次の情報が表示されます。
-   ツールの進捗状況
-   まだ処理する必要があるテーブルの数
-   発生したエラー数

処理が完了した後、ツールは、現在のディレクトリに DPLog.xml ログ ファイルを書き込みます。 エラーを見つけるには、ログ ファイルで ‘failed’ を検索します。
### <a name="syntax"></a>構文

    DP.exe direction directory database server

すべての引数はオプションです。

| パラメーター   | 既定値         | 説明                                                                                                                                                                                                                                                                                                           |
|-------------|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *方向* | エクスポート                | データをエクスポートには EXPORT、データをインポートするには IMPORT を指定します。                                                                                                                                                                                                                                                               |
| *ディレクトリ* | 現在のディレクトリ | データのエクスポート元またはデータのインポート先のディレクトリを指定します。                                                                                                                                                                                                                 |
| *データベース*  | AXDB                  | データベースの名前です。                                                                                                                                                                                                                                                                                             |
| *サーバー*    | 現在のコンピューター  | Microsoft Dynamics AX データベースをホストしている SQL Server コンピューターのコンピューター名またはインスタンス名を指定します。 インスタンス名を指定するには、ServerNameInstanceName の形式で入力します。 ローカル コンピューターの名前付きインスタンスがある場合は、localhostInstanceName または InstanceName という形式を使用できます。 |

  コマンド ライン オプションの概要を表示するには、次のコマンドを使用できます。

    DP.exe -?

### <a name="stop-the-tool"></a>ツールを停止

ツールを停止するには、Ctrl キーを押しながら C キーを押します。 ツールは、現在作業中のテーブルを終了して終了します。

## <a name="overview-of-data-export-and-import"></a>データのエクスポートとインポートの概要
テスト データ転送ツール (ベータ) は、Microsoft Dynamics AX のテーブルごとに 3 つのファイルをエクスポートおよびインポートします。 テーブルに Microsoft Dynamics AX での依存関係がある場合、これらのファイルは、関連テーブルに関係なくテーブルをエクスポートおよびインポートするためのツールの機能をサポートします。 次の図は、エクスポートとインポートのプロセスを示しています。 ![データのエクスポートとインポートを実行するプロセス](./media/dataportprocess.jpg)
### <a name="export-and-import-process"></a>プロセスをエキスポートおよびインポート

次のテーブルでは、ファイルの 3 つのタイプについて説明します。

| ファイル タイプ | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| .out      | テーブル データを含む bcp データ ファイル。 列は \ #&#124;EOC&#124;\# で区切られます。 列は \# &#124;EOR &#124;\#n で区切られます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| .xml      | テーブル メタデータ (列の説明) を含む bcp データ ファイル。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| .outmodel | Microsoft Dynamics AX に固有のメタデータを含むファイルです。 このメタデータには、テーブルとそのフィールドのすべての名前と ID が含まれます。 このファイルには、**elementType** 属性も含まれています。この属性は、テーブルで参照される Microsoft Dynamics AX のテーブル、クラス、または拡張データ型の名前と ID を格納します。 この情報は、インポート中に名前が変更されたフィールドを照合するために使用されます。 また、これらの ID がターゲット データベース内の ID と一致するように、テーブル ID、クラス ID、またはデータ タイプ ID を更新するためにも使用されます。 .outmodel ファイルのデータは、Metadata.xml ファイルから作成されます。 このファイルは、ソース データベースの Microsoft Dynamics AX から実行する X++ ジョブによって生成されます。 |

テスト データ転送ツール (beta) がデータをエクスポートするとき、インポート時に追加情報を必要とする、テーブルのリレーションシップおよび EDT 参照を識別するために Metadata.xml ファイルが使用されます。 この追加情報は、ツールがエクスポートする .outmodel ファイルに含まれています。

テーブルの継承に関連するシナリオなど一部のシナリオでは、更新された .outmodel ファイルを維持することが重要です。 **SuperType** テーブルの各行は、その行の **SubType** テーブルの Microsoft Dynamics AX ID を含む **InstanceRelationType** コラムが含まれます。 Microsoft Dynamics AX の ID は時間経過に伴い変更可能であるため、.out ファイルのデータは不正確になる場合があります。 テスト データ転送ツール (ベータ) は、Metadata.xml ファイルからの情報を使用して、この状況を回避し、データが正しくインポートされるようにします。 

ファイルをインポートするときは、Metadata.xml ファイルが最新であることを確認します。 インポート プロセス中に、ツールは .outmodel ファイルを使用して関係を認識します。 このツールは、Microsoft Dynamics AX にクエリを実行して、データが正しくインポートされるようにします。 たとえば、.outmodel ファイルは、**InstanceRelationType** 列に挿入する値が **1234** であることを示します。 ただし、ツールは、サブタイプ テーブルが **1235** である新しい Microsoft Dynamics AX ID に新しいテーブルが追加されたことを認識します。 

期限が切れている Metadata.xml ファイルを使用したとき、データは通常、エラーを発生させずにインポートおよびエクスポートされます。 このエラーの欠如は、問題の診断を困難にする可能性があります。 .out ファイルに含まれている Microsoft Dynamics AX ID は、通常正確です。 ただし、テーブルの Microsoft Dynamics AX ID が変更されると、データ インポートが正常に完了しても、不正確な値が Microsoft Dynamics AX ID フィールドに追加されます。 たとえば、給与データには、従業員の給与税の設定に関連するいくつかの継承テーブルが含まれます。 

古い Metadata.xml ファイルを使用してエクスポートされたデータを読み込むと、テーブルの継承関係を含むいくつかの問題が発生します。 Microsoft Dynamics AX を管理者として実行している場合は、継承関係を正しく解決できるし、給与支払が正常に生成されます。 ただし、Microsoft Dynamics AX を非管理者として実行する場合、X++ コードはデータベースからのレコードを読み取りません。 したがって、生成される給与支払には税金は含まれません。

## <a name="exporting-data"></a>データのエクスポート
データをエクスポートする手順は、次の一般的なステップで構成されます。
1.  Metadata.xml ファイルを生成します。
2.  エクスポートするデータを決定します。
3.  ツールを実行します。

### <a name="generate-the-metadataxml-file"></a>Metadata.xml ファイルを生成します

テスト データ転送ツール (ベータ) を使用してデータをエクスポートする前に、ソース システムで Metadata.xml ファイルを生成する必要があります。 Metadata.xml ファイルは、エクスポート中にのみ使用されます。

> [!NOTE] 
> Metadata.xml ファイルは、定期的に更新されない場合に古くなる可能性があります。 ファイルの有効期限が切れている場合、エクスポートしたデータに**要素型**属性が含まれていない可能性があり、インポートによって、ターゲット データベースで ID が一致するように ID がアップデートされない可能性があります。 手動でファイルを更新する必要があります。

Metadata.xml ファイルを更新するには、次の手順を実行します。
1.  DP.exe が格納されている同じフォルダーの MetadataXMLGenerator.xpo をインポートしてから、MetadataXMLGenerator ジョブを実行します。 新しい Metadata.xml ファイルは、コンピューター上の一時フォルダーに作成されます。
2.  次の方法のいずれかで新しい Metadata.xml ファイルを検索します。
    -   MetadataXMLGenerator ジョブが完了すると、新しい Metadata.xml ファイルのパスが情報ログに用意されています。
    -   コマンド プロンプト ウィンドウを開いて **echo %temp%** と入力し、Metadata.xml ファイルが保存されている一時フォルダーのパスを表示します。

3.  一時フォルダーに移動してから、テスト データ転送ツール (ベータ) がインストールされているサブフォルダーに Metadata.xml ファイルをコピーします。 \[リスト\] サブフォルダーに既存の Metadata.xml ファイルがある場合、生成された Metadata.xml ファイルを使用することによって、既存のエクスポートできるファイルを上書きします。

### <a name="choose-data-to-export"></a>エクスポートするデータの選択

テスト データ転送ツール (ベータ) は、データベース内のすべてのテーブルのすべてのデータをエクスポートするように設計されています。ただし、エクスポートしたデータから、テーブル、列、または行がフィルタ処理により除かれている場合があります。 このツールは、多くのテーブルを除外するフィルターのセットを含むように事前設定されています。 コンフィギュレーション済のフィルターは、次のガイドラインに基づいています。
-   コードやモデルを含むテーブルをエクスポートしないでください。
-   セキュリティ設定をエクスポートしないでください。
-   コンピューターの固有データをエクスポートしないでください。
-   ユーザーの固有データをエクスポートしないでください。
-   一時的なテーブルをエクスポートしないでください。

これらのフィルタは、要件に完全ではないかもしれません。 たとえば、既定でフィルター除外されるデータの一部をエクスポートする、またはエクスポートされない追加のテーブルがある場合があります。

> [!IMPORTANT]
> テーブルが含まれている場合、**RecVersion**列で、テスト データ転送ツール (beta) テーブルで現在の値を無視し、常に1の値を使用して、テーブルをエクスポートします。 この機能を使用すると、.out ファイルを比較して意味のある違いのみを簡単に確認できます。 この機能は、データをバージョン管理システムに保存する場合に特に便利です。 ほとんどの Microsoft Dynamics AX テーブルには、**RecVersion** 列が含まれます。

次のテーブルでは、標準除外ファイルと Filters.xml ファイルで使用されるエクスポート方法について説明します。

| テーブルのコンテンツ                                                       | 戦略をエクスポート                 | 理由                                                                                                                                                                                                                                                                                |
|----------------------------------------------------------------------------|---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 業務データに接続されていないコード、システム データ、またはユーザー データ | エクスポートからテーブルを除外 | この戦略により、ビジネス データのインポート時に意図しないデータの変更が防止されます。                                                                                                                                                                                        |
| 業務データから計算されるキャッシュされた値                       | 空の .out ファイルをエクスポートします。      | この戦略は、コンテンツがビジネス データに依存するため、テーブルをインポートするときにテーブルのコンテンツを制御するのに役立ちます。 .out ファイルは必須ですが、ソース データから再計算することができる値を格納しないためです。 したがって、空の .out ファイルがエクスポートされます。 |

### <a name="export-data"></a>データのエクスポート

Metadata.xml ファイルを生成し、エクスポートするデータを選択した後、ファイルをエクスポートできます。 テスト データ転送ツール (ベータ) では、エクスポート中に一時ファイルは作成されません。 テスト データ転送ツール (ベータ) は、\[リスト\]Filters.xml ファイルの内容から SQL ステートメントを生成します。 特に、&lt;フィルター&gt;要素の内容には、エクスポート中にユーザーのコンテキストで実行される任意の SQL ステートメントを含むことができます。 変更する前に Filters.xml ファイルへのすべての変更を十分にテストしてください。

### <a name="export-filtering"></a>フィルタリングをエクスポート

Microsoft Dynamics AX 2012 テスト データ転送ツール (beta) を使用してデータをエクスポートするとき、次の 3 つの方法で、このツールによるデータのエクスポートを回避できます。
-   テーブルを除外または含む
-   列を除外
-   行を除外

#### <a name="create-an-exclude-file-to-exclude-tables-from-the-export"></a>エクスポートからテーブルを除外する除外ファイルを作成する

エクスポートされたデータからテーブルまたはテーブルのセットを除外するには、次の手順を実行します。
1.  \[一覧表示\]ディレクトリのテキスト ファイルを追加します。 ファイル名は、**Exclude –** (スペースとハイフンは名前の一部です) で始まり、ファイル名の拡張子は **.txt** でなければなりません。 また、既存のファイルを変更することができます。
2.  テキスト ファイルで、エクスポートから除外するテーブルの名前に一致する正規表現を含む行を追加します。

テーブルが除外されると、エクスポート時にそのテーブルに対してファイルが作成されません。 指定した正規表現は、その名前が SQL Server データベースに表示されるため、テーブルの名前と照合されます。 大文字と小文字の違いは無視されます。 また、テスト データ転送ツール (ベータ) は、除外ファイルから正規表現にアンカーを追加して、名前全体が正規表現と一致する場合にのみテーブルが除外されていることを確認します。 このツールでは、Microsoft .NET 正規表現構文を使用します。 除外ファイル形式では空白行を入力できるため、1 つのファイルで式のグループを個別に作成できます。 ファイル形式では、(行が // で始まる) 単一行のコメントを入力できるため、表が除外された理由を説明するコメントを入力できます。

#### <a name="examples-of-excluding-tables-from-the-export"></a>エクスポートからテーブルを除外する例

SysVersionControlParameters という名前のテーブルのみを除外するには、次の正規表現を使用します。
// SYSVERSIONCONTROLPARAMETERS のテーブルを除外します

SysVersionControl で始まる名前を持つすべてのテーブルを除外するには、次の正規表現を使用します。
// SYSVERSIONCONTROL* の複数のテーブルを除外します。

#### <a name="including-tables-in-the-export"></a>エクスポートにテーブルを含める

通常、エクスポートしないテーブルを記述してエクスポートするデータを指定します。 ただし、エクスポートするテーブルを記述する場合、除外リストで正規表現を使用できます。 エクスポートするテーブル以外のすべてのテーブルに一致する正規表現を作成します。 次のテーブルに、正規表現に含めることができる構文を示します。

| 正規表現の構文 | 説明                                                                                                                                                     |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| .                         | 任意の 1 文字と一致します。                                                                                                                                     |
| \*                        | 前の式と 0 回以上一致します。                                                                                                               |
| (?&lt;! subexpression)    | 以前に一致したコンテンツの末尾が部分式と一致する場合は、一致を禁止します。 この式は、ゼロ幅後読みアサーションと呼ばれます。 |
| ^                         | 文字列の開始と一致します。                                                                                                                                  |

テーブルを指定するには、最初に \* で始まる正規表現を定義して、すべてのテーブルに一致させます。 次に、エクスポートするテーブルごとに幅ゼロの負の lookbehind アサーションを追加します。 各アサーションの部分式は、文字列の先頭に固定されているテーブルの名前です。 たとえば、InventTable および DocuRef テーブルのみをエクスポートするには、次の正規表現を使用します。
// InventTable および DocuRef を除くすべてのテーブルに一致させます。*(?<!^InventTable)(?<!^DocuRef)

エクスポートする追加のテーブルごとに、同じ正規表現に (?&lt;!^ NameOfTable) を追加します。

#### <a name="exclude-columns-from-the-export"></a>エクスポートから列を除外

エクスポートされたデータから列を除外するには、次の手順を実行します。
1.  **\[Lists\]Filters.xml** を開きます。
2.  **名前**属性を持つ&lt;テーブル&gt;要素を追加します。 **name** 属性の値は、除外する列を含むテーブルの名前です。
3.  &lt;テーブル&gt;要素の&lt;除外&gt;要素を追加します。
4.  このテーブルでエクスポートから除外する各列に対して、&lt;フィールド&gt; 要素を追加します。 &lt;フィールド&gt; 要素のコンテンツは、除外する列の名前です。

> [!NOTE]
> テーブルごとに指定できる &lt;exclude&gt; 要素は 1 つだけです。

#### <a name="example-of-excluding-columns-from-the-export"></a>エクスポートから列を除外する例

**DimensionAttribute** テーブルをエクスポートするときに、**BackingEntityTableId**、**BackingEntityKeyFieldId**、**BackingEntityValueFieldId** 列を除外するには、次のようなエントリを Filters.xml に含めます。
      <table name="DimensionAttribute">
        <exclude> <field>BackingEntityTableId</field> <field>BackingEntityKeyFieldId</field> <field>BackingEntityValueFieldId</field> </exclude>
      </table>

#### <a name="exclude-rows-from-the-export"></a>エクスポートから行を除外

エクスポートされたデータから行を除外するには、次の手順を実行します。
1.  \[Lists\]Filters.xml を開きます。
2.  **名前**属性を持つ&lt;テーブル&gt;要素を追加します。 **name** 属性の値は、除外する列を含むテーブルの名前です。
3.  &lt;テーブル&gt;要素の&lt;フィルター&gt;要素を追加します。 &lt;フィルター&gt; 要素のコンテンツは、エクスポートする行を記述する SQL ステートメントである必要があります。 &lt;filter&gt; 要素は SQL WHERE 句と似ていますが、各列名は &lt;field&gt; ステートメントで囲む必要があります。

テーブルごとに指定できる &lt;filter&gt; 要素は 1 つだけです。 テーブル内の複数の列に基づきフィルター処理することができます。 他のテーブルのデータに基づいてフィルター処理することはできません。 ユーザーは、エクスポートからすべての行を削除することが必要な場合がよくあります。 常に false に評価されるフィルターを使用することにより、すべての行を簡単に除外することができます。 供給している標準フィルターで、0 = 1 のフィルターは空でエクスポートするテーブルの慣用句です。 しかし、この技術を使用すると、テスト データ転送ツール (ベータ) では、.out ファイルにデータが含まれていない場合でも、エクスポート時にテーブルの表が作成されます。 この動作は、除外ファイルのエントリを使用してテーブル全体を除外した場合の動作とは異なります。
#### <a name="examples-of-excluding-rows-from-the-export"></a>エクスポートから行を除外する例

**UserID** が空白の **SysLastValue** の行のみをエクスポートするには、Filters.xml に次のエントリを含めます。
      <table name="SysLastValue">
        <filter><field>UserID</field> = ''</filter>
      </table>

この場合、エクスポートするために行を定義する SQL クエリは SELECT \* FROM SysLastValue WHERE UserID = '' であることが想像できます。 SysPersonalization のすべての行がエクスポートされないようにするには、Filters.xml に次のエントリを含めます。
      <table name="SysPersonalization">
        <filter>0 = 1</filter>
      </table>

この場合、エクスポートするために行を定義する SQL クエリは SELECT \* FROM SysPersonalization WHERE 0 = 1 であることが想像できます。
データのインポート

テスト データ転送ツール (ベータ) は、指定したディレクトリ内のすべてのデータのインポートを試みるように設計されています。 このツールはインポート中にフィルタリングを実行しません。 このルールの唯一の例外は、**SystemSequences** テーブルです。 このツールは他のテーブルと同様に **SystemSequences** テーブルをエクスポートします。 ただし、インポート中に、このテーブル用に供給する任意のデータはツールにより無視されます。 代わりに、**SystemSequences** テーブルの次の **RecID** の値が、インポートされているテーブルの最大 **RecID** よりも低い場合、ツールはインポートされる各テーブルについてデータベースで **SystemSequences** テーブルを更新します。 各テーブルがインポートされると、ツールは **SystemSequences** テーブルに格納されている他の ID 値に必要な調整も行います。 .out ファイルで行を持たないテーブルをインポートすることができます。 テーブルをまったくインポートしないこともできます。 これら 2 つの工程は同じではありません。 行を持たないテーブルをインポートするとき、そのテーブル内の既存のデータは削除されます。 ただし、テーブルを全くインポートしない場合、そのテーブルの既存のデータは変更されません。 インポートする必要があるテーブルごとに、ツールは以下のアクションを実行します。
1.  ツールは、同じ起点 GUID を持つターゲット データベース内のテーブルを検索します。
    -   このようなテーブルが存在する場合、ツールは、インポートの対象としてそのテーブルを使用します。
    -   そのようなテーブルが存在しない場合、ツールは、同じ名前であるターゲット データベース内のテーブルを検索しようとします。 このようなテーブルが存在する場合、ツールは、インポートの対象としてそのテーブルを使用します。
    -   対象となるテーブルが見つからない場合は、テーブルはインポートされず、エラーは生成されません。

2.  ターゲット テーブルが特定されると、ターゲット テーブル内の列に一致する .out ファイルの新しい一時的なバージョンがツールによって作成されます。
3.  ソース テーブル内の各列で、ツールは最初に、フィールドの GUID の発生元を使用して、ターゲット テーブルで対応する列を検索します。 発生元に基づく一致が見つからない場合は、フィールド名を使用して列が一致します。
    -   ターゲット テーブル内で一致した列がないソース テーブル内に列がある場合は、それらの列のデータは無視され、エラーは生成されません。
    -   ソース テーブル内に一致した列がないターゲット テーブル内に列がある場合は、既定値が使用されます。 ほとんどの場合、既定値は 0 (ゼロ) またはターゲット列のデータ型と一致する空の列です。 ただし、ターゲット列が **InstanceRelationType** と名付けられる場合、既定値はターゲット テーブルのテーブル ID です。

4.  エンティティのテーブル ID、クラス ID、または拡張データ型 ID により Microsoft Dynamics AX のエンティティを参照することで知られる任意の列に関しては、ツールはターゲット データベースで同じエンティティの ID と一致する ID を更新します。 このツールは、まず、エクスポート時にソースデータの ID をエンティティの起点にマッピングします。 ツールは、エンティティの原点を使用して、ターゲット データベース内の ID を取得します。 ターゲット システムで、事業体が見つからない場合に元の ID を使用すると、エラーは生成されません。
5.  インポート中に、クラスター化されていないインデックスのインデックス違反のためにデータがインポートされなかった場合、ツールはインデックスを無効にしてからインポートを再試行します。 この場合、インデックスを無効にされた後にデータが正常にインポートされた場合でも、ログ ファイルにエラーが報告されます。

### <a name="import-example"></a>インポートの例

次の例は、**Import\_March2013** ディレクトリにあるすべてのファイルをインポートする方法を示しています。
DP.exe インポート Import_March2013 AXTestDB

### <a name="files-used-during-import"></a>インポート中に使用されるファイル

このセクションでは、インポート処理中にテスト データ転送ツール (ベータ版) で使用されるファイルについて説明します。
#### <a name="temporary-files"></a>一時ファイル

テスト データ転送ツール (beta) は、追加、削除、または名前変更が実行された列などの多くの種類の変更を含むテーブルにデータをインポートできます。 この機能を有効にするには、修正されたバージョンの .out ファイルをディスクの一時的な場所に書き込み、このファイルを bcp に渡してインポートします。 インポートが完了すると、ツールは一時ファイルを削除します。 一時ファイルの名前は、**Path.GetTempPath()** および **Path.GetRandomFileName()** を呼び出すことによって生成されます。 通常、一時ファイルは実行時エラーが発生しても削除されます。 ただし、インポート中に停電が発生する場合などのまれな状況では、一時ファイルに書き込まれ、削除はされません。 ファイルが現在のユーザーの一時的なパスに書き込まれるため、この問題により予期せぬ情報開示が発生しないようにする必要があります。 ただし、インポートする情報の重要度によって、および組織のデータ処理のポリシーによっては、このリスクについて理解しておく必要があります。

### <a name="sql-files"></a>.sql ファイル

テスト データ転送ツール (ベータ) では、.sql ファイルを \[インポート\] フォルダに追加すると、ユーザーのコンテキストで任意の SQL ステートメントを実行できます。。 信頼済のソースから .sql ファイルだけを追加します。

### <a name="out-files-outmodel-files-and-xml-files"></a>.out ファイル、.outmodel ファイル、および .xml ファイル

テスト データ転送ツール (ベータ) は、.out ファイルの名前から、およびインポートするデータを含むディレクトリ内のその他のファイルの内容から SQL ステートメントを生成します。 これらのファイルから取得され、SQL ステートメントを生成するために使用されるコンテンツは、テーブル名を表す必要があります。 SQL インジェクション攻撃を防ぐため、ツールは SQL クエリを作成する前にデータの検証とエスケープを行います。 ただし、信頼できるソースからのみデータを受け入れることを引き続きお勧めします。

## <a name="run-sql-scripts-after-import"></a>インポート後に SQL スクリプトを実行
テスト データ転送ツール (ベータ) では、インポートを完了した後に SQL スクリプトを実行できます。 インポートされたデータに対して行う変更は、SQL スクリプトを使用することによって完了できます。 データのインポートを完了する前に、SQL スクリプトを作成し、ツールと同じ場所にある\[インポート\] サブフォルダーに .sql ファイルとして保存します。 インポートが完了したら、ツールは、\[インポート\] フォルダに保存されている SQL スクリプト ファイルを自動的に実行します。





