---
title: "Excel アドインの使用"
description: "このトピックでは、Microsoft Excel でエンティティ データを開き、Excel 用の Microsoft Dynamics Office アドインを使用してそのデータを表示、更新、また編集する方法を説明します。"
author: ChrisGarty
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28T00:00:00.000Z
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 08c38aada355583c5a6872f75b57db95d9b81786
ms.openlocfilehash: 06fc9f8dda83fddea9ae331bb82c8874b15d76b9
ms.contentlocale: ja-jp
ms.lasthandoff: 07/27/2017

---

# <a name="use-the-excel-add-in"></a>Excel アドインの使用

[!include[banner](../includes/banner.md)]


このトピックでは、Microsoft Excel でエンティティ データを開き、Excel 用の Microsoft Dynamics Office アドインを使用してそのデータを表示、更新、また編集する方法を説明します。 エンティティ データを開くには、Excel か Microsoft Dynamics 365 for Finance and Operations、Enterprise Edition のいずれからでも開始できます。

Microsoft Excel でエンティティ データを開くことにより、Excel 用の Microsoft Dynamics Office アドインを使用して迅速かつ簡単にデータを表示し編集することができます。 このアドインには Microsoft Excel 2016 が必要です。 **注記:** Microsoft Azure Active Directory (Azure AD) テナントが Active Directory フェデレーション サービス (AD FS) を使用するようにコンフィギュレーションされている場合は、Excel のアドインに正しくサインインできるように、2016 年 5 月の更新が適用されていることを確認する必要があります。

## <a name="open-entity-data-in-excel-when-you-start-from-dynamics-365-for-finance-and-operations"></a>Dynamics 365 for Finance and Operations から開始して Excel でエンティティ データを開く
1.  Microsoft Dynamics 365 for Finance and Operations のページで、[**Microsoft Office で開く**] をクリックします。 そのページのルート データ ソース (テーブル) がエンティティのルート データ ソースと同じである場合は、既定の [**Excel で開く**] オプションがそのページに生成されます。 [**Excel で開く**] オプションは [**すべての仕入先**] や [**すべての顧客**] などの頻繁に使用するページに表示されます。
2.  [**Excel で開く**] オプションをクリックし、生成されるブックを開きます。 このブックには、エンティティのバインディング情報、環境へのポインター、また Excel アドインへのポインターがあります。
3.  Excel で [**編集機能を有効にする**] をクリックし、Excel アドインが実行されるようにします。 Excel のウィンドウ右側のウィンドウで Excel アドインが実行されます。
4.  初めて Excel アドインを実行する場合は、[**このアドインを信頼します**] をクリックします。
5.  サインインするようにとのメッセージが表示されたら、[**サインイン**] をクリックし、Dynamics 365 for Finance and Operations へのサインインに使用するのと同じ資格情報を用いてサインインします。 可能な場合、Excel アドインは Internet Explorer のサインイン コンテキストを使用し、自動的にサインインします。 そのため、Excel アドインの右上隅のユーザー名を確認します。

Excel アドインが、選択したエンティティのデータを自動的に読み取ります。 Excel アドインが読み込むまでブックにデータはないことに注意してください。

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>Excel から開始して Excel でエンティティ データを開く
1.  Excel の [**挿入**] タブの [**アドイン**] グループで、[**ストア**] をクリックして Office ストアを開きます。
2.  Office ストアで、キーワード「Dynamics」で検索し、[**Microsoft Dynamics Office アドイン**] (Excel アドイン) の隣の [**追加**] をクリックします。
3.  初めて Excel アドインを実行する場合は、[**このアドインを信頼します**] をクリックして Excel アドインの実行を有効化します。 Excel のウィンドウ右側のウィンドウで Excel アドインが実行されます。
4.  [**サーバー情報の追加**] をクリックして [**オプション**] ウィンドウを開きます。
5.  ターゲットの Dynamics 365 for Finance and Operations インスタンスからブラウザの URL をコピーし、それを [**サーバー URL**] フィールドに貼り付けてから、ホスト名以降をすべて消去します。 結果の URL はホスト名のみである必要があります。
たとえば、URL が https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage なら、**https://xxx.dynamics.com** 以外すべて消去します。
6.  [**OK**] をクリックしてから [**はい**] をクリックし、変更を確認します。 Excel アドインが再開しメタデータを読み込みます。 [**デザイン**] ボタンが使用できるようになりました。 Excel アドインに [**アプレットの読み込み**] ボタンがある場合は、正しいユーザーとしてサインインしていない可能性があります。 詳細については、このトピックの「トラブルシューティング」セクションにある「アプレットの読み込みボタンが表示される」を参照してください。
7.  [**デザイン**] をクリックします。 Excel アドインがエンティティ メタデータを取得します。
8.  [**テーブルの追加**] をクリックします。 エンティティの一覧が表示されます。 エンティティは「名前 - ラベル」形式で一覧表示されます。
9.  一覧にある [**顧客 - 顧客**] などのエンティティを選択し、[**次へ**] をクリックします。
10. フィールドを [**使用可能なフィールド**] リストから [**選択されたフィールド**] リストに追加するには、そのフィールドをクリックしてから [**追加**] をクリックします。 または、そのフィールドをダブルクリックします。
11. **選択されたフィールド** リストへフィールドの追加が完了したら、カーソルがブックの正しい場所 (たとえば、セル A1) にあることを確認し、**完了** をクリックします。 その後 [**完了**] をクリックしてデザイナーを終了します。
12. [**更新**] をクリックしてデータを取得します。

## <a name="view-and-update-entity-data-in-excel"></a>Excel でのエンティティ データの表示および更新
Excel アドインがエンティティ データをブックに読み込んだら、Excel アドインで [**更新**] をクリックすることでいつでもデータを更新できます。

## <a name="edit-entity-data-in-excel"></a>Excel でのエンティティ データの編集
Excel アドインで [**公開**] をクリックすることにより、必要に応じてエンティティ データを変更してから再公開することができます。 レコードを編集するには、ワークシートのセルを選択し、セルの値を変更します。 新しいレコードを追加するには、次のいずれかの手順を実行します。

-   データ ソース テーブルの任意の場所をクリックし、Excel アドインで **新規** をクリックします。
-   データ ソース テーブルの最終行をクリックし、カーソルがその行の最終列から出て新しい行が作成されるまで Tab キーを押します。
-   データ ソース テーブルの真下の行をクリックして、セルへのデータ入力を開始します。 そのセルからフォーカスを移動させると、テーブルが拡張してその新しい行を含めます。
-   ヘッダー レコードのフィールド バインディングには、いずれかのフィールドをクリックし、Excel アドインの **新規** をクリックします。

新しいレコードは、ワークシートですべてのキーと必須フィールドが選択されている場合、もしくはフィルタ条件を使用して既定値が入力された場合にのみ作成できることに注意してください。
レコードを削除するには、次のいずれかの手順を実行します。

-   削除したいワークシートの行の横にある行番号を右クリックし、[**削除**] をクリックします。
-   削除したいワークシートの行で右クリックし、[**削除**] &gt; [**テーブル行**] をクリックします。
データ ソースが関連付けて追加される場合、行の前にヘッダーが発行されます。 他のデータ ソースとの間に依存関係がある場合は、既定の公開オーダーを変更する必要があるかもしれません。 公開オーダーを変更するには、Excel アドインで **オプション** ボタン (ギヤ記号) をクリックします。 その後、**データ コネクタ** クイック タブで **公開オーダーのコンフィギュレーション** をクリックします。

## <a name="add-or-remove-columns"></a>列の追加または削除
デザイナーを使用して、ワークシートに自動的に追加された列を調整することができます。

1.  [**オプション**] ボタン (ギヤ記号) をクリックしてから [**デザインの有効化**] チェック ボックスを選択することにより、Excel アドインのデータ ソース デザイナーを開始します。
2.  Excel アドインで [**デザイン**] をクリックします。 すべてのデータ ソースが一覧表示されます。
3.  データ ソースの横の [**編集**] ボタン (鉛筆記号) をクリックします。
4.  必要に応じて [**選択されたフィールド**] リストの一覧を調整します。
    -   フィールドを [**使用可能なフィールド**] リストから [**選択されたフィールド**] リストに追加するには、そのフィールドをクリックしてから [**追加**] をクリックします。 または、そのフィールドをダブルクリックします。
    -   [**選択されたフィールド**] リストからフィールドを削除するには、そのフィールドをクリックしてから [**削除**] をクリックします。 または、そのフィールドをダブルクリックします。
    -   フィールドの順序を変更するには、**選択されたフィールド** リストでフィールドをクリックし、フィールドをクリックし、**上へ** または **下へ** をクリックします。

5. データ ソースに変更を適用するには、**更新** をクリックします。 その後 [**完了**] をクリックしてデザイナーを終了します。 
6. フィールド (列) を追加した場合、[**更新**] をクリックして更新されたデータを取得します。

## <a name="troubleshooting"></a>トラブルシューティング
生じる問題のいくつかは簡単なステップで解決できます。

-   **アプレットの読み込みボタンが表示される** サインイン後に Excel アドインに [**アプレットの読み込み**] ボタンがある場合は、正しいユーザーとしてサインインしていない可能性があります。 この問題を解決するために、Excel アドインの右上隅に正しいユーザー名が表示されることを確認します。 正しくないユーザー名が表示されている場合は、それをクリックし、サインアウトしてから再度サインインします。
-   **「禁止された」メッセージを受信する** Excel アドインのメタデータの読み込み中に「禁止された」メッセージを受信する場合、Excel アドインにサインインしているアカウントには、対象のサービス、インスタンス、またはデータベースを使用するためのアクセス許可がありません。 この問題を解決するために、Excel アドインの右上隅に正しいユーザー名が表示されることを確認します。 正しくないユーザー名が表示されている場合は、それをクリックし、サインアウトしてから再度サインインします。
-   **Excel 上に空白の Web ページが表示される** サインイン プロセス中に空白の Web ページが開く場合、そのアカウントには AD FS が必要ですが、アドインを実行している Excel のバージョンがサインイン ダイアログ ボックスを読み込めるほど新しくありません。 この問題を解決するには、使用している Excel のバージョンを更新します。 繰延チャンネルの企業にいる場合に Excel のバージョンを更新するには、[繰延チャンネルから現在のチャンネルに移動する](https://technet.microsoft.com/library/mt455210.aspx) ために [Office 配置ツール](https://technet.microsoft.com/library/jj219422.aspx) を使用します。





