環境間でデータベースをコピーするとき、コピーされたデータベースが完全に機能するには、その前に環境の再プロビジョニング ツールを実行して、すべての Retail コンポーネントを確実に最新にしておく必要があります。

> [!IMPORTANT]
> 小売機能はすべての環境に含まれているため、Retail コンポーネントを使用しているかどうかに関係なく、このプロシージャを実行することをお勧めします。 

続行する前に、次の前提条件が満たされていることを確認する必要があります。

1. ターゲット環境で 2017 年 7 月リリース以降が実行されている場合は、KB 4035399 を適用します。 
2. ターゲット環境で 11 月リリース (バージョン 1611) が実行されている場合は、次の修正プログラムを適用します。
   -   KB 4025631
   -   KB 4035355
   -   KB 4035492
   -   KB 4010947
   -   KB 4045801
3. 既定のチャネル データベースおよび既定のチャネル データ グループの名前は **既定** にする必要があります。 これらの名前を変更していた場合は、名前を元に戻す必要があります。

以下の手順に従って、環境再プロビジョニング ツールを実行します。

1. 共有アセット ライブラリで、**ソフトウェア配置可能なパッケージ** を選択します。
2. 環境再プロビジョニング ツールをダウンロードします。
3. 自身のプロジェクトのアセット ライブラリで、**ソフトウェア配置可能パッケージ** を選択します。
4. **新規作成** コマンドを選択して、新しいパッケージを作成します。
5. パッケージの名前と説明を入力します。 **環境再プロビジョニング ツール** をパッケージ名として使用できます。
6. 先ほどダウンロードしたパッケージをアップロードします。
7. ターゲット環境の **環境の詳細** ページで、**管理** > **更新プログラムを適用** を順に選択します。
8. 先ほどアップロードした環境再プロビジョニング ツールを選択し、**適用** を選択してパッケージを適用します。
9. パッケージの配置の進捗を監視します。 

配置可能パッケージを適用する方法の詳細については、[配置可能パッケージの適用](../deployment/create-apply-deployable-package.md)を参照してください。 配置可能パッケージを手動で適用する方法の詳細については、[配置可能パッケージのインストール](../deployment/install-deployable-package.md)を参照してください。
