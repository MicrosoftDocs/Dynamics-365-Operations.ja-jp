---
title: "データ管理"
description: "このトピックでは、Microsoft Dynamics 365 for Finance and Operations のデータ管理に関する一般情報を提供します。"
author: Sunil-Garg
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Developer, IT Pro
ms.reviewer: margoc
ms.search.scope: Operations
ms.custom: 96283
ms.assetid: e67f5edc-1087-4867-8955-b2a40d94217f
ms.search.region: Global
ms.author: sunilg
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 879eb9f2a63a8514791f74965005ed3e22bc0de7
ms.openlocfilehash: b3a3fc20dd558630bec957f2af5ae73ffa7fbad5
ms.contentlocale: ja-jp
ms.lasthandoff: 04/20/2018

---

# <a name="data-management"></a>データ管理


[!include [banner](../includes/banner.md)]

このトピックでは、データ管理フレームワークを使用して、Microsoft Dynamics 365 for Finance and Operations のデータ エンティティおよびデータ エンティティ パッケージを管理する方法について説明します。 

データ管理フレームワークは、以下の概念で構成されています。 

- **データ エンティティ**: データ エンティティは、1 つ以上の基になるテーブルを概念的に抽象化してカプセル化したものです。 データ エンティティは、共通のデータ概念や機能、たとえば、顧客または仕入先を表します。 データ エンティティは、業務コンセプトに精通したユーザーが容易に理解できるように意図されています。 データ エンティティの作成後、Excel アドインを使用して再利用したり、インポート/エクスポート パッケージを定義したり、統合に使用することができます。 
- **データ プロジェクト**: マッピングおよび既定の処理オプションを含む、コンフィギュレーションされているデータ エンティティを含むプロジェクト。
- **データ ジョブ**: データ プロジェクトの実行インスタンス、アップロードされたファイル、スケジュール (反復)、および処理オプションを含むジョブ。
- **ジョブ履歴**: ステージングおよびターゲット ジョブへのステージングのソースの履歴。
- **データ パッケージ**: データ プロジェクト マニフェストとデータ ファイルを含む単一の圧縮ファイル。 これは、データジョブから生成され、マニフェストを含む複数のファイルのインポートまたはエクスポートに使用されます。 

データ管理フレームワークでは、以下のコア データ管理シナリオでデータ エンティティを使用することができます。

- データ移行
- セットアップとコピーのコンフィギュレーション
- 統合


## <a name="data-entities"></a>データ エンティティ

データ エンティティは重要なデータの概念および機能を表すテーブル スキーマの抽象化およびカプセル化の概念を提供します。 Microsoft Dynamics AX 2012 では、顧客および仕入先のテーブルなどのほとんどのテーブルが非正規化され、複数のテーブルに分割されていました。 これはデータベース設計の観点からは有益でしたが、実装者や ISV が物理スキーマを十分に理解することなく使用することは困難でした。 データ エンティティは、ビジネス概念を使用して容易に理解できる抽象化のレイヤーとして使用されるデータ管理の一部として導入されました。 以前のバージョンの Microsoft Dynamics 365 for Finance and Operations では、Microsoft Excel アドイン、AIF、DIXF などのデータを管理するための複数の方法がありました。 データ エンティティの概念は、これらの異なる概念を 1 つにまとめたものです。 データ エンティティの作成後、Excel アドイン、インポート/エクスポート、または統合のためにそれらを再利用できるようになります。 次のテーブルは、コア データ管理シナリオを示しています。

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>データ移行</strong></td>
<td><ul>
<li>レガシまたは外部のシステムからのデータを参照、マスター、およびドキュメントのデータを移行します。</li>
</ul></td>
</tr>
<tr class="even">
<td><strong>セットアップとコピーのコンフィギュレーション</strong></td>
<td><ul>
<li>会社/環境間でコンフィギュレーションをコピーします。</li>
<li>Lifecycle Services (LCS) 環境を使用してプロセスまたはモジュールをコンフィギュレーションします。</li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>統合</strong></td>
<td><ul>
<li>統合に基づくリアルタイム サービス。</li>
<li>非同期の統合。</li>
</ul></td>
</tr>
</tbody>
</table>


## <a name="data-migration"></a>データ移行
データ管理フレームワークを使用することで、レガシまたは外部システムからの参照、マスター、およびドキュメント データを簡単に移行できます。 このフレームワークは、次の機能を使用してデータをすばやく移行するのに役立ちます。 

-   移行する必要があるエンティティのみを選択することができます。 
-   インポート中にエラーが発生した場合は、選択したレコードをスキップでき、適切なデータのみを使用し、不正なデータを修正して後でインポートし続行できます。 部分的に継続し、エラーを使用して不正なデータをすばやく見つけることができます。 
-   データ エンティティは、Excel を介することなく、直接 1 つの Finance and Operations システムから別の Finance and Operations システム、または XML に移動することができます。 
-   バッチを使用してデータのインポートを簡単にスケジュールすることができ、実行が必要なときに柔軟性を提供します。 たとえば、システムでいつでも顧客グループ、顧客、仕入先、およびその他のデータ エンティティを移行できます。

## <a name="set-up-and-copy-configuration"></a>セットアップとコピーのコンフィギュレーション
データ管理フレームワークを使用すると、会社または環境間の構成をコピーして、Microsoft Dynamics Lifecycle Services (LCS) を使用するプロセスまたはモジュールを構成することができます。 

コンフィギュレーションのコピーは、入力が必要なデータの構造やデータの依存関係、または実装にデータを追加する順序をチームが深く理解していなくても、新しい実装の開始を容易にするためのものです。 

データ管理フレームワークでは、次のことが可能です。

-   2 つの類似したシステム間でのデータの移動
-   エンティティと与えられた業務プロセスまたはモジュールのエンティティ間の依存関係を検出
-   データ テンプレートおよびデータセットの再利用可能なライブラリの管理
-   差分データ エンティティを作成するには、データ パッケージを使用します。 データ エンティティは、パッケージ内で順序付けすることができます。 データ パッケージは、インポートまたはエクスポート中に識別しやすい名前を付けることができます。 データ パッケージを作成するときは、グリッドに、またはビジュアル マッピング ツールを使用して、ステージング テーブルにマップすることができます。 また、列を手動でドラッグ アンド ドロップすることができます。 
-   データを比較して有効であることを確認できるように、インポート中にデータを表示します。

## <a name="working-with-data-entities"></a>データ エンティティの作業
次のセクションでは、データ エンティティを使用するデータ管理のさまざまな機能の簡単なスナップショットを提供します。 目標は、データ移行中に利用可能なツールを最適に活用する方法を戦略化し、効果的に決定するのを支援することです。 データ移行時に各領域を効果的に使用する方法についてのヒントとコツも検索します。 各領域の使用可能なデータ エンティティの一覧は、データの依存関係を示す、推奨されるデータの順序で見つけることもできます。 Microsoft は、Lifecycle Services (LCS) で確認できるデータ パッケージを初期ガイドとして提供します。 このドキュメントの情報は、独自のパッケージを作成するためのガイドとして使用できます。 各データ エンティティの説明には、オブジェクトに含まれるものとデータ移行中に必要なものが表示されます。

### <a name="sequencing"></a>優先順位
データ エンティティを扱うときに考慮する必要がある優先順位には 2 つのタイプがあります。

-   データ パッケージ内のシーケンス データ エンティティ
-   データ パッケージ インポートの順序の優先順位

#### <a name="sequence-data-entities-within-a-data-packages"></a>データ パッケージ内のシーケンス データ エンティティ**

1.  ユーザーがデータ プロジェクトにデータ エンティティを追加すると、既定では、シーケンスはエンティティが読み込まれる順序に設定されます。 プロジェクトに追加された最初のエンティティは、ロードする最初のエンティティとして設定され、次に追加されるエンティティは 2 番目に、次のエンティティは 3 番目に、などとなります。 
    たとえば、ユーザーがこの注文に 2 つのエンティティ**売上税コード**および**売上税グループ**を追加した場合、**売上税コード**に **1. 1.1** のエンティティ順序に割り当てられ、さらに**売上税グループ**に **1.1.2** のエンティティ順序が割り当てられます。 シーケンス レベルは、第 1 レベルが終了するまで第 2 エンティティがインポート プロセスを開始しないことを示します。
2.  シーケンスを表示または編集するには、データ プロジェクトのアクション ウィンドウにある **エンティティのシーケンス** ボタンをクリックします。 

    ![エンティティ シーケンス](./media/dataentitiesdatapackages01.png)

4.  定義グループ エンティティの順序で、実行単位と順序を表示できます。 一覧からデータ エンティティを選択して、異なる実行単位またはシーケンスを等しく設定してから、**選択対象の更新** をクリックすることにより、シーケンスを変更することができます。 **選択対象の更新**をクリックした後、エンティティはエンティティの一覧で上または下に移動します。

**例** 次のスクリーンショットは、消費税 CodeGroups データ パッケージに設定されているエンティティの順序を示しています。 

    ![Sales Tax CodeGroups data package sequence](./media/dataentitiesdatapackages02.png)

売上税コードとグループを正常にインポートするためには、最初に売上税コードおよび詳細を読み込んでから、売上税グループをインポートする必要があります。 売上税コードとグループがすべて実行単位 = 1 になっていますが、シーケンスはインポートされる順序になっています。 読み込まれる他のデータ エンティティに依存していないその他の関連する売上税エンティティは、パッケージに含まれます。 たとえば、消費税非課税番号が独自の実行単位 = 2 に設定されます。 このデータ エンティティは、直前に読み込んでいる他のエンティティに依存しないため、すぐに読み込みを開始します。 

#### <a name="sequence-data-package-imports"></a>シーケンス データ パッケージのインポート
正常にデータを読み込むには、モジュール内およびモジュール間に存在する依存関係のため、データ パッケージをインポートするための適切な順序を設定することが重要です。 LCS 内のデータ パッケージ用に作成された番号の形式は、次のとおりです。

-   最初のセグメント: モジュール
-   2 番目のセグメント: データ型 (設定、マスター、トランザクション)
-   第 3 セグメント: シーケンス番号

次のテーブルは、既定の番号付け形式の詳細を示しています。 

**モジュール番号**

[![モジュール地域番号](./media/dataentitiesdatapackages03.png)](./media/dataentitiesdatapackages03.png)

**データ型の数** 

[![データ型番号](./media/dataentitiesdatapackages04.png)](./media/dataentitiesdatapackages04.png)

**番号順序**

[![番号順序](./media/dataentitiesdatapackages05.png)](./media/dataentitiesdatapackages05.png)

データ パッケージは、シーケンス番号に続いて、モジュールの省略形、記述の順に続きます。 次の例は、総勘定元帳 データ パッケージを示しています。 

[![番号付けの例](./media/dataentitiesdatapackages06.png)](./media/dataentitiesdatapackages06.png)

## <a name="mapping"></a>マッピング
データ エンティティを使用するときは、ソースへのエンティティのマッピングは自動です。 必要な場合は、フィールドの自動マッピングを上書きできます。 

### <a name="view-mapping"></a>マッピングの表示
エンティティのマッピング方法を表示するには、プロジェクト内のエンティティのタイルを見つけて、**マップを表示** をクリックします。 

マッピング視覚化ビュー (既定値) とマッピング詳細ビューを提供します。 赤いアスタリスク (\*) によりエンティティの必須フィールドを識別します。 エンティティを使用して作業するために、これらのフィールドをマップする必要があります。 エンティティを使用して作業する際、必要に応じて他のフィールドのマップ解除をすることができます。 

- フィールドのマップ解除をするには、いずれかの列 (**エンティティ**または**ソース**) でフィールドを強調表示し、**選択項目を削除** をクリックしてから **Save** をクリックします。   保存したら、フォームを閉じてプロジェクトに戻ります。 

ソースからステージングへのフィールド マッピングも、同じプロセスを使用してインポートした後で編集できます。 
[![マッピングの視覚化](./media/dataentitiesdatapackages07.png)](./media/dataentitiesdatapackages07.png) 

### <a name="regenerate-a-map"></a>マップを再生成
エンティティ (追加済みフィールド) を拡張する場合、または自動マッピングが不適切であると表示された場合は、エンティティのマッピングを**マッピング** フォームで再生成できます。 

1. これを行うには、**ソース マッピングの生成** をクリックします。 
    「マッピングを最初から生成しますか?」と尋ねるメッセージが表示されます。 
2. マップを再生成するためには、**はい**をクリックします。

### <a name="generate-data"></a>データの生成
エンティティに、インポート時にデータを生成するフィールドがある場合は、ソース ファイルにデータを提供する代わりに、エンティティのマッピングの詳細で自動生成された機能を使用できます。 たとえば、顧客および顧客の住所情報をインポートしても、住所情報がグローバル アドレス帳エンティティで以前にインポートされなかった場合、インポート上の関係者番号を自動生成するエンティティを持つことができ、GAB 情報が作成されます。 この機能にアクセスするには、エンティティのマップを表示し、**マッピング詳細** タブをクリックします。自動生成するフィールドを選択します。 これにより、ソース フィールドが**自動**に変更されます。 

[![dataw の生成](./media/dataentitiesdatapackages18.png)](./media/dataentitiesdatapackages18.png)

### <a name="turn-off-automatically-generated-number-sequences"></a>自動的に生成される番号シーケンスをオフにする
多くのエンティティは、番号順序の設定に基づく ID の自動生成をサポートしています。 たとえば、製品を作成するときに、製品番号は自動で生成され、フォームで値を手動で編集することはできません。 

[![自動番号 sequence.png](./media/dataentitiesdatapackages15.png-300x213.jpg)](./media/dataentitiesdatapackages15.png.jpg) 

特定のエンティティに対する番号順序の手動割り当てを有効にできます。

[![手動番号順序を有効化](./media/dataentitiesdatapackages16-300x153.png)](./media/dataentitiesdatapackages16.png) 

手動割り当てを有効にした後、代わりに手動で割り当てられた番号を指定できます。

[![番号シーケンスの提供](./media/dataentitiesdatapackages17-300x214.png)](./media/dataentitiesdatapackages17.png)


## <a name="export"></a>輸出
エキスポートは、データ エンティティを使用してシステムからデータを取得するプロセスです。 エクスポート プロセスは、プロジェクトを通じて行われます。 エクスポートするとき、エクスポート プロジェクトの定義方法に関して、多くの柔軟性があります。 エクスポートするデータ エンティティ、エンティティ数、使用するファイル形式 (エクスポートのために選択できる 14 の形式があります)、を選択して、各エンティティにフィルターを適用してエクスポート対象を制限することができます。 データ エンティティがプロジェクトを取り出した後、前述されたシーケンスとマッピングは、各エクスポート プロジェクトに対して実行できます。

[![ページのエクスポート](./media/dataentitiesdatapackages08-1024x400.png)](./media/dataentitiesdatapackages08.png)

プロジェクトが作成され保存された後は、プロジェクトをエクスポートし、ジョブを作成することができます。 エクスポート プロセス中に、ジョブのステータスとレコード数をグラフィカルに表示できます。 このビューには複数のレコードが表示されるので、実際のファイルをダウンロードする前に各レコードの状態を確認できます。 

-   システム ユーザーのエンティティをインポート中、エクスポートされたパッケージにゲスト ユーザーがある場合は、整合性違反エラーが発生する可能性があります。 エンティティを動作させるには、ゲスト ユーザーをパッケージから削除する必要があります。
-   レコードが **UserInfo** テーブルに既に存在する場合 (管理者レコードが存在する可能性が最も高い)、インポートはそれらのレコードでは失敗しますが、他のレコードでは機能します。


[![実行の要約](./media/dataentitiesdatapackages10-1024x280.png)](./media/dataentitiesdatapackages10.png) 

[![レコードのカウント](./media/dataentitiesdatapackages11.png)](./media/dataentitiesdatapackages11.png) 

ジョブが完了した後、ファイルのダウンロード方法を選択できます。各データ エンティティは別々のファイルにすることも、ファイルをパッケージにまとめることもできます。 ジョブに複数のデータ エンティティがある場合は、パッケージ オプションを選択すると、アップロードのプロセス速度が上がります。 パッケージは zip ファイルであり、各エンティティのデータ ファイルとパッケージ ヘッダーとマニフェストを含んでいます。 これらの追加のドキュメントは、データ ファイルを正しいデータ エンティティに追加してインポート プロセスを順序付けるために、インポート時に使用されます。

## <a name="import"></a>インポート元
インポートは、データ エンティティを使用してシステムにデータを引き出すプロセスです。 インポートプロセスは、**データ管理** ワークスペースの **インポート** タイルで行います。 データは、個々のエンティティまたは正しい順序で配列された論理的に関連するエンティティのグループのいずれかにインポートできます。 ファイル形式はインポートのタイプによって異なります。 エンティティについては、コンマ区切り、タブ区切り、またはテキストの Excel ファイルである可能性があります。 データ パッケージで、それは .zip ファイルです。 どちらの場合も、ファイルは上記のエクスポート プロセスを使用してエクスポートされます。 


### <a name="import-a-data-package"></a>データ パッケージのインポート: 
1.  十分な権限 (通常、これは管理者ロール) のあるログインを使用して環境にログインします。
2.  ダッシュボードで、**データ管理**ワークスペースをクリックします。
3.  **インポート** タイルをクリックします。
4.  次のページで、次の操作を行います。
    1.  名前を入力します。
    2.  **ソース データ形式**フィールドで、**パッケージ**を選択します。
    3.  **アップロード** ボタンをクリックし、インポートするデータの場所から適切なパッケージ ファイルを選択します。 これにより、パッケージからすべてのファイルがインポートされます。 
    [![パッケージファイルを選択する](./media/dataentitiesdatapackages12-1024x555.png)](./media/dataentitiesdatapackages12.png)
    4.  **保存**をクリックし、**インポート**をクリックします。

### <a name="import-multiple-data-packages"></a>複数のデータ パッケージのインポート:
複数のデータ パッケージをインポートするには、次のいずれかの方法を使用します。
-   各パッケージの新しいジョブを作成し、上記の手順 4(a) から 4(d) をパッケージごとに繰り返します。 
-   1 つのジョブを作成して、複数のパッケージをシーケンス内にインポートします。 インポートする必要があるすべてのパッケージで上記の手順 4(a) ～ 4(c) を繰り返します。 パッケージを選択した後に、ステップ 4 (d) を実行し選択したデータ パッケージから単一のジョブでデータをインポートします。 
        [![Multiple data packages](./media/dataentitiesdatapackages13-1024x555.png)](./media/dataentitiesdatapackages13.png)

**インポート**をクリックした後、ステージング テーブルを使用してデータがインポートされます。 インポートの進行状況は、画面の右上にある **更新** ボタンを使用して追跡できます。 

## <a name="troubleshoot-data-package-processing"></a>データ パッケージ処理のトラブルシューティング
このセクションでは、データ パッケージ処理のさまざまな段階に関するトラブルシューティング情報を提供します。

-   スケジュールされたジョブのステータスおよびエラーの詳細は、**データ管理** フォームの **ジョブの履歴** セクションにあります。
-   データ エンティティの前の実行のステータスおよびエラーの詳細は、データ プロジェクトを選択して **ジョブの履歴** をクリックすることで表示できます。 **実行履歴**フォームで、ジョブを選択して**ステージング データの表示**および**実行ログの表示**をクリックします。 上記の実行には、バッチ ジョブとして、または手動で実行された、データのプロジェクトの実行が含まれます。

### <a name="export-process-troubleshooting"></a>プロセス トラブルシューティングをエキスポート
-   エクスポート プロセス中にエラーが発生した場合、**実行ログの表示**をクリックし、ログのテキスト、ステージング ログ詳細、詳細情報の情報ログをを確認します。
-   エクスポート プロセス中にエラーが発生し、ステージングをスキップするように指示ノートが表示された場合、**ステージングをスキップ** オプションをオフにし、エンティティを追加します。 複数のデータ エンティティをエクスポートする場合は、個々のデータ エンティティに対して**ステージングのスキップ**ボタンを使用できます。

### <a name="import-process-troubleshooting"></a>プロセス トラブルシューティングのインポート
データ エンティティ ファイルをアップロードするとき、次の操作を行います。
- インポート処理中に**アップロード**をクリックした後に、データ エンティティが**選択したファイルとエンティティ**内で表示されていない場合は、数分待ってから、OLEDB ドライバーがまだインストールされているかどうかを確認します。 それ以外の場合は、OLEDB ドライバーを再インストールします。 ドライバーは Microsoft Access データベース エンジン 2010 再頒布可能パッケージ – AccessDatabaseEngine\_x64.exe。
- インポート処理中に**アップロード**をクリックした後に、データ エンティティが**選択されているファイルとエンティティ**内で警告と一緒に表示されている場合、**マップの表示**をクリックし、個々のデータ エンティティのマッピングを確認し、修正します。 マッピングを更新し、各データ エンティティの **保存** をクリックします。
  データ エンティティのインポート中:
- **インポート**をクリックし、データ エンティティ (データ エンティティ タイルの赤い X アイコンまたは黄色の三角アイコンで表示されている) が失敗した場合、**実行の概要**ページにある各タイルの**ステージング データの表示**をクリックし、エラーを確認します。 移動ステータス = エラーのレコードを並べ替えてスクロールし、メッセージ セクションにエラーを表示します。 ステージング テーブルをダウンロードします。 **編集、すべて検証、およびデータをターゲットにコピー**をクリックしてステージングで直接レコード (またはすべてのレコード) を修正するか、またはインポート ファイル (ステージング ファイルではない) を修正し、データを再インポートします。
  -   **インポート**をクリックし、データ エンティティ (データ エンティティ タイルの赤い x アイコンまたは黄色の三角アイコンで表示されている) が失敗し、**ステージング データの表示**にデータがない場合は、**実行の概要**ページに戻ります。 **実行ログの表示**に移動し、データ エンティティを選択し、詳細については**ログ テキスト、ステージング ログの詳細、および情報ログ**を確認してください。 **ステージング ログ詳細**が表示され**エラー列** (フィールド) の詳細および**ログ説明**がエラーの詳細を説明します。
- データ エンティティが失敗した場合、インポート ファイルを確認し、「これは 255 文字以上をサポートするための列にするダミー セルとして Excel に挿入される文字列です」というテキストが表示されている追加の明細行がファイルにあるかどうかを確認できます。 既定では、Excel 出力先コンポーネントは 255 文字以上をサポートしません。 既定の Excel タイプは、最初の数行に基づいて設定されます。 この行は、データのエクスポート中に追加されます。 この明細行が存在する場合は、それを削除し、データ エンティティを再パッケージし、インポートを試行します。

### <a name="troubleshooting-the-system-users-entity"></a>システム ユーザーのエンティティのトラブルシューティング
-   システム ユーザーのエンティティをインポートするとき、エクスポートされたパッケージにゲスト ユーザーがある場合は、整合性違反エラーが発生する可能性があります。 エンティティを動作させるには、ゲスト ユーザーをパッケージから削除する必要があります。
-   レコードが **UserInfo** テーブル (管理者レコードが存在する可能性があります) に既に存在する場合、インポートはそれらのレコードでは失敗しますが、他のレコードでは機能します。


## <a name="additional-resources"></a>その他のリソース
[データ エンティティ](data-entities.md)




