---
title: "サンドボックス データベース更新の要求"
description: "このトピックでは、サンドボックスのユーザー受け入れテスト (UAT) 環境で、Microsoft Dynamics 365 for Finance and Operations のデータベースの更新を要求する方法について説明します。"
author: LaneSwenka
manager: AnnBe
ms.date: 10/26/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: IT Pro, Developer
ms.reviewer: margoc
ms.search.scope: Operations
ms.custom: 257614
ms.assetid: 558598db-937e-4bfe-80c7-a861be021db1
ms.search.region: Global
ms.author: laneswenka
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 0450326dce0ba6be99aede4ebc871dc58c8039ab
ms.openlocfilehash: 8f1a120ac04fa12fc4998393be86634839def633
ms.contentlocale: ja-jp
ms.lasthandoff: 11/01/2018

---

# <a name="request-sandbox-database-refreshes"></a>サンドボックス データベース更新の要求

[!include [banner](../includes/banner.md)]

Microsoft Dynamics Lifecycle Services (LCS) を使用して、サンドボックス ユーザー承認テスト (UAT) 環境で、Microsoft Dynamics 365 for Finance and Operations のデータベースのリフレッシュを要求することができます。 データベースの更新対象となるサンド ボックス UAT 環境に、本番環境のデータベース (および財務報告データベース) をコピーできます。 別の UAT 環境を使用する場合は、その環境からデータベースをコピーすることもできます。

この機能により、生産データを使用して UAT 環境で予定されているコード変更をテストできます。 また、デバッグの目的で、生産データベースを UAT 環境にコピーすることもできます。

## <a name="database-refresh-process"></a>データベース更新プロセス

> [!NOTE]
> 2018 年 10 月の時点で、同じ環境内の別の更新を開始する前に、データベース更新要求をサインオフする必要があります。 これは、データベース移動操作の将来の自動化をサポートするためです。 サインオフするには、環境の詳細ページにアクセスし、**サインオフ** ボタンをクリックします。 将来に向けて多くのデータベース更新サービス要求を作成できますが、各要求間でサインオフする必要があります。

Microsoft サービス エンジニアリング チームは、環境をオフラインにして、更新を実行し、環境をオンラインに戻します。 ダウンタイム期間が約 2 時間であると予測することができます。 ユーザーが要求を入力してから、マイクロソフトのサービス エンジニアが措置を講じるまでの時間が、ユーザーの環境のダウンタイムよりも長くなります。 今後、データベース更新を実行するために使用できるセルフ サービスのメソッドを提供する予定です。

1. LCS のプロジェクト ホーム ページで、**サービス要求** を選択します。
2. **サービス要求**ページの、ツールバーで**追加**を選択し、**データベースの更新**を選択します。
3. **データベース更新の要求**ダイアログ ボックスで、これらの手順に従います。

    1. **環境名**フィールドで、更新する環境を選択します。
    2. **データベース** フィールドでは、更新するデータベースは常に Microsoft Dynamics AX データベースまたは Finance and Operations データベースです。 エンティティ格納などの他のデータベースでは、データベースの更新が現在サポートされていません。
    3. チェック ボックスを隣に置いたステートメントを注意深く読んで確認してください。

4. 要求を送信した後、作業項目のリストに戻ります。 ここで、要求のステータスを表示し、または再スケジューリングし、または要求をキャンセルできます。
5. サインオフまたはロールバックを待機している事前サービス要求が環境にないことを確認します。 環境の詳細ページに移動し、完了した更新やパッケージの展開をサインオフします。
6. サービス エンジニア リング チームがお客様の要求を達成できることを確認したとき、その要求のステータスは **要求受入済** に変更されます。 この時点で、次のいずれかの手順を実行できます。

    - サービス エンジニア リング チームによる更新が完了するまで待ちます。 復元が完了したら、ステータスが **"成功"** に変更されます。
    - ID を選択するか、要求を選択してツール バーで **再スケジューリング** を選択することにより、リクエストを再スケジューリングします。 ダウンタイム ウィンドウの日時を変更することができます。
    - 要求を選択し、ツールバーの**キャンセル**を選択して、要求をキャンセルします。

## <a name="conditions-of-a-database-refresh"></a>データベース更新の条件
データベース更新の操作の要件および条件の一覧を次に示します。

- パッケージの展開や事前データベース更新など、環境の詳細ページから以前のサービス操作を*サインオフする必要があります*。
- 要求は、要求を完了するためにリソースを確実に使用できるようにするため、目的のダウンタイム期間の 5 時間前までに送信する必要があります。
- 更新により、ターゲット環境の既存のデータベースが消去されます。 更新が完了すると、既存のデータベースを復元することはできません。
- 更新プロセスが完了するまで、ターゲット環境は使用できなくなります。
- リフレッシュは、Finance and Operations and Financial Reporting データベースにのみ影響します。
- Azure blob storage のドキュメントは、ある環境から別の環境にコピーされません。 つまり、添付されたドキュメント処理ドキュメントとチームプレートは変更されず、現在の状態にとどまります。
- 管理者ユーザー、およびその他の内部サービス ユーザー アカウントを除くすべてのユーザーは無効になります。 このプロセスにより、他のユーザーをシステムに戻す前に、管理者ユーザーがデータを削除または難読化できます。
- 管理者ユーザーは、特定のサービスまたは URL に統合エンドポイントを再接続するなど、必要な構成の変更を加える必要があります。
- 定期的にインポートおよびエクスポート ジョブされるすべてのデータ管理フレームワークは完全に処理され復元が開始される前にターゲット システムで停止する必要があります。 さらに、すべての定期的なインポートおよびエクスポート ジョブが完全に処理された後に、データベースをソースから選択することをお勧めします。 これにより、いずれかのシステムから Azure ストレージにオーファン ファイルが存在しないことが保証されます。 これは、データベースがターゲット環境にリストアされた後にオーファン ファイルを処理できないため重要です。 復元後、統合ジョブを再開することができます。
- 実行するように設定されていたすべてのバッチは**源泉**状態として設定され、環境が再コンフィギュレーションされる前にバッチは実行を停止します。
- SMTP サーバー構成、すべての電子メール アドレス、およびすべての **印刷管理**設定 (ネットワーク プリンターを含む) が削除されました。
- LCS でプロジェクト所有者または環境マネージャーのロールを持つユーザーは、すべての非実稼働環境の SQL とマシンの資格情報にアクセスできます。

## <a name="steps-to-complete-after-a-database-refresh-for-environments-that-use-retail-functionality"></a>Retail 機能を使用する環境のデータベース更新後に実行する手順
[!include [environment-reprovision](../includes/environment-reprovision.md)]

