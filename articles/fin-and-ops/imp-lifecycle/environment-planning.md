---
title: 環境計画
description: このトピックでは、プロジェクトの環境を計画するときに考慮する必要があるさまざまな側面の概要を示します。
author: ClaudiaBetz-Haubold
manager: AnnBe
ms.date: 08/13/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: IT Pro
ms.reviewer: kfend
ms.search.scope: Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: chaubold
ms.search.validFrom: 2018-08-01
ms.dyn365.ops.version: Finance and Operations
ms.openlocfilehash: 2f305bca82f6b16d02280eb5dcac049234b75d27
ms.sourcegitcommit: 574d4dda83dcab94728a3d35fc53ee7e2b90feb0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/22/2019
ms.locfileid: "1595600"
---
# <a name="environment-planning"></a>環境計画

[!include[banner](../includes/banner.md)]

このトピックでは、プロジェクトの環境を計画するときに考慮する必要があるさまざまな側面の概要を示します。 Microsoft Dynamics 365 for Finance and Operations の正常なクラウド実装を保証するには、プロジェクトの早い段階で環境について話し合い、計画することは重要です。

## <a name="environment-planning-overview"></a>環境計画の概要

最初に、いくつかの重要な概念を以下に示します。

- **環境の目的**: 環境が存在する理由。 例には、開発、システムのテスト、ユーザー受け入れテスト (UAT)、および工程が含まれます。
- **環境トポロジ**: 環境と目的の構成。 例としては、第 1 層環境の**開発**および**ビルドとテスト**があります。
- **環境層**: 環境のタイプやカテゴリ。 例には、第 1 層環境と第 2 層環境が含まれます。

さまざまな環境と層の詳細については、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド*をダウンロードしてください。

### <a name="environment-types"></a>環境タイプ

プロジェクトでは次のタイプの環境を使用できます。

- **標準**: この環境は、標準的なオファーに含まれ、Microsoft サブスクリプションで Microsoft が管理します。 標準環境には、製造環境、レベル 2 スタンダード承認テスト環境、およびレベル 1 開発およびテスト環境が含まれます。
- **アドオン**: アドオン環境は、標準的なオファーに加えて、顧客が購入している Microsoft 管理のサブスクリプションにあります。 たとえば、アドオン環境は、パフォーマンスをテストするための追加のレベル 4 環境の場合があります。
- **クラウド ホスト** - クラウド ホスト環境は、Microsoft Azure サブスクリプションの顧客またはパートナーである顧客またはパートナーによって管理されている追加の環境です。 クラウド ホスト環境には、レベル 1 デモ環境を含めることができます。
- **環境イメージ (VHD)** - これら追加のレベル 1 環境は、[Microsoft Dynamics Lifecycle Services (LCS)](https://lcs.dynamics.com/v2) からダウンロードできる仮想ハード ディスク (VHD) を使用してオンプレミスにホストされます。

> [!IMPORTANT]
> *顧客またはパートナーの Azure サブスクリプション*では、評価および開発目的でのみ、顧客またはパートナーが独自の Azure サブスクリプションをもって Finance and Operations 環境をそのサブスクリプションに配置します。 顧客やパートナーは、Azure サブスクリプションに展開されるリソースに対して支払います。 顧客やパートナーの支払額は、Azure 価格リストに基づきます。 これに対して、*Microsoft サブスクリプション*では、顧客は Finance and Operations ライセンスを購入します。 これらのライセンスは、顧客が Microsoft によって管理されている Azure サブスクリプションに環境を配置できるようにします。 したがって、顧客に別個の Azure の請求はありません。

### <a name="tier-1-vs-tier-2-and-higher"></a>レベル 1 とレベル 2 以上の比較

| レベル 1 | レベル 2 以上 |
|--------|-------------------|
| シングルボックス環境 | マルチボックス環境 |
| すべてのコンポーネントは、同じサーバーにインストールされます。 これらのコンポーネントには、アプリケーション オブジェクト サーバー (AOS)、データベース、Microsoft Dynamics 365 for Retail、および Management Reporter が含まれます。 | コンポーネントは、複数のサーバーにインストールされます。 |
| Microsoft SQL Server で使用 | [Azure SQL データベース](https://docs.microsoft.com/azure/sql-database/)が使用されます。 |
| アーキテクチャは、開発チームの効率を最大化するため、実稼働環境のアーキテクチャとは異なります。 | アーキテクチャは、実稼働環境のアーキテクチャと同じです。ただし、このような環境はサイズがさまざまで、災害復旧に対応していません。 |
| さまざまな方法で環境を配置することができます。 たとえば、アドオンとして配置する、クラウド ホストにする、または環境イメージ (VHD) として配置することができます。 | 環境は、標準環境またはアドオン環境としてのみ展開することができます。 クラウド ホストにすることはできません。 |
| この環境は、UAT またはパフォーマンス テストに適していません。 | この環境は、UAT およびパフォーマンス テストに適しています。 |

## <a name="finance-and-operations-standard-cloud-offer"></a>Finance and Operations 標準クラウド オファー

各 Finance and Operations 標準クラウド サービスには、3 つの環境が含まれています。

- **レベル 1 環境: 開発およびテスト**: サブスクリプションの期間の開発/テスト インスタンスが 1 つ用意されています。 このインスタンスは、顧客が自動ビルド環境として使用できる、または Finance and Operations をカスタマイズして変更の単体テストを実行するために使用できる、非生産シングル ボックス インスタンスです。 追加の開発/テスト インスタンスは、オプションのアドオンとして別途購入することができます。
- **レベル 2 環境: 標準承認テスト**: サブスクリプションの期間用に標準承認テスト (UAT) インスタンスが 1 つ用意されています。 このインスタンスは、ユーザーが UAT、統合テスト、トレーニングに使用できる非運用環境マルチボックス インスタンスです。 追加のサンドボックス/ステージング インスタンスは、オプションのアドオンとして別途購入することができます。
- **実稼働環境**: テナントあたり 1 つの生産インスタンスが用意されています。 生産マルチ ボックス インスタンスには、障害復旧と高可用性が含まれています。 実装が運用段階に近づき、Microsoft Dynamics Lifecycle Services (LCS) 手法の必要なアクティビティと正常な運用評価が完了するとプロビジョニングされます。 また、いくらかのファイル ストレージとデータベース ストレージはサービスに含まれます。

    - **ファイル ストレージ:** すべての顧客は、ファイルまたはバイナリ データ用のファイル/Azure blob クラウド ストレージを 100 GB 受け取ります。 その他のファイル/blob ストレージは購入することができます。
    - **データベース ストレージ:** すべての Finance and Operations サブスクリプションには、追加料金なしで顧客ごとに 10 GB の Azure SQL データベース ストレージが含まれています。 ユーザーとデバイス サービス ライセンスの数が増えると、組織には無償で追加のストレージ容量が提供されます。 さまざまな環境とさまざまな種類のストレージの詳細については、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド*をダウンロードしてください。

### <a name="provisioning-of-standard-environments"></a>標準環境のプロビジョニング

さまざまな時点で Finance and Operations のさまざまな環境がプロビジョニングされます。 次の表は、Finance and Operations の標準クラウド サービスにおける環境の推奨されるタイミングを示しています。

| 環境                     | プロビジョニングが行われるタイミング | セルフサービスかどうか |
|---------------------------------|-------------------------------|---------------------|
| レベル 2 標準承認テスト | Microsoft FastTrack チームとのオンボード中 | 有 |
| レベル 1 開発/ビルドおよびテスト   | 設計フェーズが開始したとき。 プロビジョニング プロセスでは、Microsoft Azure DevOps を構成することが必要です。 | 有 |
| 生産                      | 生産システムの準備完了時 | 生産配置要求を LCS に提出する必要があります。 展開は、Dynamics サービス エンジニア リング (DSE) チームによって 2 営業日以内に行われます。 |

> [!IMPORTANT]
> 常に、`dynadmin@customer.com` などの**名前のない**アカウントを使用して環境を配置します。 このトポロジは、ビルド管理を簡略化し、Azure DevOps ソース リポジトリを自動的に初期化するため、作成およびテスト環境を展開して使用するには、ビルド トポロジを使用します。

### <a name="production-system-readiness"></a>生産システムの準備

プロジェクトで初回 Go-Live の準備ができたら、実稼働環境を展開することができます。 詳細については、「[Go-Live の準備](prepare-go-live.md)」を参照してください。

生産システムの準備には、次の条件が含まれますがこれに限定されません。

- 最新のサブスクリプションの見積が「[サブスクリプション見積もりツール](../../dev-itpro/lifecycle-services/subscription-estimator.md)」の説明に従って有効になっている。
- コード、構成、およびデータの切替準備が整っている。
- エンジニアリング プロセスが重要な修正プログラムを管理するために配置されている。
- 顧客は、ソリューションと UAT にサインオフしている。
- 切替計画が設定されている。

顧客は、ソリューションをビルドするのではなく**運用**するために実稼働環境を使用する必要がある。 実稼働環境が業務の遂行に合ったサイズになっている。 サイズ決定は、サブスクリプションの見積とパフォーマンス テストの診断データに基づいて行われます。 展開後、顧客は実稼働環境でモック切替および最終的な一連の検証を行うことができ、その必要があります。 最後切替の前に、顧客はポイント イン タイム復元を要求し、実稼働環境をクリーンなスナップショット (最大 35 日前) に復元できます。

実稼働環境の適切なデータ センターを選択するには、ビジネスが運営されている地理的な場所から待機時間を検討してください。 [PsPing](https://docs.microsoft.com/sysinternals/downloads/psping) や [AzureSpeed.com](http://azurespeed.com/) などのツールを使って、Azure データ センターの待機時間をテストします。

次の図は、環境計画プロセスを示しています。

![環境計画プロセス フロー](./media/environment-planning-1-process-flow.png)

## <a name="additional-environments"></a>追加の環境

追加の環境は、アドオンとして購入するか、クラウド ホスト環境として展開することができます。 次の図は、Finance and Operations の実装の複雑さに基づく標準および追加の環境の*サンプル*概要を示しています。

![環境の目的と複雑度](./media/environment-planning-2-purpose-complexity-matrix.png)

> [!IMPORTANT]
> 常に、`dynadmin@customer.com` などの**名前のない**アカウントを使用して環境を配置します。 環境に、ステータスと保守を担当する所有者を割り当てます。 Go-Live 後、新しいリリースで作業する場合、生産をサポートするために追加のレベル 2 以上の環境を取得します。

### <a name="deployment-considerations-for-development-environments"></a>開発環境での配置に関する考慮事項

開発環境には、次の 3 つの配置オプションがあります。

- **標準またはアドオン**: 環境は、Microsoft により Microsoft サブスクリプションで管理されます。
- **クラウド ホスト**: 環境は、顧客/パートナーにより顧客/パートナーの Azure サブスクリプションで管理されます。
- **環境イメージ (ダウンロード可能な VHD)**: 環境はオンプレミスにホストされます。

> [!NOTE]
> 開発者ごとに 1 つの開発環境を割り当てる必要があります。

次の表では、展開オプションを比較します。

| 能力                            | 標準/アドオン | クラウド ホスト | 環境イメージ |
|---------------------------------------|-----------------|--------------|-------------------|
| パブリック URL                            | ✓ | ✓ | サポートされていません |
| 統合開発               | ✓ | ✓ | 追加の設定が必要です。 (たとえば、管理者ユーザー プロビジョニング ツールを実行します。) |
| Azure DevOps                          | ✓ | ✓ | 追加の設定が必要です。 (たとえば、コンピューター名を変更します。) |
| LCS から配置可能なパッケージを適用 | 自動化 | 自動化 | Runbook を通じて手動 |
| LCS からデータ パッケージを展開      | ✓ | ✓ | サポートされていません |
| 管理                           | Microsoft が管理 | お客様/パートナーが管理 | お客様/パートナーが管理 |
| コスト モデル                            | 定額 (価格は、環境が 24/7 である場合と同じ)。 | 従量課金制 (環境が 8 時間の場合、8 時間分お支払い)。 | ハードウェア関連 |
| 制限                           | 管理者アクセスが無効です (管理者ロックダウン)。 | None | None |

> [!IMPORTANT]
> レベル 1 環境の管理者ロックダウンは、プラットフォーム更新 12 以降で有効です。 ローカル管理者のアクセスが必要なアクションを実行することはできなくなりました。 これらのアクションには、サード パーティ ツールのインストールおよび Microsoft Power BI レポートの開発が含まれます。 管理者のアクセス許可が必要な場合は、クラウド ホスト環境または環境イメージ (ダウンロード可能な VHD) を代わりに使用します。 詳細については、[管理者アクセスを許可しない開発用 VM および ビルド用 VM に関するよく寄せられる質問](../../dev-itpro/sysadmin/vms-no-admin-access.md)を参照してください。

### <a name="selecting-the-correct-tier-2-or-higher-environment"></a>正しいレベル 2 以上の環境の選択

環境の用途によって、正しいレベル 2 以上の環境を選択することが重要です。 次の図に記載されているガイダンスは、*ベースライン*です。 特定のビジネス シナリオと、ユーザーの種類、複雑さ、およびボリュームなどの要因に基づいて、実装パートナーと協力してこのガイドを調整してください。

![環境レベル](./media/environment-planning-3-environment-tiers.png)

サブスクリプション見積が有効になると、次の図に示すように、LCS で 1 時間あたりのトランザクション明細行を表示できます。

![サブスクリプション見積](./media/environment-planning-4-subscription-estimate.png)

> [!IMPORTANT]
> レベル 2 以上の環境の将来の管理者ロックダウンがあると、サーバーへのリモート デスクトップ プロトコル (RDP) 接続ができなくなります。 Microsoft ロードマップの一環として、RDP アクセスが必要な最も一般的なアクションは LCS でのセルフ サービス タスクによって置き換えられます。 たとえば、「[Finance and Operations データベースを SQL Server から Azure SQL データベース運用環境にコピーする](../../dev-itpro/database/copy-database-from-sql-server-to-azure-sql.md)」で現在説明されている手順は、Microsoft からサービスとして利用できます。 したがって、Finance and Operations データベースを SQL Server から Azure SQL データベース環境にコピーするには、LCS でサービス要求を作成する必要があります。 詳しくは、[LCS ブログ](https://blogs.msdn.microsoft.com/lcs/2018/02/27/notice-of-upcoming-change-removing-rdp-access-to-tiers-2-3-4-and-5-standard-acceptance-test-or-sandbox-environments-deployed-in-microsoft-subscription/)と[ドキュメント](https://docs.microsoft.com/dynamics365/unified-operations/fin-and-ops/)をご覧ください。

### <a name="purchasing-add-on-environments"></a>アドオン環境の購入

アドオン環境を購入する場合、クラウド ソリューション プロバイダーまたはライセンス サービス再販業者に相談することをお勧めします。 発注してから環境が展開されるまでに発生する可能性のあるリード タイムを考慮してください。

次の図では、アドオン環境を購入するためのプロセスを表示します。

![アドオンの調達](./media/environment-planning-5-procuring-add-on.png)

> [!IMPORTANT]
> マイクロソフト ボリューム ライセンス契約をお持ちの場合、Microsoft の製品およびサービス契約 (MPSA) ライセンス プログラムを通じて月間ベースでアドオン環境にサブスクライブできます。 または、Microsoft クラウド ソリューション プロバイダー (CSP) プログラムからサブスクライブすることができます。 さまざまな環境と層の詳細については、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド*をダウンロードしてください。

## <a name="environments-plan"></a>環境計画

実装の早い段階で環境の計画を作成します。

1. 環境を必要とするプロジェクトの活動を識別します。 これらの活動には、カスタマイズの開発や高品質の構成データの保守が含まれますが、これだけではありません。
2. *アクティビティ ライフライクル*を見分けて*環境ライフサイクル*を見分けます。 この手順で確認する必要がある質問の例を示します。

    - 環境に必要なタイミングと長さはどれくらいか?
    - Go-Live の後に環境が必要か?

3. 必要な環境の種類とトポロジを決定します。
4. マトリックスに必要な環境の一覧をまとめています。

環境を識別した後は、アプリケーション ライフサイクル管理 (ALM) フローを構造化するために環境計画を使用できます。 たとえば、環境計画が完成したら、環境間でのコードおよびデータの構築と移動のためのフローを定義できます。

[環境計画 TechTalk](https://infopedia.eventbuilder.com/event?eventid=o8a5q2&source=Dynamics_365_for_Operations_-_FastTrack_Tech_Talks) をご覧になることを強くお勧めします。 リンク先のページからは、環境計画の演習を有利に始めることができるように、*サンプル環境計画演習*スプレッドシートをダウンロードすることもできます。
