---
title: 詳細な口座調整のインポート プロセスの設定
description: 詳細な口座調整機能では、電子口座取引明細書をインポートし、Microsoft Dynamics 365 Finance での銀行トランザクションに合わせて自動的に調整することができます。 この資料では、口座取引明細書のインポート機能を設定する方法について説明します。
author: angelad116
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: BankStatementFormat
audience: Application User
ms.reviewer: kfend
ms.custom: 106853
ms.assetid: 45dae275-ea45-4c7e-b38f-89297c7b5352
ms.search.region: Global
ms.author: angelading
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d8d186e6b3e44222410c8be94390d7c58a90e352
ms.sourcegitcommit: 0b7a034e644f4d93fe55c7baca5a3f89dbe56898
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/14/2022
ms.locfileid: "9151528"
---
# <a name="set-up-the-advanced-bank-reconciliation-import-process"></a>詳細な口座調整のインポート プロセスの設定

[!include [banner](../includes/banner.md)]

> [!NOTE]
> この機能は 2022 年 9 月で廃止される予定です。新しいユーザーは電子申告を使用する必要があります。 詳細については、[電子申告を使用した詳細な口座調整インポートの設定](../accounts-payable/import-bai2-er.md) を参照してください。


詳細な口座調整機能では、電子口座取引明細書をインポートし、Dynamics 365 Finance での銀行トランザクションに合わせて自動的に調整することができます。 この資料では、口座取引明細書のインポート機能を設定する方法について説明します。 

口座取引明細書のインポートの設定は、電子口座取引明細書の形式によって異なります。 Finance は、ISO20022、MT940、および BAI2 の 3 つの口座取引明細書の形式を包括的にサポートしています。

## <a name="set-time-zone-preference"></a>タイム ゾーンの基本設定
口座取引明細書のインポート設定をコンフィギュレーションする場合、インポートされる口座取引明細書ファイル内の日時データのタイム ゾーンを考慮することが重要です。 既定では、任意の日付と時刻の値は協定世界時 (UTC) に既に含まれていると仮定されるため、データのインポート時にタイム ゾーン変換は適用されません。 

データのインポートに使用するタイム ゾーンを指定するためのオプションがあります。 このオプションは、各 **ソース データ形式の詳細** ページの **タイム ゾーンの基本設定** フィールド (**データ管理ワークスペース > データ ソースの構成 > データ形式の選択 > 地域の設定** クイック タブ) で使用可能です。 入力したこのタイム ゾーンの基本設定は、そのソース データ形式を使用するすべてのインポートに適用されます。 複数のタイム ゾーンからデータをインポートするために必要な数のデータ ソース形式を作成できます。  

このタイム ゾーンは、ユーザーまたは会社のタイム ゾーンとは異なる場合があるため、日時データが使用しているタイム ゾーンを明確にしておく必要があります。 タイム ゾーンの基本設定を設定する際には、次の点を考慮することをお勧めします。 

 - タイム ゾーンの基本設定は、そのソース データ形式を使用しているすべてのインポートに適用されます。 複数のタイム ゾーンからデータのインポートを処理するために必要な数のデータ ソース形式を作成できます。 
 
 - タイム ゾーンの基本設定は、インポート ファイルの日時データのローカル タイム ゾーンである必要があります。 
 
 - 日時データのタイム ゾーンは、ユーザーまたは会社のタイム ゾーンとは異なる場合があります。
 
 - ユーザーは、**ユーザー オプション** を使用して独自のタイム ゾーンを調整できます。

次のアクションを使用すると、口座取引明細書をインポートする際に、起きる可能性のある日時の競合を最小限に抑えることができます。 

 - 既に明細書がインポートされた銀行口座に関しては、タイム ゾーンの基本設定の変更を避けてください。 タイム ゾーンの基本設定を変更すると、タイム ゾーン調整により、既存の明細書に対する新しい明細書の順序に影響する可能性があります。 
 
 - 選択したデータ ソース形式を使用するすべてのインポートを確認します。 その形式用に指定されたタイム ゾーンの基本設定は、その形式を使用するすべてのインポート プロジェクトに適用されます。 タイム ゾーンの基本設定の検証は、その形式を使用するすべてのインポート プロジェクトに対して適切です。

## <a name="sample-files"></a>サンプル ファイル
すべての 3 つの形式には、電子口座取引明細書を元の形式から、Finance で使用できる形式に変換するファイルが必要です。 Microsoft Visual Studio のアプリケーション エクスプローラーの **リソース** ノードの下に必要なリソース ファイルがあります。 ファイルを見つけたら、1 つのわかる場所にコピーして、設定プロセス中に容易にアップロードできるようにします。

| リソース名                                           | ファイル名                            |
|---------------------------------------------------------|--------------------------------------|
| BankStmtImport\_BAI2CSV\_to\_BAI2XML\_xslt              | BAI2CSV-to-BAI2XML.xslt              |
| BankStmtImport\_BAI2XML\_to\_Reconciliation\_xslt       | BAI2XML-to-Reconciliation.xslt       |
| BankStmtImport\_BankReconciliation\_to\_Composite\_xslt | BankReconciliation-to-Composite.xslt |
| BankStmtImport\_ISO20022XML\_to\_Reconciliation\_xslt   | ISO20022XML-to-Reconciliation.xslt   |
| BankStmtImport\_MT940TXT\_to\_MT940XML\_xslt            | MT940TXT-to-MT940XML.xslt            |
| BankStmtImport\_MT940XML\_to\_Reconciliation\_xslt      | MT940XML-to-Reconciliation.xslt      |
| BankStmtImport\_SampleBankCompositeEntity\_xml          | SampleBankCompositeEntity.xml        |

## <a name="examples-of-bank-statement-formats-and-technical-layouts"></a>口座取引明細書の形式と技術的な配置の例
詳細な口座調整のインポート ファイルの技術的な配置の定義、および 3 つの関連する口座取引明細書のサンプル ファイルの例を以下に示します。[インポート ファイルの例](//download.microsoft.com/download/8/e/c/8ec8d2d0-eb8c-41fb-ad8c-f01a4d670a44/Dynamics365FinanceAdvancedBankStatementLayouts.xlsx)  

| 技術的なレイアウトの定義                             | 口座取引明細書のサンプル ファイル          |
|---------------------------------------------------------|--------------------------------------|
| DynamicsAXMT940Layout                                   | [MT940StatementExample](//download.microsoft.com/download/2/d/c/2dcc4e55-ddc8-4a74-b79c-250fae201c3c/mt940StatementExample.txt)                |
| DynamicsAXISO20022Layout                                | [ISO20022StatementExample](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdownload.microsoft.com%2Fdownload%2F1%2F5%2F5%2F155d84ed-c250-48f3-b0b1-c5a431e7855b%2FISO20022-MultipleStatements.xml&data=04%7C01%7CRobert.Schlomann%40microsoft.com%7C30d0c233cb6546547d0a08d8f4965edc%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637528273956712775%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=3VzvLZK%2BO8PjuI7XVdC6rD2j3nUJfteo7zFp%2B1s9BwM%3D&reserved=0)             |
| DynamicsAXBAI2Layout                                    | [BAI2StatementExample](//download.microsoft.com/download/1/1/6/11693f57-bfc1-4993-a274-5fb978be70fa/BAI2StatementExample.txt)                 |



## <a name="set-up-the-import-of-iso20022-bank-statements"></a>ISO20022 口座取引明細書のインポートの設定
最初に、データ エンティティ フレームワークを使用して「ISO20022 口座取引明細書」の口座取引明細書の形式処理グループを定義する必要があります。

1.  **ワークスペース** &gt; **データ管理** の順に移動します。
2.  **インポート** をクリックします。
3.  **ISO20022** などの形式の名前を入力します。
4.  **ソース データ形式** フィールドを **XML-Element** に設定します。
5.  **エンティティ名** フィールドを **口座取引明細書** に設定します。
6.  インポート ファイルをアップロードするには、**アップロード** をクリックし、参照して先ほど保存した **SampleBankCompositeEntity.xml** ファイルを選択します。
7.  口座取引明細書のエンティティがアップロードされ、マッピングが完了した後、エンティティの **マップの表示** アクションをクリックします。
8.  口座取引明細書のエンティティは、4 つの別々のエンティティで構成される複合エンティティです。 一覧で、**BankStatementDocumentEntity** を選択し、次に **マップの表示** アクションをクリックします。
9.  **変換** タブで、**新規** をクリックします。
10. シーケンス番号 1 で、**ファイルのアップロード** をクリックし, 先ほど保存した **ISO20022XML-to-Reconciliation.xslt** ファイルを選択します。 **注記:** 変換ファイルは、標準形式で作成されます。 銀行は多くの場合、この形式と異なるため、口座取引明細書の形式にマップする変換ファイルを更新する必要があるかもしれません。 <!-- For details about the expected format for ISO20022, see [Dynamics AX ISO20022 Layout](./media/dynamicsaxiso20022layout1.xlsx).-->
11. **新規** をクリックします。
12. シーケンス番号 2 で、**ファイルのアップロード** をクリックし, 先ほど保存した **BankReconciliation-to-Composite.xslt** ファイルを選択します。
13. **変換の適用** をクリックします。

形式の処理グループを設定した後の次の手順は、「ISO20022 口座取引明細書」の口座取引明細書の形式ルールを定義することです。

1.  **現金および銀行管理** &gt; **設定** &gt; **詳細な口座調整の設定** &gt; **口座取引明細書の形式** の順に移動します。
2.  **新規** をクリックします。
3.  **ISO20022** のように明細書の形式を指定します。
4.  形式の名前を入力します。
5.  **処理グループ** フィールドを **ISO20022** などの先ほど定義したグループに設定します。
6.  **XML ファイル** チェック ボックスを選択します。

最後の手順は、詳細な口座調整を有効にし、銀行口座の明細書の形式を設定することです。

1.  **現金および銀行管理** &gt; **銀行口座** の順に移動します。
2.  銀行口座を選択し、ファイルを開いて詳細を表示します。
3.  **調整** タブで、**詳細な口座調整** オプションを **はい** に設定します。
4.  **明細書形式** フィールドを **ISO20022** などの先ほど作成した形式に設定します。

## <a name="set-up-the-import-of-mt940-bank-statements"></a>MT940 口座取引明細書のインポートの設定
最初に、データ エンティティ フレームワークを使用して、「MT940 口座取引明細書」の口座取引明細書の形式処理グループを定義する必要があります。

1.  **ワークスペース** &gt; **データ管理** の順に移動します。
2.  **インポート** をクリックします。
3.  **MT940** などの形式の名前を入力します。
4.  **ソース データ形式** フィールドを **XML-Element** に設定します。
5.  **エンティティ名** フィールドを **口座取引明細書** に設定します。
6.  インポート ファイルをアップロードするには、**アップロード** をクリックし、次に参照して先ほど保存した **SampleBankCompositeEntity.xml** ファイルを選択します。
7.  口座取引明細書のエンティティがアップロードされ、マッピングが完了した後、エンティティの **マップの表示** アクションをクリックします。
8.  口座取引明細書のエンティティは、4 つの別々のエンティティで構成される複合エンティティです。 一覧で、**BankStatementDocumentEntity** を選択し、次に **マップの表示** アクションをクリックします。
9.  **変換** タブで、**新規** をクリックします。
10. シーケンス番号 1 で、**ファイルのアップロード** をクリックし、先ほど保存した **MT940TXT-to-MT940XML.xslt** ファイルを選択します。
11. **新規** をクリックします。
12. シーケンス番号 2 で、**ファイルのアップロード** をクリックし、先ほど保存した **MT940XML-to-Reconciliation.xslt** ファイルを選択します。 **注記:** 変換ファイルは、標準形式で作成されます。 銀行は多くの場合、この形式と異なるため、口座取引明細書の形式にマップする変換ファイルを更新する必要があるかもしれません。 <!--- For details about the expected format for MT940, see [Dynamics AX MT940 Layout](./media/dynamicsaxmt940layout1.xlsx)-->
13. **新規** をクリックします。
14. シーケンス番号 3 で、**ファイルのアップロード** をクリックし、先ほど保存した **BankReconciliation-to-Composite.xslt** ファイルを選択します。
15. **変換の適用** をクリックします。

形式の処理グループを設定したら、次に、「MT940 口座取引明細書」の口座取引明細書の形式ルールを定義します。

1.  **現金および銀行管理** &gt; **設定** &gt; **詳細な口座調整の設定** &gt; **口座取引明細書の形式** の順に移動します。
2.  **新規** をクリックします。
3.  **MT940** などの明細書の形式を指定します。
4.  形式の名前を入力します。
5.  **処理グループ** フィールドを **MT940** などの先ほど定義したグループに設定します。
6.  **ファイル タイプ** フィールドを **txt** に設定します。

最後の手順は、詳細な口座調整を有効にし、銀行口座の明細書の形式を設定することです。

1.  **現金および銀行管理** &gt; **銀行口座** の順に移動します。
2.  銀行口座を選択し、ファイルを開いて詳細を表示します。
3.  **調整** タブで、**詳細な口座調整** オプションを **はい** に設定します。
4.  選択内容、および詳細な口座調整を有効にしたことを確認した時点で、**OK** をクリックします。
5.  **明細書形式** フィールドを **MT940** などの先ほど作成した形式に設定します。

## <a name="set-up-the-import-of-bai2-bank-statements"></a>BAI2 口座取引明細書のインポートの設定
最初に、データ エンティティ フレームワークを使用して「BAI2 口座取引明細書」の口座取引明細書の形式処理グループを定義する必要があります。

1.  **ワークスペース** &gt; **データ管理** の順に移動します。
2.  **インポート** をクリックします。
3.  **BAI2** などの形式の名前を入力します。
4.  **ソース データ形式** フィールドを **XML-Element** に設定します。
5.  **エンティティ名** フィールドを **口座取引明細書** に設定します。
6.  インポート ファイルをアップロードするには、**アップロード** をクリックし、次に参照して先ほど保存した **SampleBankCompositeEntity.xml** ファイルを選択します。
7.  口座取引明細書のエンティティがアップロードされ、マッピングが完了した後、エンティティの **マップの表示** アクションをクリックします。
8.  口座取引明細書のエンティティは、4 つの別々のエンティティで構成される複合エンティティです。 一覧で、**BankStatementDocumentEntity** を選択し、次に **マップの表示** アクションをクリックします。
9.  **変換** タブで、**新規** をクリックします。
10. シーケンス番号 1 で、**ファイルのアップロード** をクリックし、先ほど保存した **BAI2CSV-to-BAI2XML.xslt** ファイルを選択します。
11. **新規** をクリックします。
12. シーケンス番号 2 で、**ファイルのアップロード** をクリックし、先ほど保存した **BAI2XML-to-Reconciliation.xslt** ファイルを選択します。 **注記:** 変換ファイルは、標準形式で作成されます。 銀行は多くの場合、この形式と異なるため、口座取引明細書の形式にマップする変換ファイルを更新する必要があるかもしれません。 <!--- For details about the expected format for BAI2, see [Dynamics AX BAI2 Layout](./media/dynamicsaxbai2layout1.xlsx).-->
13. **新規** をクリックします。
14. シーケンス番号 3 で、**ファイルのアップロード** をクリックし、先ほど保存した **BankReconciliation-to-Composite.xslt** ファイルを選択します。
15. **変換の適用** をクリックします。

形式の処理グループを設定した後は、BAI2 口座取引明細書の口座取引明細書の形式のルールを定義します。

1.  **現金および銀行管理** &gt; **設定** &gt; **詳細な口座調整の設定** &gt; **口座取引明細書の形式** の順に移動します。
2.  **新規** をクリックします。
3.  **BAI2** などの明細書の形式を指定します。
4.  形式の名前を入力します。
5.  **処理グループ** フィールドを **BAI2** などの先ほど定義したグループに設定します。
6.  **ファイル タイプ** フィールドを **txt** に設定します。

最後の手順は、詳細な口座調整を有効にし、銀行口座の明細書の形式を設定することです。

1.  **現金および銀行管理** &gt; **銀行口座** の順に移動します。
2.  銀行口座を選択し、ファイルを開いて詳細を表示します。
3.  **調整** タブで、**詳細な口座調整** オプションを **はい** に設定します。
4.  選択内容、および詳細な口座調整を有効にしたことを確認した時点で、**OK** をクリックします。
5.  **明細書形式** フィールドを **BAI2** などの先ほど作成した形式に設定します。

## <a name="test-the-bank-statement-import"></a>口座取引明細書のインポートのテスト
最後の手順では、口座取引明細書がインポートできることをテストします。

1.  **現金および銀行管理** &gt; **銀行口座** の順に移動します。
2.  詳細な口座調整機能が有効な銀行口座を選択します。
3.  **調整** タブで、**口座取引明細書** をクリックします。
4.  **口座取引明細書** ページで、**明細書のインポート** をクリックします。
5.  **銀行口座** フィールドを選択した銀行口座に設定します。 **明細書形式** フィールドは、銀行口座の設定に基づいて自動的に設定されます。
6.  **参照** をクリックし、電子口座取引明細書ファイルを選択します。
7.  **アップロード** をクリックします。
8.  **OK** をクリックします

インポートが成功した場合、明細書がインポートされたことを示すメッセージが表示されます。 インポートが失敗した場合、**データ管理** ワークスペースの **ジョブ履歴** セクションで、ジョブを検索します。 ジョブの **実行の詳細** をクリックして、**実行の要約** ページを開き、次に **実行ログの表示** をクリックしてインポート エラーを表示します。





[!INCLUDE[footer-include](../../includes/footer-banner.md)]
