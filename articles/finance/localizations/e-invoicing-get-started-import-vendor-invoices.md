---
title: 電子請求サービスを使用した仕入先請求書のインポート
description: このトピックでは、電子請求サービスを使用して仕入先請求書をインポートする方法について説明します。
author: gionoder
ms.date: 09/03/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.custom:
- "97423"
- intro-internal
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: c28adbfe532e77a52cab7625b9539d1e8e528bea
ms.sourcegitcommit: 19f0e69a131e9e4ff680eac13efa51b04ad55a38
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/22/2022
ms.locfileid: "7983826"
---
# <a name="use-the-electronic-invoicing-service-to-import-vendor-invoices"></a>電子請求サービスを使用した仕入先請求書のインポート

[!include [banner](../includes/banner.md)]

[!include [banner](../includes/preview-banner.md)]

このトピックでは、電子請求サービスを使って仕入先の請求書をインポートする際に役立つ情報を提供します。 仕入先から電子仕入先請求書を受け取るために従う必要のある、Regulatory Configuration Services (RCS)、Dynamics 365 Finance および Dynamics 365 Supply Chain Management の構成手順について説明します。

## <a name="set-up-vendor-invoice-import-in-rcs"></a>RCS で仕入先請求書のインポートを設定する
RCS で仕入先請求書インポートを設定するには、次の手順に従います。

1. [一般的に利用可能な電子請求機能](e-invoicing-configuration-rcs.md#generally-available-features)のリストを参照してください。
2. 電子請求機能を選択してインポートします。 詳細については、[Microsoft 構成プロバイダから電子請求機能をインポートする](e-invoicing-get-started.md#import-an-electronic-invoicing-feature-from-the-microsoft-configuration-provider)を参照してください。
3. 組織の電子請求機能を作成します。 詳細については、[組織のプロバイダー配下に電子請求書発行機能を作成](e-invoicing-get-started.md#create-an-electronic-invoicing-feature-under-your-organization-provider)を参照してください。

## <a name="configure-an-email-account-channel"></a>メール アカウント チャンネルの構成

作成した電子請求機能が、電子メールで受信した添付ファイルから電子的な仕入の請求書をインポートする場合は、電子メール アカウント チャネルを構成します。

1. RCS で、作成した電子請求機能を選択します。 ステータスが **ドラフト** のバージョンを選択していることを確認してください。
2. グリッドにある **設定** タブで、機能の設定を選択し、**編集** を選択します。
3. **パラメーター** フィールド グループにある **データ チャネル** タブの **データ チャネル** フィールドに、チャネルの名前を入力します。 チャネルの名前は 10 文字以内にしてください。
4. **サーバー アドレス** フィールドに、電子メール アカウント プロバイダーを入力します。 たとえば、**https://outlook.live.com/** のサーバー アドレスは **imap-mail.outlook.com** です。
5. **サーバー ポート** フィールドに、電子メール アカウント プロバイダーが使用するポートを入力します。 たとえば、**https://outlook.live.com/** のサーバー ポートは **993** です。
6. **ユーザー名シークレット** フィールドに、電子メール ユーザー アカウントの ID を含むキー コンテナー シークレットの名前を入力します。 このシークレットは、Azure Key Vault で作成し、サービス環境で設定する必要があります。 
7. **ユーザー パスワード シークレット** フィールドに、電子メール ユーザー アカウントのパスワードを含むキー コンテナー シークレットの名前を入力します。
8. オプション - **送信元フィルター**、**件名フィルター**、および **日付フィルター** フィールドに値を入力します。
9. 電子メールが保存されるメール ボックス フォルダーの名前を入力します。

    - インポート元: **メイン フォルダー**
    - 処理が正常に行われた後に保存: **アーカイブ フォルダー**
    - 処理が成功しなかった後に保存: **エラー フォルダー** メール ボックスにこれらのフォルダーを作成する必要はありません。 電子請求書を最初にインポートおよび処理した後、フォルダーが自動的に作成されます。 
   
10. **添付ファイル フィルター** フィールド グループで、ファイル フィルター処理情報を追加します。 定義されているフィルターを満たす添付ファイルだけが処理されます。 たとえば、XML 拡張子を持つ添付ファイルに対して「\*.xml」を設定できます。 添付ファイルの名前は、設定中に Dynamics 365 Finance または Dynamics 365 Supply Chain Management で使用されます。 
11. 必要に応じて、**適用ルール** タブで基準の確認および更新を行います。 **チャネル** フィールドは、以前に指定した **データ チャネル** と一致している必要があります。 詳細については、[適用ルール](e-invoicing-configuration-rcs.md#applicability-rules) を参照してください。
12. **保存** を選択して、ページを閉じます。

### <a name="configure-a-microsoft-sharepoint-channel"></a>Microsoft SharePoint チャネルを構成する

電子請求機能が SharePoint フォルダーに配置されたファイルから電子仕入先請求書をインポートする場合は、Microsoft SharePoint チャネルを構成します。

1. RCS で、作成した電子請求機能を選択します。 ステータスが **ドラフト** の **バージョン** を選択していることを確認してください。
2. グリッドにある **設定** タブで、機能の設定を選択し、**編集** を選択します。
3. 上の **データ チャネル** のタブの **パラメーター** フィールド グループで、**SharePoint のアドレス** を選択し、SharePoint の URL を入力します。
4. **サーバー ポート** を選択し、電子メール アカウント プロバイダーが使用するポートを入力します。
5. **アプリケーション ID** を選択し、SharePoint クライアントの ID を含むキー コンテナー シークレットの名前を入力します。
6. **アプリケーション シークレット** を選択し、SharePoint クライアントのパスワードを含むキー コンテナー シークレットの名前を入力します。
7. **ファイル フィルター** を選択します。 マスクを確認および更新して、インポートする電子仕入先請求書を含むファイルをフィルタリングします。
8. **適用ルール** タブで、必要に応じて基準を確認および更新します。 詳細については、[適用ルール](e-invoicing-configuration-rcs.md#applicability-rules) を参照してください。
9. **保存** を選択して、ページを閉じます

### <a name="deploy-an-electronic-invoicing-feature"></a>電子請求書機能をデプロイする

電子請求機能をデプロイするには、[サービス環境に電子請求機能をデプロイする](e-invoicing-get-started.md#deploy-the-electronic-invoicing-feature-to-service-environment)を参照してください。

## <a name="set-up-vendor-invoice-import-in-finance-or-supply-chain-management"></a>Finance または Supply Chain Management で仕入先請求書のインポートを設定する
次の 2 つのセクションの手順を実行して、さまざまなタイプのベンダー請求書のインポートを設定します。

### <a name="import-brazilian-nf-e-from-email"></a>電子メールからブラジル NF-e をインポートする

1. Finance または Supply Chain Management 環境にサインインし、正しい法人に所属していることを確認します。
2. **組織管理** > **設定** > **電子ドキュメント パラメーター** に移動します。
3. **機能** タブで、**NF-e Federal - ブラジル電子請求書** が選択されていることを確認します。
4. **外部チャンネル** タブの **チャンネル** フィールド グループで、**追加** を選択します。
5. **チャネル** フィールドで、**NFe** (RCS の電子請求書作成機能のデータ チャネルの設定で指定されたチャネルの名前) を入力します。
6. **説明** フィールドに説明を入力します。 **法人** フィールドで、法人を選択します。
7. **ドキュメント コンテキスト** フィールドで、**会計ドキュメントのコンテキスト – 顧客請求書コンテキスト モデル** を選択します。
8. **インポート ソース** フィールド グループで、**追加** を選択します。
9. **名前** フィールドで、**XmlFile** (RCS の電子請求書作成機能のデータ チャネルの設定で指定された **添付フィルター** の名前) を入力します。
10. **説明** フィールドに説明を入力し、**データ エンティティ名** フィールドで **受信した NF-eXML ドキュメント** を選択します。
11. **モデル マッピング フィールド** で、**NF-e メール インポート – NF-e メール インポート (BR)** を選択して、**保存** を選択します。
12. **電子ドキュメント** タブの **電子申告** フィールド グループで **追加** を選択し、**テーブル名** フィールドで **受信した NF-eXML ドキュメント** を選択します。
13. **ドキュメント コンテキスト** フィールドで、**会計ドキュメントの照会 – 顧客請求書コンテキスト** を選択します。
14. **電子ドキュメント モデル マッピング** フィールドで、**マッピングの照会 – 会計ドキュメント マッピング** を選択します。
15. **応答タイプ** を選択し、**新規** を選択します。
16. **応答タイプ** フィールドに、**応答** と入力します。 **提出の状態** フィールドで **スケジュール済み** を入力します。
17. **モデル マッピング** フィールドで、**応答メッセージからモデル マッピング – 応答メッセージのインポート フォーマット** を選択します。
18. **保存** を選択し、ページを閉じます。

### <a name="import-peppol-electronic-vendor-invoices"></a>PEPPOL 電子仕入先請求書の取り込み

1. **電子申告** ワークスペースに移動し、**レポート構成** を選択します。
2. **顧客請求書コンテクスト モデル** を選択し、**コンフィギュレーションの作成** > **名前から派生: 顧客請求書コンテクスト モデル、Microsoft** を選択して、派生した構成を作成します。
3. **ドラフト** バージョンで **デザイナー** を選択し、**データ モデル** ツリーで **モデルをデータ ソースにマップする** を選択します。
4. **定義** ツリーで **DataChannel** を選択し、**デザイナー** を選択します。
5. **データ ソース** ツリーで、**コンテキスト\_チャネル** コンテナーを展開します。 **値** フィールドで、**編集** を選択し、データ チャネル名を入力します。 これは、RCS の電子請求書作成機能のデータ チャネルの設定で与えられたチャネルの名前です。 
7. **保存** を選択して、ページを閉じます。
8. ページを閉じます。
9. **顧客請求書コンテキスト モデル** から作成した、派生した構成を選択し、**バージョン** クイックタブで **変更状態** > **完了** を選択します。
10. **組織管理** > **設定** > **電子ドキュメント パラメーター** に移動し、**機能** タブで 、**POL グローバル電子請求書** が選択されている必要があります。 
11. **外部チャンネル** タブの **チャンネル** フィールド グループで、**追加** を選択します。
12. **チャネル** フィールドにデータ チャネルの名前を入力し、**説明** フィールドに説明を入力します。
13. **法人** フィールドで、法人を選択します。 
14. **ドキュメント コンテキスト** フィールドで、**顧客請求書コンテキスト モデル** から新しく派生した構成を選択します。 マッピングの説明は、**データ チャネル コンテキスト** である必要があります。
15. **インポート ソース** フィールド グループで、**追加** を選択します。
16. **名前** フィールドに **添付ファイル フィルター名** を入力し、**データ エンティティ名** フィールドで **仕入先請求書ヘッダー** を選択します。
17. **モデル マッピング** フィールドで、**仕入先請求書のインポート - 仕入先請求書をインポートする** を選択します。
18. **保存** をクリックし、ページを閉じます。


## <a name="receive-electronic-invoices"></a>電子請求書の受け取り

電子請求サービスは、データ チャネルからの請求書のインポート中に次の 2 つの手順を実行します。

1. メール ボックスと読み取る電子メールにアクセスします。
2. 電子メールを処理します。 
    
これらの 2 つの手順を実行するには、各手順ごとにクライアントが手動でサービスを呼び出す必要があります。 ただし、受信する電子ドキュメントに対してバッチを設定することをお勧めします。

請求書の電子化は、以下の手順で行います。

1. **組織管理** > **定期的** > **電子ドキュメント** > **電子ドキュメントの受信** に移動します。
2. **OK** を選択し、ページを閉じます。


## <a name="view-receive-logs-for-electronic-invoices"></a>電子請求書の受信ログの表示

電子請求書の受信ログを表示するには、**組織管理** > **定期** > **電子文書** > **電子文書受信ログ** と進みます。
正常に処理された請求書が表示されない場合、テーブル フィルターを削除します。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
