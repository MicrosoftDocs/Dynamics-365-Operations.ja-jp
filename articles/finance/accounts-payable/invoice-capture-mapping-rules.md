---
title: Invoice Capture ソリューションのマッピング ルール
description: この記事では、Invoice Capture ソリューションにおけるマッピング ルールの設定について説明します。
author: sunfzam
ms.date: 09/25/2022
ms.topic: overview
ms.prod: ''
ms.technology: ''
ms.search.form: VendorInvoiceWorkspace, VendInvoiceInfoListPage
audience: Application User
ms.reviewer: twheeloc
ms.custom:
- "13971"
- intro-internal
ms.assetid: 0ec4dbc0-2eeb-423b-8592-4b5d37e559d3
ms.search.region: Global
ms.author: zezhangzhao
ms.search.validFrom: 2022-09-28
ms.dyn365.ops.version: ''
ms.openlocfilehash: cd0d06f7fd3ed946756e975d0706687c2d4acc93
ms.sourcegitcommit: 40c80a617b903c2b26e44b41147e0021c5cb680d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/18/2022
ms.locfileid: "9691234"
---
# <a name="invoice-capture-solution-mapping-rules"></a>Invoice Capture ソリューションのマッピング ルール

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

マッピング ルールは、Microsoft Dynamics 365 Finance またはエンタープライズ リソース プランニング (ERP) システムから基本的なマスターデータを取得します。 マッピング ルールが設定されると、Finance でベンダー インボイスを作成するために必要な情報が派生します。 マッピング ルールを使用すると、買掛金勘定 (AP) の担当者は、不足しているフィールド値をすべて手作業で入力する代わりに、状態を確認することになります。

マッピング ルールには次の 4 つのタイプがあります:

- 法人
- 仕入先アカウント
- 品目
- 経費タイプ

## <a name="manage-mapping-rules-by-using-the-app"></a>アプリケーションを使用したマッピング ルールの管理

アプリケーションを使用してマッピング ルールを管理するには、**設定** を選択します。 **マッピング ルールの設定** タブには、次の 4 つのオプションがあります:

- 法人 
- 仕入先アカウント 
- 項目マッピング 
- 経費タイプ

たとえば、**法人マッピング ルール** オプションを選択します。 法人コードは、会社名、住所、および税登録番号を使用して識別されます。 **LE-USPM** という名前のルールで、会社名に 「Contoso Contosos USA」 という文字列が含まれている場合、法人コードは **USPM** になります。

このページには、有効なすべてのマッピング ルールが表示されます。 無効なマッピング ルールを表示する場合は、**有効なマッピングの法人ルール** を選択し、**無効なマッピングの法人のルール** を選択します。

以下のアクションは、マッピング ルールに利用できます。

### <a name="create-a-mapping-rule"></a>マッピング ルールの作成

次の 2 つの方法を使用して、マッピング ルールを作成できます:

- **新規** を選択して、新しいマッピング ルールを作成します。 その後、マッピング ルールの実行の情報を入力します。 **ルール名** の値は、マッピング ルールのタイプごとに一意である必要があります。
- 既存のマッピング ルールを選択すると、**コピー** ボタンを使用できます。 これを選択し、表示されるダイアログ ボックスで、**OK** を選択します。 マッピング ルールは、選択したルールを複製して作成します。

### <a name="edit-a-mapping-rule"></a>マッピング ルールの編集

マッピング ルールを編集するには、フィールドを選択して値を変更します。

### <a name="activatedeactivate-mapping-rules"></a>マッピング ルールの有効化/無効化

1 つ以上のマッピング ルールを無効化するには、**有効なマッピング ルール** ページでマッピング ルールを選択し、**無効化** を選択します。 ルールは、**有効なマッピング ルール** ページ から **無効なマッピング ルール** ページ に移動されます。

同様に、マッピング ルールを有効化するには、**無効なマッピング ルール** ページでマッピング ルールを選択し、**有効化** を選択します。

### <a name="remove-mapping-rules"></a>マッピング ルールの削除

マッピング ルールを削除するには、ルールを選択して、**削除** を選択します。

### <a name="check-for-conflicts"></a>競合の確認

2 つのマッピング ルールで **法人** と **仕入先アカウント** の値が同じで、**品目名** の値が異なる場合、競合が検出され、マッピング ルールは作成または更新されません。

## <a name="importexport-mapping-rules-from-excel"></a>Excel からのマッピング ルールのインポート/エクスポート

Excel アドインは、バッチのルールを管理するために使用できます。 次のオプションを使用できます。

- Excel テンプレートのダウンロード。
- Excel にエクスポート。
- Excel からインポート。

### <a name="download-an-excel-template"></a>Excel テンプレートのダウンロード

Excel のテンプレートをダウンロードするには、**テンプレートのダウンロード** を選択します。 次に、テンプレートに含めるフィールドを選択します。

### <a name="export-to-excel"></a>Excel にエクスポート

2 つの方法でエクスポートできます:

- **Excel Online で開く** を選択すると、Excel でファイルを開くことができます。 その後、オンラインでファイルを編集できます。 完了したら、**保存** を選択します。 変更はすべて **マッピング ルール** ページ に保存されます。
- **ワークシート のダウンロード** を選択して、マッピング ルールを含む Excel ファイルをダウンロードします。 その後、ファイルを編集できます。 完了後は、**Excel からインポート** を選択して、更新したワークシートをアップロードします。

### <a name="import-from-excel"></a>Excel からインポート

1. **Excel からインポート** を選択して、XLSX ファイルからデータをインポートします。 コンマ区切り値 (CSV) または XML ファイルからインポートすることもできます。 インポートする前に、重複を許可するかどうかを決定する必要があります。
2. **マッピングのレビュー** を選択して、属性マッピングを確認し、その属性が正しいかどうかを判断します。 マッピングのリレーションシップを変更することはできません。
3. 完了後は、**インポートの完了** を選択してインポートを開始します。
4. **プロセスの追跡** を 選択すると、インポート 処理の進行状況を追跡できます。

    インポートの状態は、**完了** から **解析** に、続いて **変換** から **完了** に更新されます。

インポート処理が完了すると、成功、部分的失敗、エラー、処理総量の統計が表示されます。
