---
title: 機械学習モデルの結果 (プレビュー版)
description: このトピックでは、機械学習 (ML) モデルの混乱マトリックス、分類に関する問題、および正確性について説明します。 ML の予測結果の正確性について理解を深めることを目的としています。
author: ShivamPandey-msft
manager: AnnBe
ms.date: 06/05/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: roschlom
ms.custom: 14151
ms.assetid: 3d43ba40-780c-459a-a66f-9a01d556e674
ms.search.region: Global
ms.author: shpandey
ms.search.validFrom: 2020-07-14
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: 5223bdfbc0f5828b5dccac30362783075ce8157f
ms.sourcegitcommit: f59df61799915f6a79aec7e3e8664c02df6597da
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/22/2021
ms.locfileid: "5044375"
---
# <a name="results-of-machine-learning-models-preview"></a><span data-ttu-id="5462c-104">機械学習モデルの結果 (プレビュー版)</span><span class="sxs-lookup"><span data-stu-id="5462c-104">Results of machine learning models (preview)</span></span>

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="5462c-105">このトピックでは、機械学習 (ML) モデルの混乱マトリックス、分類に関する問題、および正確性について説明します。</span><span class="sxs-lookup"><span data-stu-id="5462c-105">This topic discusses confusion matrices, classification problems, and accuracy in machine learning (ML) models.</span></span> <span data-ttu-id="5462c-106">ML の予測結果の正確性について理解を深めることを目的としています。</span><span class="sxs-lookup"><span data-stu-id="5462c-106">The purpose is to enhance your understanding of accuracy in ML prediction results.</span></span> <span data-ttu-id="5462c-107">対象者は、データサイエンスの知識やスキルを身につけたいエンジニア、アナリスト、管理者などです。</span><span class="sxs-lookup"><span data-stu-id="5462c-107">The target audience includes engineers, analysts, and managers who want to build their knowledge and skills in data science.</span></span>

## <a name="confusion-matrix"></a><span data-ttu-id="5462c-108">混乱マトリックス</span><span class="sxs-lookup"><span data-stu-id="5462c-108">Confusion matrix</span></span>
<span data-ttu-id="5462c-109">一連の履歴データに関して、監督された ML の問題をトレーニングした後、トレーニング プロセスから取得したデータを使用してテストを行います。</span><span class="sxs-lookup"><span data-stu-id="5462c-109">After a supervised ML problem is trained on a set of historical data, it's tested by using data that is withheld from the training process.</span></span> <span data-ttu-id="5462c-110">このようにして、訓練されたモデルの予測値と実際の値を比較することができます。</span><span class="sxs-lookup"><span data-stu-id="5462c-110">In this way, you can compare the predictions from the trained model with the actual values.</span></span> <span data-ttu-id="5462c-111">混乱マトリックスには、分類の問題がどの程度成功しているか、どこで誤りが発生しているかを評価する手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="5462c-111">The confusion matrix provides a means of evaluating how successful a classification problem is and where it makes mistakes (that is, where it becomes "confused").</span></span>

<span data-ttu-id="5462c-112">たとえば、いくつかの身体的属性や行動的属性に基づいて、ペットが犬なのか猫なのかを予測するなどです。</span><span class="sxs-lookup"><span data-stu-id="5462c-112">For example, your objective is to predict whether a pet is a dog or a cat, based on some physical and behavioral attributes.</span></span> <span data-ttu-id="5462c-113">30匹の犬と20匹の猫を含むテストのデータセットを使用している場合、混乱マトリックスは次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="5462c-113">If you have a test dataset that contains 30 dogs and 20 cats, the confusion matrix might resemble the following illustration.</span></span>

![種の予測例](media/species-prediction-matrix.png)

<span data-ttu-id="5462c-115">緑のセルの数値は、正しい予測を表します。</span><span class="sxs-lookup"><span data-stu-id="5462c-115">The numbers in the green cells represent correct predictions.</span></span> <span data-ttu-id="5462c-116">ご覧のように、モデルは猫の割合が高いことを予測していました。</span><span class="sxs-lookup"><span data-stu-id="5462c-116">As you can see, the model predicted a higher percentage of the actual cats correctly.</span></span> <span data-ttu-id="5462c-117">モデルの全体的な精度は簡単に計算できます。</span><span class="sxs-lookup"><span data-stu-id="5462c-117">The overall accuracy of the model is easy to calculate.</span></span> <span data-ttu-id="5462c-118">この場合は、42÷ 50 (0.84) になります。</span><span class="sxs-lookup"><span data-stu-id="5462c-118">In this case, it's 42 ÷ 50, or 0.84.</span></span>

### <a name="multi-class-classifiers-in-a-confusion-matrix"></a><span data-ttu-id="5462c-119">混乱マトリックスの複数クラスの分類子</span><span class="sxs-lookup"><span data-stu-id="5462c-119">Multi-class classifiers in a confusion matrix</span></span>

<span data-ttu-id="5462c-120">混乱マトリックスに関する議論のほとんどは、前述の例のように、2進分類子に焦点を置いています。</span><span class="sxs-lookup"><span data-stu-id="5462c-120">Most discussions about the confusion matrix are focused on binary classifiers, as in the preceding example.</span></span> <span data-ttu-id="5462c-121">この場合は、特殊なケースとして、感度や呼び戻しといった他の指標を考えることができます。</span><span class="sxs-lookup"><span data-stu-id="5462c-121">This case is a special case where other metrics can be considered, such as sensitivity and recall.</span></span>

<span data-ttu-id="5462c-122">次に、3つの状態を持つファイナンス シナリオの分類に関する問題を検討します。</span><span class="sxs-lookup"><span data-stu-id="5462c-122">Next, we will consider a classification problem for a finance scenario that has three states.</span></span> <span data-ttu-id="5462c-123">このモデルでは、顧客請求書が時間どおりに支払われるか、遅延しているか、または遅延しているかを予測します。</span><span class="sxs-lookup"><span data-stu-id="5462c-123">The model predicts whether a customer invoice will be paid on time, late, or very late.</span></span> <span data-ttu-id="5462c-124">この場合、 テスト請求書 100 件のうち、50 件は定時払い、35 件は遅延、15 件は大幅に遅延しています。</span><span class="sxs-lookup"><span data-stu-id="5462c-124">For example, out of 100 test invoices, 50 are paid on time, 35 are paid late, and 15 are paid very late.</span></span> <span data-ttu-id="5462c-125">この場合、モデルが次の図のような混乱マトリックスを生成する場合があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-125">In this case, a model might produce a confusion matrix that resembles the following illustration.</span></span>

![モデル 1](media/payment-prediction-matrix.png)<span data-ttu-id="5462c-127">]</span><span class="sxs-lookup"><span data-stu-id="5462c-127">]</span></span>

<span data-ttu-id="5462c-128">混乱マトリックスには、簡素な精度メトリックよりもはるかに多くの情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-128">A confusion matrix provides significantly more information than a simple accuracy metric.</span></span> <span data-ttu-id="5462c-129">ただし、わかりやすさを維持しています。</span><span class="sxs-lookup"><span data-stu-id="5462c-129">However, it's still relatively easy to understand.</span></span> <span data-ttu-id="5462c-130">この混乱マトリックスでは、出力クラスのカウントが類似しているデータセットがあるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-130">A confusion matrix tells you whether you have a balanced dataset where the output classes have similar counts.</span></span> <span data-ttu-id="5462c-131">マルチクラスシナリオでは、前に示した顧客支払などのように、出力クラスが序数である場合に予測からどれだけ乖離しているかを示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-131">For the multi-class scenario, it tells you how far off a prediction might be when the output classes are ordinal, as in the preceding example about customer payments.</span></span>

## <a name="model-accuracy"></a><span data-ttu-id="5462c-132">モデルの精度</span><span class="sxs-lookup"><span data-stu-id="5462c-132">Model accuracy</span></span> 
<span data-ttu-id="5462c-133">さまざまな精度基準を活用することで、モデルの品質を定量化できるという利点があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-133">Different accuracy metrics have the advantage of quantifying the model quality.</span></span> 

<span data-ttu-id="5462c-134">精度はわかりやすい指標であるため、特にデータ サイエンティストではないモデルのユーザーに対して、モデルを説明する際の出発点として適しています。</span><span class="sxs-lookup"><span data-stu-id="5462c-134">Because accuracy is an easy metric to understand, it's a good starting point for explaining a model to other people, especially to users of the model who aren't data scientists.</span></span> <span data-ttu-id="5462c-135">モデルの正確性を理解するためには、統計を把握することが必要となります。</span><span class="sxs-lookup"><span data-stu-id="5462c-135">No understanding of statistics is required to understand the model's accuracy.</span></span> <span data-ttu-id="5462c-136">混乱マトリックスが使用可能な場合は、モデルのパフォーマンスをさらに詳しく把握できます。</span><span class="sxs-lookup"><span data-stu-id="5462c-136">When a confusion matrix is available, it provides further insight into the model's performance.</span></span>

<span data-ttu-id="5462c-137">ただし、より詳細に理解するためには、正確さに関連するいくつかの問題に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-137">However, for a more thorough understanding, several challenges that are associated with accuracy should be noted.</span></span> <span data-ttu-id="5462c-138">メトリックの有用性は、問題のコンテキストによって異なります。</span><span class="sxs-lookup"><span data-stu-id="5462c-138">The usefulness of the metric depends on the context of the problem.</span></span> <span data-ttu-id="5462c-139">モデルのパフォーマンスに関してよく発生する問題は、"モデルがどの程度良好であるか？" という点です。</span><span class="sxs-lookup"><span data-stu-id="5462c-139">A question that often arises in relation to model performance is, "How good is the model?"</span></span> <span data-ttu-id="5462c-140">ただし、この質問に対する回答は、必ずしもわかりやすいわけではありません。</span><span class="sxs-lookup"><span data-stu-id="5462c-140">However, the answer to this question isn't necessarily straightforward.</span></span> <span data-ttu-id="5462c-141">次の混乱マトリックスについて検討してください (モデル2)。</span><span class="sxs-lookup"><span data-stu-id="5462c-141">Consider the following confusion matrix (model 2).</span></span>

![大規模サンプルを使用した支払予測の例](media/payment-prediction-matrix-2.png)

<span data-ttu-id="5462c-143">簡単な計算では、このモデルの精度 (70 + 10 + 3) ÷100 (0.83) が示されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-143">A quick calculation shows that this model's accuracy is (70 + 10 + 3) ÷ 100, or 0.83.</span></span> <span data-ttu-id="5462c-144">表面的には、この結果は、精度 0.73 の以前のマルチ クラス モデル (モデル1) の結果よりも優れているようです。</span><span class="sxs-lookup"><span data-stu-id="5462c-144">On the surface, this result seems better than result for the previous multi-class model (model 1), which has an accuracy of 0.73.</span></span> <span data-ttu-id="5462c-145">ただし、それでも良いでしょうか。</span><span class="sxs-lookup"><span data-stu-id="5462c-145">But is it better?</span></span>

<span data-ttu-id="5462c-146">この質問に対処するために、単純な推測が正確であることを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="5462c-146">To begin to address this question, consider the accuracy of a naïve guess.</span></span> <span data-ttu-id="5462c-147">分類上の問題については、単純な推測は常に最も一般的なクラスを予測します。</span><span class="sxs-lookup"><span data-stu-id="5462c-147">For a classification problem, a simple guess will always predict the most common class.</span></span> <span data-ttu-id="5462c-148">モデル 1 では、この推測が 「時間通り」であり、0.50 の精度が得られることになります。</span><span class="sxs-lookup"><span data-stu-id="5462c-148">For model 1, that guess will be "on time," and it will produce an accuracy of 0.50.</span></span> <span data-ttu-id="5462c-149">モデル 2 では、この推測が 「時間通り」であり、0.80 の精度が得られることになります。</span><span class="sxs-lookup"><span data-stu-id="5462c-149">The guess for model 2 will also be "on time," and it will produce an accuracy of 0.80.</span></span> <span data-ttu-id="5462c-150">モデル 1 は、0.73-0.50 = 0.23 によって単純な推測によって改善されているのに対し、モデル 2 は、0.83 による単純な予想 (0.80 = 0.03) を向上させているため、精度が低い場合でも、モデル 1 は優れたモデルと見なすことができます。</span><span class="sxs-lookup"><span data-stu-id="5462c-150">Because model 1 improves on the naïve guess by 0.73 – 0.50 = 0.23, whereas model 2 improves on the naïve guess by 0.83 – 0.80 = 0.03, model 1 is a better model, even though it has lower accuracy.</span></span> <span data-ttu-id="5462c-151">この計算から、モデルの品質を効果的に評価するには、精度の値よりも多くのコンテキストが必要になることがわかります。</span><span class="sxs-lookup"><span data-stu-id="5462c-151">The calculation reveals that effective assessment of a model's quality requires more context than the accuracy value.</span></span>

<span data-ttu-id="5462c-152">もうひとつ注目すべき点があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-152">Another aspect is worth noting.</span></span> <span data-ttu-id="5462c-153">医療検査で病気を発見するシナリオを考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="5462c-153">Consider a scenario where a medical test is used to detect a disease in a patient.</span></span> <span data-ttu-id="5462c-154">この問題は、正の結果が患者に病気があることを示す二項分類の問題です。</span><span class="sxs-lookup"><span data-stu-id="5462c-154">This problem is a binary classification problem where a positive result indicates that the patient has the disease.</span></span> <span data-ttu-id="5462c-155">このシナリオでは、次のエラーの影響について考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-155">In this scenario, you must think about the impact of the following errors:</span></span>

- <span data-ttu-id="5462c-156">偽陽性: 検査では患者に病気があると出ても、実際には病気ではない場合</span><span class="sxs-lookup"><span data-stu-id="5462c-156">False positives, where the test says that a patient has the disease, but she doesn't really have it</span></span>
- <span data-ttu-id="5462c-157">偽陽性: 検査では患者に病気があると出ても、実際には病気ではない場合</span><span class="sxs-lookup"><span data-stu-id="5462c-157">False negatives, where the test says that a patient doesn't have the disease, but he really does have it</span></span>

<span data-ttu-id="5462c-158">明らかに、どちらのタイプのエラーも望ましいものではありませんが、どちらが悪いのでしょうか？</span><span class="sxs-lookup"><span data-stu-id="5462c-158">Obviously, both types of error are undesirable, but which is worse?</span></span> <span data-ttu-id="5462c-159">これは状況によります。</span><span class="sxs-lookup"><span data-stu-id="5462c-159">Again, it depends.</span></span> <span data-ttu-id="5462c-160">迅速な治療が必要な生命に関わる病気の場合は、偽陰性の最小化 (可能な場合は別途追加検査を行う) が優先されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-160">In the case of a life-threatening disease that requires fast treatment, minimization of false negatives (hopefully followed by additional tests) takes priority.</span></span> <span data-ttu-id="5462c-161">それ以外の重要度の低い状況では、モデル作成者は偽陽性を最小限に抑えることができるでしょう。</span><span class="sxs-lookup"><span data-stu-id="5462c-161">In other, less critical situations, the model creators might minimize false positives instead.</span></span> <span data-ttu-id="5462c-162">いずれにしても、モデルの品質を効果的に判断するにあたっては、精度の指標よりも多くの情報を持っている必要があるというのが、合理的な結論です。</span><span class="sxs-lookup"><span data-stu-id="5462c-162">At any rate, a reasonable conclusion is that to effectively determine a model's quality, you must have more information than an accuracy metric provides.</span></span>

### <a name="recommendations"></a><span data-ttu-id="5462c-163">推奨</span><span class="sxs-lookup"><span data-stu-id="5462c-163">Recommendations</span></span>

<span data-ttu-id="5462c-164">精度は、統計学に精通していないドメイン専門家とコミュニケーションをとるための重要なツールです。</span><span class="sxs-lookup"><span data-stu-id="5462c-164">Accuracy is an important tool for communicating with domain experts who aren't familiar with statistics.</span></span> <span data-ttu-id="5462c-165">ただし、情報を有用にするために、精度の値と一緒に追加のコンテキストを提供することが重要です。</span><span class="sxs-lookup"><span data-stu-id="5462c-165">However, to make the information useful, it's critical that additional context be provided together with the accuracy value.</span></span>

<span data-ttu-id="5462c-166">支払予測シナリオについては、異なる支払動作の係数を含む ML モデルのターゲットを設定できます。</span><span class="sxs-lookup"><span data-stu-id="5462c-166">For the payment prediction scenario, you can set a target for the ML model that includes factors in different payment behaviors.</span></span> <span data-ttu-id="5462c-167">目標は、誤った回答の数を少なくとも 50 パーセント減少させることによって、単純な推測でモデルを改善することです。</span><span class="sxs-lookup"><span data-stu-id="5462c-167">The target is that the model should improve upon a naïve guess by reducing the number of incorrect answers by at least 50 percent.</span></span> <span data-ttu-id="5462c-168">言い換えると、単純な推測と100% の精度を分割するターゲット精度が必要です。</span><span class="sxs-lookup"><span data-stu-id="5462c-168">In other words, you want a target accuracy that splits the different between the accuracy of a naïve guess and 100 percent.</span></span>

<span data-ttu-id="5462c-169">以下の表では、このトピックの混乱マトリックスについて、この原則をまとめています。</span><span class="sxs-lookup"><span data-stu-id="5462c-169">The following table summarizes this principle for the confusion matrices in this topic.</span></span>

| <span data-ttu-id="5462c-170">モデル</span><span class="sxs-lookup"><span data-stu-id="5462c-170">Model</span></span>   | <span data-ttu-id="5462c-171">単純推測</span><span class="sxs-lookup"><span data-stu-id="5462c-171">Naïve guess</span></span> | <span data-ttu-id="5462c-172">目標</span><span class="sxs-lookup"><span data-stu-id="5462c-172">Target</span></span> | <span data-ttu-id="5462c-173">モデルの精度</span><span class="sxs-lookup"><span data-stu-id="5462c-173">Model accuracy</span></span> | <span data-ttu-id="5462c-174">目標が満たしているかどうか</span><span class="sxs-lookup"><span data-stu-id="5462c-174">Is the goal met?</span></span>                                          |
|---------|-------------|--------|----------------|-----------------------------------------------------------|
| <span data-ttu-id="5462c-175">モデル 1</span><span class="sxs-lookup"><span data-stu-id="5462c-175">Model 1</span></span> | <span data-ttu-id="5462c-176">0.50</span><span class="sxs-lookup"><span data-stu-id="5462c-176">0.50</span></span>        | <span data-ttu-id="5462c-177">0.75</span><span class="sxs-lookup"><span data-stu-id="5462c-177">0.75</span></span>   | <span data-ttu-id="5462c-178">0.73</span><span class="sxs-lookup"><span data-stu-id="5462c-178">0.73</span></span>           | <span data-ttu-id="5462c-179">ほぼ。</span><span class="sxs-lookup"><span data-stu-id="5462c-179">Almost.</span></span> <span data-ttu-id="5462c-180">このモデルは、推測に応じて大幅に改善されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-180">This model significantly improves upon the guess.</span></span> |
| <span data-ttu-id="5462c-181">モデル 2</span><span class="sxs-lookup"><span data-stu-id="5462c-181">Model 2</span></span> | <span data-ttu-id="5462c-182">0.80</span><span class="sxs-lookup"><span data-stu-id="5462c-182">0.80</span></span>        | <span data-ttu-id="5462c-183">0.90</span><span class="sxs-lookup"><span data-stu-id="5462c-183">0.90</span></span>   | <span data-ttu-id="5462c-184">0.83</span><span class="sxs-lookup"><span data-stu-id="5462c-184">0.83</span></span>           | <span data-ttu-id="5462c-185">No.</span><span class="sxs-lookup"><span data-stu-id="5462c-185">No.</span></span> <span data-ttu-id="5462c-186">改善が必要です。</span><span class="sxs-lookup"><span data-stu-id="5462c-186">Improvement is required.</span></span>                              |

## <a name="classification-f1-accuracy"></a><span data-ttu-id="5462c-187">分類 F1 の精度</span><span class="sxs-lookup"><span data-stu-id="5462c-187">Classification F1 accuracy</span></span>

<span data-ttu-id="5462c-188">このトピックの最後の考察では、より高度な測定を行う分類 ML パフォーマンスである F1 精度について解説します。</span><span class="sxs-lookup"><span data-stu-id="5462c-188">The final consideration in this topic is a more advanced measure of classification ML performance that is known as F1 accuracy.</span></span>

<span data-ttu-id="5462c-189">F1 精度を定義する前に、精度とリコールという 2 つの追加指標を導入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-189">Before F1 accuracy can be defined, two additional metrics must be introduced: precision and recall.</span></span> <span data-ttu-id="5462c-190">精度は、陽性として指定された予測の合計数のうち、正しく割り当てられている数を示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-190">Precision indicates how many of the total number of predictions that are specified as positive are correctly assigned.</span></span> <span data-ttu-id="5462c-191">この指標は、陽性の予測値としても知られています。</span><span class="sxs-lookup"><span data-stu-id="5462c-191">This metric is also known as the positive predictive value.</span></span> <span data-ttu-id="5462c-192">リコールとは、正しく予測された実際の陽性例の総数です。</span><span class="sxs-lookup"><span data-stu-id="5462c-192">Recall is the total number of the actual positive cases that were predicted correctly.</span></span> <span data-ttu-id="5462c-193">この指標は感度としても知られています。</span><span class="sxs-lookup"><span data-stu-id="5462c-193">This metric is also known as sensitivity.</span></span>

<span data-ttu-id="5462c-194">[![真の結果と偽の結果の対比](./media/tn-fn.png)](./media/tn-fn.png)</span><span class="sxs-lookup"><span data-stu-id="5462c-194">[![True results vs. false results](./media/tn-fn.png)](./media/tn-fn.png)</span></span>

<span data-ttu-id="5462c-195">前の図の混乱マトリックスでは、これらメトリックは次のように計算されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-195">In the confusion matrix in the preceding illustration, these metrics are calculated in the following way:</span></span>

- <span data-ttu-id="5462c-196">精度 = TP ÷ (TP + FP)</span><span class="sxs-lookup"><span data-stu-id="5462c-196">Precision = TP ÷ (TP + FP)</span></span>
- <span data-ttu-id="5462c-197">リコール = TP ÷ (TP + FN)</span><span class="sxs-lookup"><span data-stu-id="5462c-197">Recall = TP ÷ (TP + FN)</span></span>

<span data-ttu-id="5462c-198">F1 のメジャーは、精度とリコールを結合します。</span><span class="sxs-lookup"><span data-stu-id="5462c-198">The F1 measure combines precision and recall.</span></span> <span data-ttu-id="5462c-199">この結果は、2 つの値の調和平均になります。</span><span class="sxs-lookup"><span data-stu-id="5462c-199">The result is the harmonic mean of the two values.</span></span> <span data-ttu-id="5462c-200">計算処理は次のように行われます。</span><span class="sxs-lookup"><span data-stu-id="5462c-200">It's calculated in the following way:</span></span>

- <span data-ttu-id="5462c-201">F1 = 2 × (精度 × リコール) ÷ (精度 + リコール)</span><span class="sxs-lookup"><span data-stu-id="5462c-201">F1 = 2 × (Precision × Recall) ÷ (Precision + Recall)</span></span>

<span data-ttu-id="5462c-202">具体的な例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-202">Let's look at a concrete example.</span></span> <span data-ttu-id="5462c-203">このトピックでは、動物が犬なのか猫なのかを予測するモデルの例を示しました。</span><span class="sxs-lookup"><span data-stu-id="5462c-203">Earlier in this topic, there was an example of a model that predicted whether an animal was a dog or a cat.</span></span> <span data-ttu-id="5462c-204">ここでも同じ図を使用します。</span><span class="sxs-lookup"><span data-stu-id="5462c-204">The illustration is repeated here.</span></span>

<span data-ttu-id="5462c-205">[![種の予測の例 (再掲)](./media/species-prediction-matrix.png)](./media/species-prediction-matrix.png)</span><span class="sxs-lookup"><span data-stu-id="5462c-205">[![Species prediction example (repeated)](./media/species-prediction-matrix.png)](./media/species-prediction-matrix.png)</span></span>

<span data-ttu-id="5462c-206">ここでは、"犬" を正の答えとして使用した場合の結果を示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-206">Here are the results if "Dog" is used as the positive answer.</span></span>

- <span data-ttu-id="5462c-207">精度 = 24 ÷ (24 + 2) = 0.9231</span><span class="sxs-lookup"><span data-stu-id="5462c-207">Precision = 24 ÷ (24 + 2) = 0.9231</span></span>
- <span data-ttu-id="5462c-208">リコール = 24 ÷ (24 + 6) = 0.8</span><span class="sxs-lookup"><span data-stu-id="5462c-208">Recall = 24 ÷ (24 + 6) = 0.8</span></span>
- <span data-ttu-id="5462c-209">F1 = 2 × (0.9231 × 0.8) ÷ (0.9231 + 0.8) = 0.8572</span><span class="sxs-lookup"><span data-stu-id="5462c-209">F1 = 2 × (0.9231 × 0.8) ÷ (0.9231 + 0.8) = 0.8572</span></span>

<span data-ttu-id="5462c-210">ご覧のように、F1の値は精度とリコールの値の間にあります。</span><span class="sxs-lookup"><span data-stu-id="5462c-210">As you can see, the F1 value is between the values for precision and recall.</span></span>

<span data-ttu-id="5462c-211">F1 の精度を理解するのは簡単ではありませんが、基本的な精度の数字には、微妙な精度が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-211">Although F1 accuracy isn't as easy to understand, it adds nuance to the basic accuracy number.</span></span> <span data-ttu-id="5462c-212">また、次の説明に示すように、不安定なデータセットに対応することもできます。</span><span class="sxs-lookup"><span data-stu-id="5462c-212">It can also help with unbalanced datasets, as the following discussion will show.</span></span>

<span data-ttu-id="5462c-213">このトピックの[モデルの精度](#model-accuracy)セクションでは、次の 2 つの混乱マトリックスを比較しています。</span><span class="sxs-lookup"><span data-stu-id="5462c-213">The [Model accuracy](#model-accuracy) section of this topic compared the following two confusion matrices.</span></span> <span data-ttu-id="5462c-214">1 つ目のモデルでは精度が低かったにもかかわらず、定時払いの既定の推測よりも改善が見られたため、より有用なモデルと判断されました。</span><span class="sxs-lookup"><span data-stu-id="5462c-214">Even though the first model had lower accuracy, it was deemed a more useful model because it showed more improvement than the default guess of an on-time payment.</span></span>

![支払予測と実績の比較例](media/payment-prediction-matrix.png)

![大規模サンプルを使用した支払予測の例 (再掲)](media/payment-prediction-matrix-2.png)

<span data-ttu-id="5462c-217">この 2 つのモデルを F1 スコアで比較してみましょう。</span><span class="sxs-lookup"><span data-stu-id="5462c-217">Let's see how these two models compare when the F1 score is used.</span></span> <span data-ttu-id="5462c-218">F1 スコアは、各状態の精度とリコールを考慮し、F1 マクロ計算で状態間の F1 スコアを平均化し、全体的な F1 スコアを決定します。</span><span class="sxs-lookup"><span data-stu-id="5462c-218">The F1 score factors in precision and recall for each state, and the F1 macro calculation then averages the F1 score across the states to determine an overall F1 score.</span></span> <span data-ttu-id="5462c-219">他にも F1 の変種はありますが、3 つの状態すべてに平等に考慮されていることを考えると、マクロ版を検討する価値がありそうです。</span><span class="sxs-lookup"><span data-stu-id="5462c-219">There are other F1 variants, but it's of greater interest to consider the macro version, given the equal consideration that is given to all three states.</span></span>

<span data-ttu-id="5462c-220">計算を簡単にするにあたり、実際の値と予測値を一致させるサンプルの配列を構築しました。</span><span class="sxs-lookup"><span data-stu-id="5462c-220">To simplify the calculations, sample arrays were built to match the actual and predicted values.</span></span> <span data-ttu-id="5462c-221">これらの配列は、Python の sklearn のメトリクスライブラリを使って計算していました。</span><span class="sxs-lookup"><span data-stu-id="5462c-221">These arrays used sklearn's metrics library in Python to calculate the values.</span></span> <span data-ttu-id="5462c-222">結果を次に示します。</span><span class="sxs-lookup"><span data-stu-id="5462c-222">Here is the result.</span></span>

| <span data-ttu-id="5462c-223">モデル</span><span class="sxs-lookup"><span data-stu-id="5462c-223">Model</span></span>   | <span data-ttu-id="5462c-224">単純推測</span><span class="sxs-lookup"><span data-stu-id="5462c-224">Naive guess</span></span> | <span data-ttu-id="5462c-225">正確性</span><span class="sxs-lookup"><span data-stu-id="5462c-225">Accuracy</span></span> | <span data-ttu-id="5462c-226">F1 マクロ</span><span class="sxs-lookup"><span data-stu-id="5462c-226">F1 macro</span></span> |
|---------|-------------|----------|----------|
| <span data-ttu-id="5462c-227">モデル 1</span><span class="sxs-lookup"><span data-stu-id="5462c-227">Model 1</span></span> | <span data-ttu-id="5462c-228">0.5</span><span class="sxs-lookup"><span data-stu-id="5462c-228">0.5</span></span>         | <span data-ttu-id="5462c-229">0.73</span><span class="sxs-lookup"><span data-stu-id="5462c-229">0.73</span></span>     | <span data-ttu-id="5462c-230">0.67</span><span class="sxs-lookup"><span data-stu-id="5462c-230">0.67</span></span>     |
| <span data-ttu-id="5462c-231">モデル 2</span><span class="sxs-lookup"><span data-stu-id="5462c-231">Model 2</span></span> | <span data-ttu-id="5462c-232">0.80</span><span class="sxs-lookup"><span data-stu-id="5462c-232">0.80</span></span>        | <span data-ttu-id="5462c-233">0.83</span><span class="sxs-lookup"><span data-stu-id="5462c-233">0.83</span></span>     | <span data-ttu-id="5462c-234">0.66</span><span class="sxs-lookup"><span data-stu-id="5462c-234">0.66</span></span>     |

<span data-ttu-id="5462c-235">この計算方法の詳細については、モデル 1 の sklearn.metrics の分類レポートを参照してください。</span><span class="sxs-lookup"><span data-stu-id="5462c-235">For more detail about how this calculation works, here is the sklearn.metrics classification report for model 1.</span></span> <span data-ttu-id="5462c-236">3 つの状態 "時間通り"、"遅延"、"大きく遅延" は、それぞれ 1、2、3 というラベルの行で表されています。</span><span class="sxs-lookup"><span data-stu-id="5462c-236">The three states, "On time," "Late," and "Very late," are represented by the rows that are labeled 1, 2, and 3, respectively.</span></span> <span data-ttu-id="5462c-237">マクロ平均は、"f1-スコア" 列の平均値になります。</span><span class="sxs-lookup"><span data-stu-id="5462c-237">The macro average is just the average of the "f1-score" column.</span></span>

|           | <span data-ttu-id="5462c-238">精度</span><span class="sxs-lookup"><span data-stu-id="5462c-238">precision</span></span> | <span data-ttu-id="5462c-239">リコール</span><span class="sxs-lookup"><span data-stu-id="5462c-239">recall</span></span>   | <span data-ttu-id="5462c-240">f1-スコア</span><span class="sxs-lookup"><span data-stu-id="5462c-240">f1-score</span></span> |
|-----------|-----------|----------|----------|
| <span data-ttu-id="5462c-241">**1**</span><span class="sxs-lookup"><span data-stu-id="5462c-241">**1**</span></span>     | <span data-ttu-id="5462c-242">0.83</span><span class="sxs-lookup"><span data-stu-id="5462c-242">0.83</span></span>      | <span data-ttu-id="5462c-243">0.80</span><span class="sxs-lookup"><span data-stu-id="5462c-243">0.80</span></span>     | <span data-ttu-id="5462c-244">0.82</span><span class="sxs-lookup"><span data-stu-id="5462c-244">0.82</span></span>     |
| <span data-ttu-id="5462c-245">**2**</span><span class="sxs-lookup"><span data-stu-id="5462c-245">**2**</span></span>     | <span data-ttu-id="5462c-246">0.68</span><span class="sxs-lookup"><span data-stu-id="5462c-246">0.68</span></span>      | <span data-ttu-id="5462c-247">0.71</span><span class="sxs-lookup"><span data-stu-id="5462c-247">0.71</span></span>     | <span data-ttu-id="5462c-248">0.69</span><span class="sxs-lookup"><span data-stu-id="5462c-248">0.69</span></span>     |
| <span data-ttu-id="5462c-249">**3**</span><span class="sxs-lookup"><span data-stu-id="5462c-249">**3**</span></span>     | <span data-ttu-id="5462c-250">0.50</span><span class="sxs-lookup"><span data-stu-id="5462c-250">0.50</span></span>      | <span data-ttu-id="5462c-251">0.50</span><span class="sxs-lookup"><span data-stu-id="5462c-251">0.50</span></span>     | <span data-ttu-id="5462c-252">0.50</span><span class="sxs-lookup"><span data-stu-id="5462c-252">0.50</span></span>     |

<span data-ttu-id="5462c-253">これらの結果が示すように、2 つのモデルの F1 マクロ精度スコアはほぼ同じです。</span><span class="sxs-lookup"><span data-stu-id="5462c-253">As these results show, the two models have nearly identical F1 macro accuracy scores.</span></span> <span data-ttu-id="5462c-254">このような場合あるいはその他多くのケースでは、F1 の精度はモデルの能力を示すより良い指標となります。</span><span class="sxs-lookup"><span data-stu-id="5462c-254">In this and many other cases, F1 accuracy provides a better indicator of a model's capability.</span></span> <span data-ttu-id="5462c-255">精度については、結果の解釈では、モデルで考慮すべき最も重要なことを理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5462c-255">As for accuracy, interpretation of the results requires that you understand what is most important to consider in the model.</span></span>

#### <a name="privacy-notice"></a><span data-ttu-id="5462c-256">プライバシー通知</span><span class="sxs-lookup"><span data-stu-id="5462c-256">Privacy notice</span></span>
<span data-ttu-id="5462c-257">プレビューは (1) Dynamics 365 Finance and Operations サービスを下回るプライバシーおよび少ないセキュリティ対策を使用している場合があり、(2) このサービスのためにサービス レベル アグリーメント (SLA) には含まれておらず、(3) 個人データや、その他の法律上またはコンプライアンス要件の対象となるデータの処理に使用されず、(4) サポートが制限されます。</span><span class="sxs-lookup"><span data-stu-id="5462c-257">Previews (1) might use less privacy and fewer security measures than the Dynamics 365 Finance and Operations service, (2) aren't included in the service level agreement (SLA) for this service, (3) should not be used to process personal data or other data that is subject to legal or regulatory compliance requirements, and (4) have limited support.</span></span>
