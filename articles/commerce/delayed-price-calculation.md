---
title: 正確な価格と割引の計算を遅らせてパフォーマンスを向上させる
description: このトピックでは、Microsoft Dynamics 365 Commerce の販売時点管理 (POS) およびコールセンターで利用できる遅延価格計算機能について説明します。
author: boycezhu
ms.date: 09/09/2021
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgri
ms.search.region: Global
ms.author: boycez
ms.search.validFrom: 2017-06-20
ms.openlocfilehash: 8c4264c3a4c71e6aab0e1ef8d7d8cfffad065a46
ms.sourcegitcommit: 7a2001e4d01b252f5231d94b50945fd31562b2bc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/15/2021
ms.locfileid: "7488366"
---
# <a name="delay-exact-price-and-discount-calculation-for-improved-performance"></a>正確な価格と割引の計算を遅らせてパフォーマンスを向上させる

[!include [banner](includes/banner.md)]

このトピックでは、Microsoft Dynamics 365 Commerce の販売時点管理 (POS) およびコールセンターで利用できる遅延価格計算機能について説明します。

Dynamics 365 Commerce は、注文書や見積書の複数の販売明細行を組み合わせて適用される複数行割引の作成に対応しています。 これらの割引には、組み合わせ割引、しきい値割引、数量割引があります。

注文に新しい明細行が追加されるたびに、Commerce の価格設定エンジンはカート全体を評価し、これらの複数行割引が適用できるかどうかを判断します。 この再計算により、新しい明細行を追加すると、販売注文の増加に伴ってパフォーマンスに影響が発生する可能性があります。

ただし、企業間 (B2B) や企業と個人間 (B2C) は、多くの場合、注文の規模が大きくなる場合が多く見られます。 そのため、商品がカートに追加されるたびに、価格設定エンジンが再計算する待機時間が発生する場合があります。 また、大規模な注文の場合、商品をカートに入れるたびに正確な価格と割引を表示することは、あまり重要ではない場合が多いです。 それよりも、ユーザーが品目をすばやく追加できる方が重要です。 正確な価格や割引の計算を、ユーザーが要求するまで、あるいは注文が確定するまで遅らせる機能により、パフォーマンスが大幅に向上します。 また、注文の完了に要する時間が短縮される場合があります。

正確な価格や割引の計算を遅延させる機能は、これまでも POS に搭載されていました。 Commerce バージョン 10.0.22 のリリースでは、コール センターも使用できます。

## <a name="enable-delayed-price-and-discount-calculation-for-pos"></a>POS の遅延価格と割引の計算を有効にする

POS で遅延価格と割引の計算を有効にするには、以下の手順に従ってください。

1. Commerce 本部で、実店舗に関連付けられた機能性プロファイルにアクセスします。
1. **金額** クイック タブで、**複数品目の割引を手動計算する** 構成を有効化します。
1. 遅延計算を有効にするレジスターの画面レイアウト デザイナーを開きます。
1. ボタン グリッドに **合計の算出** ボタンを追加します。
1. ジョブ **1070** と **1090** を実行します。

これにより、品目がトランザクションに追加されても、レジ担当者が **合計を計算** ボタンを選択しない限り、複数行の割引は計算されません。 トランザクションで **合計を計算** を選択した後は、常に複数行割引が計算されます。 カートに商品が追加されても、レジ担当者が再度ボタンを選択する必要はありません。 **合計の計算** が選択されるまでは、レジ担当者は支払を取り込む必要があります。

## <a name="enable-delayed-price-and-discount-calculation-for-call-center"></a>コールセンターの遅延価格と割引の計算を有効にする

コールセンターで遅延価格と割引の計算を有効にするには、以下の手順に従ってください。

1. Commerce の本部で、**ワークスペース \> 機能管理** にアクセスします。
1. **コマースの注文で意図せずに価格が計算されることを防ぐ** 機能を有効化します。 この機能は、遅延価格や割引の計算機能の前提となるものです。

    > [!NOTE]
    > 新規デプロイ時には、**コマース注文で意図しない価格計算を防ぐ** 機能が既定で有効になっています。

1. **Commerce パラメータ \> 価格 と割引** に移動します。
1. **その他** セクションで、**複数行の価格および割引の手動計算** の構成を有効化します。

この設定により、コールセンターで販売注文や販売見積書を作成・編集する際に、正確な価格や割引の計算に遅延が発生することになります。 価格設定エンジンでは、追加、編集された販売明細行のみを考慮し、他の販売明細行はすべて無視されます。 品目の正味金額には、価格計算と単純な割引が (個々の品目の割引率または金額オフ) 含まれます。 ただし、組み合わせ割引、しきい値割引、数量割引は適用されません。 すべての割引を含む正確な価格を表示するコール センターのユーザーは、次の 3 つのボタンのうちのいずれかを選択することができます: **再計算**、**合計**、**完了**。

> [!NOTE]
> コールセンターでの注文の場合、正確な価格と割引の計算を行うためには、**再計算**、**合計**、**完了** のいずれかのボタンを選択する必要があることをユーザーに知らせる警告メッセージが表示されます。 **完了** ボタンが利用可能な注文では、コールセンターのユーザーが正確な価格や割引の計算を省略することはできないため、注文の取得を完了するには **完了** を選択する必要があります。 **完了** ボタンが利用できない注文では、注文の取り込みが完了したことを示すアクションはありません。 そのため、コール センターのユーザーは、注文の取り込みを完了する前に、**再計算** または **合計** のいずれかを選択する必要があります。

[!INCLUDE[footer-include](../includes/footer-banner.md)]
