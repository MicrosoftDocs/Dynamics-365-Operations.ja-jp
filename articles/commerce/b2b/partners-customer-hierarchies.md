---
title: 顧客階層を使用した B2B ビジネス パートナーの管理
description: このトピックでは、顧客階層を使用して、Microsoft Dynamics 365 Commerce 企業間 (B2B) の e コマース Web サイトのビジネス パートナーを管理する方法について説明します。
author: josaw1
ms.date: 02/16/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: RetailOperations
audience: Application User, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.search.industry: retail
ms.author: josaw
ms.search.validFrom: 2021-01-31
ms.dyn365.ops.version: 10.0.14
ms.openlocfilehash: 70acdf469be2fcddd9e2bf755e958c1b20ee2fcf
ms.sourcegitcommit: a58dfb892e43921157014f0784bd411f5c40e454
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/04/2022
ms.locfileid: "8686574"
---
# <a name="manage-b2b-business-partners-using-customer-hierarchies"></a>顧客階層を使用した B2B ビジネス パートナーの管理

[!include [banner](../../includes/banner.md)]

このトピックでは、顧客階層を使用して、Microsoft Dynamics 365 Commerce 企業間 (B2B) の e コマース Web サイトのビジネス パートナーを管理する方法について説明します。

Commerce 本部では、B2B e コマース サイトを使用するビジネス パートナー組織を表すために *顧客階層* エンティティが使用されます。 顧客階層を使用してビジネス パートナーを管理するには、Commerce 本部で B2B e コマース機能を有効にし、顧客階層の番号順序を定義する必要があります。

## <a name="enable-the-b2b-e-commerce-feature-in-commerce-headquarters"></a>Commerce 本部で B2B e コマース自動リンク機能を有効にする

B2B e コマース機能を使用するには、最初に Commerce 本部 で **B2B eその他の機能の使用を有効にする** を有効にする必要があります。

1. **ワークスペース \> 機能管理** に移動します。
1. **すべて** タブで、フィルター ボックスを使用して **モジュール : 小売とコマース** を検索します。
1. **B2B e コマース機能の使用を有効にする** 機能を検索してそれを選択し、右下隅で **今すぐ有効にする** を選択します。

## <a name="define-a-number-sequence-for-the-customer-hierarchy"></a>顧客階層の番号順序の定義

番号順序は、ID が必要なマスター データ レコードおよびトランザクション レコードに対して読みやすい固有の ID を生成するために使用されます。 顧客階層の ID を生成するために使用する番号シーケンスを定義する必要があります。 番号シーケンスの詳細については、[番号シーケンスの概要](/dynamics365/fin-ops-core/fin-ops/organization-administration/number-sequence-overview) を参照してください。

Commerce 本部で顧客階層の番号シーケンスを定義するには、次の手順を実行します。

1. **小売とコマース \> Headquarters の設定 \> 番号シーケンス \> 番号シーケンス** に移動して、番号シーケンスを作成します。
1. 新しい番号シーケンスを作成するか、既存の番号シーケンスを選択して再利用します。
1. **小売とコマース \> 本社の設定 \> パラメーター \> コマース共有パラメーター** の順に移動します。
1. **番号シーケンス** タブ で、**顧客階層 ID** 参照に先に作成または選択した番号シーケンスを追加します。

![顧客階層 ID 参照に追加された番号シーケンス。](../media/NumberSequenceCustHierarchy.png)

## <a name="how-the-approval-process-works"></a>承認プロセスの機能方法

ビジネス パートナーが B2B e コマース サイトへの参加を要求すると、システムはその要求を *見込顧客* として保存します。 リテールの業務マネージャーのような Commerce 本部の担当者は、パートナーの要求を承認または否認できます。 ビジネス パートナーの要求と [見込顧客の承認を管理する方法の詳細については、B2B e コマースの Web サイトでのビジネス パートナー ユーザーの管理](manage-b2b-users.md) を参照してください。

見込顧客が承認されると、システムは次の 2 つの新しい顧客レコードを作成します。

- **組織タイプ** の顧客レコードは、ビジネス パートナーへの指定を要求している組織を表します。
- **人** タイプの顧客レコードは、要求を送信した人物を表します。

さらに、**小売とコマース \> 顧客 \> 顧客階層** で新しい顧客階層レコードが作成されます。 この顧客階層レコードには、次のプロパティがあります。

- **Customer hierarchy ID** – 顧客階層固有の ID。 この ID では、Commerce 共有パラメータで定義した番号シーケンスが使用されます。
- **名前** - オンボード リクエストで指定した取引先組織の名称です。 このフィールドは編集可能です。
- **目的** - このプロパティは、**B2B 組織** の定義済の値に設定されます 。
- **Organization** – ビジネス パートナー組織の顧客 ID。

オンボード要求を送信したユーザーが **階層** クイック タブに追加され、**管理者** ロールが割り当てられます。 管理者が B2B サイトのビジネス パートナー組織にユーザーを追加すると、ユーザーごとに新しい顧客レコードが作成されます。 この顧客レコードは、ビジネス パートナーの関連する顧客階層レコードにも追加され、**ユーザー** ロールがそれに割り当てられます。

### <a name="examples"></a>例

Sam J. という名前の人物が、Microsoft 組織に代わって変更前の要求を提出します。 要求が承認されると、次の 2 つの新しい顧客アカウントが作成されます (Sam J の **個人** タイプが 1 つと、Microsoft の **組織** タイプが 1 つ)。

次の図の例に示すように、新しい顧客階層レコードも作成されます。 このレコードは組織 (**Microsoft**) と同じ名前で、**管理者** ロールはSam Jに割り当てられます。管理者であるSam J. は、B2B サイトのその他の Microsoft ユーザーをこの階層に追加し、その **ユーザー** をそのユーザーに割り当てます。 この例では、1 人のユーザーとして追加されました。

![顧客階層レコードの例。](../media/CustomerHierarchy2.png)

顧客が顧客階層に関連付けられているかどうかを確認するには、顧客レコードを開きます。 次の図に示すように、**Retail** クイック タブの **B2B** セクションの **顧客階層 ID** フィールドには、顧客が顧客階層の一部であるかどうかを示し、**B2B 管理者** オプションによって顧客が階層の管理者であるかどうかを示します。

![顧客レコードの Retail クイック タブにある B2B セクションの例では、顧客が階層に関連付け、管理者として指定されています。](../media/CustomerHierarchyMapping2.png)

ほとんどの場合、階層内のすべての顧客レコードの対応するプロパティ値は一致している必要があります。 たとえば、すべての取引先ユーザーは共通する製品価格とする必要があるため、価格グループと関連する構成は一致している必要があります。 ただし、この整合性はシステムが適用します。 したがって、関連する Commerce 本部のユーザーは、特定の階層内のすべての顧客のプロパティ値と構成が一致している必要があります。

Commerce 本部のユーザーは、階層内のすべての顧客レコードのプロパティ値を検証して並べて表示することができます。 次の図に示すように、**階層** クイック タブのドロップダウン リストで **全般** オプションを使用し、顧客レコードの任意のセクションを選択して関連プロパティを表示できます。 ユーザーは、このビューからプロパティの値を直接確認および編集することができます。 管理者顧客レコードのすべての値をすべてのユーザーにコピーするには、**階層** クイック タブで **上書き** を選択します。

![顧客階層レコードの例 (上書きボタンとドロップダウン リストにオプションが表示されます)。](../media/HierarchyDetails2.png)

[!include [footer-include](../../includes/footer-banner.md)]
