---
title: 店舗での顧客管理
description: このトピックでは、小売業者が Microsoft Dynamics 365 Commerce の販売時点管理 (POS) で顧客管理機能を有効にする方法について説明します。
author: josaw1
ms.date: 09/01/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: RetailOperations
audience: Application User, IT Pro
ms.reviewer: v-chgri
ms.search.region: Global
ms.search.industry: retail
ms.author: shajain
ms.search.validFrom: 2021-01-31
ms.dyn365.ops.version: 10.0.14
ms.openlocfilehash: 395bc7049ba32c1e572730e482b81613a4873c59
ms.sourcegitcommit: 1707cf45217db6801df260ff60f4648bd9a4bb68
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/23/2021
ms.locfileid: "7675228"
---
# <a name="customer-management-in-stores"></a>店舗での顧客管理

[!include [banner](includes/banner.md)]

このトピックでは、小売業者が Microsoft Dynamics 365 Commerce の販売時点管理 (POS) で顧客管理機能を有効にする方法について説明します。

店舗の関係者が POS で顧客レコードを作成および編集できることが重要です。 このようにして、電子メール アドレス、電話番号、住所などの顧客情報の更新を取得できます。 これらのシステムの有効性は、顧客データの正確性に依存するため、この情報はマーケティングなどの下流システムで役立ちます。

販売担当者は、2 つの POS エントリ ポイントから顧客作成ワークフローをトリガーできます。 **顧客の追加** 操作にマップされているボタンを選択、もしくは検索結果のアプリ バーで **顧客の作成** を選択できます。 どちらの場合も、**新規顧客** ダイアログ ボックスが表示され、販売担当者は、顧客の名前、電子メール アドレス、電話番号、住所、およびビジネスに関連する追加情報など、必要な顧客の詳細情報を入力できます。 この追加情報は、顧客に関連付けられている顧客属性を使用して取得できます。 顧客属性の詳細については、[顧客属性](dev-itpro/customer-attributes.md)を参照してください。

販売担当者は、副次的な電子メール アドレスと電話番号を取得することもできます。 また、それらの副次的な電子メール アドレスまたは電話番号を介してマーケティング情報を受け取る顧客の好みを取得できます。 この機能を有効にするには、小売業者は、Commerce 本社の **機能管理** ワークスペースで **複数の電子メール アドレスと電話番号を取得し、これら連絡先でのマーケティングに同意する** 機能をオンにする必要があります (**システム管理 \> ワークスペース \> 機能管理**)。

## <a name="default-customer-properties"></a>既定の顧客プロパティ

小売業者は、Commerce 本社 の **すべての店舗** ページ (**Retail と Commerce \> チャネル \> 店舗**) を使用して、既定の顧客を各店舗に関連付けることができます。 次に、Commerce は、既定の顧客に定義されたプロパティを、作成された全ての新しい顧客レコードにコピーします。 たとえば、**顧客の作成** ダイアログ ボックスには、店舗に関連付けられている既定の顧客から継承されたプロパティが表示されます。 このプロパティには、**顧客タイプ**、**顧客グループ**、**レシートのオプション**、**メールの受信**、**通貨**、**言語** が含まれます。 **所属** (顧客のグループ) も既定の顧客から継承されます。 ただし、**財務分析コード** は、既定の顧客自体からではなく、既定の顧客に関連付けられている顧客グループから継承されます。

> [!NOTE]
> 新しく作成された顧客に対してレシート電子メールIDが指定されていない場合にのみ、**レシートの電子メール** の値が既定の顧客からコピーされます。 つまり、既定の顧客にレシートのメールIDが存在する場合、顧客からレシートのメールIDを取得するユーザー インターフェースがないため、eコマースのサイトから作成されたすべての顧客が同じレシートのメールIDを取得することになります。 店舗の既定の顧客に対する **レシートの電子メール** のフィールドを空白にし、レシートの電子メール アドレスが必要な業務プロセスがある場合にのみ使用することをお勧めします。 

販売担当者は、1 人の顧客に対して複数の住所を取り込む場合があります。 顧客の名前と電話番号は、各住所に関連付けられている連絡先情報から継承されます。 顧客レコードの **住所** クイック タブには、販売担当者が編集できる **目的** フィールドが含まれています。 顧客タイプが **個人** の場合、既定値は **自宅** になります。 顧客タイプが **組織** の場合、既定値は **勤務先** になります。 このフィールドがサポートするその他の値には、**自宅**、**オフィス**、および **ポスト** が含まれます。 住所の **国** フィールドの値は、**組織管理 \> 組織 \> 作業単位** の Commerce 本社にある **作業単位** ページで指定された基本住所から継承されます。

## <a name="sync-customers-and-async-customers"></a>顧客の同期と顧客の非同期

> [!IMPORTANT]
> POS がオフラインになると、非同期顧客作成モードが無効になっている場合でも、システムは自動的に顧客を非同期で作成します。 したがって、同期顧客または非同期顧客の作成の選択にかかわらず、Commerce 本社の管理者は、**P ジョブ**、**非同期モードから顧客とビジネス パートナーを同期する** ジョブ  (旧 **非同期モードから顧客とビジネス パートナーを同期する** ジョブ)、および **1010** ジョブに対して定期的なバッチ ジョブを作成しスケジュールする必要があります。これにより、非同期顧客は Commerce 本社で同期顧客に変換されます。

Commerce には、同期と非同期の 2 つの顧客作成モードがあります。 既定では、顧客は同期的に作成されます。 つまり、これらはリアルタイムに Commerce 本社に作成されます。 同期顧客作成モードは、新しい顧客をチャネル間で検索するのに役立ちます。 ただし、欠点もあります。 Commerce 本社への [Commerce Data Exchange: リアルタイム サービス](dev-itpro/define-retail-channel-communications-cdx.md#realtime-service)呼び出しを生成するため、多数の顧客作成呼び出しが同時に行われると、パフォーマンスに影響を与える可能性があります。

店舗の機能プロファイルで **顧客を非同期モードで作成** オプションが **はい** に設定されている場合 (**Retail と Commerce \> チャネル設定 \> オンライン ストアの設定 \> 機能プロファイル**)、チャネル データベースに顧客レコードを作成するためにリアルタイム サービス コールは使用されません。 非同期顧客作成モードは、Commerce 本社のパフォーマンスには影響しません。 一時的なグローバル固有識別子 (GUID) は、すべての新しい非同期顧客レコードに割り当てられ、顧客 ID として使用されます。 この GUID は、POS ユーザーには示されません。 代わりに、これらのユーザーには、顧客 ID として **同期を保留中** と表示されます。 

### <a name="convert-async-customers-to-sync-customers"></a>非同期顧客を同期顧客に変換する

非同期顧客を同期顧客に変換するには、最初に **P ジョブ** を実行して、非同期顧客を Commerce 本社に送信する必要があります。 次に、**非同期モードから顧客とビジネス パートナーを同期する** ジョブ (旧 **非同期モードから顧客とビジネス パートナーを同期する** ジョブ) を実行し、顧客アカウント ID を作成します。 最後に、**1010** ジョブを実行して、新しい顧客 ID をチャネルに同期します。

### <a name="async-customer-limitations"></a>非同期顧客の制限

現在、非同期顧客機能には次の制限があります。

- 顧客が Commerce 本社で作成され、新しい顧客 ID がチャネルに同期されない限り、非同期顧客レコードを編集することはできません。 したがって、顧客アドレスの追加は顧客プロファイルの編集操作として内部で実装されているため、その顧客が Commerce 本社に同期されるまで、非同期顧客のアドレスを保存することはできません。 ただし、**顧客アドレスの非同期作成を有効にする** 機能が有効になっている場合、非同期顧客でも顧客アドレスを保存することができます。
- 所属を非同期顧客に関連付けることはできません。 したがって、新しい非同期顧客は、既定の顧客から所属を継承しません。
- 新しい顧客 ID をチャネルに同期しない限り、ロイヤルティ カードを非同期顧客に発行することはできません。
- 非同期顧客は、副次的な電子メール アドレスと電話番号を取得できません。

前述のいくつかの制限により、ビジネスのために同期顧客オプションを選択したいと思うかもしれませんが、Commerce チームは、非同期顧客の機能を同期顧客の機能により近づけるように取り組んでいます。 たとえば、Commerce バージョン 10.0.22 リリースの時点で、**機能管理** ワークスペースで有効にできる新しい **顧客アドレスの非同期作成を有効にする** 機能は、新しく作成された顧客アドレスを、同期顧客と非同期顧客両方で保存します。 Commerce 本社の顧客プロファイルにこれらのアドレスを保存するには、**P ジョブ**、**非同期モードから顧客とビジネス パートナーを同期する** ジョブ、および  **1010** ジョブの定期的なバッチ ジョブをスケジュールする必要があります。これにより、すべての非同期顧客が Commerce 本社で同期顧客に変換されます。

### <a name="customer-creation-in-pos-offline-mode"></a>POS オフライン モードでの顧客作成

POS がオフラインになると、非同期顧客作成モードが無効になっている場合でも、システムは自動的に顧客を非同期で作成します。 したがって、既述のように、Commerce 本社の管理者は、**P ジョブ**、**非同期モードからの顧客とビジネス パートナーの同期** ジョブ、および **1010** ジョブの定期的なバッチ ジョブを作成およびスケジュールする必要があります。これにより、非同期顧客が Commerce 本社で同期顧客に変換されます。

> [!NOTE]
> **コマース チャネル スキーマ** ページで **共有顧客データ テーブルのフィルター** オプションが **はい** に設定されている場合 (**Retail と Commerce \> 本社の設定 \> コマース スケジューラ \> チャネル データベース グループ**)、顧客レコードは POS オフライン モードでは作成されません。 詳細については、[オフライン データの除外](dev-itpro/implementation-considerations-cdx.md#offline-data-exclusion)を参照してください。

## <a name="additional-resources"></a>追加リソース

[顧客属性](dev-itpro/customer-attributes.md)

[オフライン データの除外](dev-itpro/implementation-considerations-cdx.md#offline-data-exclusion)
