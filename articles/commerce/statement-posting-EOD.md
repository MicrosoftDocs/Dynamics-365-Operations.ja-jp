---
title: 明細書転記機能の改良
description: このトピックでは、明細書転記の機能に加えられた機能強化事項について説明します。
author: josaw1
manager: AnnBe
ms.date: 05/14/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: retail
ms.author: anpurush
ms.search.validFrom: 2018-04-30
ms.dyn365.ops.version: AX 7.0.0, Retail July 2017 update
ms.openlocfilehash: 68abef8f28c04a4f6f88e638c8abf944d06a32c4
ms.sourcegitcommit: 199848e78df5cb7c439b001bdbe1ece963593cdb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/13/2020
ms.locfileid: "4413824"
---
# <a name="improvements-to-statement-posting-functionality"></a><span data-ttu-id="2435d-103">明細書転記機能の改良</span><span class="sxs-lookup"><span data-stu-id="2435d-103">Improvements to statement posting functionality</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="2435d-104">このトピックでは、明細書転記の機能に加えられた最初の一連の機能強化事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="2435d-104">This topic describes the first set of improvements that have been made to the statement posting feature.</span></span> <span data-ttu-id="2435d-105">これらの機能強化事項は、Microsoft Dynamics 365 for Finance and Operations 7.3.2 で利用可能です。</span><span class="sxs-lookup"><span data-stu-id="2435d-105">These improvements are available in Microsoft Dynamics 365 for Finance and Operations 7.3.2.</span></span>

## <a name="activation"></a><span data-ttu-id="2435d-106">アクティブ化</span><span class="sxs-lookup"><span data-stu-id="2435d-106">Activation</span></span>

<span data-ttu-id="2435d-107">既定では、Finance and Operations 7.3.2 の展開中に、プログラムは明細書転記のレガシ機能を使用するために設定されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-107">By default, during deployment of Finance and Operations 7.3.2, the program is set up to use the legacy feature for statement postings.</span></span> <span data-ttu-id="2435d-108">改良された明細書転記機能を有効にするには、そのためのコンフィギュレーション キーをオンにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-108">To enable the improved statement posting feature, you must turn on the configuration key for it.</span></span>

- <span data-ttu-id="2435d-109">**システム管理** \> **設定** \> **ライセンス コンフィギュレーション** の順に移動し、その後、**Retail と Commerce** ノードで、**明細書 (従来)** チェック ボックスを消去し、**明細書** チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="2435d-109">Go to **System administration** \> **Setup** \> **License configuration**, and then, under the **Retail and Commerce** node, clear the **Statements (legacy)** check box, and select the **Statements** check box.</span></span>

<span data-ttu-id="2435d-110">新しい **明細書** コンフィギュレーション キーが有効になると、**明細書** という新しいメニュー項目が使用できます。</span><span class="sxs-lookup"><span data-stu-id="2435d-110">When the new **Statements** configuration key is turned on, a new menu item that is named **Statements** is available.</span></span> <span data-ttu-id="2435d-111">このメニュー項目は手動で作成、計算、および明細書の転記をすることができます。</span><span class="sxs-lookup"><span data-stu-id="2435d-111">This menu item lets you manually create, calculate, and post statements.</span></span> <span data-ttu-id="2435d-112">バッチの転記プロセスを使用する際にエラーが生じるステートメントは、このメニュー項目を通して使用可能にもなります。</span><span class="sxs-lookup"><span data-stu-id="2435d-112">Any statement that causes an error when the batch posting process is used will also be available through this menu item.</span></span> <span data-ttu-id="2435d-113">(新しい **明細書 (従来)** コンフィギュレーション キーが有効になると、メニュー項目は **未処理の明細書** と呼ばれます。)</span><span class="sxs-lookup"><span data-stu-id="2435d-113">(When the **Statements (legacy)** configuration key is turned on, the menu item is named **Open statements**.)</span></span>

<span data-ttu-id="2435d-114">コマースには、これらのコンフィギュレーション キーに関連付けられている以下の検証が含まれています。</span><span class="sxs-lookup"><span data-stu-id="2435d-114">Commerce includes the following validations that are related to these configuration keys:</span></span>

- <span data-ttu-id="2435d-115">両方のコンフィギュレーション キーを、同時に有効にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="2435d-115">Both configuration keys can't be turned on at the same time.</span></span>
- <span data-ttu-id="2435d-116">ライフサイクル (作成、計算、消去、転記など) の間に指定された明細書上で実行されるすべての工程に対して、同じコンフィギュレーション キーを使用する必要があります 。</span><span class="sxs-lookup"><span data-stu-id="2435d-116">The same configuration keys must be used for all the operations that are performed on a given statement during its lifecycle (Create, Calculate, Clear, Post, and so on).</span></span> <span data-ttu-id="2435d-117">たとえば、**明細書 (従来)** コンフィギュレーション キーが有効である間は、明細書の作成や計算をすることはできません。さらに **明細書** コンフィギュレーション キーが有効である間は、同じ明細書を転記しようとします。</span><span class="sxs-lookup"><span data-stu-id="2435d-117">For example, you can't create and calculate a statement while the **Statement (legacy)** configuration key is turned on, and then try to post the same statement while the **Statement** configuration key is turned on.</span></span>

> [!NOTE]
> <span data-ttu-id="2435d-118">**明細書 (従来)** コンフィギュレーション キーを代わりに使用するやむを得ない理由がない限り、改良された明細書転記機能の **明細書** コンフィギュレーション キーを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-118">We recommend that you use the **Statements** configuration key for the improved statement posting feature, unless you have compelling reasons to use the **Statements (legacy)** configuration key instead.</span></span> <span data-ttu-id="2435d-119">Microsoft は新しい改良された明細書転記機能に投資し続けるため、ユーザーが益を得るには早期にそれに切り替えることが重要です。</span><span class="sxs-lookup"><span data-stu-id="2435d-119">Microsoft will continue to invest in the new and improved statement posting feature, and it's important that you switch to it at the earliest opportunity to benefit from it.</span></span> <span data-ttu-id="2435d-120">従来の明細書転記機能は、8.0 リリースから廃止される予定です。</span><span class="sxs-lookup"><span data-stu-id="2435d-120">The legacy statement posting feature is deprecated starting in 8.0 release.</span></span>

## <a name="setup"></a><span data-ttu-id="2435d-121">セットアップ</span><span class="sxs-lookup"><span data-stu-id="2435d-121">Setup</span></span>

<span data-ttu-id="2435d-122">明細書転記機能の改良の一環として、**パラメーター** ページの **転記** タブの **明細書** クイック タブで、3 つの新しいパラメーターが導入されました。</span><span class="sxs-lookup"><span data-stu-id="2435d-122">As part of the improvements to the statement posting feature, three new parameters have been introduced on the **Statement** FastTab on the **Posting** tab of the **Commerce parameters** page:</span></span>

- <span data-ttu-id="2435d-123">**明細書のクリアを無効にする**– このオプションは、従来の明細書転記機能に対してのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-123">**Disable clear statement** – This option is applicable only for the legacy statement posting feature.</span></span> <span data-ttu-id="2435d-124">このオプションを **いいえ** に設定して、ユーザーが半転記の状態になっている明細書を削除するのを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="2435d-124">We recommend that you set this option to **No** to prevent users from clearing statements that are in a semi-posted state.</span></span> <span data-ttu-id="2435d-125">半転記の状態になっている明細書が削除されると、データが破損します。</span><span class="sxs-lookup"><span data-stu-id="2435d-125">If statements that are in a semi-posted state are cleared, data becomes corrupted.</span></span> <span data-ttu-id="2435d-126">特別な事情でのみ、このオプションを **はい** に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-126">You should set this option to **Yes** only in exceptional circumstances.</span></span>
- <span data-ttu-id="2435d-127">**計算時に在庫を引き当てる**– 在庫引当の **在庫の転記** バッチ ジョブを使用し、このオプションを **いいえ** に設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-127">**Reserve inventory during calculation** – We recommend that you use the **Post inventory** batch job for inventory reservation, and that you set this option to **No**.</span></span> <span data-ttu-id="2435d-128">このオプションを **いいえ** に設定すると、改良された明細書転記機能は、計算時に在庫引当のエントリを作成しようとしません (エントリが **在庫の転記** バッチ ジョブを通してまだ作成されていない場合)。</span><span class="sxs-lookup"><span data-stu-id="2435d-128">When this option is set to **No**, the improved statement posting feature doesn't try to create inventory reservation entries at the time of calculation (if entries weren't already created through the **Post inventory** batch job).</span></span> <span data-ttu-id="2435d-129">代わりに、機能は転記時にのみ、在庫引当のエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="2435d-129">Instead, the feature creates inventory reservation entries only at the time of posting.</span></span> <span data-ttu-id="2435d-130">この実装は設計上の選択であり、計算プロセスおよび転記プロセス間の時間枠が典型的に小さいという事実に基づいていました。</span><span class="sxs-lookup"><span data-stu-id="2435d-130">This implementation was a design choice and was based on the fact that the time window between the calculation process and the posting process is typically small.</span></span> <span data-ttu-id="2435d-131">ただし、計算時に在庫引当を行う場合は、このオプションを **はい** に設定できます。</span><span class="sxs-lookup"><span data-stu-id="2435d-131">However, if you want to reserve inventory at the time of calculation, you can set this option to **Yes**.</span></span>

    <span data-ttu-id="2435d-132">このオプションの設定に関係なく、従来の明細書転記機能によって、明細書の計算プロセス中に常に在庫が引当られます (引当が **在庫の転記** バッチ ジョブを通してまだ行われていない場合)。</span><span class="sxs-lookup"><span data-stu-id="2435d-132">The legacy statement posting feature always reserves inventory during the statement calculation process (if reservation wasn't already done through the **Post inventory** batch job), regardless of the setting of this option.</span></span>

- <span data-ttu-id="2435d-133">**棚卸を無効化する必要がある** – このオプションを **はい** に設定すると、明細書の計算済金額とトランザクション金額の差額が、店舗の **明細書** クイック タブで定義されるしきい値以外であっても、明細書の転記プロセスが続行されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-133">**Disable counting required** – When this option is set to **Yes**, the posting process for a statement continues, even if the difference between the counted amount and the transaction amount on the statement is outside the threshold that is defined on the **Statement** FastTab for stores.</span></span>

<span data-ttu-id="2435d-134">また、**コマース パラメーター** ページの **転記** タブの **バッチ処理** クイック タブに次のパラメーターが導入されました。</span><span class="sxs-lookup"><span data-stu-id="2435d-134">Additionally, the following parameters have been introduced on the **Batch processing** FastTab on the **Posting** tab of the **Commerce parameters** page:</span></span> 

- <span data-ttu-id="2435d-135">**同時に転記する明細書の最大数** – このフィールドは、複数の明細書の転記に使用されるバッチ タスクの数を定義します。</span><span class="sxs-lookup"><span data-stu-id="2435d-135">**Maximum number of parallel statement posting** – This field defines the number of batch tasks that will be used to post multiple statements.</span></span> 
- <span data-ttu-id="2435d-136">**明細書ごとの注文処理の最大スレッド** – このフィールドは、1 つの明細書の販売注文を作成および請求するために、明細書の転記バッチ ジョブで使用されるスレッドの最大数を表します。</span><span class="sxs-lookup"><span data-stu-id="2435d-136">**Max thread for order processing per statement** – This field represents the maximum number of threads used by the statement posting batch job to create and invoice sales orders for a single statement.</span></span> <span data-ttu-id="2435d-137">明細書の転記プロセスで使用されるスレッドの総数は、このパラメーターの値に **同時に転記する明細書の最大数** パラメーターを掛けた値に基づいて計算されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-137">The total number of threads that will be used by the statement posting process will be computed based on the value in this parameter multiplied by the value in the **Maximum number of parallel statement posting** parameter.</span></span> <span data-ttu-id="2435d-138">このパラメーターの値を高く設定しすぎると、明細書転記プロセスのパフォーマンスに悪影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-138">Setting the value of this parameter too high can negatively impact the performance of the statement posting process.</span></span>
- <span data-ttu-id="2435d-139">**集計に含まれる最大トランザクション明細行** – このフィールドは、新しいトランザクションが作成される前に、1 つの集計トランザクションに含まれるトランザクション明細行の番号を定義します。</span><span class="sxs-lookup"><span data-stu-id="2435d-139">**Max transaction lines included in aggregation** – This field defines the number of transaction lines that will be included in a single aggregated transaction before a new one is created.</span></span> <span data-ttu-id="2435d-140">集計トランザクションは、顧客、営業日、財務分析コードなどのさまざまな集計基準に基づいて作成されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-140">Aggregated transactions are created based on different aggregation criteria such as customer, business date, or financial dimensions.</span></span> <span data-ttu-id="2435d-141">1 つのトランザクションからの行が異なる集計トランザクションに分割されないことに注意することが重要です。</span><span class="sxs-lookup"><span data-stu-id="2435d-141">It is important to note that the lines from a single transaction will not be split across different aggregated transactions.</span></span> <span data-ttu-id="2435d-142">これは、集計トランザクションの行数が、特徴的製品の数などの要因に基づいて若干増減する可能性があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="2435d-142">This means that there is a possibility that the number of lines in a aggregated transaction is slightly higher or lower based on factors such as number of distinct products.</span></span>
- <span data-ttu-id="2435d-143">**店舗トランザクションを検証するスレッドの最大数** – このフィールドは、トランザクションの検証に使用されるスレッド数を定義します。</span><span class="sxs-lookup"><span data-stu-id="2435d-143">**Maximum number of threads to validate store transactions** – This field defines the number of threads that will be used to validate transactions.</span></span> <span data-ttu-id="2435d-144">トランザクションの検証は、トランザクションが明細書に取り込まれる前に行われる必要がある必須ステップです。</span><span class="sxs-lookup"><span data-stu-id="2435d-144">Validating transactions is a required step that needs to occur before the transactions can be pulled into the statements.</span></span> <span data-ttu-id="2435d-145">また、**コマース パラメーター** ページの **転記** タブ上にある **ギフト カード** クイック タブの **ギフト カード製品** を定義する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="2435d-145">You also need to define a **Gift card product** on the **Gift card** FastTab on the **Posting** tab of the **Commerce parameters** page.</span></span> <span data-ttu-id="2435d-146">ギフト カードが組織によって使用されていない場合でも、これを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-146">This needs to defined even if gift cards are not used by the organization.</span></span>

> [!NOTE]
> <span data-ttu-id="2435d-147">明細書転記に関連する、さらに小売店舗および **コマース パラメーター** ページで定義されるすべての設定およびパラメーターが、改良された明細書転記機能に適用されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-147">All settings and parameters that are related to statement postings, and that are defined on stores and on the **Commerce parameters** page, are applicable to the improved statement posting feature.</span></span>

## <a name="processing"></a><span data-ttu-id="2435d-148">処理中</span><span class="sxs-lookup"><span data-stu-id="2435d-148">Processing</span></span>

<span data-ttu-id="2435d-149">明細書は、**明細書をバッチ計算する** および **明細書をバッチ転記する** のメニュー項目を使用して、バッチで計算および転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-149">Statements can be calculated and posted in batch using the menu items **Calculate statements in batch** and **Post statements in batch**.</span></span> <span data-ttu-id="2435d-150">また、明細書は、改良された明細書転記機能が提供する **明細書** メニュー項目を使用して、手動で計算および転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-150">Alternatively, statements can be manually calculated and posted by using the **Statements** menu item that the improved statement posting feature provides.</span></span>

<span data-ttu-id="2435d-151">バッチで明細書を計算および転記するプロセスと手順は、従来の明細書転記機能でのものと同じです。</span><span class="sxs-lookup"><span data-stu-id="2435d-151">The process and steps for calculating and posting statements in a batch are the same as they were in the legacy statement posting feature.</span></span> <span data-ttu-id="2435d-152">ただし、大幅な改良が、明細書のコア バックエンド処理に加えられています。</span><span class="sxs-lookup"><span data-stu-id="2435d-152">However, significant improvements have been made in the core back-end processing of the statements.</span></span> <span data-ttu-id="2435d-153">これらの改良は、プロセスをより強くし、状態およびエラー情報への可視性を高めます。</span><span class="sxs-lookup"><span data-stu-id="2435d-153">These improvements make the process more resilient, and provide for better visibility into the states and error information.</span></span> <span data-ttu-id="2435d-154">したがって、ユーザーはエラーの根本原因に対処でき、必要になるデータ破損およびデータ修正の発生なしで、転記プロセスを続行できます。</span><span class="sxs-lookup"><span data-stu-id="2435d-154">Therefore, users can address the root cause of errors and then continue the posting process without causing data corruption and without causing data fixes to be required.</span></span>

<span data-ttu-id="2435d-155">次のセクションでは、明細書および転記済明細書のユーザー インターフェイスに表示される、明細書転記機能の主要な改良点のいくつかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="2435d-155">The following sections describe some of the major improvements for the statement posting feature that appear in the user interface for statements and posted statements.</span></span>

### <a name="status-details"></a><span data-ttu-id="2435d-156">状態の詳細</span><span class="sxs-lookup"><span data-stu-id="2435d-156">Status details</span></span>

<span data-ttu-id="2435d-157">計算および転記プロセス間の明細書転記ルーティンに、新しい状態モデルが導入されました。</span><span class="sxs-lookup"><span data-stu-id="2435d-157">A new state model has been introduced in the statement posting routine across the calculation and posting processes.</span></span>

<span data-ttu-id="2435d-158">次の表では、計算プロセス中のさまざまな状態およびその順序について説明します。</span><span class="sxs-lookup"><span data-stu-id="2435d-158">The following table describes the various states and their order during the calculation process.</span></span>

| <span data-ttu-id="2435d-159">注文の状態</span><span class="sxs-lookup"><span data-stu-id="2435d-159">State order</span></span> | <span data-ttu-id="2435d-160">行政単位 (区画)</span><span class="sxs-lookup"><span data-stu-id="2435d-160">State</span></span>      | <span data-ttu-id="2435d-161">説明</span><span class="sxs-lookup"><span data-stu-id="2435d-161">Description</span></span> |
|-------------|------------|-------------|
| <span data-ttu-id="2435d-162">1</span><span class="sxs-lookup"><span data-stu-id="2435d-162">1</span></span>           | <span data-ttu-id="2435d-163">開始済</span><span class="sxs-lookup"><span data-stu-id="2435d-163">Started</span></span>    | <span data-ttu-id="2435d-164">明細書が作成され、計算の準備ができています。</span><span class="sxs-lookup"><span data-stu-id="2435d-164">The statement was created and is ready to be calculated.</span></span> |
| <span data-ttu-id="2435d-165">2</span><span class="sxs-lookup"><span data-stu-id="2435d-165">2</span></span>           | <span data-ttu-id="2435d-166">マーク済</span><span class="sxs-lookup"><span data-stu-id="2435d-166">Marked</span></span>     | <span data-ttu-id="2435d-167">明細書の範囲にあるトランザクションは、明細書パラメーターに基づいて識別され、明細書 ID でマークされています。</span><span class="sxs-lookup"><span data-stu-id="2435d-167">The transactions that are in scope for the statement are identified based on the statement parameters, and they are marked with the statement ID.</span></span> |
| <span data-ttu-id="2435d-168">3</span><span class="sxs-lookup"><span data-stu-id="2435d-168">3</span></span>           | <span data-ttu-id="2435d-169">計算済</span><span class="sxs-lookup"><span data-stu-id="2435d-169">Calculated</span></span> | <span data-ttu-id="2435d-170">明細行が計算され、表示されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-170">The statement lines are computed and shown.</span></span> |

<span data-ttu-id="2435d-171">次の表では、転記プロセス中のさまざまな状態およびその順序について説明します。</span><span class="sxs-lookup"><span data-stu-id="2435d-171">The following table describes the various states and their order during the posting process.</span></span>

| <span data-ttu-id="2435d-172">注文の状態</span><span class="sxs-lookup"><span data-stu-id="2435d-172">State order</span></span> | <span data-ttu-id="2435d-173">行政単位 (区画)</span><span class="sxs-lookup"><span data-stu-id="2435d-173">State</span></span>                   | <span data-ttu-id="2435d-174">説明</span><span class="sxs-lookup"><span data-stu-id="2435d-174">Description</span></span> |
|-------------|-------------------------|-------------|
| <span data-ttu-id="2435d-175">1</span><span class="sxs-lookup"><span data-stu-id="2435d-175">1</span></span>           | <span data-ttu-id="2435d-176">確認済</span><span class="sxs-lookup"><span data-stu-id="2435d-176">Checked</span></span>                 | <span data-ttu-id="2435d-177">複数の検証は、パラメーター (たとえば、廃棄請求金額)、および明細書と明細行 (たとえば、計算済金額とトランザクション金額の差額) に関連して行われます。</span><span class="sxs-lookup"><span data-stu-id="2435d-177">Multiple validations are done that are related to parameters (for example, the disposition charge), and to the statement and statement lines (for example, the difference between the counted amount and the transaction amount).</span></span> |
| <span data-ttu-id="2435d-178">2</span><span class="sxs-lookup"><span data-stu-id="2435d-178">2</span></span>           | <span data-ttu-id="2435d-179">集計</span><span class="sxs-lookup"><span data-stu-id="2435d-179">Aggregated</span></span>              | <span data-ttu-id="2435d-180">名前付きおよび名前のない顧客の販売トランザクションは、コンフィギュレーションに基づいて集計されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-180">Sales transactions for named and unnamed customers are aggregated based on the configuration.</span></span> <span data-ttu-id="2435d-181">すべての集計トランザクションが最終的に、販売注文に変換されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-181">Every aggregated transaction is eventually converted to a sales order.</span></span> |
| <span data-ttu-id="2435d-182">3</span><span class="sxs-lookup"><span data-stu-id="2435d-182">3</span></span>           | <span data-ttu-id="2435d-183">顧客注文が作成されました</span><span class="sxs-lookup"><span data-stu-id="2435d-183">Customer order created</span></span>  | <span data-ttu-id="2435d-184">集計されたトランザクションに基づき、販売注文がシステムで作成されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-184">Based on the aggregated transaction, sales orders are created in the system.</span></span> |
| <span data-ttu-id="2435d-185">4</span><span class="sxs-lookup"><span data-stu-id="2435d-185">4</span></span>           | <span data-ttu-id="2435d-186">販売注文が請求されました</span><span class="sxs-lookup"><span data-stu-id="2435d-186">Customer order invoiced</span></span> | <span data-ttu-id="2435d-187">販売注文が請求されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-187">Sales orders are invoiced.</span></span> |
| <span data-ttu-id="2435d-188">5</span><span class="sxs-lookup"><span data-stu-id="2435d-188">5</span></span>           | <span data-ttu-id="2435d-189">割引が転記されました</span><span class="sxs-lookup"><span data-stu-id="2435d-189">Discounts posted</span></span>        | <span data-ttu-id="2435d-190">期間割引仕訳帳がコンフィギュレーションに基づいて転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-190">Periodic discount journals are posted based on the configuration.</span></span> |
| <span data-ttu-id="2435d-191">6</span><span class="sxs-lookup"><span data-stu-id="2435d-191">6</span></span>           | <span data-ttu-id="2435d-192">収入/経費が転記されました</span><span class="sxs-lookup"><span data-stu-id="2435d-192">Income/expense posted</span></span>   | <span data-ttu-id="2435d-193">収入/経費トランザクションは、伝票として転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-193">Income/expense transactions are posted as vouchers.</span></span> |
| <span data-ttu-id="2435d-194">7</span><span class="sxs-lookup"><span data-stu-id="2435d-194">7</span></span>           | <span data-ttu-id="2435d-195">伝票がリンクされました</span><span class="sxs-lookup"><span data-stu-id="2435d-195">Vouchers linked</span></span>         | <span data-ttu-id="2435d-196">支払仕訳帳が作成され、対応する請求書にリンクされています。</span><span class="sxs-lookup"><span data-stu-id="2435d-196">Payment journals are created and linked to the corresponding invoice.</span></span> |
| <span data-ttu-id="2435d-197">8</span><span class="sxs-lookup"><span data-stu-id="2435d-197">8</span></span>           | <span data-ttu-id="2435d-198">支払が転記されました</span><span class="sxs-lookup"><span data-stu-id="2435d-198">Payments posted</span></span>         | <span data-ttu-id="2435d-199">支払仕訳帳が転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-199">Payment journals are posted.</span></span> |
| <span data-ttu-id="2435d-200">9</span><span class="sxs-lookup"><span data-stu-id="2435d-200">9</span></span>           | <span data-ttu-id="2435d-201">ギフト カードが転記されました</span><span class="sxs-lookup"><span data-stu-id="2435d-201">Gift cards posted</span></span>       | <span data-ttu-id="2435d-202">ギフト カード トランザクションは、伝票として転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-202">Gift card transactions are posted as vouchers.</span></span> |
| <span data-ttu-id="2435d-203">10</span><span class="sxs-lookup"><span data-stu-id="2435d-203">10</span></span>          | <span data-ttu-id="2435d-204">投稿済</span><span class="sxs-lookup"><span data-stu-id="2435d-204">Posted</span></span>                  | <span data-ttu-id="2435d-205">転記済として明細書がマークされます。</span><span class="sxs-lookup"><span data-stu-id="2435d-205">The statement is marked as posted.</span></span> |

<span data-ttu-id="2435d-206">前の表でのそれぞれの状態は本質的に依存せず、階層構造の依存関係は状態間で構築されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-206">Every state in the preceding tables is independent in nature, and a hierarchical dependency is built between the states.</span></span> <span data-ttu-id="2435d-207">この依存関係は、上から下へ流れます。</span><span class="sxs-lookup"><span data-stu-id="2435d-207">This dependency flows from top to bottom.</span></span> <span data-ttu-id="2435d-208">状態を処理している間に、システムに任意のエラーが発生すると、明細書の状態は、前の状態に戻されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-208">If the system encounters any errors while it's processing a state, the status of the statement is reverted to the previous state.</span></span> <span data-ttu-id="2435d-209">プロセスに続く再試行は、失敗した状態から再開し、移行し続けます。</span><span class="sxs-lookup"><span data-stu-id="2435d-209">Any subsequent reattempt of the process resumes from the state that failed and continues to move forward.</span></span> <span data-ttu-id="2435d-210">このアプローチには、次の利点があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-210">This approach has the following benefits:</span></span>

- <span data-ttu-id="2435d-211">ユーザーには、エラーが発生した状態への完全な可視性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-211">The user has complete visibility into the state where the error occurred.</span></span>
- <span data-ttu-id="2435d-212">データの破損が回避されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-212">Data corruption is avoided.</span></span> <span data-ttu-id="2435d-213">たとえば、従来の明細書転記機能では、いくつかの販売注文が請求されても、他のユーザーが開いているというインスタンスがありました。</span><span class="sxs-lookup"><span data-stu-id="2435d-213">For example, in the legacy statement posting feature, there were instances where some sales orders were invoiced but others were left open.</span></span> <span data-ttu-id="2435d-214">請求書の転記にエラーがあったために、一部の支払仕訳帳には決済するための対応する請求書がないというインスタンスもありました。</span><span class="sxs-lookup"><span data-stu-id="2435d-214">There were also instances where some payment journals didn't have a corresponding invoice to settle, because the invoice posting had an error.</span></span>
- <span data-ttu-id="2435d-215">ユーザーは、明細書の **実行の詳細** グループで **状態の詳細** ボタンを使用して、明細書の現在の状態を表示できます。</span><span class="sxs-lookup"><span data-stu-id="2435d-215">Users can see the current state of a statement by using the **Status details** button in the **Execution details** group of the statement.</span></span> <span data-ttu-id="2435d-216">ステータスの詳細ページには、3 つのセクションがあります。</span><span class="sxs-lookup"><span data-stu-id="2435d-216">The status details page has three sections:</span></span>

    - <span data-ttu-id="2435d-217">最初のセクションでは、エラーが発生したかどうか、エラー コードおよび詳細なエラー メッセージと共に、明細書の現在の状態を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-217">The first section shows the current status of the statement, together with the error code and a detailed error message, if an error occurred.</span></span>
    - <span data-ttu-id="2435d-218">2 番目のセクションでは、計算プロセスのさまざまな状態を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-218">The second section shows the various states of the calculation process.</span></span> <span data-ttu-id="2435d-219">視覚キューは、正常に実行されてき状態、エラーが原因で実行できなかった状態、およびまだ実行されていない状態を示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-219">Visual cues indicate states that have been successfully run, states that could not be run because of errors, and states that haven't yet been run.</span></span>
    - <span data-ttu-id="2435d-220">3 番目のセクションでは、転記プロセスのさまざまな状態を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-220">The third section shows the various states of the posting process.</span></span> <span data-ttu-id="2435d-221">視覚キューは、正常に実行されてき状態、エラーが原因で実行できなかった状態、およびまだ実行されていない状態を示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-221">Visual cues indicate states that have been successfully run, states that could not be run because of errors, and states that haven't yet been run.</span></span>

<span data-ttu-id="2435d-222">また、2 番目と 3 番目のセクションのヘッダーは、関連するプロセスの全般的な状態を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-222">Additionally, the header of the second and third sections shows the overall status of the relevant process.</span></span>

### <a name="event-logs"></a><span data-ttu-id="2435d-223">イベント ログ</span><span class="sxs-lookup"><span data-stu-id="2435d-223">Event logs</span></span>

<span data-ttu-id="2435d-224">さまざまな操作 (たとえば、作成、計算、削除、および転記)、および同じ操作の複数のインスタンスを経た明細書は、明細書のライフサイクル中に呼び出される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-224">A statement goes through various operations (for example, Create, Calculate, Clear, and Post), and multiple instances of the same operation might be called during the statement's lifecycle.</span></span> <span data-ttu-id="2435d-225">たとえば、明細書が作成および計算された後、ユーザーは明細書を削除してもう一度計算することができます。</span><span class="sxs-lookup"><span data-stu-id="2435d-225">For example, after a statement is created and calculated, a user can clear the statement and calculate it again.</span></span> <span data-ttu-id="2435d-226">明細書の **実行の詳細** グループの **イベント ログ** ボタンは、それらの操作が呼び出されたときに関する情報と共に、明細書で呼び出されたさまざまな操作の完全な監査証跡を提供します。</span><span class="sxs-lookup"><span data-stu-id="2435d-226">The **Event logs** button in the **Execution details** group of the statement provides a complete audit trail of the various operations that were called on a statement, together with information about when those operations were called.</span></span>

### <a name="aggregated-transactions"></a><span data-ttu-id="2435d-227">集計トランザクション</span><span class="sxs-lookup"><span data-stu-id="2435d-227">Aggregated transactions</span></span>

<span data-ttu-id="2435d-228">転記プロセス中に、コンフィギュレーションに基づいて販売トランザクションが集計されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-228">During the posting process, the sales transactions are aggregated based on the configuration.</span></span> <span data-ttu-id="2435d-229">これらの集計トランザクションはシステムに格納され、販売注文を作成するのに使用されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-229">These aggregated transactions are stored in the system and used to create sales orders.</span></span> <span data-ttu-id="2435d-230">各集計トランザクションは、システムで対応する 1 つの販売注文を作成します。</span><span class="sxs-lookup"><span data-stu-id="2435d-230">Every aggregated transaction creates one corresponding sales order in the system.</span></span> <span data-ttu-id="2435d-231">ユーザーは、明細書の **実行の詳細** グループで **集計トランザクション** ボタンを使用して、集計トランザクションを表示できます。</span><span class="sxs-lookup"><span data-stu-id="2435d-231">You can view the aggregated transactions by using the **Aggregated transactions** button in the **Execution details** group of the statement.</span></span>

<span data-ttu-id="2435d-232">集計トランザクションの **販売注文の詳細** タブは、次の情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-232">The **Sales order detail** tab of an aggregated transaction shows the following information:</span></span>

- <span data-ttu-id="2435d-233">**レコード ID**– 集計トランザクションの ID。</span><span class="sxs-lookup"><span data-stu-id="2435d-233">**Record ID** – The ID of the aggregated transaction.</span></span>
- <span data-ttu-id="2435d-234">**明細書番号**– 集計トランザクションが属する明細書。</span><span class="sxs-lookup"><span data-stu-id="2435d-234">**Statement number** – The statement that the aggregated transaction belongs to.</span></span>
- <span data-ttu-id="2435d-235">**日付**– 集計トランザクションが作成された日付。</span><span class="sxs-lookup"><span data-stu-id="2435d-235">**Date** – The date when the aggregated transaction was created.</span></span>
- <span data-ttu-id="2435d-236">**販売 ID**– 販売注文が集計トランザクションから作成される場合、販売注文 ID。</span><span class="sxs-lookup"><span data-stu-id="2435d-236">**Sales ID** – When a sales order is created from the aggregated transaction, the sales order ID.</span></span> <span data-ttu-id="2435d-237">このフィールドが空白の場合、対応する販売注文が作成されていません。</span><span class="sxs-lookup"><span data-stu-id="2435d-237">If this field is blank, the corresponding sales order hasn't been created.</span></span>
- <span data-ttu-id="2435d-238">**集計行の数**– 集計トランザクションおよび販売注文の明細行の合計数。</span><span class="sxs-lookup"><span data-stu-id="2435d-238">**Number of aggregated lines** – The total number of lines for the aggregated transaction and sales order.</span></span>
- <span data-ttu-id="2435d-239">**状態**– 集計トランザクションの最後の状態。</span><span class="sxs-lookup"><span data-stu-id="2435d-239">**Status** – The last status of the aggregated transaction.</span></span>
- <span data-ttu-id="2435d-240">**請求書 ID**– 集計トランザクションの販売注文が請求される場合、売上請求書 ID。</span><span class="sxs-lookup"><span data-stu-id="2435d-240">**Invoice ID** – When the sales order for the aggregated transaction is invoiced, the sales invoice ID.</span></span> <span data-ttu-id="2435d-241">このフィールドが空白の場合、販売注文の請求書が転記されていません。</span><span class="sxs-lookup"><span data-stu-id="2435d-241">If this field is blank, the invoice for the sales order hasn't been posted.</span></span>

<span data-ttu-id="2435d-242">集計トランザクションの **トランザクションの詳細** タブは、集計されたトランザクションで引き出されたすべてのトランザクションを表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-242">The **Transaction details** tab of an aggregated transaction shows all the transactions that have been pulled into the aggregated transaction.</span></span> <span data-ttu-id="2435d-243">集計されたトランザクションの集計行は、トランザクションから集計されたすべてのレコードを表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-243">The aggregated lines on the aggregated transaction show all the aggregated records from the transactions.</span></span> <span data-ttu-id="2435d-244">集計行は、品目、バリアント、数量、価格、正味金額、単位、および倉庫などの詳細も表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-244">The aggregated lines also show details such as the item, variant, quantity, price, net amount, unit, and warehouse.</span></span> <span data-ttu-id="2435d-245">基本的に、各集計行は、1 つの販売注文明細行に対応します。</span><span class="sxs-lookup"><span data-stu-id="2435d-245">Basically, each aggregated line corresponds to one sales order line.</span></span>

<span data-ttu-id="2435d-246">**集計トランザクション** ページから、**販売注文を XML 形式でエクスポートする** ボタンを使用して、特定の集計トランザクションの XML をダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="2435d-246">From the **Aggregated transactions** page, you can download the XML for a specific aggregated transaction by using the **Export sales order XML** button.</span></span> <span data-ttu-id="2435d-247">XML を使用して、販売注文の作成および転記を含む問題をデバッグすることができます。</span><span class="sxs-lookup"><span data-stu-id="2435d-247">You can use the XML to debug issues that involve sales order creation and posting.</span></span> <span data-ttu-id="2435d-248">XML をダウンロードし、テスト環境にアップロードして、テスト環境での問題をデバッグします。</span><span class="sxs-lookup"><span data-stu-id="2435d-248">Just download the XML, upload it to a test environment, and debug the issue in the test environment.</span></span> <span data-ttu-id="2435d-249">集計トランザクションの XML をダウンロードするための機能は、転記された明細書では使用できません。</span><span class="sxs-lookup"><span data-stu-id="2435d-249">The functionality for downloading the XML for aggregated transactions isn't available for statements that have been posted.</span></span>

<span data-ttu-id="2435d-250">集計トランザクション ビューには、次の利点があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-250">The aggregated transaction view provides the following benefits:</span></span>

- <span data-ttu-id="2435d-251">ユーザーには、販売注文の作成中に失敗した集計トランザクションや、請求時に失敗した販売注文の可視性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-251">The user has visibility into the aggregated transactions that failed during sales order creation and the sales orders that failed during invoicing.</span></span>
- <span data-ttu-id="2435d-252">ユーザーには、トランザクションの集計方法への可視性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-252">The user has visibility into how transactions are aggregated.</span></span>
- <span data-ttu-id="2435d-253">ユーザーには、トランザクションから販売注文、売上請求書への完全な監査証跡があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-253">The user has a complete audit trail, from transactions, to sales orders, to sales invoices.</span></span> <span data-ttu-id="2435d-254">この監査証跡は、従来の明細書転記機能では使用できませんでした。</span><span class="sxs-lookup"><span data-stu-id="2435d-254">This audit trail wasn't available in the legacy statement posting feature.</span></span>
- <span data-ttu-id="2435d-255">集計された XML ファイルは、販売注文の作成および請求時に問題を識別しやすくします。</span><span class="sxs-lookup"><span data-stu-id="2435d-255">Aggregated XML file make it easier to identify issues during sales order creation and invoicing.</span></span>

### <a name="journal-vouchers"></a><span data-ttu-id="2435d-256">仕訳伝票</span><span class="sxs-lookup"><span data-stu-id="2435d-256">Journal vouchers</span></span>

<span data-ttu-id="2435d-257">明細書の **実行の詳細** グループの **仕訳伝票** ボタンは、明細書用に作成され、割引、収入/経費勘定、ギフト カードなどに関連するすべてのさまざまな伝票トランザクションを表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-257">The **Journal vouchers** button in the **Execution details** group of the statement shows all the various voucher transactions that are created for a statement, and that are related to discounts, income/expense accounts, gift cards, and so on.</span></span>

<span data-ttu-id="2435d-258">現時点では、プログラムは、転記済明細書のみに対するこのデータを表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-258">Currently, the program shows this data only for posted statements.</span></span>

### <a name="payment-journals"></a><span data-ttu-id="2435d-259">支払仕訳帳</span><span class="sxs-lookup"><span data-stu-id="2435d-259">Payment journals</span></span>

<span data-ttu-id="2435d-260">明細書の **実行の詳細** グループの **支払仕訳帳** ボタンは、明細書用に作成されるすべてのさまざまな支払仕訳帳を表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-260">The **Payment journals** button in the **Execution details** group of the statement shows all the various payment journals that are created for a statement.</span></span>

<span data-ttu-id="2435d-261">現時点では、プログラムは、転記済明細書のみに対するこのデータを表示します。</span><span class="sxs-lookup"><span data-stu-id="2435d-261">Currently, the program shows this data only for posted statements.</span></span>

## <a name="other-improvements"></a><span data-ttu-id="2435d-262">その他の改良</span><span class="sxs-lookup"><span data-stu-id="2435d-262">Other improvements</span></span>

<span data-ttu-id="2435d-263">その他、明細書転記の機能に加えられた、ユーザーが表示できるバックエンド改良点です。</span><span class="sxs-lookup"><span data-stu-id="2435d-263">Other, back-end improvements that users can see have been made to the statement posting feature.</span></span> <span data-ttu-id="2435d-264">次にいくつか例を挙げます。</span><span class="sxs-lookup"><span data-stu-id="2435d-264">Here are some examples:</span></span>

- <span data-ttu-id="2435d-265">集計はスタッフ、端末、シフト エンティティを考慮しません。</span><span class="sxs-lookup"><span data-stu-id="2435d-265">The aggregation doesn't consider the staff, terminal, and shift entities.</span></span> <span data-ttu-id="2435d-266">より少ない集計パラメーターがあるため、少ない販売注文明細行を処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-266">Because there are fewer aggregation parameters, fewer sales order lines must be processed.</span></span>
- <span data-ttu-id="2435d-267">トランザクション テーブルで発生したデッドロックは、拡張機能テーブルの追加を導入することによって、およびトランザクション テーブルでの更新操作ではなく挿入操作によって減らされます。</span><span class="sxs-lookup"><span data-stu-id="2435d-267">The occurrence of deadlock on transaction tables is reduced by introducing additional extension tables and by doing insert operations instead of update operations on the transaction tables.</span></span>
- <span data-ttu-id="2435d-268">実行中のバッチ タスクの数が、パラメーター化され制限されています。</span><span class="sxs-lookup"><span data-stu-id="2435d-268">The number of running batch tasks has been parameterized and limited.</span></span> <span data-ttu-id="2435d-269">したがって、この番号は、具体的に顧客の環境に対して微調整されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-269">Therefore, this number can be fine-tuned specifically to a customer's environment.</span></span> <span data-ttu-id="2435d-270">従来の明細書転記機能では、バッチ タスクは同時に無制限に作成されました。</span><span class="sxs-lookup"><span data-stu-id="2435d-270">In the legacy statement posting feature, an unlimited number of batch tasks was created at the same time.</span></span> <span data-ttu-id="2435d-271">結果として、管理不能な負荷、間接費、およびバッチ サーバー上のボトルネックが生じました。</span><span class="sxs-lookup"><span data-stu-id="2435d-271">The results were unmanageable loads, overhead, and bottlenecks on the batch server.</span></span>
- <span data-ttu-id="2435d-272">明細書は、トランザクションの最大数を持つ明細書の優先順位付けによって、効率的に処理のキューに格納されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-272">Statements are efficiently queued for processing by prioritizing the statements that have the maximum number of transactions.</span></span>
- <span data-ttu-id="2435d-273">**明細書をバッチ計算する** および **明細書をバッチ転記する** などのバッチ プロセスは、バッチ モードでのみ実行されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-273">Batch processes such as **Calculate statements in batch** and **Post statements in batch** are run only in batch mode.</span></span> <span data-ttu-id="2435d-274">従来の明細書転記機能では、ユーザーは、マルチ スレッドであるバッチ処理とは異なり、単一スレッド操作である対話モードでこれらのバッチ プロセスを実行するよう選択できました。</span><span class="sxs-lookup"><span data-stu-id="2435d-274">In the legacy statement posting feature, users could choose to run these batch processes in an interactive mode which is s single threaded operation unlike batch processes which are multi-threaded.</span></span>
- <span data-ttu-id="2435d-275">従来の明細書転記機能では、バッチ タスクの任意の失敗は、エラー状態のバッチ ジョブ全体に据え置かれていました。</span><span class="sxs-lookup"><span data-stu-id="2435d-275">In the legacy statement posting feature, any failure of a batch task put the whole batch job in an error state.</span></span> <span data-ttu-id="2435d-276">改良された機能では、バッチ タスクの失敗は、その他のバッチ タスクが正常に完了した場合に、バッチ ジョブをエラー状態に据え置きません。</span><span class="sxs-lookup"><span data-stu-id="2435d-276">In the improved feature, batch task failures don't put the batch job in an error state if other batch tasks are successfully completed.</span></span> <span data-ttu-id="2435d-277">エラーが原因で転記されなかった任意の明細書を確認できる **明細書** ページを使用して、バッチ実行の転記状態を評価する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-277">You should assess the posting status for a batch execution run by using the **Statements** page, where you can see any statements that weren't posted because of errors.</span></span>
- <span data-ttu-id="2435d-278">従来の明細書転記機能では、最初に発生した明細書の失敗が、バッチ全体の失敗の原因となります。</span><span class="sxs-lookup"><span data-stu-id="2435d-278">In the legacy statement posting feature, the first occurrence of a statement failure causes the whole batch to fail.</span></span> <span data-ttu-id="2435d-279">残りの明細書は処理されません。</span><span class="sxs-lookup"><span data-stu-id="2435d-279">The remaining statements aren't processed.</span></span> <span data-ttu-id="2435d-280">改良された機能では、一部の明細書が失敗した場合でも、バッチ処理はすべての明細書の処理を続行します。</span><span class="sxs-lookup"><span data-stu-id="2435d-280">In the improved feature, the batch process continues to process all statements, even if some of the statements fail.</span></span> <span data-ttu-id="2435d-281">1 つの利点は、エラーを含む明細書の正確な数への可視性を、ユーザーが取得することです。</span><span class="sxs-lookup"><span data-stu-id="2435d-281">One benefit is that users gain visibility into the exact number of statements that have errors.</span></span> <span data-ttu-id="2435d-282">したがって、ユーザーはすべての明細書が転記されるまで、エラー修正および明細書転記プロセスを実行する継続的なループで行き詰る必要はありません。</span><span class="sxs-lookup"><span data-stu-id="2435d-282">Therefore, users don't have to be stuck in a continuous loop of fixing the errors and running the post statement process till all statements are posted.</span></span>

## <a name="general-guidance-about-the-statement-posting-process"></a><span data-ttu-id="2435d-283">明細書転記プロセスに関する一般的なガイダンス</span><span class="sxs-lookup"><span data-stu-id="2435d-283">General guidance about the statement posting process</span></span>

- <span data-ttu-id="2435d-284">バッチ実行がマルチスレッドに関するバッチ フレームワークの能力を最大限に活かすために、バッチで明細書転記プロセスを実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-284">We recommend that you run the statement posting process in a batch, because batch runs take advantage of the power of the batch framework in terms of multithreading.</span></span> <span data-ttu-id="2435d-285">マルチスレッドは、通常明細書転記に表示される大量のトランザクションを処理するために必要とされます。</span><span class="sxs-lookup"><span data-stu-id="2435d-285">Multithreading is required in order to handle the huge volumes of transactions that are normally seen in statement postings.</span></span>
- <span data-ttu-id="2435d-286">品目モデル グループでマイナスの現物在庫を有効にし、シームレスな転記エクスペリエンスができるようにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-286">We recommend that you turn on negative physical inventory on the item model group, so that you have a seamless posting experience.</span></span> <span data-ttu-id="2435d-287">一部のシナリオでは、マイナスの現物在庫がない限り、マイナスの明細書は転記できない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2435d-287">In some scenarios, negative statements might not be able to be posted unless there is negative physical inventory.</span></span> <span data-ttu-id="2435d-288">たとえば、理論上、在庫に 1 単位の品目のみがあり、および品目の販売トランザクションと返品トランザクションがあった場合、マイナスの現物在庫が有効になっていない場合でもトランザクションは転記されます。</span><span class="sxs-lookup"><span data-stu-id="2435d-288">For example, in theory, if there is only one unit of an item in inventory, and there have been a sales transaction and a return transaction for the item, the transaction should be able to be posted even if negative inventory isn't turned on.</span></span> <span data-ttu-id="2435d-289">ただし、明細書転記プロセスは、単一の顧客注文で販売トランザクションと返品トランザクションの両方を取り込むため、販売明細行が最初に転記され、返品明細行がそれに続くという保証はありません。</span><span class="sxs-lookup"><span data-stu-id="2435d-289">However, because the statement posting process pulls both the sales transaction and the return transaction in a single customer order, there is no guarantee that the sales line will be posted first, followed by the return line.</span></span> <span data-ttu-id="2435d-290">したがって、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="2435d-290">Therefore, errors can occur.</span></span> <span data-ttu-id="2435d-291">このシナリオでマイナスの現物在庫を有効にすると、トランザクション転記は悪影響を受けませんし、システムは在庫を正しく反映します。</span><span class="sxs-lookup"><span data-stu-id="2435d-291">If negative inventory is turned on in this scenario, the transaction posting isn't negatively affected, and the system will correctly reflect the inventory.</span></span>
- <span data-ttu-id="2435d-292">明細書を計算および転記する間に、集計を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-292">We recommend that you use aggregation while you calculate and post statements.</span></span> <span data-ttu-id="2435d-293">したがって、いくつかの集計パラメーターに対する以下の設定をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2435d-293">Therefore, the following settings are recommended for some of the aggregation parameters:</span></span>

    - <span data-ttu-id="2435d-294">**Retail とコマース** \> **バックオフィスの設定** \> **パラメーター** \> **コマース パラメーター** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="2435d-294">Go to **Retail and Commerce** \> **Headquarters setup** \> **Parameters** \> **Commerce parameters**.</span></span> <span data-ttu-id="2435d-295">その後、**明細レベル** フィールドの、**在庫更新** クイック タブの、**転記** タブで、**集計** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2435d-295">Then, on the **Posting** tab, on the **Inventory update** FastTab, in the **Detail level** field, select **Summary**.</span></span>
    - <span data-ttu-id="2435d-296">**Retail とコマース** \> **バックオフィスの設定** \> **パラメーター** \> **コマース パラメーター** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="2435d-296">Go to **Retail and Commerce** \> **Headquarters setup** \> **Parameters** \> **Commerce parameters**.</span></span> <span data-ttu-id="2435d-297">それから、**集計** クイック タブの、**転記** タブで、**伝票トランザクション** オプションを **はい** に設定します。</span><span class="sxs-lookup"><span data-stu-id="2435d-297">Then, on the **Posting** tab, on the **Aggregation** FastTab, set the **Voucher transactions** option to **Yes**.</span></span>
