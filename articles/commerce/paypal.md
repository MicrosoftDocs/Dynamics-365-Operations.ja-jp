---
title: PayPal 向け Dynamics 365 Payment Connector
description: このトピックでは、PayPal 向け Microsoft Dynamics 365 Payment Connector の概要について説明します。
author: rubendel
manager: annbe
ms.date: 11/18/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: IT Pro
ms.reviewer: josaw
ms.search.scope: Operations, Retail
ms.custom: 141393
ms.assetid: e23e944c-15de-459d-bcc5-ea03615ebf4c
ms.search.region: Global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2020-10-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: fa573334ddc0b11860712953c055c0f5b587777a
ms.sourcegitcommit: deb711c92251ed48cdf20ea514d03461c26a2262
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/25/2020
ms.locfileid: "4644855"
---
# <a name="dynamics-365-payment-connector-for-paypal"></a>PayPal 向け Dynamics 365 Payment Connector

[!include [banner](../includes/banner.md)]

このトピックでは、PayPal 向け Microsoft Dynamics 365 Payment Connector (PayPal コネクタ) の概要について説明します。 これには、サポートされているフィーチャおよび機能、コネクタの設定および構成のガイド、トラブルシューティング情報、および一般的な一部の問題に関する説明の一覧が含まれています。

## <a name="key-terms"></a>重要な用語

| 相談 | 説明 |
|---|---|
| PayPal ウォレット | PayPal 「ボタン」ととして知られる PayPal ウォレットは、PayPal コネクタでサポートされるカスタマー エクスペリエンスと統合について説明します。 |
| ウォレット | BIN 範囲や有効期限など、クレジット カード タイプとデビット カード タイプを区別するために使用される従来の支払特性を含まない支払タイプ。 |

## <a name="overview"></a>概要

Microsoft Dynamics 365 Commerce は、PayPal ウォレットとの統合を最初から用意しています。 PayPal コネクタが構成されている場合、PayPal ボタンは、オンライン注文のチェックアウトの一部として選択可能な支払方法になります。 ユーザーが **PayPal** を選択すると、PayPal で直接支払を完了するように指示され、注文完了のためにオンライン店舗に戻ります。  

PayPal コネクタは、クレジット カード決済で活用されているのと同じ支払 SDK を使用して実装されます。 PayPal による支払のサポートを向上させるために、「ウォレット」支払タイプのサポートが追加され、クレジット カード以外の支払のサポートも強化されました。 具体的には、PayPal による支払は BIN 範囲を返しません。 PayPal および他のウォレットの支払をサポートするために、BIN 範囲を含まない支払のための新しいマッピングが導入されました。 この新しいマッピングは、クレジット カード決済の方法に対する既存の BIN 範囲マッピングを拡張するために使用することもできます。 詳細については、[ウォレット支払のサポート](wallets.md) を参照してください。 

PayPal 向け Microsoft Dynamics 365 Payment Connector は中国では使用できません。 Dynamics 365 Commerce が利用可能な他のロケールについては、現在のところ制限はありません。 

## <a name="functional-overview"></a>機能の概要

### <a name="paypal-wallet-in-storefront"></a>店舗での PayPal ウォレット 

コネクタは、電子商取引の支払のために PayPal ウォレットまたは PayPal ボタンの使用をサポートしています。 コネクタがオンライン店舗用に構成されている場合、顧客は支払時に PayPal ボタンを使用して支払を行うオプションが表示されます。 顧客が PayPal ボタンを選択すると、PayPal によって認証され、支払方法を選択できる、PayPal ウォレットの小さなブラウザー ウィンドウにリダイレクトされます。 認証と支払方法の選択に成功すると、顧客は、PayPal 支払がチェックアウト フォームに読み込まれた店舗にリダイレクトされます。 注文が行われると、PayPal 支払は注文の支払明細行として含められ、Commerce 本社に同期されます。

PayPal ウォレットの詳細については、PayPal がホストする [PayPal チェックアウト ページ](https://www.paypal.com/merchantapps/appcenter/acceptpayments/checkout) を参照してください。 

### <a name="fulfillment"></a>フルフィルメント

PayPal 支払明細行を含む注文は、クレジット カードを使用して支払が行われる注文と同じ方法で実行されます。 注文が作成されると、PayPal の支払は「承認済み」状態に追加されます。 フルフィルメント時に、注文が物流センターから顧客に出荷されるか、または店舗でピッキングされたかにかかわらず、注文に関連付けられた支払承認は、クレジット カード決済の取得に使用されるのと同じ支払 SDK 要求を使用して「取得」されます。 

PayPal による注文のフルフィルメントは、増分取得をサポートします。 つまり、注文が部分的にフルフィルメントされて請求された場合、残りの注文のために新しい承認を取得するのではなく元の承認の一部が取得されることになり、残りの注文がフルフィルメントされるときは元の同じ承認が参照されます。 

### <a name="authorization-expiration"></a>認証の有効期限

PayPal 支払コネクタを使用して行われた注文は、30 日以内にフルフィルメントする必要があります。 注文が 30 日以内にフルフィルメントまたは請求できない場合、元の認証は期限切れになります。 現在、PayPal コネクタは請求契約をサポートしていません。 定期請求の契約の場合、定期的なカード参照/トークンと同様に、元の承認が期限切れになった後、自動的に新しい承認を生成する必要があります。 つまり、承認が期限切れになった場合、注文は「処理しない」状態になり、顧客に連絡して代替の支払方法を用意してもらう必要があります。 

元の承認の有効期限が切れた時点で新しい承認を作成することを可能にする請求契約のサポートは、将来のリリースで追加されます。 

## <a name="testing-the-paypal-payment-connector"></a>PayPal 支払コネクタのテスト

### <a name="creating-a-paypal-developer-account"></a>PayPal 開発者アカウントの作成

PayPal 支払コネクタをテストするには、最初に PayPal 開発者の資格情報と PayPal のサンドボックス環境を作成する必要があります。 

1. PayPal の開発リソースの一部として提供される [テストと Go-Live ](https://developer.paypal.com/docs/business/test-and-go-live/) に移動します。 
2. **テストと Go-Live** ページの [開始](https://developer.paypal.com/docs/platforms/get-started/) を選択します。 
3. そのページで、**開発者のダッシュボードにログイン** を選択します。
4. サインインを求められた場合、**サインアップ** を選択します。
5. **ビジネス アカウント** を選択し、**次へ** を選択 します。
6. PayPal アカウントに関連付ける電子メール アドレスを入力し、PayPal アカウントのパスワードを作成します。 
7. 次のページで、連絡先情報の詳細を入力し、PayPal のユーザー契約とプライバシーに関する声明を読みます。 使用条件に同意する場合は、**同意してアカウントを作成** を選択します。  

    > [!NOTE]
    > PayPal 開発者アカウントの作成で合意した契約条件は、アカウントを作成した組織または個人と PayPal との間のものです。 Microsoft はいかなる責任も追わず、契約で示される契約条件についていかなる保証も行いません。 これらの指示は、情報提供のみを目的としています。 

8. 契約条件に同意した後、ビジネス タイプを指定し、**続行** を選択します。
9. 次に、[PayPal 開発者のページ](https://developer.paypal.com/developer/applications) に移動し、**ダッシュボードにログイン** を選択します。
10. PayPal アカウントの作成時に使用した資格情報を使用してサインインします。
11. 開発者のダッシュボードで、RestAPI アプリの一覧で **既定のアプリケーション** を選択します。
12. サンドボックス アカウントの **クライアント ID** と **シークレット** に注意してください。 これらは、Dynamics 365 Commerce のコネクタの設定に使用します。

    > [!NOTE]
    > ライブ環境の **クライアント ID** と **シークレット** を収集するには、選択した RestAPI アプリの **ライブ** タブを選択します。

## <a name="set-up-the-connector-in-dynamics-365-commerce"></a>Dynamics 365 Commerce で支払コネクタを設定する

### <a name="map-the-paypal-wallet-payment-method-to-a-processor-payment-method"></a>PayPal ウォレットの支払方法をプロセッサ支払方法にマップする

> [!NOTE]
> これらの手順の一部は、ウォレットの支払方法をサポートするために新しい機能を活用しています。 この機能の詳細については、[ウォレット支払のサポート](wallets.md) を参照してください。

1. **Retail と Commerce \> チャネル設定 \> 支払方法 \> 支払い方法** に移動します。
2. **新規** を選択します。
3. **支払方法 ID** および **ウォレット** などの **支払方法名** を指定します。 **既定の機能** を **ウォレット** に設定し、**保存** を選択します。
4. **Retail と Commerce \> チャネル設定 \> 支払方法\> カード タイプ** に移動します。
5. **新規** を選択します。
6. **PayPal** などの **ID** を指定します。 **PayPal** などの **電子支払名** を設定します。 **種類** に **ウォレット** を設定し、**発行者** に **PayPal** などの名前を指定します。 **保存** を選択します。
7. 以前に作成したエントリを選択し、**プロセッサ マッピング** を選択します。
8. **プロセッサ支払方法のマッピング** ページで、以前に作成した **PayPal** のカード タイプを選択します。 中央の列で、**PayPal 向け Dynamics 365 Payment Connector** を選択し、**追加** を選択します。 

### <a name="set-up-the-paypal-payment-connector-in-payment-services"></a>支払サービスで PayPal 支払コネクタを設定する

次の手順に従って、**支払サービス** で PayPal 支払コネクタを構成します。

1. Commerce 本社で、**売掛\> 支払設定\> 支払サービス** の順に移動します。
2. アクション ウィンドウで、**新規** を選択してから、**設定** タブで以下の情報を入力します。

    | フィールド | 説明 | サンプル値 |
    |---|---|---|
    | 支払サービス | 構成する支払サービスの名前を入力します。 | PayPal |
    | 支払コネクタ | PayPal 支払コネクタを選択します。 | PayPal 向け Dynamics 365 Payment Connector |
    | テスト モード | PayPal コネクタに関しては、実稼働環境とテスト環境でこのフィールドを **False** に設定する必要があります。 | False |
    | クレジット カードの既定のプロセッサ | コール センターでは既定のプロセッサが使用されるため、この値は **No** に設定する必要があります。 | なし |
    | ゼロ トランザクションの支払プロセッサをバイパスする | この支払プロセッサが 0 (ゼロ) の量の取引でスキップする必要があるかを指定します。 | 有 |

3. **支払サービス アカウント** タブで、以下の情報を入力します。

    | フィールド | 説明 | 必須 | 自動セット | サンプル値 |
    |---|---|:-:|:-:|---|
    | アセンブリ名 | PayPal 向け Dynamics 365 Payment Connector の自動入力されたアセンブリ名。 | あり | あり | *バイナリ名* |
    | サービス アカウント ID | 商社のプロパティの設定のための自動入力された一意の識別子。 この識別子は支払トランザクションで記録され、下位のプロセスが使用する (請求など) 商業プロパティを識別します。 | あり | あり | *Guid* |
    | マーチャント クライアント ID | **既定のアプリケーション** で、PayPal 開発者のダッシュボードから収集されたサンドボックスの **クライアント ID** を入力します。  | あり | あり | *文字列* |
    | マーチャント API キー | **既定のアプリケーション** で、PayPal 開発者のダッシュボードから収集されたサンドボックスの **シークレット** を入力します。 | あり | あり | *文字列* |
    | サポートされている通貨 | PayPal コネクタでサポートされるように、セミコロン区切りのサポートされている通貨を入力します。 既定値は **USD** です。 | あり | はい、ただし編集することができます。 | USD; CAD |
    | サポートされている支払/入金タイプ | その他の支払コネクタは、複数の支払/入金タイプをサポートします。 PayPal の場合、支払い方法は **PayPal** だけです。 | あり | あり | PayPal |
    | サポートされている支払方法のバリアント | その他の支払コネクタは、複数の支払方法のバリアントを返すことがあります。 PayPal の場合、バリアントは **PayPal** だけです。 | あり | あり | PayPal |
    | 環境 | このフィールドは、トランザクションをサンドボックス環境またはライブ環境に送信するかを指定するために使用されます。 | あり | あり | *サンドボックス* または *ライブ* |
    
> [!NOTE]
> サンドボックス環境で支払のテストをする場合、**環境** フィールドをライブおよびライブ環境に設定することはできません。 **マーチャント クライアント ID** および **マーチャント API キー** を使用することはできません。 サンドボックス環境は、サンドボックス テストの目的でのみ使用されます。

### <a name="set-up-the-paypal-payment-connector-for-the-online-store"></a>オンライン ストア用に PayPal 支払コネクタを設定する

1. Commerce 本社で、**小売とコマース\>チャネル\>オンライン店舗** の順に移動します。
2. PayPal 向け Dynamics 365 Payment Connector を追加するオンライン店舗を選択します。
3. **オンライン店舗** ページの、**支払口座** クイック タブで、**追加** を選択します。
4. **コネクタ** で、**PayPal 向け Dynamics 365 Payment Connector** を選択します。
5. 以下の追加情報を入力します。

    | フィールド | 説明 | 必須 | 自動セット | サンプル値 |
    |---|---|:-:|:-:|---|
    | アセンブリ名 | PayPal 向け Dynamics 365 Payment Connector の自動入力されたアセンブリ名。 | あり | あり | *バイナリ名* |
    | サービス アカウント ID | 商社のプロパティの設定のための自動入力された一意の識別子。 この識別子は支払トランザクションで記録され、下位のプロセスが使用する (請求など) 商業プロパティを識別します。 | あり | あり | *Guid* |
    | マーチャント クライアント ID | **既定のアプリケーション** で、PayPal 開発者のダッシュボードから収集されたサンドボックスの **クライアント ID** を入力します。  | あり | あり | *文字列* |
    | マーチャント API キー | **既定のアプリケーション** で、PayPal 開発者のダッシュボードから収集されたサンドボックスの **シークレット** を入力します。 | あり | あり | *文字列* |
    | サポートされている通貨 | PayPal コネクタでサポートされるように、セミコロン区切りのサポートされている通貨を入力します。 既定値は **USD** です。 | あり | はい、ただし編集することができます。 | USD; CAD |
    | サポートされている支払/入金タイプ | その他の支払コネクタは、複数の支払/入金タイプをサポートします。 PayPal の場合、支払い方法は **PayPal** だけです。 | あり | あり | PayPal |
    | サポートされている支払方法のバリアント | その他の支払コネクタは、複数の支払方法のバリアントを返すことがあります。 PayPal の場合、バリアントは **PayPal** だけです。 | あり | あり | PayPal |
    | 環境 | このフィールドは、トランザクションをサンドボックス環境またはライブ環境に送信するかを指定するために使用されます。 | あり | あり | *サンドボックス* または *ライブ* |
    
> [!NOTE]
> サンドボックス環境で支払のテストをする場合、**環境** フィールドをライブおよびライブ環境に設定することはできません。 **マーチャント クライアント ID** および **マーチャント API キー** を使用することはできません。 サンドボックス環境は、サンドボックス テストの目的でのみ使用されます。

Commerce 本社で上記の変更を行った後、**1070** の配送スケジュールを使用して変更を同期します。

### <a name="configure-paypal-for-the-storefront-checkout-module"></a>店舗チェックアウト モジュールに対して PayPal を構成する

店舗がチェックアウト モジュールで PayPal を使用できるように構成する方法の詳細については、[支払モジュール](payment-module.md) を参照してください。  

## <a name="entering-a-merchant-relationship-with-paypal"></a>マーチャントと PayPal の関係を入力する

PayPal で **ライブ** のマーチャント アカウントを作成するには、セルフサービスの [PayPal チェックアウト ページ](https://www.paypal.com/merchantapps/appcenter/acceptpayments/checkout) に移動するか、または [販売担当者に連絡](https://www.paypal.com/business/contact-sales) してカスタム率について話し合います。 
 

## <a name="additional-resources"></a>追加リソース

- [支払に関するよく寄せられる質問](dev-itpro/payments-retail.md)
- [チェックアウト モジュール](add-checkout-module.md)
- [支払モジュール](payment-module.md)
