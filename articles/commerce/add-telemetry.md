---
title: サイト ページにスクリプト コードを追加してテレメトリをサポートする
description: このトピックでは、クライアント側のテレメトリの収集をサポートするクライアント側のスクリプト コードをサイト ページに追加する方法について説明します。
author: bicyclingfool
ms.date: 09/29/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application user
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: StuHarg
ms.search.validFrom: 2019-10-31
ms.dyn365.ops.version: Release 10.0.5
ms.openlocfilehash: fb1773ab10b23a586eb6a8286f145181818585b9
ms.sourcegitcommit: 3cdc42346bb653c13ab33a7142dbb7969f1f6dda
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/31/2021
ms.locfileid: "5797434"
---
# <a name="add-script-code-to-site-pages-to-support-telemetry"></a>サイト ページにスクリプト コードを追加してテレメトリをサポートする

[!include [banner](includes/banner.md)]

このトピックでは、クライアント側のテレメトリの収集をサポートするクライアント側のスクリプト コードをサイト ページに追加する方法について説明します。

Web Analytics は、顧客がサイトとどのように対話するかを理解し、最大のコンバージョンのためにエクスペリエンスを最適化するのに役立つ決定を下したい場合に、重要なツールとなります。 Google Analytics、Clicky、Moz Analytics、KISSMetrics など、これらの目標を達成するために、多くの Web Analytics パッケージが用意されています。 ほとんどの Web Analytics パッケージでは、サイトのすべてのページの HTML の **\<head\>** 要素にクライアント側のスクリプト コードを追加する必要があります。

> [!NOTE]
> このトピックの手順は、Microsoft Dynamics 365 Commerce がネイティブに提供していない他のカスタム クライアント側機能にも適用されます。

## <a name="create-a-reusable-fragment-for-your-script-code"></a>スクリプ トコードに再利用可能なフラグメントを作成する

フラグメントを使用すると、使用するテンプレートに関係なく、サイト上のすべてのページでインラインまたは外部スクリプト コードを再利用できます。

### <a name="create-a-reusable-fragment-for-your-inline-script-code"></a>インライン スクリプト コードに再利用可能なフラグメントを作成する

サイト ビルダーのインライン スクリプト コードに再利用可能なフラグメントを作成するには、次の手順を実行します。

1. **フラグメント** に移動し、**新規** を選択します。
1. **新規フラグメント** ダイアログ ボックスで、**インライン スクリプト** を選択します。
1. **フラグメント名** で、フラグメントの名前を入力し、**OK** を選択します。
1. 作成したフラグメントで、**既定のインライン スクリプト** モジュールを選択します。
1. 右側のプロパティウィンドウの **インライン スクリプト** で、クライアント サイド スクリプトを入力します。 次に、必要に応じて他のオプションを設定します。
1. **保存** を選択し、**編集完了** を選択します。
1. **公開** を選択します。

### <a name="create-a-reusable-fragment-for-your-external-script-code"></a>外部スクリプト コードに再利用可能なフラグメントを作成する

サイト ビルダーの外部スクリプト コードに再利用可能なフラグメントを作成するには、次の手順を実行します。

1. **フラグメント** に移動し、**新規** を選択します。
1. **新規フラグメント** ダイアログ ボックスで、**外部スクリプト** を選択します。
1. **フラグメント名** で、フラグメントの名前を入力し、**OK** を選択します。
1. 作成したフラグメントで、**既定の外部スクリプト** モジュールを選択します。
1. 右側のプロパティウィンドウの **スクリプト ソース** で、外部スクリプト ソースの外部または相対 URL を追加します。 次に、必要に応じて他のオプションを設定します。
1. **保存** を選択し、**編集完了** を選択します。
1. **公開** を選択します。

> [!NOTE]
> サイトのコンテンツ セキュリティ ポリシー (CSP) が有効になっている場合は、すべての外部 URL が Commerce サイト ビルダーの **script-src** CSP ディレクティブに追加されていることを確認してください。 詳細については、[コンテンツ セキュリティ  ポリシー (CSP) の管理](manage-csp.md)を参照してください。

## <a name="add-a-fragment-that-includes-script-code-to-a-template"></a>スクリプト コードを含むフラグメントをテンプレートに追加する

サイト ビルダーのテンプレートにスクリプト コードを含むフラグメントを追加するには、次の手順を実行します。

1. **テンプレート** に移動して、スクリプト コードを追加するページのテンプレートを開きます。
1. 左ウィンドウでテンプレート階層を展開し、**HTML ヘッド** スロットを表示します。
1. **HTML Head** スロットの省略ボタン (**...**) を選択し、**フラグメントの追加** を選択します。
1. スクリプト コードに対して作成したフラグメントを選択します。
1. **保存** を選択し、**編集完了** を選択します。
1. **公開** を選択します。

## <a name="add-an-external-script-or-inline-script-directly-to-a-template"></a>外部スクリプトまたはインライン スクリプトを直接テンプレートに追加する

単一のテンプレートによって制御される一連のページにインラインまたは外部スクリプトを直接挿入する場合は、最初にフラグメントを作成する必要はありません。

### <a name="add-an-inline-script-directly-to-a-template"></a>インライン スクリプトを直接テンプレートに追加する

サイト ビルダーのテンプレートにインライン スクリプトを直接追加するには、次の手順を実行します。

1. **テンプレート** に移動して、スクリプト コードを追加するページのテンプレートを開きます。
1. 左ウィンドウでテンプレート階層を展開し、**HTML ヘッド** スロットを表示します。
1. **HTML Head** スロットの省略ボタン (**...**) を選択し、**モジュールの追加** を選択します。
1. **モジュールの追加** ダイアログ ボックスで、**インライン スクリプト** を選択します。
1. 右側のプロパティウィンドウの **インライン スクリプト** で、クライアント サイド スクリプトを入力します。 次に、必要に応じて他のオプションを設定します。
1. **保存** を選択し、**編集完了** を選択します。
1. **公開** を選択します。

### <a name="add-an-external-script-directly-to-a-template"></a>外部スクリプトを直接テンプレートに追加する

サイト ビルダーのテンプレートに外部スクリプトを直接追加するには、次の手順を実行します。

1. **テンプレート** に移動して、スクリプト コードを追加するページのテンプレートを開きます。
1. 左ウィンドウでテンプレート階層を展開し、**HTML ヘッド** スロットを表示します。
1. **HTML Head** スロットの省略ボタン (**...**) を選択し、**モジュールの追加** を選択します。
1. **モジュールの追加** ダイアログ ボックスで、**外部スクリプト** を選択します。
1. 右側のプロパティウィンドウの **スクリプト ソース** で、外部スクリプト ソースの外部または相対 URL を追加します。 次に、必要に応じて他のオプションを設定します。
1. **保存** を選択し、**編集完了** を選択します。
1. **公開** を選択します。

## <a name="additional-resources"></a>追加リソース

[ロゴの追加](add-logo.md)

[サイト テーマの選択](select-site-theme.md)

[CSS 上書きファイルの作業](css-override-files.md)

[ファビコンの追加](add-favicon.md)

[ようこそメッセージの追加](add-welcome-message.md)

[著作権に関する注意事項の追加](add-copyright-notice.md)

[サイトに言語を追加する](add-languages-to-site.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]
