---
title: 販売時点管理 (POS) での顧客のチェックイン通知の有効化
description: この記事では、Microsoft Dynamics 365 Commerce 販売時点管理 (POS) で顧客チェックイン通知を有効にする方法について説明します。
author: bicyclingfool
ms.date: 12/03/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application user
ms.reviewer: v-chgriffin
ms.search.region: global
ms.author: stuharg
ms.search.validFrom: 2021-04-01
ms.dyn365.ops.version: 10.0.19
ms.custom: ''
ms.assetid: ''
ROBOTS: ''
ms.openlocfilehash: 5627f529f72fe06103fa64548a7d182fc008bd83
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/12/2022
ms.locfileid: "9287653"
---
# <a name="enable-customer-check-in-notifications-in-point-of-sale-pos"></a>販売時点管理 (POS) での顧客のチェックイン通知の有効化

[!include [banner](includes/banner.md)]

この記事では、Microsoft Dynamics 365 Commerce 販売時点管理 (POS) で顧客チェックイン通知を有効にする方法について説明します。

"ピックアップ可能な注文" のメールには、顧客が店内にいて荷物が運ばれてくるのを待っていることを店舗に通知するリンクやボタンを設けることができます。 顧客はチェックイン確認を受け取り、店舗は POS アプリケーションでタスクとして通知を受け取ります。 このタスクは、販売担当者が顧客の車両に注文を届けるためのプロンプトとして機能します。 したがって、顧客は店舗に入る必要はありません。

顧客のチェックイン ワークフローは、駐車場の番号、車両のメーカー、モデル、色、配送手順など、顧客から追加情報を収集するように構成することもできます。 小売用店舗のスタッフは、この情報を利用して注文のフルフィルメントを円滑化することができます。

## <a name="enable-customer-check-in"></a>顧客チェックインを有効にする

顧客チェックイン機能を有効にすると、Commerce によって注文確認 ID (チャネル参照 ID とも呼ばれます) が生成されます。 また、販売時点管理 (POS) またはコール センター チャネルを通じて作成された注文の注文確認 ID も生成されます。 

Commerce 本部の顧客チェックイン機能をオンにするには、次の手順に従います。

1. **ワークスペース \> 機能管理** に移動します。
2. **チャネル全体で一貫したチャネル参照 ID フォーマットを生成する** 機能を検索します。 
3. 機能を選択し、プロパティ ウィンドウで **今すぐ有効にする** を選択します。 

## <a name="create-a-check-in-confirmation-page"></a>チェックイン確認ページの作成

eコマース サイトで、チェックイン確認エクスペリエンスとして機能する新しいページを作成する必要があります。 このページには、追加の構成を使用して、顧客からの追加情報を収集して注文のフルフィルメントを容易にするフォームを含めることもできます。 ページおよびモジュールの設定方法については、[顧客チェックイン モジュール](check-in-pickup-module.md) を参照してください。

## <a name="configure-the-transactional-email-template"></a>トランザクション メール テンプレートの構成

注文した商品がピックアップ可能になったときに顧客が受け取るトランザクション メールのテンプレートに、**I am here** のリンクまたはボタンを追加する必要があります。 顧客はこのリンクまたはボタンを使用して、注文をピックアップするために到着したことを店舗に通知します。 

通知タイプの **梱包完了済** と、カーブサイド注文のフルフィルメントに使用している配送モードにマッピングされたテンプレートに、リンクまたはボタンを追加します。 テンプレートには、以下の例のように、作成したチェックイン確認ページの URL を指し、パラメータ名と値を含んだ HTML リンクまたはボタンを作成してください。

`<a href="https://[YOUR_SITE_DOMAIN]/[CHECK-IN_CONFIRMATION_PAGE]?channelReferenceId=%confirmationid%&channelId=%channelid%&packingSlipId=%packingslipid%" target="_blank">I am here!</a>`

メール テンプレートの構成方法の詳細については、「[配送モードによるトランザクション メールのカスタマイズ](customize-email-delivery-mode.md)」を参照してください 。 

## <a name="a-check-in-confirmation-task-is-created-in-pos"></a>POS でチェックイン確認タスクが作成される

顧客が受け取りに来たことを店舗に通知すると、チェックインページには確認メッセージと、顧客の注文確認 ID を含むオプションの QR コードが表示されます。 同時に、POS のタスクリストに、顧客が注文を受け取る店舗のタスクが作成されます。 このタスクには、注文を満たすために必要なすべての顧客情報と注文情報が含まれています。 タスクの指示フィールドには、追加情報フォームで顧客から収集した情報が表示されます。

## <a name="end-to-end-testing"></a>エンドツーエンドのテスト

顧客のチェックインでは、特定のパラメータや値をチェックイン ページに渡し、さらに顧客チェックイン API に渡す必要があります。 したがって、最も簡単な方法は、テスト注文を作成して梱包できる環境で機能をテストする方法です。 この方法で、必要なパラメータ名と値を含む URL を持つ 「集荷用の注文」 メールを生成することができます。

顧客チェックイン機能をテストするには、以下の手順に従ってください。

1. 顧客チェックイン ページを作成し、顧客チェックイン モジュールを追加、構成します。 詳細については、[集荷モジュールのチェックイン](check-in-pickup-module.md) を参照してください。 
1. ページをチェックインしますが、公開はしません。
1. 配送の集荷モードの梱包完了通知タイプで呼び出されるメールテンプレートに、以下のリンクを追加します。 詳細については、[トランザクション イベント用の電子メール テンプレートの作成](email-templates-transactions.md)を参照してください。

    - **生産前 (UAT) 環境の場合:** この記事の前の方にある [取引のメールテンプレートを構成する](#configure-the-transactional-email-template) セクションにあるコード スニペットを追加します。
    - **運用環境の場合:** 既存の顧客に影響が出ないように、以下のコメント付きコードを追加します。

        `<!-- https://[DOMAIN]/[CHECK_IN_PAGE]?channelReferenceId=%confirmationid%&channelId=%pickupchannelid%&packingSlipId=%packingslipid%&preview=inprogress -->`

1. 配送の集荷モードが指定されている注文を作成します。
1. 梱包完了通知タイプをトリガーとしたメールを受信したら、先に追加した URL を持つチェックインページを開いて、チェックインのフローをテストします。 URL に `&preview=inprogress` フラグが含まれるため、ページを表示する前に認証を求めるメッセージが表示されます。
1. モジュールの設定に必要な追加情報を入力してください。
1. チェックインの確認画面が正しく表示されていることを確認します。
1. 注文を受け取る店舗の POS 端末を開きます。
1. **集荷する注文** のタイルを選択し、注文が表示されることを確認します。
1. チェックイン モジュールで構成された追加情報が詳細ウィンドウに表示されていることを確認します。

顧客のチェックイン機能が最初から最後まで動作することを確認した後、以下の手順に従います。

1. チェックイン ページを公開します。
1. 運用環境でテストしている場合は、「集荷用注文」のメール テンプレートの URL のコメントを外し、**到着しました** のリンク、またはボタンが表示されるようにしてください。 その後、テンプレートを再アップロードします。

## <a name="additional-resources"></a>追加リソース

[ピックアップのチェックイン モジュール](check-in-pickup-module.md)

[配送モードによるトランザクション メールのカスタマイズ](customize-email-delivery-mode.md)

[トランザクション イベント用の電子メール テンプレートの作成](email-templates-transactions.md)
