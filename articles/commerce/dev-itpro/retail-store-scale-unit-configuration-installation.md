---
title: Commerce Scale Unit のコンフィギュレーションとインストール (自己ホスト)
description: このトピックでは、セルフサービスを使用して、従来型の店舗にあるコンピューターに Commerce Scale Unit (自己ホスト) を構成し、インストールする方法について説明します。
author: jashanno
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: SysAADClientTable, RetailCDXDataStore, RetailCDXDataGroup, RetailChannelProfile, RetailSharedParameters, RetailStoreTable
audience: IT Pro
ms.reviewer: rhaertle
ms.custom: 219744
ms.assetid: 5e28948f-d40a-40e8-843b-8c2747916546
ms.search.region: Global
ms.search.industry: Retail
ms.author: jashanno
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 673c062ade8c9a5ed084d6022b59c358e37228b2
ms.sourcegitcommit: 97ada5d52ed1829dcf030dad254096cd8df25da8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2021
ms.locfileid: "5864368"
---
# <a name="configure-and-install-commerce-scale-unit-self-hosted"></a><span data-ttu-id="731ae-103">Commerce Scale Unit のコンフィギュレーションとインストール (自己ホスト)</span><span class="sxs-lookup"><span data-stu-id="731ae-103">Configure and install Commerce Scale Unit (self-hosted)</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="731ae-104">このトピックでは、セルフ サービスを使用して、Microsoft Dynamics 365 Commerce バックオフィスで Commerce Scale Unit (自己ホスト。以前は Retail Store Scale Unit と呼ばれていました) を構成し、ダウンロードして、従来型の店舗にある 1 台以上のコンピューターにインストールする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="731ae-104">This topic explains how you can use self-service to configure a Commerce Scale Unit (self-hosted, previously called Retail Store Scale Unit) in Microsoft Dynamics 365 Commerce Headquarters, download it, and install it on one or more computers in a brick-and-mortar store.</span></span> <span data-ttu-id="731ae-105">Commerce Scale Unit は、コマース チャネル データベース、Commerce Async Client、Retail Server、およびクラウド販売時点管理 (POS) コンポーネントを組み合わせたものです。</span><span class="sxs-lookup"><span data-stu-id="731ae-105">Commerce Scale Unit combines the Commerce channel database, Commerce Async Client, Retail Server, and Cloud point of sale (POS) components.</span></span> <span data-ttu-id="731ae-106">コマース環境では、クラウドでこれらのコンポーネントが既に提供されています。</span><span class="sxs-lookup"><span data-stu-id="731ae-106">A Commerce environment already provides these components in the cloud.</span></span> <span data-ttu-id="731ae-107">ただし、単一コンピューターのセットアップ (既定のオプション) または複数コンピューターのセットアップのいずれかで、ストアまたはデータ センター内でローカルに動作するように構成できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="731ae-107">However, you can now configure them so that they work locally in a store or datacenter, in either a single-computer setup (the default option) or a multiple-computer setup.</span></span> <span data-ttu-id="731ae-108">このトピックは、Commerce Scale Unit のアンインストールとトラブルシューティングの方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="731ae-108">This topic also explains how to uninstall and troubleshoot Commerce Scale Unit.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="731ae-109">基本的な設計原則は、Commerce Scale Unit (クラウド) 上で要求された方法でカスタマイズできない場合は、CSU (自己ホスト) を使用してこの方法をカスタマイズしないことです。</span><span class="sxs-lookup"><span data-stu-id="731ae-109">A basic design principle to follow is that if you are not able to customize in a requested manner on a Commerce Scale Unit (Cloud), you should not customize this way with a CSU (self-hosted).</span></span>  <span data-ttu-id="731ae-110">直接データベース アクセスはサポートされていないため、この概念を使用するカスタマイズが容易に中断される可能性があることを理解しておくことが重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-110">It is critical to understand that direct database access is not supported and can easily cause breaks in customizations that use this concept.</span></span>  <span data-ttu-id="731ae-111">CSU (自己ホスト) は、主にクロス ターミナル シナリオの有効化、WAN 接続の不良に備えた待機時間またはバックアップの短縮、および複数の CSU コンポーネント間での POS 端末の負荷を分散するためのスケールアウトの提供を行います。</span><span class="sxs-lookup"><span data-stu-id="731ae-111">A CSU (self-hosted) is primarily forenabling cross-terminal scenarios, reducing latency or backup for poor WAN connectivity, and providing scale-out to spread the load of POS terminals across multiple CSU components.</span></span>
>
> <span data-ttu-id="731ae-112">このコンポーネントは、Azure サービス間の認証に加えてサーバー証明書を利用することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-112">It is critical to note that this component utilizes a server certificate in addition to Azure Service-to-Service authentication.</span></span>  <span data-ttu-id="731ae-113">生成された Azure Web アプリケーション キー (旧 *シークレット*) とサーバー証明書の両方が、有効期限に対して管理されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-113">Both the generated Azure web application keys (formerly called *secrets*) and the server certificate must be managed for expiration.</span></span>  <span data-ttu-id="731ae-114">既定では、証明書と生成された Azure web アプリケーション キーは 1 つの暦年 (365日) で期限切れになります。</span><span class="sxs-lookup"><span data-stu-id="731ae-114">By default, a certificate and a generated Azure web application key expires in one calendar year (365 days).</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="731ae-115">準備</span><span class="sxs-lookup"><span data-stu-id="731ae-115">Before you begin</span></span>

> [!IMPORTANT]
> <span data-ttu-id="731ae-116">会社全体で高いレベルのセキュリティを維持するために、作成する店舗ごとに新しいアプリケーション ID (クライアント ID) とキー (シークレット) を作成することを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="731ae-116">To help maintain a high level of security across the company, we strongly recommend that you create a new application ID (client ID) and key (secret) for each store that is created.</span></span> <span data-ttu-id="731ae-117">このステップでは、新しい Web アプリが必要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-117">This step requires a new Web app.</span></span>

1. <span data-ttu-id="731ae-118">アプリケーション ID (クライアント ID) とキー (シークレット) を作成する Microsoft Azure Active Directory (Azure AD) アプリ登録を生成します。</span><span class="sxs-lookup"><span data-stu-id="731ae-118">Generate a Microsoft Azure Active Directory (Azure AD) app registration to create an application ID (client ID) and key (secret).</span></span> <span data-ttu-id="731ae-119">手順については、[Azure Active Directory アプリケーションを作成する](/azure/azure-resource-manager/resource-group-create-service-principal-portal#create-an-azure-active-directory-application) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-119">For instructions, see [Create an Azure Active Directory application](/azure/azure-resource-manager/resource-group-create-service-principal-portal#create-an-azure-active-directory-application).</span></span> <span data-ttu-id="731ae-120">このトピックでは、Azure ユーザーのアクセス許可と要件を確認し、アプリ登録を生成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="731ae-120">This topic reviews Azure user permissions and requirements, and explains how to generate an app registration.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-121">Azure ではなく Active Directory Federation Services を使用するオンプレミス環境で使用する Commerce Scale Unit をインストールする場合は、オンプレミス環境の Commerce インストール ドキュメントの手順に従います。</span><span class="sxs-lookup"><span data-stu-id="731ae-121">If you are installing Commerce Scale Unit for use with an on-premises environment using Active Directory Federation Services, instead of Azure, follow the instructions in the Commerce installation document for on-premises environments.</span></span> <span data-ttu-id="731ae-122">詳細については、[オンプレミス環境での Commerce チャネル コンポーネントのインストール手順](../../dev-itpro/deployment/deploy-retail-onprem.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-122">For more information, see [Installation steps for Commerce channel components in an on-premises environment](../../dev-itpro/deployment/deploy-retail-onprem.md).</span></span>

2. <span data-ttu-id="731ae-123">Commerce Scale Unit のアプリケーション ID (クライアント ID) とキーが作成された後、Commerce でクライアント ID を受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-123">After an application ID (client ID) and key are created for Commerce Scale Unit, the client ID must be accepted in Commerce.</span></span> <span data-ttu-id="731ae-124">**システム管理** &gt; **設定** &gt; **Azure Active Directory アプリケーション** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-124">Go to **System administration** &gt; **Setup** &gt; **Azure Active Directory applications**.</span></span> <span data-ttu-id="731ae-125">アプリケーション ID (クライアントID) を **クライアント ID** 列に入力し、説明のテキストを **名** 列に入力および **RetailServiceAccount** を **ユーザー ID** 列に入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-125">Enter the application ID (client ID) in the **Client ID** column, enter descriptive text in the **Name** column, and enter **RetailServiceAccount** in the **User ID** column.</span></span>

## <a name="configure-a-new-commerce-scale-unit"></a><span data-ttu-id="731ae-126">新しい Commerce Scale Unit の構成</span><span class="sxs-lookup"><span data-stu-id="731ae-126">Configure a new Commerce Scale Unit</span></span>

<span data-ttu-id="731ae-127">機能する Commerce Scale Unit を作成するには、「複数のコンピューターのインストール」セクションまでこのトピックのすべてのセクションの手順を完了します。</span><span class="sxs-lookup"><span data-stu-id="731ae-127">To create a functioning Commerce Scale Unit, complete the procedures in all sections of this topic until the "Multiple-computer installation" section.</span></span> <span data-ttu-id="731ae-128">構成とインストールを完了するには、まず Headquarters で初期構成を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-128">To complete the configuration and installation, you must first do the initial configuration in Headquarters.</span></span> <span data-ttu-id="731ae-129">次に、インストールを完了する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-129">Next, you must complete the installation.</span></span> <span data-ttu-id="731ae-130">最後に、Commerce Scale Unit が正しく動作するよう、Headquarters に戻って構成を完了する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-130">Finally, you must return to Headquarters to finish the configuration, so that Commerce Scale Unit works correctly.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="731ae-131">オンプレミス環境では、チャネル機能は Commerce Scale Unit (自己ホスト) の使用により排他的に有効になります。</span><span class="sxs-lookup"><span data-stu-id="731ae-131">Channel functionality in an on-premises environment is enabled exclusively via use of Commerce Scale Unit (self-hosted).</span></span> <span data-ttu-id="731ae-132">概要については、Commerce Scale Unit (自己ホスト) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-132">For an overview, see Commerce Scale Unit (self-hosted).</span></span> <span data-ttu-id="731ae-133">クラウド展開とは異なり、オンプレミス環境では Lifecycle Services (LCS) 経由でチャネル コンポーネントのシームレスで可用性の高い展開は有効になりません。</span><span class="sxs-lookup"><span data-stu-id="731ae-133">Unlike a cloud deployment, an on-premises environment does not enable seamless, high-availability deployment of channel components via Lifecycle Services (LCS).</span></span> <span data-ttu-id="731ae-134">Commerce Scale Unit (自己ホスト) をインストールすることによってのみ、チャネル コンポーネントを使用できます。</span><span class="sxs-lookup"><span data-stu-id="731ae-134">The only way to use channel components is by installing Commerce Scale Unit (self-hosted).</span></span>
>
> <span data-ttu-id="731ae-135">設置配置では、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="731ae-135">For on-premises deployments, perform the following steps:</span></span>
>   1. <span data-ttu-id="731ae-136">**Retail と Commerce** &gt; **Headquarters の設定** &gt; **Commerce スケジューラ** &gt; **チャネル データベース グループ** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-136">Go to **Retail and Commerce** &gt; **Headquarters setup** &gt; **Commerce scheduler** &gt; **Channel database group**.</span></span>
>   2. <span data-ttu-id="731ae-137">アクション ウィンドウで、**新規** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-137">On the Action pane, select **New**.</span></span>
>   3. <span data-ttu-id="731ae-138">**名前** フィールドに、**既定** と入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-138">In the **Name** field, enter **Default**.</span></span> <span data-ttu-id="731ae-139">必要に応じて、**説明** フィールドに説明を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-139">Enter a description in the **Description** field, if needed.</span></span>
>   4. <span data-ttu-id="731ae-140">**チャネル スキーマ** フィールドで、**AX7** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-140">In the **Channel schema** field, select **AX7**.</span></span>
>   5. <span data-ttu-id="731ae-141">**作業フォルダー** フィールドで、**ファイル ストレージ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-141">In the **Working folders** field, select **File storage**.</span></span>
>   6. <span data-ttu-id="731ae-142">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-142">On the Action Pane, select **Save**.</span></span>

1. <span data-ttu-id="731ae-143">Headquarters で、**Retail と Commerce** &gt; **Headquarters の設定** &gt; **Commerce スケジューラ** &gt; **チャネル データベース** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-143">In Headquarters, go to  **Retail and Commerce** &gt; **Headquarters setup** &gt; **Commerce scheduler** &gt; **Channel database**.</span></span>
2. <span data-ttu-id="731ae-144">**チャネル データベース** ページの、アクション ウィンドウで、**新規** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-144">On the **Channel database** page, on the Action Pane, select **New**.</span></span>
3. <span data-ttu-id="731ae-145">**チャネル データベース ID** フィールドに、固有の値を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-145">In the **Channel database ID** field, enter a unique value.</span></span>
4. <span data-ttu-id="731ae-146">**チャンル データ グループ** フィールドで、**既定** オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-146">In the **Channel data group** field, select the **Default** option.</span></span> <span data-ttu-id="731ae-147">作成されている任意のオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-147">Select any option that has been created.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-148">オンプレミス配置では、この値が前にこのトピックで説明した **既定** 値になります。</span><span class="sxs-lookup"><span data-stu-id="731ae-148">For on-premises deployments, this value will be the **Default** value that was previously described in this topic.</span></span>

5. <span data-ttu-id="731ae-149">**タイプ** フィールドで、既定値 (**チャネル データベース**) を選択したままにします。</span><span class="sxs-lookup"><span data-stu-id="731ae-149">In the **Type** field, leave the default value (**Channel database**) selected.</span></span>
6. <span data-ttu-id="731ae-150">**データ同期間隔** フィールドは空白のままにすることができます。</span><span class="sxs-lookup"><span data-stu-id="731ae-150">You can leave the **Data sync interval** field blank.</span></span> <span data-ttu-id="731ae-151">あるいは、このフィールドで値を選択することができます。</span><span class="sxs-lookup"><span data-stu-id="731ae-151">Alternatively, you can select a value in this field.</span></span> <span data-ttu-id="731ae-152">たとえば、デモ データでは、**D60-U15** の値が 15 分の同期間隔を指定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-152">For example, in the demo data, the value **D60-U15** specifies a 15-minute synchronization interval.</span></span>

    <span data-ttu-id="731ae-153">**データ同期間隔** の値は、チャネル データベース (Commerce Scale Unit) および Headquarters 間でデータを同期する頻度を決定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-153">The **Data sync interval** value determines how often the data is synchronized between the channel database (Commerce Scale Unit) and Headquarters.</span></span> <span data-ttu-id="731ae-154">値が入力されていない場合は、Commerce Scale Unit で設定されている既定の間隔が使用されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-154">If no value is entered, the default interval that is set up in Commerce Scale Unit is used.</span></span> <span data-ttu-id="731ae-155">この既定の間隔は、3 分です。</span><span class="sxs-lookup"><span data-stu-id="731ae-155">This default interval is three minutes.</span></span>

7. <span data-ttu-id="731ae-156">**Commerce チャネル** クイック タブで、**追加** を選択し、**チャネル フィールド** で、適切な店舗のチャネルを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-156">On the **Commerce channel** FastTab, select **Add**, and then, in the **Channel** field, select the appropriate store channel.</span></span> <span data-ttu-id="731ae-157">このデータベースを使用するすべてのチャンネルを追加するには、この手順を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="731ae-157">Repeat this step to add all the channels that should use this database.</span></span>

    <span data-ttu-id="731ae-158">また、このデータベースを使用しないチャンネルを追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="731ae-158">You can also add channels that don't use this database.</span></span> <span data-ttu-id="731ae-159">この方法で、Commerce Scale Unit のチャネル データベースのチャネルのデータを保持します。</span><span class="sxs-lookup"><span data-stu-id="731ae-159">In this way, you keep the data for those channels in the Commerce Scale Unit channel database.</span></span> <span data-ttu-id="731ae-160">このデータベースを頻繁に使用するチャネルは、ローカルでそのデータにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="731ae-160">The channels that actively use this database can then access that data locally.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-161">オンプレミス配置では、アクション ウィンドウの **ダウンロード** ボタンを選択し、**Commerce Scale Unit パッケージ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-161">For on-premises deployments, select the **Download** button on the Action pane and select **Commerce Scale Unit package**.</span></span>  <span data-ttu-id="731ae-162">これにより、既知のエラーが発生し、このドキュメントの次の手順を正しく完了できるように、アップロード ロジックが開始されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-162">This will cause a known error and initiate the upload logic so that the following step in this document can be correctly completed.</span></span> <span data-ttu-id="731ae-163">アップロード ロジックが完了するまで少なくとも 1 分以上待ってください。</span><span class="sxs-lookup"><span data-stu-id="731ae-163">Allow for at least one minute to pass while the upload logic completes.</span></span>

8. <span data-ttu-id="731ae-164">**Commerce Scale Unit パッケージ** クイック タブの、**パッケージ参照** フィールドで、適切な Commerce Scale Unit パッケージを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-164">On the **Commerce Scale Unit package** FastTab, in the **Package reference** field, select the appropriate Commerce Scale Unit package.</span></span>  <span data-ttu-id="731ae-165">各環境は、基本の Commerce Scale Unit パッケージを生成します。</span><span class="sxs-lookup"><span data-stu-id="731ae-165">Each environment generates a base Commerce Scale Unit package.</span></span> <span data-ttu-id="731ae-166">したがって、このフィールドには常に少なくとも 1 つのオプションが含まれます。</span><span class="sxs-lookup"><span data-stu-id="731ae-166">Therefore, this field always contains at least one option.</span></span>
9. <span data-ttu-id="731ae-167">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-167">On the Action Pane, select **Save**.</span></span>
10. <span data-ttu-id="731ae-168">**Retail と Commerce** &gt; **チャネル設定** &gt; **チャネル プロファイル** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-168">Go to **Retail and Commerce** &gt; **Channel setup** &gt; **Channel profiles**.</span></span>
11. <span data-ttu-id="731ae-169">アクション ウィンドウで、**新規** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-169">On the Action Pane, select **New**.</span></span>
12. <span data-ttu-id="731ae-170">**名前** フィールドに、チャネル プロセスの一意な名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-170">In the **Name** field, enter a unique name for the channel profile.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-171">オンプレミス配置の場合、このフィールドにはどのような値も入力できますが、 **既定** の値は一般となります。</span><span class="sxs-lookup"><span data-stu-id="731ae-171">For on-premises deployments, any value can be entered in this field, however, the value **Default** is common.</span></span>

13. <span data-ttu-id="731ae-172">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-172">On the Action Pane, select **Save**.</span></span>
14. <span data-ttu-id="731ae-173">新しいチャネル プロファイルの **プロファイルのプロパティ** クイック タブで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-173">On the **Profile properties** FastTab for the new channel profile, select **Add**.</span></span>
15. <span data-ttu-id="731ae-174">**プロパティ キー** フィールドで、**Retail Server URL** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-174">In the **Property key** field, select **Retail Server URL**.</span></span>
16. <span data-ttu-id="731ae-175">**プロパティ値** フィールドに、インストールする Retail Server の URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-175">In the **Property value** field, enter the URL of the Retail Server that will be installed.</span></span>

    <span data-ttu-id="731ae-176">Commerce Scale Unit の URL の標準形式は、`https://<Computer Name>:<Port>/RetailServer/Commerce` です。</span><span class="sxs-lookup"><span data-stu-id="731ae-176">The standard format for the URL of Commerce Scale Unit is `https://<Computer Name>:<Port>/RetailServer/Commerce`.</span></span> <span data-ttu-id="731ae-177">この形式で、**&lt;コンピューター名&gt;** は Commerce Scale Unit がインストールされているコンピューター、またはドメイン、フル コンピューター名に結合されていないシステムの完全修飾ドメイン名 (FQDN) のどちらかです。</span><span class="sxs-lookup"><span data-stu-id="731ae-177">In this format, **&lt;Computer Name&gt;** is either the fully qualified domain name (FQDN) of the computer where Commerce Scale Unit is installed or, for systems that aren't joined to a domain, the full computer name.</span></span> <span data-ttu-id="731ae-178">**&lt;ポート&gt;** はインストールに使用するポート番号です。</span><span class="sxs-lookup"><span data-stu-id="731ae-178">**&lt;Port&gt;** is the port number that should be used in the installation.</span></span> <span data-ttu-id="731ae-179">ポート番号は、 1 ～ 65535 の範囲の値である必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-179">The port number must be a value between 1 and 65535.</span></span> <span data-ttu-id="731ae-180">既定の HTTPS ポート (443) を使用している場合、ポート番号を指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="731ae-180">If you're using the default HTTPS port (443), you don't have to specify the port number.</span></span>

17. <span data-ttu-id="731ae-181">新しいチャネル プロファイルの **プロファイルのプロパティ** クイック タブで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-181">On the **Profile properties** FastTab for the new channel profile, select **Add**.</span></span>
18. <span data-ttu-id="731ae-182">**プロパティ キー** フィールドで、**クラウド POS URL** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-182">In the **Property key** field, select **Cloud POS URL**.</span></span>
19. <span data-ttu-id="731ae-183">**プロパティ値** フィールドに、Commerce Scale Unit にインストールする必要のあるクラウド POS インスタンスの URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-183">In the **Property value** field, enter the URL of the Cloud POS instance that should be installed for Commerce Scale Unit.</span></span>

    <span data-ttu-id="731ae-184">Cloud POS の URL の標準形式は `https://<Computer Name>:<Port>/POS` です。</span><span class="sxs-lookup"><span data-stu-id="731ae-184">The standard format for the URL of Cloud POS is `https://<Computer Name>:<Port>/POS`.</span></span> <span data-ttu-id="731ae-185">この形式で、**&lt;コンピューター名&gt;** は Commerce Scale Unit がインストールされているコンピューター、またはドメイン、フル コンピューター名に結合されていないシステムの FQDN のどちらかです。</span><span class="sxs-lookup"><span data-stu-id="731ae-185">In this format, **&lt;Computer Name&gt;** is either the FQDN of the computer where the Commerce Scale Unit is installed or, for systems that aren't joined to a domain, the full computer name.</span></span> <span data-ttu-id="731ae-186">**&lt;ポート&gt;** はインストールに使用するポート番号です。</span><span class="sxs-lookup"><span data-stu-id="731ae-186">**&lt;Port&gt;** is the port number that will be used in the installation.</span></span> <span data-ttu-id="731ae-187">ポート番号は、 1 ～ 65535 の範囲の値である必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-187">The port number must be a value between 1 and 65535.</span></span> <span data-ttu-id="731ae-188">既定の HTTPS ポート (443) を使用している場合、ポート番号を指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="731ae-188">If you're using the default HTTPS port (443), you don't have to specify the port number.</span></span>

20. <span data-ttu-id="731ae-189">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-189">On the Action Pane, select **Save**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-190">メディアがよく使用される場合、プロファイルの **メディア サーバー ベース URL** を生成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-190">If media is commonly used, it will be necessary to generate a **Media Server Base URL** for the profile.</span></span>  <span data-ttu-id="731ae-191">テストとわかりやすくするために、**既定の** チャネル プロファイルに存在する URL を再利用できます。</span><span class="sxs-lookup"><span data-stu-id="731ae-191">For testing and simplicity, the URL that exists for the **Default** Channel profile can be reused.</span></span>
    >
    > <span data-ttu-id="731ae-192">オンプレミス配置では、**メディア サーバー ベースの URL** は、POS デバイスのすべてのメディアが格納されている場所になります。</span><span class="sxs-lookup"><span data-stu-id="731ae-192">For on-premises deployments, the **Media Server Base URL** will be where all media is stored for POS devices.</span></span>

21. <span data-ttu-id="731ae-193">**Retail と Commerce** &gt; **チャネル** &gt; **店舗** &gt; **すべての店舗** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-193">Go to **Retail and Commerce** &gt; **Channels** &gt; **Stores** &gt; **All stores**.</span></span>
22. <span data-ttu-id="731ae-194">新しいチャネル データベースを使用する店舗のチャネル ID を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-194">Select the channel ID for the store that will use the new channel database.</span></span>
23. <span data-ttu-id="731ae-195">選択したストアの詳細ページにある、アクション ウィンドウで、**編集** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-195">On the details page for the selected store, on the Action Pane, select **Edit**.</span></span>
24. <span data-ttu-id="731ae-196">店舗の **一般** クイック タブの、**ライブ チャネル データベース** フィールドで、手順 3 で作成したチャネル データベースを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-196">On the **General** FastTab for the store, in the **Live channel database** field, select the channel database that you created in step 3.</span></span>
25. <span data-ttu-id="731ae-197">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-197">On the Action Pane, select **Save**.</span></span>
26. <span data-ttu-id="731ae-198">店舗の **一般** クイック タブの、**チャネル プロファイル** フィールドで、手順 12 で作成したチャネル プロファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-198">On the **General** FastTab for the store, in the **Channel profile** field, select the channel profile that you created in step 12.</span></span>
27. <span data-ttu-id="731ae-199">**Retail と Commerce** &gt; **Headquarters の設定** &gt; **Commerce スケジューラ** &gt; **チャネル データ グループ** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-199">Go to **Retail and Commerce** &gt; **Headquarters setup** &gt; **Commerce scheduler** &gt; **Channel data group**.</span></span>
28. <span data-ttu-id="731ae-200">**既定** データ グループを選択した後、アクション ウィンドウで、**完全データ同期** を選択します。**配送スケジュールの選択** のフィールドで、ジョブ **9999** を選択し、**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-200">Select the **Default** data group, and then, on the Action Pane, select **Full data sync**. In the **Select a distribution schedule** field, select job **9999**, and then select **OK**.</span></span> <span data-ttu-id="731ae-201">表示されるダイアログ ボックスで、**OK** を選択して完全同期を確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-201">In the dialog box that appears, select **OK** to confirm the full synchronization.</span></span> <span data-ttu-id="731ae-202">チャンネル データベース内のすべてのデータはダウンロードの準備をします。</span><span class="sxs-lookup"><span data-stu-id="731ae-202">All the data in the channel database is prepared for download.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-203">オンプレミス配置の場合、 **既定** のチャンネルのデータ グループはありません。</span><span class="sxs-lookup"><span data-stu-id="731ae-203">For on-premises deployments, there is no **Default** channel data group.</span></span>  <span data-ttu-id="731ae-204">新しいデータ グループを作成します (そしてそれをチャネル データベースとディストリビューション スケジュールジョブに関連付けます)。</span><span class="sxs-lookup"><span data-stu-id="731ae-204">Create a new data group (and associate it to the channel database and distribution schedule jobs).</span></span>

### <a name="download-the-commerce-scale-unit-installer"></a><span data-ttu-id="731ae-205">Commerce Scale Unit インストーラーのダウンロード</span><span class="sxs-lookup"><span data-stu-id="731ae-205">Download the Commerce Scale Unit installer</span></span>

1. <span data-ttu-id="731ae-206">Headquarters で、**Retail と Commerce** &gt; **Headquarters の設定** &gt; **Commerce スケジューラ** &gt; **チャネル データベース** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-206">In Headquarters, go to **Retail and Commerce** &gt; **Headquarters setup** &gt; **Commerce scheduler** &gt; **Channel database**.</span></span>
2. <span data-ttu-id="731ae-207">左のチャネル データベースの一覧で、以前に作成したチャネル データベースを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-207">In the list of channel databases on the left, select the channel database that you created earlier.</span></span>
3. <span data-ttu-id="731ae-208">アクション ウィンドウで、**ダウンロード** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-208">On the Action Pane, select **Download**.</span></span>
4. <span data-ttu-id="731ae-209">ドロップダウン メニューで、**コンフィギュレーション ファイル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-209">On the drop-down menu, select **Configuration file**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-210">Commerce Scale Unit インストーラーが構成ファイル (XML ファイル) を正しく使用するためには、構成ファイルをインストーラーと同じ場所に保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-210">To ensure that the Commerce Scale Unit installer correctly uses the configuration file (XML file), you must save the configuration file to the same location as the installer.</span></span> <span data-ttu-id="731ae-211">構成ファイルが、実行可能なインストーラーと同じファイル名でない場合は、コマンド ラインを使用して実行可能ファイルを実行して構成ファイルを指定するか、XML 構成ファイルの名前を実行可能ファイル名と同じベース名に変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-211">If the configuration file is not the same file name as the installer executable, either the executable must be run using the command line to specify the configuration file or you need to rename the XML configuration file to have the same base name as the executable file name.</span></span>
    >
    > <span data-ttu-id="731ae-212">オンプレミス配置では、構成ファイル (この時点で) を手動で編集する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-212">For on-premises deployments, the configuration file (at this time) requires manual editing:</span></span>
    > - <span data-ttu-id="731ae-213">StoreSystemAosUrl には、Headquarters (AX) へのアクセスに使用される値が必要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-213">StoreSystemAosUrl should have the value used to access headquarters (AX).</span></span>  <span data-ttu-id="731ae-214">この URL の末尾にスラッシュを保持することが重要です (たとえば、`https://myContosoURL.com/namespaces/AXSF/`)。</span><span class="sxs-lookup"><span data-stu-id="731ae-214">It is critical to keep a trailing slash at the end of this URL (for example, `https://myContosoURL.com/namespaces/AXSF/`).</span></span>
    > - <span data-ttu-id="731ae-215">AADTokenIssuerPrefix には値 `https://NOTUSED.microsoft.com` が必要です</span><span class="sxs-lookup"><span data-stu-id="731ae-215">AADTokenIssuerPrefix should have the value `https://NOTUSED.microsoft.com`</span></span>
    > - <span data-ttu-id="731ae-216">TransactionServiceAzureAuthority には値 `https://<ADFS FQDN including .com>/adfs` が必要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-216">TransactionServiceAzureAuthority should have the value `https://<ADFS FQDN including .com>/adfs`.</span></span>
    > - <span data-ttu-id="731ae-217">TransactionServiceAzureResourceには、上記のように編集された **StoreSystemAosUrl** のベースURL値が必要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-217">TransactionServiceAzureResource should have the base URL value of the **StoreSystemAosUrl** edited as shown above.</span></span> <span data-ttu-id="731ae-218">たとえば、上記の例に基づいて `https://myContosoURL.com` が値として使用され、URLの **/namespaces/AXSF/** 部分が削除されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-218">For instance, based on the above example `https://myContosoURL.com` would be used as the value, removing the **/namespaces/AXSF/** portion of the URL.</span></span>

5. <span data-ttu-id="731ae-219">Internet Explorer ウィンドウの下部に表示される通知バーで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-219">On the Notification bar that appears at the bottom of the Internet Explorer window, select **Save**.</span></span> <span data-ttu-id="731ae-220">(通知バーは、他のブラウザでは別の場所に表示される場合があります。)</span><span class="sxs-lookup"><span data-stu-id="731ae-220">(The Notification bar might appear in a different place in other browsers.)</span></span>

    <span data-ttu-id="731ae-221">ブラウザーは、生成されたダウンロード ポップアップをブロックする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-221">Browsers might block the download pop-up that is generated.</span></span> <span data-ttu-id="731ae-222">**1 回許可** または **このサイトのオプション** &gt; **常に許可** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-222">Select either **Allow once** or **Options for this site** &gt; **Always allow**.</span></span> <span data-ttu-id="731ae-223">その後、再度 **ダウンロード** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-223">Then select **Download** again.</span></span>

6. <span data-ttu-id="731ae-224">アクション ウィンドウで、**ダウンロード** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-224">On the Action Pane, select **Download**.</span></span>
7. <span data-ttu-id="731ae-225">ドロップダウン メニューで、**Commerce Scale Unit パッケージ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-225">On the drop-down menu, select **Commerce Scale Unit package**.</span></span>
8. <span data-ttu-id="731ae-226">Internet Explorer ウィンドウの下部に表示される通知バーで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-226">On the Notification bar that appears at the bottom of the Internet Explorer window, select **Save**.</span></span> <span data-ttu-id="731ae-227">(通知バーは、他のブラウザでは別の場所に表示される場合があります。)</span><span class="sxs-lookup"><span data-stu-id="731ae-227">(The Notification bar might appear in a different place in other browsers.)</span></span>

    <span data-ttu-id="731ae-228">選択したチャネル データベースの Commerce Scale Unit パッケージに基づいて、適切なインストール パッケージがダウンロード用に自動的に選択されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-228">The correct installation package is automatically selected for download, based on the Commerce Scale Unit package on the selected channel database.</span></span>

9. <span data-ttu-id="731ae-229">セットアップ インストーラが保存されたら、通知バーの、**実行** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-229">After the setup installer has been saved, on the Notification bar, select **Run**.</span></span> <span data-ttu-id="731ae-230">(この手順はブラウザの種類によって異なる場合があります。)</span><span class="sxs-lookup"><span data-stu-id="731ae-230">(This step might differ, depending on the type of browser.)</span></span>

### <a name="run-the-commerce-scale-unit-installer"></a><span data-ttu-id="731ae-231">Commerce Scale Unit インストーラーの実行</span><span class="sxs-lookup"><span data-stu-id="731ae-231">Run the Commerce Scale Unit installer</span></span>

> [!NOTE]
> <span data-ttu-id="731ae-232">Commerce Scale Unit (自己ホスト) インストーラーを実行する前に、インストーラーの実行可能ファイルと同じ名前の構成ファイルがあることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-232">Before running the Commerce Scale Unit (self-hosted) installer, verify that the configuration file is named the same as the installer executable.</span></span> <span data-ttu-id="731ae-233">これは、**ExecutableInstallerName.xml** のように表示され、両方のファイルを同じフォルダに配置します。</span><span class="sxs-lookup"><span data-stu-id="731ae-233">This would look like **ExecutableInstallerName.xml** and put both files in the same folder.</span></span> <span data-ttu-id="731ae-234">別の方法として、構成ファイルを手動で指定するためのコマンド ライン区切り記号があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-234">Alternatively, there is a command line delimiter to specify the configuration file manually.</span></span>
> <span data-ttu-id="731ae-235">Retail Cloud POS をインストールして使用する場合は、次の手順に従って、インストーラーを初めて実行するときに構成を初期化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-235">If you plan to install and use Retail Cloud POS, you must initialize the configuration the first time that you run the installer, as described in the following procedure.</span></span>

<span data-ttu-id="731ae-236">Commerce Scale Unit インストーラーを実行する前に、すべての[システム要件](../../fin-and-ops/get-started/system-requirements.md) が満たされていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-236">Before you run the Commerce Scale Unit installer, make sure that all [system requirements](../../fin-and-ops/get-started/system-requirements.md) are met.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="731ae-237">オンプレミス環境で使用する Commerce Scale Unit をインストールする場合は、次のように、管理者権限を使用して、コマンド ラインから起動する必要があります: StoreSystemSetup.exe -UseAdfsAuthentication</span><span class="sxs-lookup"><span data-stu-id="731ae-237">If you are installing Commerce Scale Unit for use with an on-premises environment, you must start it from a command line using administrator privileges as follows: StoreSystemSetup.exe -UseAdfsAuthentication</span></span>

<span data-ttu-id="731ae-238">Commerce Scale Unit インストーラーは、まず、関連付けられているファイルを展開します。</span><span class="sxs-lookup"><span data-stu-id="731ae-238">The Commerce Scale Unit installer first extracts the associated files.</span></span> <span data-ttu-id="731ae-239">インストールを開始します。</span><span class="sxs-lookup"><span data-stu-id="731ae-239">It then begins the installation.</span></span>

1. <span data-ttu-id="731ae-240">インストーラーの最初のページで、インストールするコンポーネントを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-240">On the first page of the installer, select the components to install.</span></span> <span data-ttu-id="731ae-241">次のコンポーネントをインストールすることができます。</span><span class="sxs-lookup"><span data-stu-id="731ae-241">You can install the following components:</span></span>

   - <span data-ttu-id="731ae-242">Commerce チャネル データベースと Async Client</span><span class="sxs-lookup"><span data-stu-id="731ae-242">Commerce channel database together with Async Client</span></span>
   - <span data-ttu-id="731ae-243">Retail Server</span><span class="sxs-lookup"><span data-stu-id="731ae-243">Retail Server</span></span>
   - <span data-ttu-id="731ae-244">クラウド POS</span><span class="sxs-lookup"><span data-stu-id="731ae-244">Cloud POS</span></span>

     > [!NOTE]
     > - <span data-ttu-id="731ae-245">クラウド POS をインストールするには、Retail Server も選択してインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-245">To install Cloud POS, you must also select and install Retail Server.</span></span> <span data-ttu-id="731ae-246">店舗内で Modern POS のみを使用する場合は、**Retail クラウド POS** チェック ボックスをオフにして、ここで説明されているようにインストール プロセスを続行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-246">If you will use only Modern POS in the store, clear the **Retail Cloud POS** check box, and continue with the installation process as it's described here.</span></span>
     > - <span data-ttu-id="731ae-247">既定では、インストーラーはすべてのコンポーネントを 1 台のコンピュータにインストールします。</span><span class="sxs-lookup"><span data-stu-id="731ae-247">By default, the installer installs all components on one computer.</span></span> <span data-ttu-id="731ae-248">複数のコンピューターにコンポーネントをインストールするには、追加の手動手順を完了する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-248">To install the components across multiple computers, you must complete additional manual steps.</span></span> <span data-ttu-id="731ae-249">詳細については、「複数のコンピューターのインストール」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-249">For more information, see the "Multiple-computer installation" section.</span></span>

     <span data-ttu-id="731ae-250">インストールするすべてのコンポーネントを選択した後、**次** を選択して続行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-250">After you've selected all the components to install, select **Next** to continue.</span></span>

2. <span data-ttu-id="731ae-251">インストーラーは、すべての前提条件が満たされていることを検証します。</span><span class="sxs-lookup"><span data-stu-id="731ae-251">The installer validates that all prerequisites are met.</span></span> <span data-ttu-id="731ae-252">有効なバージョンの Microsoft SQL Server が見つからない場合、前提条件の確認中にインストーラーは失敗します。</span><span class="sxs-lookup"><span data-stu-id="731ae-252">If a valid version of Microsoft SQL Server isn't found, the installer will fail during the prerequisites check.</span></span>  <span data-ttu-id="731ae-253">サポートされているバージョンの SQL Server をインストールし、インストーラーを再試行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-253">Install a supported version of SQL Server and try the installer again.</span></span>

    > [!NOTE]
    > - <span data-ttu-id="731ae-254">この前提条件を満たすためには、SQL Server に全文検索機能を搭載し、最低限トランスポート層セキュリティ (TLS) 1.2 がサポートされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-254">To meet the prerequisites, SQL Server must have full-text search, and it must support, at a minimum, Transport Layer Security (TLS) 1.2.</span></span> <span data-ttu-id="731ae-255">サポートされているバージョンの SQL Server のシステム要件を確認してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-255">Review the system requirements for the supported versions of SQL Server.</span></span>
    > - <span data-ttu-id="731ae-256">システムの再起動が必要な場合、インストーラーはユーザーにプロンプトを表示します。</span><span class="sxs-lookup"><span data-stu-id="731ae-256">If a system restart is required, the installer will prompt the user.</span></span>  <span data-ttu-id="731ae-257">このプロンプトは、再起動が必要かどうかをすべてのアプリケーションに通知する Windows システム レジストリ キーに基づいています。</span><span class="sxs-lookup"><span data-stu-id="731ae-257">This prompt is based upon a Windows system registry key that notifies all applications if a restart is required.</span></span> <span data-ttu-id="731ae-258">インストールを続行する前に再起動することをお勧めしますが、再起動は必須ではなく、インストーラーはコンピュータを再起動せずに続行することができます。</span><span class="sxs-lookup"><span data-stu-id="731ae-258">While it is recommended to restart prior to continuing the installation, a restart is not required and the installer can continue without restarting the computer.</span></span>

3. <span data-ttu-id="731ae-259">Application Object Server (AOS) の URL を確認し、**次へ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-259">Verify the URL for Application Object Server (AOS), and then select **Next**.</span></span> <span data-ttu-id="731ae-260">(AOS URL とは、Headquarters にアクセスするために使用される URL のことです。)</span><span class="sxs-lookup"><span data-stu-id="731ae-260">(The AOS URL is the URL that is used to access Headquarters.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-261">Retail Server URL は、構成ファイルから自動的に入力されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-261">The Retail Server URL is automatically entered from the configuration file.</span></span>

4. <span data-ttu-id="731ae-262">HTTPS 通信に使用する、有効な Secure Sockets Layer (SSL) 証明書を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-262">Select a valid Secure Sockets Layer (SSL) certificate to use for HTTPS communication.</span></span>

    <span data-ttu-id="731ae-263">証明書は秘密キー ストレージを使用する必要があり、サーバー認証は拡張キー使用プロパティにリストされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-263">The certificate must use private key storage, and server authentication must be listed in the enhanced key usage property.</span></span> <span data-ttu-id="731ae-264">また、証明書はローカルに信頼される必要があり、期限切れにすることはできません。</span><span class="sxs-lookup"><span data-stu-id="731ae-264">Additionally, the certificate must be trusted locally, and it can't be expired.</span></span> <span data-ttu-id="731ae-265">ローカル コンピューターの個人用証明書格納場所に保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-265">It must be stored in the personal certificate store location on the local computer.</span></span>

5. <span data-ttu-id="731ae-266">特定のユーザーが必要な場合は、アプリケーション プールを実行するために必要なユーザー名とパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-266">If a specific user is required, enter the user name and password that the application pool should run under.</span></span> <span data-ttu-id="731ae-267">既定では、インストーラーは自動的に使用するサービス アカウントを生成します。</span><span class="sxs-lookup"><span data-stu-id="731ae-267">By default, the installer automatically generates a service account to use.</span></span> <span data-ttu-id="731ae-268">この方法は、安全性がより向上するためお勧めします。</span><span class="sxs-lookup"><span data-stu-id="731ae-268">This approach is more secure and is recommended.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-269">最初から用意されているサービス アカウントは、他のすべてのアカウントに定義されているのと同じパスワード ポリシー下で引き続き機能する点に留意することは重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-269">It is important to note that service accounts, out of box, still function under the same password policy that is defined for all other accounts.</span></span>  <span data-ttu-id="731ae-270">つまり、最小限のパスワード有効期間ポリシーが引き続き Retail Server サービス アカウントに適用されるため、必要な場合に更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-270">This means that the minimum password age policy still applies to the Retail Server service account and must be updated when necessary.</span></span>  <span data-ttu-id="731ae-271">既定では、Windows Server 2012 R2 では通常 42 日です。</span><span class="sxs-lookup"><span data-stu-id="731ae-271">By default, on Windows Server 2012 R2, this is typically 42 days.</span></span>  <span data-ttu-id="731ae-272">使用されるサービス アカウントのパスワードが期限切れの場合、問題が解決されるまで Commerce Scale Unit コンポーネントが機能しなくなります。</span><span class="sxs-lookup"><span data-stu-id="731ae-272">If the password does expire on a used service account, the Commerce Scale Unit components will fail to continue functioning until the issue is resolved.</span></span>

6. <span data-ttu-id="731ae-273">次のページで、小売サーバー アプリケーション プールと Async Client のユーザー アカウントとパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-273">On the next page, enter the user account and password for the Retail Server application pool and Async Client.</span></span> <span data-ttu-id="731ae-274">既定では、このアカウントは自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-274">By default, this account is automatically generated.</span></span> <span data-ttu-id="731ae-275">ただし、ユーザー アカウントとパスワードを手動で入力できます。</span><span class="sxs-lookup"><span data-stu-id="731ae-275">However, you can manually enter the user account and password.</span></span>
7. <span data-ttu-id="731ae-276">使用する HTTPS ポートを入力し、コンピューターのホスト名が正しいことを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-276">Enter the HTTPS port to use, and verify that the host name of the computer is correct.</span></span> <span data-ttu-id="731ae-277">その後、**次へ** を選択して続行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-277">Then select **Next** to continue.</span></span>

    > [!NOTE]
    > - <span data-ttu-id="731ae-278">インストーラーは自動的にホスト名を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-278">The installer automatically enters the host name.</span></span> <span data-ttu-id="731ae-279">何らかの理由で、インストールのためにホスト名を変更する必要がある場合は、ここで変更します。</span><span class="sxs-lookup"><span data-stu-id="731ae-279">If, for any reason, the host name must be changed for the installation, change it here.</span></span> <span data-ttu-id="731ae-280">ホスト名はシステムの FQDN でなければなりません。また、選択した Store システム エントリの **ホスト名** フィールドに入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-280">The host name must be the FQDN of the system, and it must be entered in the **Host name** field for the selected Store system entry.</span></span>

8. <span data-ttu-id="731ae-281">アプリケーション ID (クライアント ID) およびこの Commerce Scale Unit インストールと関連するキー (シークレット) を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-281">Enter the application ID (client ID) and key (secret) that are associated with this Commerce Scale Unit installation.</span></span> <span data-ttu-id="731ae-282">また、コンフィギュレーション ファイルから自動的に入力されるチャネル データベース ID を確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-282">Additionally, verify the channel database ID, which is automatically entered from the configuration file.</span></span> <span data-ttu-id="731ae-283">その後、**インストール** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-283">Then select **Install**.</span></span> <span data-ttu-id="731ae-284">Retail Cloud POS を使用する場合は、ページの下部にある **Retail Cloud POS のコンフィギュレーション** チェック ボックスが選択されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-284">If you will use Retail Cloud POS, make sure that the **Configure Retail Cloud POS** check box at the bottom of the page is selected.</span></span> <span data-ttu-id="731ae-285">この構成では Azure AD サインインが要求され、必要なすべての情報が Azure で自動的に生成され、Retail Cloud POS をオンプレミスで使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="731ae-285">This configuration requests Azure AD sign-in and automatically generates all required information in Azure, so that Retail Cloud POS can be used on-premises.</span></span> <span data-ttu-id="731ae-286">オンプレミス環境で使用する Commerce Scale Unit をインストールする場合、このオプションをオフにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-286">If you are installing Commerce Scale Unit for use with an on-premises environment, you must clear this option.</span></span>

    <span data-ttu-id="731ae-287">Azure で Web アプリケーションを作成する方法については、[Azure Active Directory アプリケーションを作成する](/azure/azure-resource-manager/resource-group-create-service-principal-portal#create-an-azure-active-directory-application) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-287">For information about how to create web applications in Azure, see [Create an Azure Active Directory application](/azure/azure-resource-manager/resource-group-create-service-principal-portal#create-an-azure-active-directory-application).</span></span>

    > [!IMPORTANT]
    > - <span data-ttu-id="731ae-288">オンプレミス環境で使用する Commerce Scale Unit をインストールするとき、クラウド POS は Azure または AD FS アプリケーションの構成を要求しないため、**Retail クラウド POS の構成** のマークを解除することが重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-288">When installing Commerce Scale Unit for use with an on-premises environment, Cloud POS does not require an Azure or AD FS application to be configured, so it is important to unmark **Configure Retail Cloud POS**.</span></span>
    > - <span data-ttu-id="731ae-289">オンプレミス環境で使用する Commerce Scale Unit をインストールするとき、使用されるクライアント ID (アプリケーション ID) およびシークレット (キー) は、[オンプレミス環境の Commerce チャネル コンポーネントのインストール手順](../../dev-itpro/deployment/deploy-retail-onprem.md) トピックの手順 6 ～ 8 で実行される構成手順で実行される PowerShell スクリプトによって生成される値になります。</span><span class="sxs-lookup"><span data-stu-id="731ae-289">When installing Commerce Scale Unit for use with an on-premises environment, the Client ID (Application ID) and Secret (Key) used will be the values generated by the PowerShell script performed in the configuration steps performed in steps 6-8 in the [Installation steps for Commerce channel components in an on-premises environment](../../dev-itpro/deployment/deploy-retail-onprem.md) topic.</span></span> <span data-ttu-id="731ae-290">(手順 6 ではクライアント ID を作成し、手順 8 ではコピーされるシークレットをリセットします)。</span><span class="sxs-lookup"><span data-stu-id="731ae-290">(Step 6 creates the Client ID and step 8 resets the Secret to be copied.)</span></span>

    <span data-ttu-id="731ae-291">Web アプリを作成するとき、最初の URI と URL は特定の値である必要はありません。</span><span class="sxs-lookup"><span data-stu-id="731ae-291">When you create the Web App, the initial URI and URL don't have to be any specific value.</span></span> <span data-ttu-id="731ae-292">作成されるアプリケーション ID (クライアント ID) とキー (シークレット) のみ重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-292">Only the application ID (client ID) and key (secret) that are created are important.</span></span>

9. <span data-ttu-id="731ae-293">Commerce Scale Unit のアプリケーション ID (クライアント ID) とキー (シークレット) が作成された後、Commerce でアプリケーション ID (クライアント ID) を受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-293">After the application ID (client ID) and key (secret) are created for Commerce Scale Unit, the application ID (client ID) must be accepted in Commerce.</span></span> <span data-ttu-id="731ae-294">次の手順に従って、Headquarters で構成を完了します。</span><span class="sxs-lookup"><span data-stu-id="731ae-294">Follow the next procedure to finish the configuration in Headquarters.</span></span>
10. <span data-ttu-id="731ae-295">インストールが完了すると、最終正常性ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-295">After the installation is complete, the final health page appears.</span></span> <span data-ttu-id="731ae-296">このページには、インストールが成功したかどうかが表示されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-296">This page shows whether the installation was successful.</span></span> <span data-ttu-id="731ae-297">また、基本的な接続テストに基づいた各コンポーネントの正常性と、このトピックの場所について示します。</span><span class="sxs-lookup"><span data-stu-id="731ae-297">It also shows the health of each component, based on basic connection tests, and the location of this topic.</span></span> <span data-ttu-id="731ae-298">インストールに失敗した場合は、ページにログ ファイルの場所が表示されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-298">If the installation wasn't successful, the page shows the location of the log files.</span></span> <span data-ttu-id="731ae-299">Commerce Scale Unit の構成を完了して、すべてのコンポーネントが正しく動作するまで、この最終正常性ページを開いたままにしておくことをお勧めします (次のセクションを完了することが必要)。</span><span class="sxs-lookup"><span data-stu-id="731ae-299">We recommend that you keep this final health page open until you've completed the configuration of Commerce Scale Unit and all components are working correctly (Requiring the completion of the following section).</span></span>

### <a name="finish-the-configuration-in-headquarters"></a><span data-ttu-id="731ae-300">Headquarters で構成を完了する</span><span class="sxs-lookup"><span data-stu-id="731ae-300">Finish the configuration in Headquarters</span></span>

<span data-ttu-id="731ae-301">最後のステップでは、Azure アプリケーション ID (クライアント ID) とキー (シークレット) が Headquarters で正しく受け入れられ、環境と新しい Commerce Scale Unit との接続が可能であることを検証し、確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-301">The last steps require validation and verification that the Azure application ID (client ID) and key (secret) are correctly accepted in Headquarters, so that connections can be made between the environment and the new Commerce Scale Unit.</span></span>

1. <span data-ttu-id="731ae-302">Commerce Scale Unit にアプリケーション ID (クライアント ID) とキー (シークレット) が作成され、インストーラーに入力された後、Headquarters でアプリケーション ID (クライアント ID) を受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-302">After the application ID (client ID) and key (secret) are created for Commerce Scale Unit and entered in the installer, the application ID (client ID) must be accepted in Headquarters.</span></span>

    <span data-ttu-id="731ae-303">Headquarters で、**システム管理** &gt; **設定** &gt; **Azure Active Directory アプリケーション** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-303">In Headquarters, go to **System administration** &gt; **Setup** &gt; **Azure Active Directory applications**.</span></span> <span data-ttu-id="731ae-304">アプリケーション ID (クライアントID) を **クライアント ID** 列に入力し、説明のテキストを **名** 列に入力および **RetailServiceAccount** を **ユーザー ID** 列に入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-304">Enter the application ID (client ID) in the **Client ID** column, enter descriptive text in the **Name** column, and enter **RetailServiceAccount** in the **User ID** column.</span></span>

2. <span data-ttu-id="731ae-305">クラウド POS を使用するように構成されている場合、インストールの最後にクライアント ID が表示されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-305">If Cloud POS is configured for use, a client ID is shown at the end of the installation.</span></span> <span data-ttu-id="731ae-306">このクライアント ID を Commerce の **Commerce 共有パラメーター** ページに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-306">You must add this client ID to the **Commerce shared parameters** page in Commerce.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-307">オンプレミス型環境では、このステップは必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="731ae-307">In an on-premises environment, this step is not required to be completed.</span></span>

    1. <span data-ttu-id="731ae-308">バックオフィスで、**Retail とコマース** &gt; **バックオフィスの設定** &gt; **パラメーター** &gt; **コマースの共有パラメーター** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-308">In Headquarters, go to **Retail and Commerce** &gt; **Headquarters setup** &gt; **Parameters** &gt; **Commerce shared parameters**.</span></span>
    2. <span data-ttu-id="731ae-309">**ID プロバイダー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-309">Select **Identity providers**.</span></span>
    3. <span data-ttu-id="731ae-310">**ID プロバイダー** クイック タブで、`HTTPS://sts.windows.net/` で始まるプロバイダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-310">On the **Identity providers** FastTab, select the provider that begins with `HTTPS://sts.windows.net/`.</span></span> <span data-ttu-id="731ae-311">選択に基づいて、**依存する関係者** FastTab の値が設定されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-311">The values on the **Relying parties** FastTab are set, based on your selection.</span></span>
    4. <span data-ttu-id="731ae-312">**依存する関係者** クイック タブで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-312">On the **Relying parties** FastTab, select **Add**.</span></span> <span data-ttu-id="731ae-313">Commerce Scale Unit インストーラーの最終正常性ページに表示されているクライアント ID を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-313">Enter the client ID that is listed on the final health page of the Commerce Scale Unit installer.</span></span> <span data-ttu-id="731ae-314">**Type** フィールドを **Public** に、**UserType** フィールドを **Worker** に設定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-314">Set the **Type** field to **Public** and the **UserType** field to **Worker**.</span></span> <span data-ttu-id="731ae-315">[アクション] ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-315">Then, on the Action Pane, select **Save**.</span></span>
    5. <span data-ttu-id="731ae-316">新しい依存する関係者を選択し、**サーバー リソース ID** クイック タブで **追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-316">Select the new relying party, and then, on the **Server resource IDs** FastTab, select **Add**.</span></span> <span data-ttu-id="731ae-317">**サーバー リソース ID** 列に、`https://retailstorescaleunit.retailserver.com` と入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-317">In the **Server Resource ID** column, enter `https://retailstorescaleunit.retailserver.com`.</span></span>
    6. <span data-ttu-id="731ae-318">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-318">On the Action Pane, select **Save**.</span></span>

3. <span data-ttu-id="731ae-319">バックオフィスで、**Retail とコマース** &gt; **バックオフィスの設定** &gt; **パラメーター** &gt; **コマースの共有パラメーター** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-319">In Headquarters, go to **Retail and Commerce** &gt; **Headquarters setup** &gt; **Parameters** &gt; **Commerce shared parameters**.</span></span>
4. <span data-ttu-id="731ae-320">**ID プロバイダー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-320">Select **Identity providers**.</span></span>
5. <span data-ttu-id="731ae-321">**ID プロバイダー** クイック タブで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-321">On the **Identity providers** FastTab, select **Add**.</span></span>
6. <span data-ttu-id="731ae-322">新しい **発行者** 行に、新たにインストールした Commerce Scale Unit の URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-322">In the new **Issuer** row, enter the URL of the newly installed Commerce Scale Unit.</span></span> <span data-ttu-id="731ae-323">URL の末尾に **/auth** を追加します。URL は `https://<My Case-Sensitive Computer Name>:<Port Number>/RetailServer/auth` のようになります。</span><span class="sxs-lookup"><span data-stu-id="731ae-323">At the end of the URL, add **/auth**. The URL will resemble `https://<My Case-Sensitive Computer Name>:<Port Number>/RetailServer/auth`.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-324">上記 URL では、大文字と小文字を区別します。</span><span class="sxs-lookup"><span data-stu-id="731ae-324">The URL described above is case sensitive.</span></span>
    > <span data-ttu-id="731ae-325">インストールされている各 Commerce Scale Unit に新しい ID プロバイダー行があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-325">There will be a new identity provider line for each Commerce Scale Unit that is installed.</span></span> <span data-ttu-id="731ae-326">それぞれに、この URL に似た URL が作成されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-326">Each will have a URL that resembles this URL.</span></span>

7. <span data-ttu-id="731ae-327">**名前** 列に、URL が属する店舗の説明を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-327">In the **Name** column, enter a description for the store that the URL belongs to.</span></span>
8. <span data-ttu-id="731ae-328">**タイプ** 列で、**OpenID 接続** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-328">In the **Type** column, select **Open ID Connect**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-329">この新しい行は、すべての Commerce Scale Unit のインストール (つまり、一意の URL ごと) に複製する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-329">This new row must be duplicated for every Commerce Scale Unit installation (that is, for every unique URL).</span></span>

9. <span data-ttu-id="731ae-330">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-330">On the Action Pane, select **Save**.</span></span>
10. <span data-ttu-id="731ae-331">**ID プロバイダー** クイック タブで、新しく作成された明細行を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-331">On the **Identity providers** FastTab, select the newly created line.</span></span> <span data-ttu-id="731ae-332">選択に基づいて、**依存する関係者** FastTab の値が設定されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-332">The values on the **Relying parties** FastTab are set, based on your selection.</span></span>
11. <span data-ttu-id="731ae-333">**依存する関係者** クイック タブで、**追加** を選択し、次の 2 つのエントリを追加します。</span><span class="sxs-lookup"><span data-stu-id="731ae-333">On the **Relying parties** FastTab, select **Add**, and add the following two entries:</span></span>

    - <span data-ttu-id="731ae-334">**ClientId** 列に、**クラウド POS** を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-334">In the **ClientId** column, enter **Cloud POS**.</span></span> <span data-ttu-id="731ae-335">**Type** フィールドを **Public** に、**UserType** フィールドを **Worker** に設定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-335">Set the **Type** field to **Public** and the **UserType** field to **Worker**.</span></span>
    - <span data-ttu-id="731ae-336">**ClientId** 列に、**Modern POS** を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-336">In the **ClientId** column, enter **Modern POS**.</span></span> <span data-ttu-id="731ae-337">**Type** フィールドを **Public** に、**UserType** フィールドを **Worker** に設定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-337">Set the **Type** field to **Public** and the **UserType** field to **Worker**.</span></span>

12. <span data-ttu-id="731ae-338">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-338">On the Action Pane, select **Save**.</span></span>
13. <span data-ttu-id="731ae-339">コマースで、**Retail とコマース** &gt; **Retail とコマース IT** &gt; **配送スケジュール** の順に移動し、CDX ジョブ **1110** を実行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-339">In Commerce, go to **Retail and commerce** &gt; **Retail and commerce IT** &gt; **Distribution Schedule**, and run CDX Job **1110**.</span></span>
14. <span data-ttu-id="731ae-340">完了したら、インストーラーに戻り、**完了** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-340">When you've finished, return to the installer, and select **Finish**.</span></span>

    <span data-ttu-id="731ae-341">インストーラーの最後のページには、すべてのコンポーネントが正しく動作することをテストして検証するために使用できる貴重な情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="731ae-341">The final page of the installer includes valuable information that you can use to test and validate that all components work correctly.</span></span> <span data-ttu-id="731ae-342">このページは、検証が完了する段階まで開いたままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="731ae-342">Keep this page open until you've completed the validation.</span></span>

> [!NOTE]
> <span data-ttu-id="731ae-343">インストーラーが Retail Server または Async Client のチェック マークを表示しない場合は、10 分待って、キャッシュされた値をクラウドで更新できるようにします。</span><span class="sxs-lookup"><span data-stu-id="731ae-343">If the installer doesn't show a check mark for Retail Server or Async Client, wait 10 minutes so that any cached values can be updated in the cloud.</span></span> <span data-ttu-id="731ae-344">再び確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-344">Then check again.</span></span> <span data-ttu-id="731ae-345">それでもインストーラーが完全に成功しない場合は、このインストールを使用する新しいチャンネル データベースで完全同期を実行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-345">If the installer still isn't fully successful, run a full synchronization on the new channel database that this installation uses.</span></span>
>
> <span data-ttu-id="731ae-346">すべての手順を正しく実行する場合、構成には次の特性が必要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-346">If you followed all the steps correctly, your configuration should have these characteristics:</span></span>
>
> - <span data-ttu-id="731ae-347">Azure では、2 つの Web アプリケーションはインストーラー経由で自動的に生成されています。</span><span class="sxs-lookup"><span data-stu-id="731ae-347">In Azure, two web applications have been automatically generated through the installer:</span></span>
>
>   - <span data-ttu-id="731ae-348">Retail Store Scale Unitクラウド POS</span><span class="sxs-lookup"><span data-stu-id="731ae-348">Retail Store Scale Unit Cloud POS</span></span>
>   - <span data-ttu-id="731ae-349">Retail Store Scale Unit Cloud POS 用 Retail サーバー</span><span class="sxs-lookup"><span data-stu-id="731ae-349">Retail Store Scale Unit Retail Server for Cloud POS</span></span>
>
> - <span data-ttu-id="731ae-350">Azure では、Web アプリケーション (つまり、新しい Azure ポータルでのアプリ登録) は各 Commerce Scale Unit のインストールに対して手動で作成されています (たとえば、CommerceScaleUnitHouston)。</span><span class="sxs-lookup"><span data-stu-id="731ae-350">In Azure, a web application (that is, an App registration in the new Azure portal) has been manually created for each Commerce Scale Unit installation (for example, CommerceScaleUnitHouston).</span></span> <span data-ttu-id="731ae-351">作成されたキー (シークレット) は、前述のようにインストーラーで使用できます。</span><span class="sxs-lookup"><span data-stu-id="731ae-351">A key (secret) has been created that can be used in the installer, as described earlier.</span></span>
> - <span data-ttu-id="731ae-352">手動で作成した Web アプリケーションのアプリケーション ID (クライアント ID) は、前の手順のステップ 1 で説明したように、Commerce の **Azure Active Directory アプリケーション** ページに追加されています。</span><span class="sxs-lookup"><span data-stu-id="731ae-352">The application ID (client ID) of the manually created web application has been added to the **Azure Active Directory applications** page in Commerce, as explained in step 1 of the preceding procedure.</span></span>
> - <span data-ttu-id="731ae-353">Commerce Scale Unit インストーラーの最後に表示されるクラウド POS アプリケーション ID (クライアント ID) は、「Commerce Scale Unit インストーラーを実行」セクションの最後の手順で説明されているように、**ID プロバイダー** クイック タブに追加されています。</span><span class="sxs-lookup"><span data-stu-id="731ae-353">The Cloud POS application ID (client ID) that was shown at the end of the Commerce Scale Unit installer has been added on the **Identity providers** FastTab, as explained in the final steps of the "Run the Commerce Scale Unit installer" section.</span></span>

### <a name="multiple-computer-installation"></a><span data-ttu-id="731ae-354">複数のコンピューターのインストール</span><span class="sxs-lookup"><span data-stu-id="731ae-354">Multiple-computer installation</span></span>

<span data-ttu-id="731ae-355">上級者のみ、複数のコンピューターに Commerce Scale Unit をインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-355">Only advanced users should install Commerce Scale Unit across multiple computers.</span></span> <span data-ttu-id="731ae-356">次の一連の手順では、1 台のコンピューターにコマース チャネル データベースと Async Client、2 台目のコンピューターに Retail Server とクラウド POS をインストールする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="731ae-356">The following set of procedures explains how to install the Commerce channel database and Async Client on one computer, and Retail Server and Cloud POS on a second computer.</span></span> <span data-ttu-id="731ae-357">指示では、両方のシステムが同じドメイン上にあり、インストールされるサービスのユーザーが両方のシステムで既に作成されていることが前提です。</span><span class="sxs-lookup"><span data-stu-id="731ae-357">The instructions assume that both systems are on the same domain, and that users for the services that will be installed have already been created on both systems.</span></span> <span data-ttu-id="731ae-358">Headquarters ですべての構成を行うことが重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-358">It's important that you do all configuration in Headquarters.</span></span>

#### <a name="installation-on-the-first-computer"></a><span data-ttu-id="731ae-359">最初のコンピューターへのインストール</span><span class="sxs-lookup"><span data-stu-id="731ae-359">Installation on the first computer</span></span>

<span data-ttu-id="731ae-360">最初のコンピューターで、このトピックで前述されているように、Commerce Scale Unit セルフ サービス インストーラーを実行しますが、次の変更を行います。</span><span class="sxs-lookup"><span data-stu-id="731ae-360">On the first computer, run the Commerce Scale Unit self-service installer as described earlier in this topic, but make the following changes.</span></span>

1. <span data-ttu-id="731ae-361">インストールするコンポーネントとして Commerce チャネル データベースと Async Client のみを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-361">Select only Commerce channel database and Async Client as the components to install.</span></span> <span data-ttu-id="731ae-362">その後 **次へ** を選択して、インストールを続行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-362">Then select **Next** to continue with the installation.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-363">Async Client はインストールされたコンピューターの外部からアクセスすることができないため、Async Client のために生成されたサービス アカウントを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="731ae-363">You can use a generated service account for Async Client, because Async Client won't be accessed outside the computer that it's installed on.</span></span>

2. <span data-ttu-id="731ae-364">クライアント ID およびキー (シークレット) を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-364">Enter the client ID and key (secret).</span></span> <span data-ttu-id="731ae-365">2 台目のコンピューターで再度使用できるように、これらの詳細情報を使用可能な状態にしておきます。</span><span class="sxs-lookup"><span data-stu-id="731ae-365">Keep these details available, so that you can use them again on the second computer.</span></span>
3. <span data-ttu-id="731ae-366">Commerce Scale Unit のクライアント ID とキー (シークレット) が作成された後、Commerce でクライアント ID を受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-366">After a client ID and key (secret) are created for Commerce Scale Unit, the client ID must be accepted in Commerce.</span></span> <span data-ttu-id="731ae-367">**システム管理** &gt; **設定** &gt; **Azure Active Directory アプリケーション** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-367">Go to **System administration** &gt; **Setup** &gt; **Azure Active Directory applications**.</span></span> <span data-ttu-id="731ae-368">クライアント ID を **クライアント ID** 列に入力し、説明のテキストを **名** 列に入力および **RetailServiceAccount** を **ユーザー ID** 列に入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-368">Enter the client ID in the **Client ID** column, enter descriptive text in the **Name** column, and enter **RetailServiceAccount** in the **User ID** column.</span></span>
4. <span data-ttu-id="731ae-369">セットアップが正常に行われたときは、SQL Server 構成マネージャーを起動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-369">When setup is successful, start SQL Server Configuration Manager.</span></span>
5. <span data-ttu-id="731ae-370">SQL Server インスタンスの **SQL Server ネットワークの構成** &gt; **プロトコル** に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-370">Go to **SQL Server Network Configuration** &gt; **Protocols** for the SQL Server instance.</span></span>
6. <span data-ttu-id="731ae-371">右クリックし、**プロパティ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-371">Right-click, and then select **Properties**.</span></span>
7. <span data-ttu-id="731ae-372">**フラグ** セクションで、**強制暗号化の設定** の値を **はい** に変更します。</span><span class="sxs-lookup"><span data-stu-id="731ae-372">In the **Flags** section, change the value of **Set Force Encryption** to **Yes**.</span></span>
8. <span data-ttu-id="731ae-373">**証明書** セクションで、ドロップダウン メニューから SSL 証明書を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-373">In the **Certificate** section, select the SSL certificate on the drop-down menu.</span></span> <span data-ttu-id="731ae-374">この SQL Server SSL 証明書は、インストーラーで使用されているのと同じ証明書です。</span><span class="sxs-lookup"><span data-stu-id="731ae-374">This SQL Server SSL certificate is the same certificate that is used in the installer.</span></span>
9. <span data-ttu-id="731ae-375">**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-375">Select **OK**.</span></span>
10. <span data-ttu-id="731ae-376">SQL Server 構成マネージャで **プロトコル** に戻り、次のプロトコルを有効にします。</span><span class="sxs-lookup"><span data-stu-id="731ae-376">Go back to **Protocols** in SQL Server Configuration Manager, and enable the following protocols:</span></span>

    - <span data-ttu-id="731ae-377">名前付きパイプ</span><span class="sxs-lookup"><span data-stu-id="731ae-377">Named Pipes</span></span>
    - <span data-ttu-id="731ae-378">TCP/IP</span><span class="sxs-lookup"><span data-stu-id="731ae-378">TCP/IP</span></span>

11. <span data-ttu-id="731ae-379">**TCP/IP** プロトコルを右クリックし、**プロパティ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-379">Right-click the **TCP/IP** protocol, and then select **Properties**.</span></span>
12. <span data-ttu-id="731ae-380">**IP アドレス** セクションで、一覧を **IPALL** まで下方向にスクロールします。</span><span class="sxs-lookup"><span data-stu-id="731ae-380">In the **IP Address** section, scroll down the list to **IPALL**.</span></span>
13. <span data-ttu-id="731ae-381">**TCPPort = 1433** と入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-381">Enter **TCPPort = 1433**.</span></span>
14. <span data-ttu-id="731ae-382">**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-382">Select **OK**.</span></span>
15. <span data-ttu-id="731ae-383">高度なセキュリティの Microsoft Windows ファイアウォールを起動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-383">Start Microsoft Windows Firewall with Advanced Security.</span></span>
16. <span data-ttu-id="731ae-384">Windows ファイアウォールで、TCP ポート 1433 を開放する受信ルールを作成します。</span><span class="sxs-lookup"><span data-stu-id="731ae-384">In Windows Firewall, create an inbound rule to open TCP port 1433.</span></span>

<span data-ttu-id="731ae-385">SQL Server および Windows ファイアウォールに関する詳細については、[データベース エンジンへ アクセス用の Windows ファイアウォールをコンフィギュレーションする](https://msdn.microsoft.com/library/ms175043.aspx) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-385">For detailed information about SQL Server and Windows Firewall, see [Configure a Windows Firewall for Database Engine Access](https://msdn.microsoft.com/library/ms175043.aspx).</span></span>

#### <a name="installation-on-the-second-computer"></a><span data-ttu-id="731ae-386">2 台目のコンピューターへのインストール</span><span class="sxs-lookup"><span data-stu-id="731ae-386">Installation on the second computer</span></span>

<span data-ttu-id="731ae-387">2 台目のコンピューターで、このトピックで前述されているように、Commerce Scale Unit セルフ サービス インストーラーを実行しますが、次の変更を行います。</span><span class="sxs-lookup"><span data-stu-id="731ae-387">On the second computer, run the Commerce Scale Unit Self-service installer as described earlier in this topic, but make the following changes.</span></span>

1. <span data-ttu-id="731ae-388">インストールするコンポーネントとして Retail Server とクラウド POS のみを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-388">Select only Retail Server and Cloud POS as the components to install.</span></span> <span data-ttu-id="731ae-389">Retail Server をインストールしている場合は、Cloud POS を選択できません。</span><span class="sxs-lookup"><span data-stu-id="731ae-389">If you are installing only Retail Server, don't select Cloud POS.</span></span> <span data-ttu-id="731ae-390">その後 **次へ** を選択して、インストールを続行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-390">Then select **Next** to continue with the installation.</span></span>
2. <span data-ttu-id="731ae-391">最初のコンピュータで、SQL Server にアクセスする権限を持つドメイン ユーザーの資格情報 (ユーザー名およびパスワード) を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-391">Enter the domain user credentials (user name and password) that have permission to access SQL Server on the first computer.</span></span> <span data-ttu-id="731ae-392">その後、**次へ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-392">Then select **Next**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-393">Retail サーバーでは、最初のコンピューター上の SQL データベースへのアクセスが必要なため、生成されたサービス アカウントは使用できません。</span><span class="sxs-lookup"><span data-stu-id="731ae-393">A generated service account can't be used, because Retail Server requires access to the SQL database on the first computer.</span></span> <span data-ttu-id="731ae-394">ドメイン アカウントを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-394">You must use a domain account.</span></span>

3. <span data-ttu-id="731ae-395">最初のコンピューターで使用される同じクライアント ID およびキー (シークレット) を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-395">Enter the same Client ID and key (secret) that are used on the first computer.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="731ae-396">前述のようにコマース バックオフィスにこのクライアント ID を追加することが重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-396">It's critical that you add this Client ID to Commerce headquarters as described earlier.</span></span>

4. <span data-ttu-id="731ae-397">**クラウド POS のコンフィギュレーション** を選択し、Azure Web アプリケーションを作成するための適切なアクセス許可を持つ Azure AD 資格情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-397">Select **Configure Cloud POS**, and then enter Azure AD credentials that have the correct permissions to create Azure Web Apps.</span></span>

    <span data-ttu-id="731ae-398">Azure Web アプリ、それを作成する方法、および新しいキー (シークレット) を生成する方法の詳細については、[リソースにアクセスできる Azure Active Directory アプリケーションおよびサービス プリンシパルを作成するポータルの使用](https://azure.microsoft.com/documentation/articles/resource-group-create-service-principal-portal/) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-398">For more information about Azure Web Apps, how to create them, and how to generate a new key (secret), see [Use portal to create an Azure Active Directory application and service principal that can access resources](https://azure.microsoft.com/documentation/articles/resource-group-create-service-principal-portal/).</span></span> <span data-ttu-id="731ae-399">サインイン URL やアプリ ID URI は重要ではないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-399">Note that the sign-in URL and the App ID URI are not important.</span></span>

5. <span data-ttu-id="731ae-400">セットアップが正常に行われたときは、インストーラーを終了しません。</span><span class="sxs-lookup"><span data-stu-id="731ae-400">When setup is successful, don't exit the installer.</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-401">最初は、データベースがまだ正しく設定されていないため、ヘルスチェック ping は成功しません。</span><span class="sxs-lookup"><span data-stu-id="731ae-401">At first, the health check ping won't be successful, because the database isn't yet set up correctly.</span></span> <span data-ttu-id="731ae-402">この手順の残りのステップを完了した後は、再度稼働状況チェックをテストできます。</span><span class="sxs-lookup"><span data-stu-id="731ae-402">After you've completed the remaining steps of this procedure, you can test the health check again.</span></span>

6. <span data-ttu-id="731ae-403">**Microsoft インターネット インフォメーション サービス (IIS)** を起動し、**Retail Server** Web サイトを選択して、**Retail Server** Web アプリケーションを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-403">Start **Microsoft Internet Information Services (IIS)**, select the **Retail Server** website, and select the **Retail Server** web application.</span></span>
7. <span data-ttu-id="731ae-404">作業ディレクトリを検証します。</span><span class="sxs-lookup"><span data-stu-id="731ae-404">Explore the working directory.</span></span>
8. <span data-ttu-id="731ae-405">Web.config ファイルを開いて、**connectionStrings** セクションで、**サーバー名** を追加します。</span><span class="sxs-lookup"><span data-stu-id="731ae-405">Open the Web.config file, and then, in the **connectionStrings** section, add **Server name**.</span></span> <span data-ttu-id="731ae-406">**サーバー名** はユーザーがコンポーネントをインストールした最初のコンピュータの名前です。</span><span class="sxs-lookup"><span data-stu-id="731ae-406">**Server name** is the name of the first computer where you installed components.</span></span> <span data-ttu-id="731ae-407">ファイル保存します。</span><span class="sxs-lookup"><span data-stu-id="731ae-407">Save the file.</span></span>
9. <span data-ttu-id="731ae-408">使用されている証明書が信頼できる機関の有効な信頼できる証明書でない場合は、CERTMGR.MSC を開いて次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-408">If the certificate that is used isn't a valid, trusted certificate from a trusted authority, open CERTMGR.MSC, and follow these steps:</span></span>

    1. <span data-ttu-id="731ae-409">前に作成した SQL Server SSL 証明書をインポートし、信頼されたルートに追加します。</span><span class="sxs-lookup"><span data-stu-id="731ae-409">Import the SQL Server SSL certificate that you created earlier, and add it to Trusted Root.</span></span>
    2. <span data-ttu-id="731ae-410">管理者として **コマンド プロンプト** ウィンドウを開き、**IISRESET** と入力し、Enter キーを押します。</span><span class="sxs-lookup"><span data-stu-id="731ae-410">Open a **Command Prompt** window as an administrator, type **IISRESET**, and then press Enter.</span></span>

10. <span data-ttu-id="731ae-411">クラウド POS を使用するように構成されている場合は、クライアント ID が表示されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-411">If Cloud POS is configured for use, a client ID is shown.</span></span> <span data-ttu-id="731ae-412">このクライアント ID を **Commerce 共有パラメーター** ページに追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-412">You must add this client ID to the **Commerce shared parameters** page.</span></span>

    1. <span data-ttu-id="731ae-413">コマースで、**Retail とコマース** &gt; **バックオフィスの設定** &gt; **パラメーター** &gt; **コマースの共有パラメーター** の順に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-413">In Commerce, go to **Retail and commerce** &gt; **Headquarters setup** &gt; **Parameters** &gt; **Commerce shared parameters**.</span></span>
    2. <span data-ttu-id="731ae-414">**ID プロバイダー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-414">Select **Identity providers**.</span></span>
    3. <span data-ttu-id="731ae-415">**ID プロバイダー** クイック タブで、`HTTPS://sts.windows.net/` で始まるプロバイダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-415">On the **Identity providers** FastTab, select the provider that begins with `HTTPS://sts.windows.net/`.</span></span> <span data-ttu-id="731ae-416">選択に基づいて、**依存する関係者** FastTab の値が設定されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-416">The values on the **Relying parties** FastTab are set, based on your selection.</span></span>
    4. <span data-ttu-id="731ae-417">**依存する関係者** クイック タブで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-417">On the **Relying parties** FastTab, select **Add**.</span></span> <span data-ttu-id="731ae-418">Commerce Scale Unit インストーラーに表示されているクライアント ID を入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-418">Enter the client ID that is listed in the Commerce Scale Unit installer.</span></span> <span data-ttu-id="731ae-419">**Type** フィールドを **Public** に、**UserType** フィールドを **Worker** に設定します。</span><span class="sxs-lookup"><span data-stu-id="731ae-419">Set the **Type** field to **Public** and the **UserType** field to **Worker**.</span></span> <span data-ttu-id="731ae-420">[アクション] ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-420">Then, on the Action Pane, select **Save**.</span></span>
    5. <span data-ttu-id="731ae-421">新しい依存する関係者を選択し、**サーバー リソース ID** クイック タブで **追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-421">Select the new relying party, and then, on the **Server resource IDs** FastTab, select **Add**.</span></span> <span data-ttu-id="731ae-422">**サーバー リソース ID** 列に、`https://retailstorescaleunit.retailserver.com` と入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-422">In the **Server Resource ID** column, enter `https://retailstorescaleunit.retailserver.com`.</span></span>
    6. <span data-ttu-id="731ae-423">アクション ウィンドウで、**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-423">On the Action Pane, select **Save**.</span></span>

11. <span data-ttu-id="731ae-424">コマースで、**Retail とコマース** &gt; **バックオフィスの設定** &gt; **コマース スケジューラ** &gt; **チャネル データベース** の順に移動し、これらの手順に従います。</span><span class="sxs-lookup"><span data-stu-id="731ae-424">In Commerce, go to **Retail and commerce** &gt; **Headquarters setup** &gt; **Commerce scheduler** &gt; **Channel database**, and follow these steps:</span></span>

    1. <span data-ttu-id="731ae-425">このトピックの先頭に作成したチャネルのデータベースを選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-425">Select the channel database that you created at the beginning of this topic.</span></span>
    2. <span data-ttu-id="731ae-426">アクション ウィンドウで、**完全な同期** &gt; **ジョブ 9999** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-426">On the Action Pane, select **Full Sync** &gt; **Job 9999**.</span></span> <span data-ttu-id="731ae-427">完全な同期には数分間かかる場合があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-427">Full synchronization might require several minutes.</span></span>
    3. <span data-ttu-id="731ae-428">Commerce Scale Unit のインストーラーで、すべての機能が正常に機能していることを確認するために再テストします。</span><span class="sxs-lookup"><span data-stu-id="731ae-428">In the Commerce Scale Unit installer, retest to verify that all functionality is working correctly.</span></span>

12. <span data-ttu-id="731ae-429">POS 操作を使用しているコンピューターからクラウド POS を起動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-429">Start Cloud POS from the computer that you're using for POS operations.</span></span> <span data-ttu-id="731ae-430">(このコンピューターは、Commerce Scale Unit システムとは別の 3 台目のコンピューターです。)</span><span class="sxs-lookup"><span data-stu-id="731ae-430">(This computer is a third computer that is separate from the Commerce Scale Unit systems.)</span></span>
13. <span data-ttu-id="731ae-431">このコンピューターで使用しているクラウド POS デバイスを有効化します。</span><span class="sxs-lookup"><span data-stu-id="731ae-431">Activate the Cloud POS device that you're using for this computer.</span></span>
14. <span data-ttu-id="731ae-432">完全なエンド ツー エンドの機能を確認する簡易販売を実行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-432">Do a simple sale to verify full end-to-end functionality.</span></span>

### <a name="help-secure-commerce-scale-unit"></a><span data-ttu-id="731ae-433">Commerce Scale Unit のセキュリティ強化</span><span class="sxs-lookup"><span data-stu-id="731ae-433">Help secure Commerce Scale Unit</span></span>

<span data-ttu-id="731ae-434">現在のセキュリティ基準によると、実稼動環境で次のオプションを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-434">According to current security standards, the following options should be set in a production environment:</span></span>

- <span data-ttu-id="731ae-435">コンピューターの SSL (v2およびv3) を完全に無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-435">You should completely disable SSL (v2 and v3) on the computer.</span></span>
- <span data-ttu-id="731ae-436">TLS バージョン 1.2 (または、現時点で最も新しいバージョン) のみを有効にし、使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-436">You should enable and use only TLS version 1.2 (or the current highest version).</span></span>

    > [!NOTE]
    > <span data-ttu-id="731ae-437">既定では、SSL および TLS 1.2 を除くすべてのバージョンの TLS は無効です。</span><span class="sxs-lookup"><span data-stu-id="731ae-437">By default, SSL and all versions of TLS except TLS 1.2 are disabled.</span></span> <span data-ttu-id="731ae-438">これらの設定を編集または有効にするには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="731ae-438">To edit or enable these settings, follow these steps:</span></span>
    >
    > 1. <span data-ttu-id="731ae-439">Windows ロゴキーと R キーを同時に押して、**実行** ウィンドウを開きます。</span><span class="sxs-lookup"><span data-stu-id="731ae-439">Press the Windows logo key+R to open a **Run** window.</span></span>
    > 2. <span data-ttu-id="731ae-440">**開く** フィールドに、**Regedit** と入力してから **OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-440">In the **Open** field, enter **Regedit**, and then select **OK**.</span></span>
    > 3. <span data-ttu-id="731ae-441">**ユーザー アカウント制御** ウィンドウで、**はい** (この手順が必要である場合) を選択してから、新しい **レジストリ エディター** ウィンドウで **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\SecurityProviders\\SCHANNEL\\Protocols** に移動します。</span><span class="sxs-lookup"><span data-stu-id="731ae-441">In the **User Account Control** window, select **Yes** (if this step is required), and then, in the new **Registry Editor** window, go to **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\SecurityProviders\\SCHANNEL\\Protocols**.</span></span>
    > 4. <span data-ttu-id="731ae-442">次のキーは自動的に入力され、TLS 1.2 のみが有効になります。</span><span class="sxs-lookup"><span data-stu-id="731ae-442">The following keys have been automatically entered to enable only TLS 1.2:</span></span>
    >
    >     - <span data-ttu-id="731ae-443">TLS 1.2\\Server:Enabled=1</span><span class="sxs-lookup"><span data-stu-id="731ae-443">TLS 1.2\\Server:Enabled=1</span></span>
    >     - <span data-ttu-id="731ae-444">TLS 1.2\\Server:DisabledByDefault=0</span><span class="sxs-lookup"><span data-stu-id="731ae-444">TLS 1.2\\Server:DisabledByDefault=0</span></span>
    >     - <span data-ttu-id="731ae-445">TLS 1.2\\Client:Enabled=1</span><span class="sxs-lookup"><span data-stu-id="731ae-445">TLS 1.2\\Client:Enabled=1</span></span>
    >     - <span data-ttu-id="731ae-446">TLS 1.2\\Client:DisabledByDefault=0</span><span class="sxs-lookup"><span data-stu-id="731ae-446">TLS 1.2\\Client:DisabledByDefault=0</span></span>
    >     - <span data-ttu-id="731ae-447">TLS 1.1\\Server:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-447">TLS 1.1\\Server:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-448">TLS 1.1\\Client:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-448">TLS 1.1\\Client:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-449">TLS 1.0\\Server:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-449">TLS 1.0\\Server:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-450">TLS 1.0\\Client:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-450">TLS 1.0\\Client:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-451">SSL 3.0\\Server:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-451">SSL 3.0\\Server:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-452">SSL 3.0\\Client:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-452">SSL 3.0\\Client:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-453">SSL 2.0\\Server:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-453">SSL 2.0\\Server:Enabled=0</span></span>
    >     - <span data-ttu-id="731ae-454">SSL 2.0\\Client:Enabled=0</span><span class="sxs-lookup"><span data-stu-id="731ae-454">SSL 2.0\\Client:Enabled=0</span></span>

- <span data-ttu-id="731ae-455">知られている特定の理由で必要とされない限り、追加のネットワーク ポートを開かないでください。</span><span class="sxs-lookup"><span data-stu-id="731ae-455">No additional network ports should be open, unless they are required for known, specified reasons.</span></span>
- <span data-ttu-id="731ae-456">クロスオリジンのリソース共有を無効にし、許可され承認されたオリジンを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="731ae-456">You must disable cross-origin resource sharing, and you must specify the allowed origins that are accepted.</span></span>
- <span data-ttu-id="731ae-457">Commerce Scale Unit コンピューターで使用する証明書の取得には、信頼された証明機関のみを活用してください。</span><span class="sxs-lookup"><span data-stu-id="731ae-457">You should use only trusted certificate authorities to obtain certificates that will be used on Commerce Scale Unit computers.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="731ae-458">IIS と Payment Card Industry (PCI) の要件向けのセキュリティ ガイドラインを確認することが重要です。</span><span class="sxs-lookup"><span data-stu-id="731ae-458">It's critical that you review security guidelines for IIS and the Payment Card Industry (PCI) requirements.</span></span>

### <a name="troubleshoot-commerce-scale-unit"></a><span data-ttu-id="731ae-459">Commerce Scale Unit のトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="731ae-459">Troubleshoot Commerce Scale Unit</span></span>

<span data-ttu-id="731ae-460">確認する項目のチェックリストを次に示します。</span><span class="sxs-lookup"><span data-stu-id="731ae-460">Here is a checklist of things to verify:</span></span>

1. <span data-ttu-id="731ae-461">構成ファイルを開き、指定された Retail サーバーの URLに接尾語 **/Commerce** が含まれていて、使用しているコンピューター名とポートに対して期待されている値に基づいて正しく形成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-461">Open the configuration file and verify that the Retail Server URL specified contains the suffix **/Commerce** and is correctly formed based on what is expected for the machine name and port used.</span></span>  <span data-ttu-id="731ae-462">URL 内または末尾にスラッシュ (**/** 文字) が含められていないか確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-462">Validate that there is no trailing or additional slash (the character **/**) in the URL or at the end of it.</span></span>
2. <span data-ttu-id="731ae-463">Commerce の **Commerce 共有パラメーター** ページで、適切なクライアント ID が **依存する関係者** クイック タブに追加されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-463">In Commerce, on the **Commerce shared parameters** page, verify that the correct client ID has been added to the **Relying parties** FastTab.</span></span> <span data-ttu-id="731ae-464">また、正しい `https://retailstorescaleunit.retailserver.com` エントリが **サーバー リソース ID** クイック タブに追加されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-464">Additionally, verify that the correct `https://retailstorescaleunit.retailserver.com` entry has been added to the **Server resource IDs** FastTab.</span></span>
3. <span data-ttu-id="731ae-465">Commerce で、各店舗に生成されたすべてのクライアント ID が **Azure Active Directory アプリケーション** ページに存在することを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-465">In Commerce, verify that every client ID that was generated for each store exists on the **Azure Active Directory applications** page.</span></span>
4. <span data-ttu-id="731ae-466">Commerce の **チャネル プロファイル** ページで、URL が正しいことを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-466">In Commerce, on the **Channel profile** page, verify that the URLs are correct.</span></span> <span data-ttu-id="731ae-467">これを行うには、各 URL のコンピューター名が正しいこと、URL が正しく書式設定されていることなどを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-467">To do this, verify that the computer name in each URL is correct, the URL is correctly formatted, and so on.</span></span>
5. <span data-ttu-id="731ae-468">Commerce の **チャネル データベース** ページで、新しいチャネル データベースに完全同期が正しく発生したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-468">In Commerce, on the **Channel database** page, verify that full synchronization correctly occurred for the new channel database.</span></span>
6. <span data-ttu-id="731ae-469">新しいチャネル データベースを使用するように店舗が正しく構成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-469">Verify that the store is correctly configured to use the new channel database.</span></span>

<span data-ttu-id="731ae-470">Retail Server が一定時間の後に停止した場合、確認すべき 2 つの簡単なことがあります。</span><span class="sxs-lookup"><span data-stu-id="731ae-470">If the Retail Server stops functioning after a period of time, there are two simple things to verify:</span></span>

- <span data-ttu-id="731ae-471">パスワード ポリシーにより、パスワード (パスワードの有効期限) を変更するために生成されたサービス アカウントが求められているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="731ae-471">Verify if the password policy requires the service account that was generated to change the password (password expiration).</span></span>
- <span data-ttu-id="731ae-472">現在のインストール (非べき等) で同一のインストーラーを再実行します。これにより、サービス アカウントのパスワードが更新されるか、選択したアカウントのパスワードの更新が許可されます。</span><span class="sxs-lookup"><span data-stu-id="731ae-472">Re-run the same installer over the current installation (idempotent), which will update a service account's password or allow the user to update the selected account's password.</span></span>

### <a name="uninstall-commerce-scale-unit"></a><span data-ttu-id="731ae-473">Commerce Scale Unit のアンインストール</span><span class="sxs-lookup"><span data-stu-id="731ae-473">Uninstall Commerce Scale Unit</span></span>

<span data-ttu-id="731ae-474">Microsoft Windows でコントロール パネルを使用して Commerce Scale Unit コンポーネントをアンインストールします。</span><span class="sxs-lookup"><span data-stu-id="731ae-474">Use Control Panel in Microsoft Windows to uninstall Commerce Scale Unit components.</span></span>

1. <span data-ttu-id="731ae-475">Windows ロゴ キーを押し、検索ボックスに **コントロール パネル** と入力します。</span><span class="sxs-lookup"><span data-stu-id="731ae-475">Press the Windows logo key, and then enter **Control Panel** in the search box.</span></span> <span data-ttu-id="731ae-476">検索結果で、**コントロール パネル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-476">In the search results, select **Control Panel**.</span></span>
2. <span data-ttu-id="731ae-477">コントロール パネルで、**プログラム** &gt; **プログラムのアンインストール** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-477">In Control Panel, select **Programs** &gt; **Uninstall a program**.</span></span>
3. <span data-ttu-id="731ae-478">**プログラムと機能** ウィンドウで、**Microsoft Dynamics 365 Commerce Scale Unit** を選択してから、プログラムの一覧で **アンインストール** を選択します。</span><span class="sxs-lookup"><span data-stu-id="731ae-478">In the **Programs and Features** window, select **Microsoft Dynamics 365 Commerce Scale Unit**, and then, above the list of programs, select **Uninstall**.</span></span>
4. <span data-ttu-id="731ae-479">アンインストールがプログラムの削除を完了するまで待ちます。</span><span class="sxs-lookup"><span data-stu-id="731ae-479">Wait for the uninstaller to finish removing the program.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
