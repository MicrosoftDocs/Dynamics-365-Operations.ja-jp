---
title: コマースの周辺機器シミュレーター
description: このトピックでは、Dynamics 365 Commerce で提供される周辺機器シミュレーター ツールについて説明します。
author: rubencdelgado
manager: AnnBe
ms.date: 03/22/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailHardwareProfile, RetailTerminalTable, EcoResProductDetailsExtended, RetailCDXSchedule, RetailStoreTable
audience: IT Pro
ms.reviewer: rhaertle
ms.search.scope: Core, Operations, Retail
ms.custom: 266544
ms.assetid: 16f31e70-15fc-441e-9727-e6a31c3a48f5
ms.search.region: global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: July 2017 update
ms.openlocfilehash: 480b232fa74e40a0acd5a1f5f0ba9ca26ef80b20
ms.sourcegitcommit: 3dede95a3b17de920bb0adcb33029f990682752b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/18/2020
ms.locfileid: "3070777"
---
# <a name="peripheral-simulator-for-commerce"></a>コマースの周辺機器シミュレーター

[!include [banner](../includes/banner.md)]

周辺機器シミュレーターは、Microsoft Dynamics 365 Commerce の一部として、またスタンドアロン ユーティリティとして、Microsoft が提供しているユーティリティです。 ユーティリティには 2 つの主要コンポーネント、*仮想周辺機器シミュレーター* および *販売時点管理シミュレーター* があります。

仮想周辺機器シミュレーターは主に、通常は物理的に POS 周辺機器が必要なシナリオのテストをサポートするために提供されます。 POS シミュレーターでは、POS クライアントを配置することなく、物理的な周辺機器との互換性をテストできます。

## <a name="install-the-peripheral-simulator"></a>周辺機器シミュレーターのインストール

1. **Retail と Commerce** &gt; **チャネル設定** &gt; **POS 設定** &gt; **POS プロファイル** &gt; **ハードウェア プロファイル** の順に移動します。
2. **ダウンロード** をクリックし、**PeripheralSimulator** をクリックします。

    > [!NOTE]
    > 周辺機器シミュレーターをダウンロードするには、ポップアップ ブロッカーをオフにする必要があります。

3. ダウンロードが完了した後、**ダウンロード** フォルダーを開き、**VirtualPeripherals.msi** をダブルクリックすると、インストーラーが開始します。
4. 既定の設定を使用して周辺機器シミュレーターをインストールします。

周辺機器シミュレーターの他に、Monroe Consulting Services からコモン コントロール オブジェクトをインストールする必要があります。 それ以外の方法では、周辺機器シミュレーターは正しく動作しません。 共通のコントロール オブジェクトをダウンロードするには、<http://monroecs.com/oposccos_current.htm> に移動してください。

## <a name="virtual-peripheral-simulator"></a>仮想周辺機器シミュレーター

この仮想周辺機器シミュレーターを使用すると、周辺機器の設定、テスト、およびトラブルシューティングを行うことができます。 周辺機器のテストを簡素化したり、正しくない設定または障害が発生しているデバイス ドライバーによって生じた問題を分離するために使用できます。 周辺機器シミュレーターには、コマースがサポートするデバイスの仮想バージョンを搭載したデスクトップ プログラムが含まれています。 各仮想デバイスのセクションには、デバイスと POS 間の相互作用が表示されます。 また、さまざまな POS シナリオに有効な入力を提供するために使用することもできます。 周辺シミュレーターは、POS と次の仮想デバイス間の相互作用をサポートします:

- **プリンター** – 仮想周辺機器シミュレーターは POS プリンターに対して設定されている入庫を表示できます。
- **ライン ディスプレイ** – 現物ライン ディスプレイの活動を示す場合は、仮想ライン ディスプレイを設定できます。
- **磁気ストライプ リーダー (MSR)** – 仮想周辺機器シミュレーターから POS にシミュレートされた磁気ストライプのイベントを送信できます。
- **ドロワー** – 現物キャッシュ ドロワーをシミュレーションできます。
- **ドロワー 2** – 周辺シミュレーターに 2 番目のキャッシュ ドロワーを設定することにより、2 つのアクティブなシフトを持つ 1 つの POS レジスターを含むシナリオをシミュレートできます。
- **スキャナー** – 周辺機器シミュレーターがサポートする仮想バーコード スキャナーは、バーコード スキャン イベントを発行することができます。
- **スケール** – A の仮想スケールは POS と計量品目との相互作用をシミュレーションすることができます。
- **個人識別番号 (PIN) パッド** – PIN パッドの操作をシミュレーションできます。

    > [!NOTE]
    > 支払コネクタによる現物の PIN パッドのサポートを実行する必要があります。

- **署名のキャプチャ** – 仮想周辺機器シミュレーターには、顧客アカウントの支払いなど、一部の入札に必要な署名を求めるプロンプトが表示されるように設定できる仮想署名キャプチャ デバイスが含まれています。
- **支払ターミナル** – 仮想支払ターミナルは、POS から仮想支払デバイスへのアプリケーション プログラミング インターフェイス (API) コールをテストするカスタム支払コネクタと組み合わせて使用できます。 仮想支払端末を使用するには、支払コネクタを実装する必要があります。 詳細については、<支払コネクタと支払デバイスの実装 (ホワイト ペーパー)>を参照してください。

仮想周辺機器シミュレータを使用して、バーコード スキャナと MSR から発生するキーボード ウェッジのイベントをシミュレートすることもできます。 仮想周辺機器のシミュレーターは、Retail POS 用 Object linking and embedding (OPOS) をサポートします。

### <a name="key-scenarios--virtual-peripheral-simulator"></a>重要なシナリオ – 仮想周辺機器シミュレーター

#### <a name="troubleshooting"></a>トラブルシューティング

周辺シミュレーターを使用し、デバイスの設定をトラブルシューティングできます。 周辺機器シミュレーターまたは同じクラスのセカンド デバイスがない場合、どこで問題が発生したかを特定することが困難になる可能性があります。 ただし、周辺シミュレーターがある場合は、仮想デバイスを設定でき、物理デバイスに使用する同じコード パスとビジネス ロジックを実行できます。 周辺機器シミュレーター側からの仮想デバイスと物理デバイス間の主な違いは、サービス オブジェクト、またはデバイス ドライバです。 物理デバイスの場合は、サービス オブジェクトはデバイス メーカーによって提供されます。 対照的に、仮想デバイスの場合、サービス オブジェクトは周辺機器シミュレーターの一部として用意されています。 周辺機器シミューレーターが正常に機能している場合、ハードウェア プロファイルのデバイス名を実際のデバイスの名前に変更した後にデバイスが正常に機能しない場合は、メーカーが提出したサービス オブジェクトに問題があると想定できます。

#### <a name="training"></a>トレーニング

物理的なハードウェアの設定が利用できない場合、周辺機器シミュレーターを使用し、実際的なレイヤーをキャッシャー トレーニングに追加できます。 周辺機器シミュレーターがトレーニングのシナリオに含まれている場合、レジ担当者は、製品のバーコードのスキャンやギフト カードの読み取りなどのインプットを提供し、さらに特定のトランザクションに対してどの入庫が印刷されるかを確認することにより、より効果的に POS を操作できます。

#### <a name="testing"></a>テスト

周辺機器シミュレーターを使用し、仮想環境の物理的なハードウェアを配置せずに、製品のバーコードや受領書フォーマットなどをテストできます。 物理的なハードウェアが必要とされず、ハードウェア ステーションまたは物理的なコンピューターの POS を配置する必要がないため、バック オフィスに行われた変更をより迅速にテストできます。

### <a name="set-up-the-virtual-peripheral-simulator"></a>仮想周辺機器シミュレーターの設定

#### <a name="set-up-a-hardware-profile"></a>ハードウェア プロファイルの設定

1. 周辺機器シミュレーターを設定するには、**Retail と Commerce** &gt; **チャネル設定** &gt; **POS 設定** &gt; **POS プロファイル** &gt; **ハードウェア プロファイル**の順に移動します。
2. **新規**をクリックしてプロファイルを作成します。
3. **プロファイル番号** および **説明** フィールドに値を入力します。
4. テストする必要がある仮想デバイスを設定するには、次の表を参照してください。 表の列の説明を次に示します。

   - **デバイス** - この列はデバイスを設定するためクイック タブの名前を示します。
   - **機器タイプ** – この列は、デバイスの名前のラベルが付いているフィールドで選択した値を提供します。
   - **デバイス名** – この列はデバイス名に対して入力する正確な値を提供します。

     > [!IMPORTANT]
     > ハードウェア ステーションがこれらの特定の名前を使用し、デバイスに対処するため、ここで指定されたデバイスは必須です。 次の特定の名前を使用しない場合、デバイスは使用できません。

     バーコード スキャナーと MSR のキーボード ウェッジのイベントをシミュレーションするには、ハードウェア プロファイルでの特定の設定は必要ありません。

     | デバイス            | デバイス タイプ | デバイス名              |
     |-------------------|-------------|--------------------------|
     | プリンター           | OPOS        | MockOPOSPrinter          |
     | ライン ディスプレイ      | OPOS        | MockOPOSLineDisplay      |
     | MSR               | OPOS        | MockOPOSMSR              |
     | 手形振出人            | OPOS        | MockOPOSDrawer1          |
     | Drawer2           | OPOS        | MockOPOSDrawers          |
     | スキャナー           | OPOS        | MockOPOSScanner          |
     | スケール             | OPOS        | MockOPOSScale            |
     | PIN パッド           | OPOS        | MockOPOSPinPad           |
     | 署名キャプチャ | OPOS        | MockOPOSSignatureCapture |

#### <a name="assign-the-hardware-profile-to-a-register"></a>レジスターへのハードウェア プロファイルの割り当て

1. ハードウェア プロファイルを作成した後、**Retail とコマース** &gt; **チャネル設定** &gt; **POS の設定** &gt; **登録**の順に移動します。
2. **POS レジスター** リストでは、周辺機器シミュレーターを使用する必要があるレジスターに対して、**レジスター番号** フィールドにあるリンクをクリックします。
3. **編集** をクリックします。
4. **プロファイル** セクションの **ハードウェア プロファイル** フィールドでは、仮想周辺機器用に作成したハードウェア プロファイルを選択します。
5. **保存**をクリックします。

#### <a name="synchronize-changes-to-the-channel-database"></a>チャンネル データベースへの変更の同期

1. **Retail と Commerce** &gt; **Retail と Commerce IT** &gt; **配送スケジュール**の順に移動します。
2. **1090** 配送スケジュールを選択します。
3. POS への変更を同期させるには、**今すぐ実行** をクリックします。

データが同期されると、新しいハードウェア プロファイルとレジスターへの変更は、チャンネル データベースで使用できます。

## <a name="using-the-virtual-peripheral-simulator"></a>仮想周辺機器シミュレーターの使用

仮想周辺機器シミュレーターを起動するには、コンピューターの**開始**をクリックし、**周辺機器シミュレーター**と入力して、検索結果に表示されたときにアプリを選択します。 周辺機器シミュレーションを開始した後、**仮想周辺機器を使用**をクリックします。 サポートされているデバイスはウィンドウの左側のタブとしてリストされます。 特定のデバイスを表示するには、そのデバイスのタブをクリックします。

### <a name="line-display-capabilities"></a>ライン ディスプレイ機能

仮想ライン ディスプレイを設定すると、POS トランザクションでスキャンする際に、品目が表示されます。 明細行品目に加えて、支払 / 入金が POS で選択されている場合に支払われる合計を表示します。 また、支払/入金を入力すると、トランザクションに対してまだ支払がされていない金額が表示されます。 POS が使用されていない場合は、レジが終了したことを示すメッセージを表示できます。 ハードウェア プロファイルの **ライン ディスプレイ** FastTab のメッセージを設定する必要があります。

### <a name="cash-drawer-capabilities"></a>キャッシュ ドロワー機能

仮想キャッシュ ドロワーを使用するようにハードウェア プロファイルが構成されている場合、POS は、支払/入金申告などのドロワー操作に応答して、有効なシフトに対してキャッシュ ドロワーを開きます。 POS は、レジ担当者が標準現金店頭払いトランザクション中に現金を変更または預金できるように、キャッシュ ドロワーも開きます。 仮想キャッシュ ドロワーには **メイン ドロワー** および **セカンド ドロワー**のラベルがあります。 これらのラベルはハードウェア プロファイルにドロワーとドロワー 2 とそれぞれ表示されます。 ドロワーが閉まると、終了したキャッシュ ドロワーの画像が表示され、終了したキャッシュ ドロワーのボタンには **ドロワーを開く** というラベルが付きます。 このボタンをクリックすると、開いていることを示す開いているキャッシュ ドロワーの画像と置き換えられます。 開いているキャッシュ ドロワーのボタンには **ドロワーを閉める** というラベルが付きます。

POS の複数の操作により、キャッシュ ドロワーを開くことができます。 キャッシュ ドロワーが開いている間はほとんどの操作を続行できません。 一部の営業終了処理は例外となります。 POS ユーザーが、キャッシュ ドロワーが開いている間に操作を実行できないことを示すエラー メッセージが表示された場合は、ユーザーは仮想または現物キャッシュ ドロワーを閉じて操作を続行する必要があります。 キャッシュ ドロワーがハードウェア プロファイルで **共有** とマークされている場合、システムは、操作の前にドロワーが閉じられていることを確認しません。 キャッシュ ドロワーを開いていても、通常通りに操作が進みます。 この動作は、キャッシュ ドロワーが販売担当者間で共有され、販売担当者がキャッシュ ドロワーを使用する一方で、他の販売担当者が自分の POS デバイスの不適切なタスクを実行するシナリオをサポートします。 キャッシュ ドロワーにした変更は、現在のシフトを閉じ、新しいシフトを開けるまでは確認できません。

### <a name="msr-capabilities"></a>MSR 機能

周辺機器シミュレーターは、OPOS モードまたはキーボード ウェッジ モードで操作することにより、仮想 MSR 操作に対して堅牢なサポートを提供します。 OPOS モードでは OPOS デバイスとして機能するようにハードウェア プロファイルで MSR を設定する必要があります。 キーボード ウェッジ モードは Microsoft Windows に、キーボード ウェッジ データ イベントを送信するのみです。 設定が異なること以外にも、OPOS とキーボード ウェッジ モードは次の点において違います。

- POS クライアントでは、ロイヤルティまたはギフト カードのエントリに対して磁気ストライプ データを有効にするシナリオなど、特定のシナリオに対して、OPOS MSR デバイスが有効になります。
- キーボード ウェッジ モードでは、データが送信されると、周辺機器シミュレーターがキーボード ウェッジ データを有効なフィールドに送信します。 この動作は、データがキーボードにより入力された場合に実行される動作に似ています。 キーボード ウェッジとして MSR を使用するには、ユーザーはデータが正しいフィールドで受信されるように、Modern POS (MPOS) に切り替える必要があります。 したがって、データが正しいフィールドに送信されるかを確認できる時間をユーザーに与えるため、遅延を設定できます。

#### <a name="testing-gift-and-payment-card-swipes"></a>ギフト カードや支払カードの読み取りのテスト

周辺機器シミュレーターが提供する仮想 MSR はギフト カードや支払カードの読み取りにおけるシナリオをテストするために特定の MSR データを設定することもできます。 カードを作成するには、プラス記号 (**+**) タンをクリックし、カードのタイプを選択します。 その後、定義しているカードの有効期限の月と年を含め、カード番号を指定するか、または POS に送信する必要があるデータを追跡します。 **カードの種類** フィールドで選択した値は、カードにマップできるだけのラベルです。 このラベルにより、周辺機器シミュレーターでカードを読み取ると、カードを識別し易くなります。 画像の上の左矢印 (**&lt;**) および右矢印 (**&gt;**) ボタンを使用して、周辺機器シミュレーターで設定されたカードを選択できます。 プラス記号 (**+**) ボタンの隣にある **編集** および **削除** ボタンを使用することにより、カードを編集または削除できます。

### <a name="pin-pad"></a>PIN パッド

PIN パッドのシミュレーターを設定し、OPOS PIN パッドをシミュレートできます。 電子決済 (EFT) トランザクションが POS で実行され、PIN の入力を必要とするとき、ハードウェア ステーションは、PIN デバイスを呼び出して、PIN 入力を要求します。 操作するには、周辺機器シミュレーターの PIN パッドが EFT 支払コネクターをサポートしている必要があります。

### <a name="printer"></a>プリンター

仮想周辺機器のプリンタには、POS から印刷されると入庫が表示されます。 印刷工程で複数の入庫が作成される場合、入庫をスクロールできます。

#### <a name="configure-receipt-printing"></a>入庫印刷の構成

1. **Retail と Commerce** &gt; **チャネル設定** &gt; **POS 設定** &gt; **POS プロファイル** &gt; **ハードウェア プロファイル** の順に移動します。
2. 仮想周辺機器用に作成したハードウェア プロファイルを選択します。
3. **プリンタ** FastTab で、**編集** をクリックします。
4. **レシート プロファイル ID** フィールドで、レシート プロファイルを選択します。
5. **保存** をクリックします。

#### <a name="scale"></a>スケール

スケールの製品が POS トランザクションに追加され、スケールが設定されると、POS によってスケールから重量を取得します。 仮想スケールと物理的スケールについては、製品がトランザクションに追加される前に製品と重量を指定する必要があります。 スケール製品をトランザクションに追加する前に、周辺機器シミュレーターに移動し、プラス記号 (**+**) およびマイナス記号 (**–**) ボタンを使用して、スケールがレポートする必要がある重量を調整します。 **現在の値** フィールドで目的の重量を入力することもできます。 プラス記号 (**+**)、**編集**、および **削除** ボタンを使用することにより、重量単位を調整できます。 これにより、単位は、重さを測る製品またはスケールを使用するロケールをベースに指定されます。

##### <a name="configure-a-scale-product"></a>スケール製品の設定

1. **Retail と Commerce** &gt; **製品とカテゴリ** &gt; **カテゴリ別リリース済製品**の順に移動します。
2. 製品レコードを開きます。
3. 重さを測る製品を選択します。
4. **Retail と Commerce** クイック タブで **スケール製品**オプションを**いいえ**から**はい**に設定します。

##### <a name="synchronize-changes-to-the-channel-database"></a>チャンネル データベースへの変更の同期

1. **Retail と Commerce** &gt; **Retail と Commerce IT** &gt; **配送スケジュール**の順に移動します。
2. **1040** 配送スケジュールを選択します。
3. POS への変更を同期させるには、**今すぐ実行** をクリックします。

データが同期されると、スケールの製品が POS トランザクションに追加され、POS は重量に対してスケールをチェックします。

#### <a name="signature-capture"></a>署名キャプチャ

仮想署名のキャプチャ デバイスは、使用している支払/入金が署名を必要とする場合、仮想署名のキャプチャ パッドに署名を提供するようユーザーに要求します。 ユーザーが署名を承諾すると、POS に署名を表示できます。 そして、レジ担当者が署名を承諾できるようになります。 署名は支払/入金とともに保存され、バック オフィスに他のトランザクション データとともに同期されます。

##### <a name="set-up-a-tender-to-require-a-signature"></a>署名を要求するよう支払/入金を設定する

1. **Retail と Commerce** &gt; **チャネル** &gt; **店舗** &gt; **すべての店舗**の順に移動します。
2. 店舗を選択します。
3. **編集** をクリックします。
4. **設定** をクリックしてから、**設定** セクションで、**支払方法** をクリックします。
5. **編集** をクリックします。
6. 署名を要求する支払方法を選択します。
7. **一般l** セクションの **署名キャプチャ** で **署名キャプチャ デバイスの使用** オプションを **はい** に設定します。
8. **署名キャプチャの最小額** フィールドで、署名のキャプチャをトリガする必要がある最小額を入力します。

##### <a name="synchronize-changes-to-the-channel-database"></a>チャンネル データベースへの変更の同期

1. **Retail と Commerce** &gt; **Retail と Commerce IT** &gt; **配送スケジュール**の順に移動します。
2. **1070** 配送スケジュールを選択します。
3. POS への変更を同期させるには、**今すぐ実行** をクリックします。

データが同期されると、署名を必要とする支払/入金が使用され、金額が署名のしきい値を満たす場合は、POS は仮想署名のキャプチャ デバイスで署名を要求します。

#### <a name="additional-configuration"></a>追加設定

周辺機器シミュレーターのコンフィギュレーション ファイルを編集して、テストしているシナリオに対してさらに適切に取り組むことができます。 構成ファイルは C:\\Program Files (x86)\\Microsoft Dynamics 365\\70\\VirtualPeripherals\\Microsoft.Dynamics.Commerce.VirtualPeripherals.Client.exe.config で見つけることができます。構成ファイルはスケール上でのテストに使用可能な単位、テストで使用可能なカードの種類、およびバー コード タイプを定義します。 たとえば、コンフィギュレーション ファイルのテキスト値の変更することによって、実行時に選択できる新しいカード タイプまたは新しい測定単位を追加できます。 新しい値は、アプリケーションの再起動後に表示されます。

#### <a name="troubleshooting"></a>トラブルシューティング

周辺機器シミュレーターの活動は、周辺機器シミュレーター内に記録されます。 ログは C:\\Program Files (x86)\\Microsoft Dynamics 365\\70\\VirtualPeripherals\\Microsoft.Dynamics.Commerce.VirtualPeripherals.Client.exe.config で見つけることができます。周辺機器シミュレーターも Windows イベント ログに問題をレポートします。これには **アプリケーションとサービス ログ** &gt; **Microsoft** &gt; **DynamicsAX** でアクセスすることができます。

MPOS または周辺機器シミュレーターを使用する場合に、ハードウェア プロファイルまたはその他の領域に加えた変更が明示的でない場合、チャンネルのデータベースにデータを同期する上で使用する配送スケジューラ ジョブを確認します。 変更が同期された後に、POS でまだ確認できない場合、POS クライアントを再起動します。

コンフィギュレーションされたキャッシュ ドロワーへの変更は、新しいシフトが作成されるまで有効になりません。 そのため、キャッシュ ドロワーに変更を加えた場合、新しいキャッシュ ドロワーの設定をテストするには、既存のシフトが常に閉まっているかを確認します。

メーカーのドライバがモンロー顧問サービスのコモン コントロール オブジェクトの後にインストールされている場合、ドライバが原因でコモン コントロール オブジェクトが正しく動作しなくなることがあります。 この場合、コモン コントロール オブジェクトを再インストールする必要があります。

インストール時に、仮想周辺機器シミュレータに関連する特定のアセンブリが誤って登録されている可能性があります。 この問題は、仮想デバイスを使用しようとすると「OPOS_E_CLOSED」というエラーに関連することがよくあります。 これは、Windows アセンブリ登録ツールを実行して修正できます。 アセンブリ (Microsoft.Dynamics.Commerce.VirtualPeripherals.ServiceObjects.dll) を登録するには、管理者としてコマンド プロンプトを開き、'regasm /codebase "C:\Program Files (x86)\Microsoft Dynamics 365\70\Peripheral simulator for Retail\Microsoft.Dynamics.Commerce.VirtualPeripherals.ServiceObjects.dll"' を実行します。

## <a name="pos-simulator"></a>POS シミュレーター

POS シミュレーターを使用すると、デバイスの製造元、独立系ソフトウェア ベンダー (ISV)、および小売業者が POS を配置しなくても周辺機器をテストできます。 MPOS およびスタンドアロン ハードウェア ステーションと同様のビジネス ロジックを周辺機器に使用することにより、POS シミュレーターはスタンドアロン ユーティリティとして POS とのデバイス ドライバーの互換性を判断できます。 したがって、デバイスの選択は、POS のセットアップと展開とは独立して行うことができます。

POS シミュレーターは、コマースから独立したスタンドアロン ユーティリティとしても提供されます。 スタンドアロン ユーティリティとして、POS シミュレータは主に周辺デバイスの互換性をテストするために使用されます。 POS シミュレーターを使用してテストされたデバイスのみ、新しい POS の配置に許容可能です。 テストは、デバイス メーカー自体が推進する必要があります。 POS シミュレーターの概要の各パートは、互換性テストに POS シミュレーターを使用する方法について説明します。 POS またはスタンドアロン ハードウェア ステーションとの互換性についてデバイスをテストすることに関心があるメーカーは、drpc@microsoft.com まで電子メールを送信してプログラムに関する情報を求める必要があります。

### <a name="using-the-pos-simulator"></a>POS シミュレーターの使用

1. コンピューターの**開始** をクリックし、**周辺機器シミュレーター**を入力してから、検索結果に表示されるアプリを選択します。
2. **仮想周辺機器を使用**をクリックします。 サポートされているデバイスはウィンドウの左側のタブとしてリストされます。 特定のデバイスを表示するには、そのデバイスのタブをクリックします。

POS シミュレーターは、次のデバイスをサポートしています。

- ライン ディスプレイ
- キャッシュ ドロワー
- MSR
- PIN パッド
- プリンター
- スケール
- 署名キャプチャ パッド
- バーコード スキャナー
- 支払ターミナル

    > [!NOTE]
    > 支払ターミナルには、支払コネクタが必要です。 詳細については、[支払ターミナルのためのエンド・ツー・エンドの支払統合を作成する](end-to-end-payment-extension.md) を参照してください。

サポートされているデバイスの一覧に**設定**タブがあります。**設定**タブを使用して、POS シミュレーターとテストされているデバイスとの通信方法を指定できます。 **ランタイム**を選択すると、POS シミュレーターがデバイスと通信するのに使用する方法は、組み込みハードウェア局を持つ MPOS が通信する方法と類似するようになります。 **Win32** が選択されている場合、POS シミュレーターはデバイスと直接通信します。 この通信方法は、スタンドアロン ハードウェア ステーションが通信する方法に似ています。

**設定**タブで、テストを実行しているユーザーに関する詳細も提供できます。 これらの詳細は、互換性テストを行うメーカーにとって重要です。

### <a name="configuring-the-pos-simulator"></a>POS シミュレーターのコンフィギュレーション

サポートされているデバイス クラスごとに、POS シミュレーターは複数のデバイスを設定できるようにします。 たとえば、複数のプリンターは、POS シミュレーターでコンフィギュレーションできます。 **プリンター** タブで、ユーザーは設定されたデバイスを順番に調べ、必要に応じてテストすることができます。

デバイスで使用可能なセットアップ パラメーターは、デバイスのタイプによって異なります。 新しいデバイスを設定するには、テストするデバイスのクラスを選択し、[プラス記号 (**+**)] ボタンをクリックします。 利用可能なデバイスパラメーターのメニューが表示されます。

すでに作成されているデバイスを編集するには、左矢印 (**&lt;**) と右矢印 (**&gt;**) ボタンを使用して適切なデバイスを見つけ、**編集** をクリックします。

#### <a name="configure-an-opos-device"></a>OPOS デバイスのコンフィギュレーション

1. デバイス タイプとして **OPOS** を選択します。
2. デバイス ドライバーの名前を選択します。 この値は必須です。 このリストには、デバイスがテストされているローカル マシンにインストールされているすべての OPOS サービス オブジェクトが含まれています。 手動でデバイス ドライバー名を入力することもできます。

    > [!IMPORTANT]
    > POS シミュレーターを使用して OPOS デバイスをテストする前に、OPOS コモン コントロール オブジェクトをインストールする必要があります。 これらのオブジェクトは、製造業者が提供するサービス オブジェクトとは別個のものです。

3. 残りの必須フィールドにデータを入力します。

    > [!NOTE]
    > テスト用に機器をコンフィギュレーションするときは、POS シミュレーションが POS との互換性を確認できるようにするために、すべてのフィールドの値が必要です。

4. デバイスがカジュアル テストまたは互換性テストに必要なレベルに構成されているときは、**デバイスの保存** をクリックします。

#### <a name="configure-a-network-device"></a>ネットワーク デバイスのコンフィギュレーション

POS シミュレーターは、ネットワーク デバイスをテストするために使用できます。 次のネットワーク デバイスがそのまま使用できます。

- **キャッシュ ドロワー:** APG Atwood
- **レシート プリンター:** Star TSP650II
- **支払ターミナル:** 支払ターミナルはネットワークデバイスとして構成することができますが、支払ターミナルのテストにはカスタム支払コネクタが必要です。

    > [!NOTE]
    > 支払ターミナルはそのまま使用できません。

1. デバイス タイプとして **ネットワーク** を選択します。
2. 残りのフィールドのデータを入力します。

    > [!NOTE]
    > デバイス ドライバー名、モデル、およびバージョンのフィールドは、テスト対象のデバイス固有の実装のバージョンを識別するのに役立ちます。 デバイスは IP 上で独自の通信プロトコルを持つ傾向があるため、カスタム実装には特定の属性でラベルを付ける必要があります。

3. デバイスがカジュアル テストまたは互換性テストに必要なレベルに構成されているときは、**デバイスの保存** をクリックします。

#### <a name="windows-devices"></a>Windows デバイス

POS シミュレーターは、Windows プリンターをテストするためにも使用できます。 セットアップ パラメーターは、OPOS デバイスのパラメーターと同じです。

1. デバイス タイプとして **プリンター** を選択します。
2. 残りの必須フィールドにデータを入力します。

    > [!NOTE]
    > テスト用に機器をコンフィギュレーションするときは、POS シミュレーションが POS との互換性を確認できるようにするために、すべてのフィールドの値が必要です。

3. デバイスがカジュアル テストまたは互換性テストに必要なレベルに構成されているときは、**デバイスの保存** をクリックします。

### <a name="testing-devices"></a>デバイスのテスト

各デバイス クラスには、固有のテスト機能があります。 デバイス固有のテストに加えて、各デバイスには**自己テスト**機能があります。

デバイスの互換性をテストするときは、デバイスを設定してから、緑の矢印をクリックして自己テストを開始します。 各デバイスで、POS (**ランタイム**モードで) またはスタンドアロン ハードウェアステーション (**Win32** モードで) のデバイスの互換性を決定するために、異なる一連のテストが実行されます。 一部のデバイスでは、テストにはユーザー操作が必要です。 たとえば、バーコード スキャナーの自己テストは、バーコードのスキャンを必要とします。 したがって、セルフテストはユーザーにバーコードをスキャンするよう指示します。

各セルフ テストおよび各手動操作による結果は、デバイス テスト ページの **ログ** セクションに表示されます。 **ログ** セクションをクリア、または結果をエクスポートしてファイルに保存することができます。 エクスポート ログの結果が公式互換性テストでどう使用されるかについては、このトピックの後半で「デバイス メーカーへの指示」セクションを参照してください。

自己テストを中止するには、[赤い四角形] をクリックします。 たとえば、デバイスが応答しない場合、自己テストを中止する必要が生じる場合があります。 赤い四角は、セルフテストが進行中の場合にのみ使用できます。

### <a name="device-specific-settings-to-be-aware-of"></a>デバイス固有の設定

このセクションでは、完了するために必要な設定が記載されています。

#### <a name="line-display-gt-settings-tab"></a>ライン ディスプレイ &gt;設定タブ

自由書式のフィールドに入力されている値を表示するには、**ロックとクレーム** をクリックしてデバイスを要求します。

1. **テキストの表示**をクリックし、デバイスに送信されたテキストを表示します。
2. ライン ディスプレイからテキストを消去するには、**テキストをクリア**をクリックします。
3. **リリース**をクリックしてライン ディスプレイをリリースし、他のプロセスに使用できるようにします。

#### <a name="line-display-gt-advanced-tab-settings"></a>ライン ディスプレイ &gt;詳細タブ設定

- **バイナリ変換** - ライン ディスプレイによって、テキストをバイナリ形式に変換する必要があります。 この変換が必要かどうかを確認するのには、デバイスのマニュアルを参照してください。
- **文字セット** - デバイスに送信される文字のコード ページ。 特定のコード ページの識別子については、<https://msdn.microsoft.com/library/windows/desktop/dd317756(v=vs.85).aspx> を参照してください。

#### <a name="msr"></a>MSR

- **MSR を開いて要求** – MSR からデータを受信するように POS シミュレーターを準備します。
- **MSR をリリースして閉じる** – テストが完了したときに、MSR デバイスを閉じます。
- **カード情報** - MSR デバイスでスキャンしたカードからのデータ。

    > [!IMPORTANT]
    > 実際のクレジット カードは、デバイス テストに使用しないでください。 期限切れのクレジットカードであっても、テストには使用しないでください。

#### <a name="pin-pad"></a>PIN パッド

**両方のタブに表示される設定**

- **ロック** – PIN パッド デバイスをロックして、POS シミュレーターでのみ使用できるようにします。
- **エントリを取得** – PIN データを受信する POS シミュレーションを有効にします。
- **操作のキャンセル** - PIN パッドに送信された要求をキャンセルします。
- **リリース** – PIN パッド デバイスをリリースします。

**設定タブ**

- **金額** - 顧客の受入のために PIN パッド デバイスに送信する金額。
- **勘定番号** - 必要な場合は、感情番号を指定します。
- **暗号化された PIN** - デバイスから受信した暗号化された PIN。
- **追加のセキュリティ データ** - 暗号化された PIN に使用される暗号を指定します。

**詳細タブ**

- **タイムアウト** – デバイスからの応答に待機する秒数を指定します。
- **排他** - 有効にするには、PIN パッド デバイスが要求されている必要があります。
- **上書き** – デバイスが応答していない場合に、デバイスに送信された前のコマンドを上書きします。

#### <a name="scale"></a>スケール

- **タイムアウト** – タイムアウトの間隔。 重量が読み取られる前に、スケールに製品を配置する必要があります。 スケールが指定した期間内に応答されない場合、要求がキャンセルされます。

#### <a name="signature-capture"></a>署名キャプチャ

**設定タブ**

- **フォーム名** – 署名要求の送信時に、一部の署名キャプチャ デバイスではフォーム名が必要です。
- **(16 進数での) 署名** – デバイスから受信した署名のデータの 16 進数の値。
- **表示する署名** – デバイスから受信した署名のイメージ。

**詳細タブ**

- **タイムアウト** – タイムアウトの間隔。 署名キャプチャ デバイスが指定した期間内に応答されない場合、要求がキャンセルされます。
- **排他** - 有効にするには、PIN パッド デバイスが要求されている必要があります。
- **上書き** – デバイスが応答していない場合に、デバイスに送信された前のコマンドを上書きします。
- **ロック** – デバイスをロックして、POS シミュレーターで使用するようにデバイスを要求します。
- **エントリを取得** – デバイスから署名を要求します。
- **操作のキャンセル** - 署名要求をキャンセルします。
- **リリース** – 他のプロセスで使用できるようにデバイスをリリースします。

#### <a name="bar-code-scanner"></a>バーコード スキャナー

- **スキャナーを開いて要求** – スキャナーを開いて要求します。 POS シミュレーターは、この操作が正常に完了した後にスキャン イベントを受け取ることができます。
- **スキャナーをリリースして閉じる** – スキャナーを他のプロセスで使用可能にします。
- **スキャンした情報** – バーコード スキャナーから受信したデータ。

#### <a name="payment-terminal"></a>支払ターミナル

**それぞれのタブに表示される設定**

- **操作を選択** – デバイス上で実行する特定の操作を選択します。 オプションには、**すべて**、**カードで支払う**、**カードへの返金**、および **支払の無効化** があります。
- **ロックと要求** – POS シミュレーターで使えるようにデバイスを準備します。
- **明細行品目の更新** – 指定した明細行品目の詳細をデバイスに送信してください。
- **支払の承認** - 支払の承認を要求する支払コネクタに指示します。
- **支払のキャプチャ** - 以前の承認をキャプチャするよう支払コネクタに指示します。
- **リリース** – デバイスをリリースします。

**設定タブ**

**設定** タブには、支払の承認が要求されたときにデバイスに送信されるプロパティが含まれています。

- **請求書番号** – POS で生成される請求書番号を指定します。
- **テスト モード** – テスト トランザクションが実行されていることを示す値。
- **支払コネクタ** – 使用する支払コネクタの名前。
- **借方キャッシュ バック限度** - 借方トランザクションが実行されるときにデバイス上で要求できるキャッシュ バックの最大金額。
- **ロケール** – 使用されるロケール。 ロケールは、POS シミュレーター用の構成ファイルで定義されます。
- **最大許容金額** – 指定されたトランザクションで処理できる最大金額。
- **最小許容金額** – 指定されたトランザクションで処理できる最小金額。
- **署名キャプチャの最小量** – 顧客が署名を提供するように促される最低額。
- **ターミナル ID** – プロセッサが提供したトランザクション プロパティに含まれるターミナル ID。

**行タブ**

**明細行** タブには、ライン ディスプレイとして使用されている場合に、デバイスに送信できるデータが含まれています。

- **説明** - デバイスに表示されるトランザクション明細行の製品説明。
- **割引** - トランザクション明細行に適用される割引金額。
- **拡張された税込明細行** - 製品明細行の金額。 この金額には税金が含まれています。
- **行項目 ID** – トランザクション明細行の製品 ID。
- **数量** – トランザクション明細行の数量。
- **最小在庫管理単位** – デバイスに表示する測定単位。
- **単価** – トランザクション明細行の販売価格。
- **統一商品コード** – トランザクション明細行のためにスキャンされたバーコード。
- **無効** – トランザクションからトランザクション行が削除されたことを示す値。

**詳細タブ**

**詳細** タブには、デバイスに表示できる小計の情報が含まれます。

- **割引金額** - トランザクション上の割引の合計金額。
- **小計金額** – トランザクションの小計。 この金額には、税金が含まれていません。
- **税額** – トランザクションの税額。
- **合計金額** – 予定されている合計金額。 この金額には税金と割引が含まれます。
- **通貨** - トランザクションに使用される通貨。

**支払情報タブ**

**支払情報** タブには、承認が処理された後に、支払コネクタから受信したデータが含まれています。

- **承認** – 承認要求が承認されているかどうかを示す値。
- **マスクされたカード番号** - デバイスによって提供されるマスクされたカード番号です。 通常、カード番号の最後の 4 桁のみが表示されます。
- **カード タイプ** - トランザクションに使用されるカードの問題です。
- **承認済金額** - カードの支払に対して承認されている金額。
- **支払 SDK データ** – 認証コードや支払プロセッサが提供するその他のデータなど、支払ソフトウェア開発キット (SDK) が提供する追加データ。
- **署名データ** – デバイスによって提供される 16 進署名データ。
- **支払エラー** – 認証要求中に発生したエラー。

## <a name="instructions-for-device-manufacturers"></a>デバイス メーカーに対する指示

コマースとの互換性を一覧表示できるようにデバイスを送信するには、次の手順を実行します。

1. **設定**タブで、要求されたすべての連絡先情報を指定します。 全フィールドが必須です。 個人の連絡先情報は、Microsoft の社内用です。 互換性のあると提出されたデバイスに問題がある場合にのみ使用されます。
2. 各デバイス用に、**デバイス**タブで、デバイスを設定し、すべてのフィールドの値を指定します。 各順列で、新しいデバイスを指定する必要があります。 たとえば、USB およびシリアル用に、指定されたデバイス モードがテストされる場合、2 つの互換性レポートが送信される必要があります。 1 つのデバイスから次のデバイスへの差異を示す必要があります。 次に、互換性のためにデバイスが記載されている場合、そのデバイスを実装するユーザーに非常に限定された情報を提供できます。 デバイスの互換性に関する情報が多く提供されるほど、実装の成功率が高くなり、サポートの問題が少なくなります。
3. デバイスおよび設定に必要な情報を入力した後に、デバイスをテストします。

    1. テストしているデバイスのログを消去します。
    2. **自己テスト**をクリックします。
    3. テストが正常に完了したときは、テストの結果をエクスポートして保存します。 ファイルに、テストを容易に識別する名前を付けます。 ファイル名として、メーカーの名前とデバイス モデルの省略形を使用することをお勧めします。

次の例は、エクスポートされたファイルに含まれるデータを示しています。

```xml
<?xml version="1.0" encoding="utf-8"?>  
<Report xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/Microsoft.Dynamics.Commerce.VirtualPeripherals.Modules">  
   <CreationDateTime>05/27/2017 19:34:50</CreationDateTime>  
   <ManufacturerInfo>  
    <ManufacturerName>Contoso </ManufacturerName>  
    <ManufacturerWebsite>http://www.contoso.com</ManufacturerWebsite>  
    <SupportEmail>support@contoso.com</SupportEmail>  
    <SupportTelephoneNumber>555-555-5555</SupportTelephoneNumber>  
    <SupportWebsite>http://www.contoso.com</SupportWebsite>  
    <TechnicalContactEmail>karen@contoso.com</TechnicalContactEmail>  
    <TechnicalContactName>Karen Berg</TechnicalContactName>  
    <TechnicalContactPhone>555-555-5555</TechnicalContactPhone>  
  </ManufacturerInfo>  
  <DeviceInfo i:type="OposDevice">  
   <DeviceDriverName>MockOPOSDrawer1</DeviceDriverName>  
   <DeviceModel>Model1</DeviceModel>  
   <DriverVersion>V2</DriverVersion>  
   <FirmwareVersion>V1</FirmwareVersion>  
  <HardwareType>OPOS</HardwareType>  
  <ConnectionType>USB</ConnectionType>  
  <DriverDownloadLink>htttp://model1.drivers.contoso.com</DriverDownloadLink>  
 <DeviceInfo i:type="OposDevice">
 <LogItems>  
  <LogMessage>  
     <LogType>Info</LogType>  
     <Message>The cash drawer is opened successfully.</Message>  
     <Timestamp>05/27/2017 19:48:14</Timestamp>  
  </LogMessage>  
  <LogMessage>  
     <LogType>Info</LogType>  
     <Message>The cash drawer open operation elapsed time: 00:00:00.053</Message>  
     <Timestamp>05/27/2017 19:48:14</Timestamp>  
  </LogMessage>  
  <LogMessage>  
      <LogType>Info</LogType>  
      <Message>The cash drawer status check operation is completed successfully.</Message>  
      <Timestamp>05/27/2017 19:48:14</Timestamp>  
   </LogMessage>  
   <LogMessage>  
      <LogType>Info</LogType>  
      <Message>The cash drawer status check operation elapsed time: 00:00:00.045</Message>  
      <Timestamp>05/27/2017 19:48:14</Timestamp>  
   </LogMessage>  
      <LogMessage>  
      <LogType>Info</LogType>  
      <Message>Test finished successfully.</Message>  
      <Timestamp>05/27/2017 19:48:14</Timestamp>  
    </LogMessage>  
  </LogItems>  
</Report>
```

最終的には、レポート (連絡先の個人情報を除く) に含まれているデータがデバイス互換性 Web サイトに表示されます。 顧客環境の管理に使用される設計および配置のツールでも表示されます。

正常なログを、drpc@microsoft.com に送信する必要があります。 件名行に、メーカーの名前とデバイス モデルを含めます。

互換性のテストを実行しているサポート、およびその他の照会については、drpc@microsoft.com に電子メールを送信します。

## <a name="additional-resources"></a>追加リソース

[周辺機器](../retail-peripherals-overview.md)
