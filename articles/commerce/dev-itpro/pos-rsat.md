---
title: Cloud POS 用のレコーダーおよび Regression Suite Automation Tool のテスト
description: このトピックでは、POS テスト レコーダーと Regression Suite Automation Tool (RSAT) を使用して、ユーザー受け入れテスト (UAT) を自動化する方法について説明します。
author: mugunthanm
manager: AnnBe
ms.date: 08/10/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.custom: 28021
ms.assetid: ''
ms.search.region: Global
ms.author: mumani
ms.search.validFrom: 2019-08-2019
ms.dyn365.ops.version: AX 10.0.5
ms.openlocfilehash: 0665491bf1e5d86e7bc841c9799c6b0d90ac171a
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2020
ms.locfileid: "4681512"
---
# <a name="test-recorder-and-regression-suite-automation-tool-for-cloud-pos"></a>Cloud POS 用のレコーダーおよび Regression Suite Automation Tool のテスト

[!include [banner](../includes/banner.md)]


このトピックでは、Cloud POS の新しいテスト レコーダー ツールを使用して、ユーザー受け入れテスト (UAT) とユーザー インターフェイス (UI) テストのビジネス シナリオを記録する方法について説明します。 また、Regression Suite Automation Tool (RSAT) を使用してテストの検証を自動化する方法についても説明します。 RSAT では、Microsoft Azure DevOps のテスト スイートを使用してテスト ケースをダウンロードします。 次に、テストの実行ステータスと共に、結果が Azure DevOps に報告されます。 テスト ケースは、Azure DevOps で手動で作成するか、または Microsoft Dynamics Lifecycle Services (LCS) の ビジネス プロセス モデラー (BPM) ツール から Azure DevOps に同期してから、RSAT に同期することができます。

このトピックは、Dynamics 365 Retail および Dynamics 365 Finance バージョン 10.0.5 (2019 年 10 月) 以降に適用されます。

> [!NOTE]
> テスト レコーダーは、Google Chrome Web ブラウザーを使用している場合にのみ、Cloud POS でサポートされます。 その他の Web ブラウザーおよびデバイス タイプのサポートは、今後追加されます。

## <a name="test-recorder"></a>テスト レコーダー

POS のテスト レコーダーは、UAT の時間とコストを大幅に削減するのに役立ちます。 通常、UAT は、Microsoft アプリケーションの更新が適用される前に、またはカスタム コードと構成がユーザーの POS 生産環境に適用される前に必要になります。

テスト レコーダーは、クライアントのユーザー アクションを記録でき、ドキュメント オブジェクト モデル (DOM) 内のすべてのコントロールおよびすべての要素に対する正確な忠実度を提供します。 POS で、テスト レコーダーは、発生したイベントを該当するユーザー アクションに関するすべての関連情報と共にキャプチャして、リアルタイムで保存します。 テスト レコーダーは、この情報からユーザー アクションのタイプ (ボタンのクリック、値の入力、ナビゲーションなど) と、ユーザー アクションに関連するデータ (入力データの値とタイプ、ビュー コンテキスト、レコード コンテキストなど) をキャプチャできます。 ただし、パスワード情報はキャプチャされません。 記録セッション中は、テスト レコーダーによってすべての記録された情報がメモリに保持されます。 その後、記録セッションの終了時に、必要な詳細を含む出力ファイルが生成されます。これにより、RSATを使用してユーザーが実行したときと同じようにアクションを再生できます。

> [!IMPORTANT]
> テスト レコーダーは、POS ユーザーのパスワードを除く、記録セッション中に入力されたすべてのデータをキャプチャします。 個人を特定できる情報 (PII)、シークレット、機密性の高いデータ、またはユーザー固有のデータは記録しないでください。 記録セッション中に入力されたデータはすべて、Recording.xml ファイルに格納されます。その他のユーザーは、LCS および Azure DevOps、variables.xlsx および Recording .xml ファイルの中と、再生中にそのデータを参照できます。

## <a name="regression-suite-automation-tool"></a>Regression Suite Automation Tool

RSAT を使用すると、機能パワーユーザーは POS でテスト ケースを実行することができます。 その後、Azure DevOps のテストの実行結果は、レポートおよび調査のために更新されます。

RSAT には、テストの失敗を調査するためのオプションが用意されています。 さらに、テスト パラメーターをテスト ステップから切り離して、Microsoft Excel ファイルにパラメーターを格納します。 この方法により、テスト パラメーター値が簡単に編集できるようになります。

## <a name="prerequisites"></a>必要条件

+ POS 環境が必要です。
+ テスト環境では、バイナリ更新プログラム 10.0.5 以降を実行する必要があります。
+ RSAT は、Web ブラウザーを介してテスト環境にアクセスできる必要があります。
+ テスト パラメーターを作成および編集するには、Excel をインストールしておく必要があります。
+ テスト ケース、テスト計画、およびテストケースの結果を保存および管理するには、 Azure DevOps プロジェクトが必要です。

## <a name="enable-test-recording-in-the-pos-application"></a>POS アプリケーションでのテスト記録の有効化

POS で記録のテスト機能を有効にするには、バックオフィスで次の手順を実行します。

1. **Retail とコマース** &gt; **チャネル設定** &gt; **POS 設定** &gt; **レジスター** の順に移動します。
2. テスト記録機能を有効にする必要があるレジスターを選択します。
3. **登録** タブの **全般** クイック タブで、**タスクとテスト レコーダーの有効化** オプションを **はい** に設定します。
4. **保存** を選択します。
5. **Retail と Commerce** &gt; **Retail と Commerce IT** &gt; **配送スケジュール** の順に移動します。
6. **1090 レジスター** ジョブを選択し、**今すぐ実行** を選択します。

## <a name="controlling-the-test-recorder"></a>テスト レコーダーの制御

### <a name="open-the-test-recorder"></a>テスト レコーダーを開く

テスト レコーダーを開くには、Cloud POS にログインしてから、**設定** ページの **タスクとテスト レコーダー** セクションで、**テスト レコーダーを開く** を選択します。

[![タスクおよびテスト レコーダー](./media/CreateTest.png)](./media/CreateTest.png)

### <a name="stop-a-recording-session"></a>記録セッションの停止

記録セッションを終了するには、**停止** を選択します。 終了後に記録セッションを再起動することはできません。 そのため、記録セッションが完了したことを確認してから終了してください。

[![テスト レコーダーの停止ボタン](./media/Stop.png)](./media/Stop.png)

### <a name="pause-a-recording-session"></a>記録セッションの一時停止

記録セッションを一時的に停止 (一時停止) するには、**一時停止** を選択します。 **一時停止** を選択した後で実行するステップは記録されません。

[![テスト レコーダーの一時停止ボタン](./media/Pause.png)](./media/Pause.png)

### <a name="continue-a-recording-session"></a>記録セッションの続行

一時停止後に記録セッションを再開するには、**記録** を選択します。

[![テスト レコーダーの記録ボタン](./media/Recording.png)](./media/Recording.png)

### <a name="start-and-end-a-task"></a>タスクの開始と終了

手順を整理するために、ステップをグループ化してタスクにまとめることができます。 グループ化されたステップの開始と終了を指定するには、**タスクの開始** と **タスクの終了** ボタンを使用します。 **タスクの開始** を選択して「タスクの開始」ステップを追加し、グループに含めるステップを実行します。 グループのステップの実行を終了したら、**タスクの終了** を選択します。 

タスクはその他のタスク内で入れ子にすることができます。 この方法を使用すると、非常に長く複雑な業務プロセスをさらに上手に整理できます。

> [!div class="mx-imgBorder"]
> [![タスク](./media/StartTask.png)](./media/Recording.png)

### <a name="add-a-new-task"></a>新しいタスクの追加

> [!div class="mx-imgBorder"]
> [![新しいタスク](./media/NewTask.png)](./media/NewTask.png)

### <a name="add-an-annotation"></a>注釈の追加

注釈は、記録でステップに追加するテキストです。 たとえば、注釈を使用して、詳細なコンテキストや指示をユーザーに与えることができます。 ステップの右側にある **編集** ボタン (鉛筆のアイコン) を選択して、任意のステップに注釈を追加できます。

> [!div class="mx-imgBorder"]
> [![テスト レコーダーの注釈鉛筆ボタン](./media/Annotation.png)](./media/Annotation.png)

### <a name="add-text-and-notes"></a>テキストとメモの追加

注釈ダイアログ ボックスの **テキスト** および **メモ** フィールドを使用して、タスク ガイドのステップに関連付けるテキストを追加できます。

+ **テキスト** – このフィールドに入力するテキストは、テスト ステップにあるステップのテキストの *上* に表示されます。
+ **メモ** – このフィールドに入力するテキストは、ステップのテキストの *下* に表示されます。

### <a name="change-input-values"></a>入力値の変更

記録セッション中に入力されたユーザー入力値を変更できます。 たとえば、記録セッション中に製品 0005 を追加した場合、既定では、製品 ID は Recording.xml ファイルに格納されます。 別の製品 ID を指定する場合は、ここで値を変更できます。 この値は、ユーザー入力がある場合のみ表示されます。

> [!div class="mx-imgBorder"]
> [![値と注釈の編集](./media/EditAnnotation.png)](./media/EditAnnotation.png)

### <a name="hide-the-test-recorder-pane"></a>テスト レコーダー ウィンドウの非表示

記録セッション中にテスト レコーダー ウィンドウの非表示と表示を切り替えるには、折りたたみボタンを選択します。

> [!div class="mx-imgBorder"]
> [![折りたたみボタン](./media/Hide.png)](./media/Hide.png)

### <a name="test-recorder-floating-control"></a>テスト レコーダーのフローティング コントロール

テスト レコーダーのフローティング コントロールは、記録セッション中にテスト レコーダー ウィンドウが非表示になっている場合に役立ちます。 テスト レコーダー ウィンドウは、エラーのないダイアログ ボックスや POS ビューの一部をオーバーライドします。 したがって、ダイアログ ボックスで検証を追加したり、コントロールを選択したりするために、ウィンドウを非表示にすることが必要な場合があります。 テスト レコーダー ウィンドウが非表示になっていても、テスト記録機能にアクセスする必要がある場合 (たとえば、検証モードをオンにしたり、記録セッションを一時停止または続行する必要がある場合)、このフローティング コントロールを使用できます。

[![フローティング コントロール](./media/Floatter.png)](./media/Floatter.png)

次のセクションでは、フローティング コントロール上のコントロールについて説明します。

#### <a name="move-control"></a>移動コントロール

移動コントロールを使用すると、POS アプリ内のフローティング コントロールを移動できます。

#### <a name="validation-mode"></a>検証モード

検証モードをオンにすると、記録セッションは一時停止します。 記録セッションを続行するには、検証モードをオフにする必要があります。

#### <a name="pause"></a>一時停止

記録セッションを一時的に中止 (一時停止) して操作を続行するには、**一時停止** を選択します。 **一時停止** を選択した後で実行するステップは記録されません。

#### <a name="recording"></a>レコード

一時停止後に記録セッションを再開するには、**記録** を選択します。

## <a name="record-a-test-case-in-pos"></a>POS でのテスト ケースの記録

### <a name="create-a-recording"></a>記録の作成

> [!IMPORTANT]
> レコーディングまたはテストの実行/再生を作成する前に、[アプリ ツアーの表示] と [ログイン後にアプリの紹介を表示] をオフにします。 これを行うには、**CPOS 設定 > アプリケーションのヘルプ** セクション (Dynamics 365 Commerce デモ データが使用されている場合にのみ適用) に移動します。 チャンネル データベースで次のスクリプトを実行して、デモ データでこれをオフにします: Update [ax].[SYSSERVICECONFIGURATIONSETTING] SET VALUE = '0' WHERE NAME = 'APPTOUR'。

次の手順に従い、テスト レコーダーを使用して新しい記録を作成します。

1. クラウド POS を起動します。

2. 左ウィンドウで ハンバーガー アイコンを選択し、**設定** を選択します。 クラウド POS にはサインインしないでください。 サインインの手順は、テスト記録フローの一部として記録する必要があるので、サインインの前にレコーダーを起動する必要があります。)

3. **設定** ページの **タスクとテスト レコーダー** セクションで、**テスト レコーダーを開く** を選択します。

    [![タスクおよびテスト レコーダー](./media/CreateTest.png)](./media/CreateTest.png)

4. **新しい記録の作成** を選択します。

    > [!div class="mx-imgBorder"]
    > [![新しい記録の作成](./media/NewTest.png)](./media/Newtest.png)

5. 記録の名前と説明を入力し、**開始** を選択します。

    テスト レコーダーが記録モードに入り、記録セッションが開始されます。 テスト レコーダー ウィンドウには、記録セッションに関連付けられている情報とコントロールが表示されます。
    
> [!NOTE]
> すべてのテスト記録は、クラウド POS サインイン ページから開始する必要があります。 記録がホーム ページから開始された場合は、トランザクションまたはその他のページの再生が失敗し、サインイン ページから再度記録を開始する必要があります。 


6. POS ユーザー インターフェイスで必要なアクションを実行します。

    > [!div class="mx-imgBorder"]
    > [![テスト レコーダーのステップ](./media/Steps.png)](./media/Steps.png)

### <a name="validation-mode"></a>検証モード

記録セッション中に検証モードを使用すると、ユーザーはテストの実行中に値を検証できます。 たとえば、ラベル テキストまたはエラー メッセージを検証する場合や、品目価格または税金が正しく計算されているかどうかを検証する場合に、検証モード機能を使用できます。 記録セッション中に検証モードをオンにするには、**検証モードの有効化** オプションを使用します。

1. **検証モードの有効化** オプションを **はい** に設定します。
2. 検証ステップを追加するには、POS の値またはテキストを選択します。 パスワード、機密データ、またはテスト レコーダーがフィールド値を取得できないフィールドに対して、検証は行われません。 テストの実行中、再生エンジンは値が同じかどうかを判断します。 検証の結果に応じて、テスト ケースは合格または不合格のいずれかになります。

    > [!NOTE]
    > 検証モードがオンになっている場合、テスト レコーダーは一時停止状態になります。 検証ステップが追加されるのみとなります。POS は検証ステップの追加以外のユーザー アクションには応答しません。 たとえば、検証モードでは、異なる POS ビューを開いたり、POS 機能を使用したりすることはできません。 記録セッションを続行するには、**検証モードの有効化** オプションを **いいえ** に設定して、検証モードをオフにする必要があります。

    [![テスト レコーダーの検証](./media/Validation.png)](./media/Validation.png)

3. 記録セッションを終了するには、**停止** を選択します。

### <a name="download-options"></a>ダウンロード オプション

記録セッションを終了した後、**このPC に保存** を選択することにより、記録をダウンロードできます。

> [!div class="mx-imgBorder"]
> ![テスト レコーダーの出力ファイルの保存](media/Save.png)

.axtr ファイルは、ローカル ファイル システムに保存されます。 このファイルを LCS または Azure DevOps に手動でアップロードしてから、ファイル システムから削除するか、セキュリティで保護する必要があります。 

Azure DevOps に直接アップロードするには:
1. .axtr ファイル拡張子を .zip に変更します。
2. .zip パッケージを開きます。 
3. パッケージの内部には、Recording.xml という名前のファイルがあります。 Recording.xml を Azure DevOps のテスト ケースにアップロードします。 .zip または .axtr パッケージ全体をアップロードしないようにします。

## <a name="install-rsat"></a>RSAT をインストールする

RSAT の Microsoft Windows インストーラー (MSI) パッケージ ファイルを [Regression Suite Automation Tool](https://www.microsoft.com/download/details.aspx?id=57357) からダウンロードします。 MSI ファイルをダブルクリックして、実行します。 RSAT をインストールした後、Selenium と Web ブラウザーのドライバーをインストールする必要があります。 

> [!NOTE]
> テストを実行する前に Azure DevOps を設定する必要があります。また、必要な全般設定およびその他の RSAT で必要な設定を完了しておく必要があります。 詳細な手順については、[Regression Suite Automation Tool のインストールおよびコンフィギュレーション](../../dev-itpro/perf-test/rsat/rsat-overview.md)を参照してください。

次の手順では、POS のテスト ケースを実行するために必要なコンフィギュレーションについて説明します。

### <a name="configure-the-pos-settings"></a>POS 設定のコンフィギュレーション

1. デスクトップから RSAT を開きます。
2. 右上にある **設定** ボタンを選択して、RSAT をコンフィギュレーションします。
3. **設定** ダイアログ ボックスで、**オプション** タブをクリックし、**Retail POS の構成** オプションを選択して Retail POS の自動化を有効にします。
4. **設定** ダイアログ ボックスの **Retail POS** タブの **再生環境** タブで、次のフィールドを設定します。

    + **Cloud POS URL** – テストを実行する Cloud POS 環境の URL を入力します。
    + **Commerce Scale Unit URL** – デバイスがまだ有効化されていない場合にデバイスの有効化に使用する、Commerce Scale Unit URL を入力します。

        > [!NOTE]
        > Cloud POS および Commerce Scale Unit URL は Finance and Operations 環境から取得できます。 **Retail とコマース > チャネル設定 > チャネル プロファイル** の順に移動します。 LCS 環境ページから URL を取得することもできます。
   
   + **AAD ユーザー電子メール** - デバイスの有効化に使用する Azure Active Directory (Azure AD) ユーザーの電子メール アドレスを入力します。 Azure AD ユーザーは、デバイスを有効にするアクセス許可を持っている必要があります。
   + **AAD パスワード** - デバイスの有効化に使用する Azure AD ユーザーのパスワードを入力します。
   + **登録番号** – テストを実行する登録番号 (チャネル) の ID を入力します。
   + **デバイス** - テストを実行するデバイスの ID を入力します。
   + **既定の待機時間** - いずれの要素も見つからなかった場合に、テスト ケースが失敗するまでの待機時間を秒単位で入力します。 テストの実行中、再生エンジンは、既定の待機時間が経過するまで要素の検索を試行し続けます。 その後、テスト ケースに失敗し、記録されていた要素が見つからなかったか、再生用に読み込まれなかったことを通知します。

    [![再生環境](./media/Settings.PNG)](./media/Settings.PNG)

5. **POS ログイン資格情報** タブを選択します。

    記録セッション中、テスト レコーダーは POS からのユーザー名のみをキャプチャします。 パスワードは保存されません。 ただし、テストを実行するには、POS へのサインインに使用するユーザー名とパスワードの両方が必要です。 このタブは POS のユーザー名とパスワードを取得して、パスワード情報が記録ファイルの外部に安全に保管されるようにします。 テストの実行時に、ユーザー ID は、RSAT で入力されたものと同じユーザー ID にマップされ、パスワードが取得されます。
    
    したがって、**POS ログイン資格情報** タブでは、記録セッション中に使用されたすべてのユーザー名とパスワードの情報を入力して、テストの実行中にパスワードを取得できるようにする必要があります。 入力しない場合、テストの実行は失敗し、サインインの詳細が見つからなかったことが通知されます。

    [![POS ログインの資格情報](./media/PosLogin.png)](./media/PosLogin.png)

6. **新規** を選択します。

    [![POS ユーザー](./media/EditPosUser.png)](./media/EditPosUser.png)

7. **ユーザー名** フィールドに、POS へのサインイン用のユーザー名を入力します。
8. **パスワード** フィールドに、POS へのサインイン用のパスワードを入力します。
9. 手順 6～8 を繰り返して、他のユーザー名とパスワードを入力します。
10. 一連の POS サインイン資格情報を編集するには、**編集** を選択します。
11. 一連の POS サインイン資格情報を削除するには、**削除** を選択します。

## <a name="run-tests"></a>テストの実行

このセクションでは、Azure DevOps からのテスト ケースの読み込み、自動化ファイルの生成、テスト パラメーターの変更、テストの実行、結果の調査、Azure DevOps への作業の保存方法について説明します。

> [!NOTE]
> Azure DevOps およびテスト ケースの設定の詳細については、[Regression Suite Automation Tool のインストールおよびコンフィギュレーション](../../dev-itpro/perf-test/rsat/rsat-overview.md)を参照してください。 テストの実行を開始する前に、この設定を完了する必要があります。 テストの実行/再生の前に、[アプリ ツアーの表示] と [ログイン後にアプリの紹介を表示] をオフにします。 チャンネル データベースで次のスクリプトを実行して、デモ データでこれをオフにします: Update [ax].[SYSSERVICECONFIGURATIONSETTING] SET VALUE = '0' WHERE NAME = 'APPTOUR'。

### <a name="load-test-cases-and-create-parameter-files"></a>テスト ケースの読み込みとパラメーター ファイルの作成

RSAT で、**読み込み** を選択して、テスト ケースとテスト ケース自動化ファイルを Azure DevOps からダウンロードします。 **設定** ダイアログ ボックスで指定されたテスト計画に属する、すべてのテスト ケースがダウンロードされます。

![貨物](./media/RSATLoad.png)

テスト ケースは、共通のテスト計画の下にあるテスト スイート別にまとめられています。 テスト スイートは、Azure DevOps プロジェクトで作成したテスト スイートです。 RSAT を使用することにより、一度に 1 つのテスト スイートを操作できます。 RSAT でテスト ケースを読み込むことができない場合は、Azure DevOps でテスト計画が正しく作成されていること、および必要なテスト スイートとテスト ケースが含まれていることを確認します。

テスト計画を初めて読み込む場合、グリッドの **パラメーター ファイル** 列は空白です。テスト ケースのテスト自動化パラメーター ファイルを生成する必要があります。

テストを実行するには、次のテスト自動化ファイルを生成します。

- テスト パラメーター ファイル (テスト ケース パラメーターを含む Excel ファイル)
- テストの実行に必要な XML ファイル

**新規** を選択すると、テスト自動化ファイルが作業ディレクトリに生成されます。 Excel テスト パラメーター ファイルは、グリッドの **パラメーター ファイル** 列に表示されます。

![パラメーター ファイル列のテスト パラメーター ファイル](./media/RSATParameter.png)

テストの記録ファイルの場合、**テストの実行ファイルのみを生成** オプションは使用できません。 Cloud POS は、Selenium WebDriver を直接使用して再生を実行するため、追加のスクリプト ファイルを生成する必要はありません。

![利用不可のテスト実行ファイルのみ生成オプション](./media/RSATNewOption.png)

### <a name="modify-test-parameters-and-validation-values"></a>テスト パラメーターおよび検証値の変更

このセクションでは、テスト実行の入力パラメーターと検証パラメーターを指定して Excel ファイルを変更する方法について説明します。

RSAT で、変更する 1 つ以上のテスト ケースを選択してから、**編集** を選択します。 選択したテスト ケースごとに Excel ウィンドウが開きます。 または、作業ディレクトリから直接 Excel ファイルを開くこともできます。

Excel ファイルには、**概要** タブに加えて、生成されたすべての変数の詳細を示す **変数** タブが含まれています。 POS は、記録セッション中に入力されたすべての入力値に対して、変数を自動的に生成します。 変数を個別に生成する必要はありません。 各変数には、一意の変数 ID があります。この ID は、テスト実行の 1 つのインスタンスで別のテスト ケースに順番に渡すことができます。 **変数** タブのすべての変数は、記録セッション中に入力された順序で表示されます。

POS のテストケース間で変数または値を渡すには、RSAT ツールでテスト ケースを選択し、ツールの [Excel] アイコンを選択して、Variables.xlsx ファイルを開きます。 変数 ID (列C) 値をコピーして、[変数値] フィールド (列D) に貼り付けます。 たとえば、**テストケース 1 - variable.Xlsx** から **テストケース 2 - variable.Xlsx** へのレシート ID を渡すには、列C: c8cc0571-9a27-b3c5-0749-c26c3cca6afe から変数 ID 値をコピーします。 変数値列 D の値を、テストケース2 - variable.xlsx ファイルに、次のように中括弧を使用して貼り付けます：**{{ c8cc0571-9a27-b3c5-0749-c26c3cca6afe}}**

### <a name="test-case-1--variablexlsx"></a>テストケース 1 – Variable.xlsx

| A （説明）            | B（表示名） | C（変数 ID）| D（変数の値） |
|---------------------------------|-------------------------------|------------------------------|--------------------------------------|
| レシート ID "HOU123R456" | ShowJournalView        | c8cc0571-9a27-b3c5-0749-c26c3cca6afe   | HOU123R456     |

### <a name="test-case-2--variablexlsx"></a>テストケース 2 – Variable.xlsx

| A （説明）            | B（表示名） | C（変数 ID）| D（変数の値） |
|---------------------------------|-------------------------------|------------------------------|--------------------------------------|
| レシート ID "HOU123R456" | ShowJournalView  | 80f23afa-5b76-5442-d16a-6cc9b8b245cb| **{{c8cc0571-9a27-b3c5-0749-c26c3cca6afe}}** |

### <a name="validate-expected-values"></a>予測値の検証

予想される値の検証は、テスト ケースの重要な要素です。 テスト ケースを作成するときに、検証モードでテスト レコーダーを使用して検証パラメーターを定義できます。

記録セッション中に、検証モードをオンにします。 次に、テスト レコーダーが記録している間に、検証する必要があるフィールドをすべて選択します。 このアクションが RSAT で使用できる検証ステップになります。 検証値は、入力された順に、Excel ファイルの **変数** タブに表示されます。 その後、テストの実行前に Excel ファイルの値を変更し、テストの実行中に新しい値を使用してデータの入力および検証を行うことができます。

![値の編集](./media/RSATExcel.png)

### <a name="run"></a>実行

RSAT で、**実行** を選択して、選択したテスト ケースを実行します。 自動化ファイルが生成されたテスト ケースのみ実行できます。 RSAT は POS を開き、Excel に入力されたデータを使用してテストを実行します。 テストの実行後、RSAT の **結果** 列、および Azure DevOps で結果が更新されます。

テスト ケースが実行される順序を変更するには、上向き矢印ボタンと下向き矢印ボタンを使用します。

### <a name="investigate-results"></a>結果の調査

テスト ケースの実行が完了すると、RSAT の **結果** 列に合格または不合格のステータスが表示されます。 詳細は Azure DevOps にあります。この詳細を使用して結果を調査できます。 Azure DevOps プロジェクト ページで、**テスト \> 実行** に移動します。

すべてのエラー メッセージは、C:\\Users\\$YourUserName\\AppData\\Roaming\\regressionTool\\errormsg\<TestCaseId\>.txt でローカルでも利用可能です。 

## <a name="system-and-metadata-files"></a>システムおよびメタデータ ファイル

次の表に、記録セッション、テストの実行、および再生時に生成されるファイルを示します。

| ファイル名      | 説明 | ファイル生成フロー | ファイル保存フロー |
|----------------|-------------|----------------------|----------------|
| Recording.xml  | このファイルには、記録の再生に必要なすべてのステップが含まれています。 記録の各ステップのすべてのユーザー固有の値が含まれます。 | ユーザーがテスト ケースを記録し、Azure DevOps にアップロードすると、RSAT で使用できるようにファイルが生成されます。 | このファイルは、テスト ケースが RSAT に読み込まれたときにディスクに保存されます。 |
| Variables.xml  | このファイルには、記録ファイルで使用されているすべての変数の値が含まれています。 再生ツールによって使用されます。 | このファイルは、ユーザーが RSAT で **新規 \> テスト実行とパラメーター ファイルの生成** を選択したときに生成されます。 | このファイルは、ユーザーが **新規 \> テスト実行とパラメーター ファイルの生成** を選択したときに保存されます。 |
| Variables.xlsx | このファイルには、記録ファイルで使用されているすべての変数の値が含まれています。 このファイルはユーザーが変更でき、再生ツールによって使用されます。 | このファイルは、ユーザーが RSAT で **新規 \> テスト実行とパラメーター ファイルの生成** を選択したときに生成されます。 | このファイルは、ユーザーが **新規 \> テスト実行とパラメーター ファイルの生成** を選択したときに保存されます。 |
| OutputLog.txt  | このファイルには、再生プロセスの実行のログが含まれています。 このファイルには、実行された各ステップの説明が含まれています。 例外が含まれている場合もあります。 例外によっては、Recording.xml ファイルに利用可能なデータが含まれている場合があります。 | このファイルは、テスト ケースが正常に再生されたかどうかに関係なく、RSAT の再生ツールの実行が完了した後に生成されます。 | このファイルは、テスト ケースが再生されるときに保存されます。 |
| Time.xml       | このファイルには、ステップの一覧、ユーザーによって編集された各ステップの説明、および各ステップの実行に必要な時間が含まれています。 | このファイルは、テスト ケースが正常に再生された場合にのみ、RSAT の再生ツールの実行が完了した後に生成されます。 | テスト ケースが正常に再生されると、このファイルが保存されます。 |
| Out.xml        | このファイルには、記録ファイルで使用されているすべての変数の値が含まれています。 このファイルは、Variables.xlsx ファイルから更新された値を各変数に対して使用します。 再生ツールはこのファイルを使用して、他のテスト ケースの変数に依存するテスト ケースをサポートします。 | このファイルは、テスト ケースが正常に再生されたかどうかに関係なく、RSAT の再生ツールの実行が完了した後に生成されます。 | このファイルは、テスト ケースが再生されるときに保存されます。 |
| In.xml         | このファイルには、現在のテスト ケースの前に実行されたすべてのテスト ケースの記録ファイルで使用される、すべての変数の値が含まれています。 このファイルは、各 Variables.xlsx ファイルから更新された値を使用します。 再生ツールはこのファイルを使用して、他のテスト ケースの変数に依存するテスト ケースをサポートします。 | 複数のテスト ケースが実行されている場合、このファイルは、RSAT の再生ツールが実行される前に生成されます。 | ファイルは、前のテスト ケースの実行が完了し、新しいテスト ケースが実行される前に保存されます。 |

これらのファイルは、手動で削除し、必要に応じて保護する必要があります。 これらのファイルはすべて、RSAT の作業ディレクトリに格納されます。

## <a name="best-practices"></a>ベスト プラクティス

### <a name="creating-test-cases-by-using-the-test-recorder"></a>テスト レコーダーを使用したテスト ケースの作成

+ レコーディングまたはテストの実行/再生を作成する前に、[アプリ ツアーの表示] と [ログイン後にアプリの紹介を表示] をオフにします。 これを行うには、**CPOS 設定 > アプリケーションのヘルプ** セクション (Dynamics 365 Commerce デモ データが使用されている場合にのみ適用) に移動します。 チャンネル データベースで次のスクリプトを実行して、デモ データでこれをオフにします: Update [ax].[SYSSERVICECONFIGURATIONSETTING] SET VALUE = '0' WHERE NAME = 'APPTOUR'。
+ Chrome 拡張機能を無効にする - 可能な場合は、記録して再生するのに使用した Chrome ブラウザーで Chrome 拡張機能を無効にします。 Chrome 拡張機能は DOM 要素の xpath を変更する場合があります。手順実行中に要素が見つからないため、テスト ケースが失敗になる可能性があるからです (xpath は記録とは異なります)。
+ 個々の記録を簡潔にし、1 人のユーザーが実行するビジネス タスク (販売トランザクションの作成など) に注目します。 この方法を使用すると、テスト ケースの管理と再利用が容易になります。
+ 機密情報を含むシナリオは記録しないでください。
+ 記録と再生は同じ画面レイアウトで実行し、同じ解像度で実行する必要があります。 記録と再生が異なるレイアウトで行われ、解像度が異なる場合、再生は失敗します。
+ 記録の再生中に POS ユーザー名を変更することはできません。 記録を作成する場合は、後で再生するときに使用するのと同じユーザー名を常に使用します。
+ POS 有効化フローの記録はサポートされていません。
+ キー操作の記録のパフォーマンスは遅くなる可能性があります。すべてのイベントが正しくキャプチャされるように、記録中はゆっくり入力してください。
+ 現在、周辺機器のエミュレーションはサポートされていません。キーボード ウェッジ ベースのデバイスを使用してください。
+ 複数のキー プレス イベントが記録される可能性があるため、記録中にキーを押したままにしないでください。
+ 拡張コントロールは、適切な XPath のベスト プラクティスに従うもので、可能であれば、各 HTML 要素に固有の ID が割り当てられている必要があります。

## <a name="troubleshooting-guides"></a>トラブルシューティング ガイド

### <a name="chrome-driver"></a>Chrome ドライバー

点滅して再生に失敗する (再生を開始せずにブラウザが複数回開いたり閉じたりする) 場合、これは Chrome ドライバーのバージョンに関連している可能性があります。 RSAT ツールのエラー ログを確認してください。 Chrome ドライバーのバージョンがサポートされていないというエラーが発生した場合は、エラー メッセージに記載されているサポートされている chromedriver.exe バージョンをダウンロードし、…\Regression Suite Automation Tool\Common\External\Selenium フォルダーに貼り付けます。  Chrome ドライバーは、[ChromeDriver](https://chromedriver.chromium.org/downloads) からダウンロードできます。

### <a name="disable-chrome-extension"></a>Chrome 拡張機能を無効にする

可能な場合は、記録して再生するのに使用した Chrome ブラウザーで Chrome 拡張機能を無効にします。 Chrome 拡張機能は DOM 要素の xpath を変更する場合があります。手順実行中に要素が見つからないため、テスト ケースが失敗になる可能性があるからです (xpath は記録とは異なります)。

### <a name="net-standard-error"></a>.NET 標準エラー

次のような 'netstandard' エラーが表示される場合は、.NET Framework 4.8 ランタイムをインストールしてください。 .NET ランタイムは、[SDK をダウンロード](https://dotnet.microsoft.com/download/visual-studio-sdks)からダウンロードできます。

ハンドルされない例外: System.IO.FileNotFoundException: ファイルまたはアセンブリ 'netstandard, Version=2.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'、あるいはその依存関係のうちのいずれか 1 つを読み込めませんでした。 システムは、Microsoft.Dynamics.Commerce.PosPlayback.RecordingsRunner.Program.Main(String[] args).Multifactor 認証で指定されたファイルを見つかることができません。

### <a name="multifactor-authentication"></a>マルチファクター認証

デバイス アクティベーション ユーザーに対してマルチファクター認証が有効になっている場合、再生が失敗する可能性があります。 可能な場合は、アクティベーション ユーザーのマルチファクター認証を一時的に無効にします。 有効化が完了したら、マルチファクター認証を再度有効にします。 有効化は、初回の再生時にのみ要求されます。 この変更を行う前に、この方法についてセキュリティの専門家に相談することをお勧めします。
