---
title: 独立したパッケージ SDK のビルド パイプラインの設定
description: このトピックでは、拡張コードに対して Cloud Scale Unit およびセルフサービスの配置可能パッケージを生成できるよう、Retail ソフトウェア開発キット (SDK) のビルド パイプラインを設定する方法について説明します。
author: mugunthanm
ms.date: 05/17/2021
ms.topic: article
audience: Developer
ms.reviewer: rhaertle
ms.search.region: Global
ms.author: mumani
ms.search.validFrom: 05-17-2020
ms.dyn365.ops.version: AX 10.0.19
ms.openlocfilehash: a8f10c26cdc28d1cab02c702838108d9e19de814
ms.sourcegitcommit: 53b797ff1b524f581046b48cdde42f50b37495bc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/28/2021
ms.locfileid: "6117197"
---
# <a name="set-up-a-build-pipeline-for-the-independent-packaging-sdk"></a><span data-ttu-id="3887f-103">独立したパッケージ SDK のビルド パイプラインの設定</span><span class="sxs-lookup"><span data-stu-id="3887f-103">Set up a build pipeline for the independent-packaging SDK</span></span>

[!include [banner](../../includes/banner.md)]

<span data-ttu-id="3887f-104">このトピックでは、拡張コードに対して Cloud Scale Unit およびセルフサービスの配置可能パッケージを生成できるよう、Retail ソフトウェア開発キット (SDK) のビルド パイプラインを設定する方法について説明します (新しい独立系拡張モデルを使用)。</span><span class="sxs-lookup"><span data-stu-id="3887f-104">This topic explains how to set up a build pipeline for the Retail software development kit (SDK) so that you can generate the Cloud Scale Unit and self-service deployable packages for extension code (by using the new independent extension model).</span></span>

<span data-ttu-id="3887f-105">このトピックは、Retail SDK 10.0.19 以降に適用されます。</span><span class="sxs-lookup"><span data-stu-id="3887f-105">This topic applies to version 10.0.19 and later of the Retail SDK.</span></span> <span data-ttu-id="3887f-106">Microsoft Dynamics Lifecycle Services (LCS) の開発者仮想マシン (VM) から Retail SDK の以前のバージョンを使用している場合、このトピックに記載されている手順は機能しません。</span><span class="sxs-lookup"><span data-stu-id="3887f-106">The steps that are described in this topic won't work if you're using the previous version of the Retail SDK from the developer virtual machine (VM) in Microsoft Dynamics Lifecycle Services (LCS).</span></span> <span data-ttu-id="3887f-107">このトピックの情報は、新しい独立した拡張モデル (つまり、パブリック フィードからパッケージを消費している場合) と、独立系梱包および拡張機能モデルを使用している場合に適用されます。</span><span class="sxs-lookup"><span data-stu-id="3887f-107">The information in this topic is applicable if you're using the new independent extension model (that is, if you're consuming the packages from the public feed), and the independent packaging and extension model.</span></span>

## <a name="set-up-a-build-pipeline-in-azure-devops-to-generate-a-cloud-scale-unit-extension-package"></a><span data-ttu-id="3887f-108">Azure DevOps のビルド パイプラインを設定し、Cloud Scale Unit 拡張パッケージを生成</span><span class="sxs-lookup"><span data-stu-id="3887f-108">Set up a build pipeline in Azure DevOps to generate a Cloud Scale Unit extension package</span></span>

1. <span data-ttu-id="3887f-109">Microsoft Azure DevOps 組織にサイン インします。</span><span class="sxs-lookup"><span data-stu-id="3887f-109">Sign in to your Microsoft Azure DevOps organization.</span></span>
2. <span data-ttu-id="3887f-110">**パイプライン** を選び、**新しいパイプライン** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-110">Select **Pipeline**, and then select **New pipeline**.</span></span>
3. <span data-ttu-id="3887f-111">拡張コードのソース リポジトリ (リポジトリ) を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-111">Select the source repository (repo) for your extension code.</span></span>
4. <span data-ttu-id="3887f-112">**既存の Azure Pipelines YAML ファイル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-112">Select **Existing Azure Pipelines YAML file**.</span></span>
5. <span data-ttu-id="3887f-113">[Dynamics365Commerce.ScaleUnit](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29) GitHub リポジトリから、[build-pipeline.yml ファイル](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/blob/release/9.29/Pipeline/YAML_Files/build-pipeline.yml) を選び、取得します。</span><span class="sxs-lookup"><span data-stu-id="3887f-113">Select or get the [build-pipeline.yml file](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/blob/release/9.29/Pipeline/YAML_Files/build-pipeline.yml) from the [Dynamics365Commerce.ScaleUnit](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29) GitHub repo.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-114">YAML ファイルは、[Dynamics365Commerce.ScaleUnit GitHub リポジトリの Pipeline/PowerShellScripts ディレクトリ](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29/Pipeline/PowerShellScripts) のスクリプトの一部を参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-114">The YAML file refers to some scripts in the [Pipeline/PowerShellScripts directory in the Dynamics365Commerce.ScaleUnit GitHub repo](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29/Pipeline/PowerShellScripts).</span></span> <span data-ttu-id="3887f-115">これら全てのスクリプトをリポジトリに含めてください。</span><span class="sxs-lookup"><span data-stu-id="3887f-115">Be sure to include all those scripts in your repo.</span></span> <span data-ttu-id="3887f-116">サンプル リポジトリをクローンする場合、すべてのスクリプトが既に含まれています。</span><span class="sxs-lookup"><span data-stu-id="3887f-116">If you clone the samples repo, all the scripts are already included.</span></span>

6. <span data-ttu-id="3887f-117">**続行** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-117">Select **Continue**.</span></span>

    <span data-ttu-id="3887f-118">YAML ファイルのスクリプトはソリューション全体を構築し、アウトプット (CloudScaleUnitExtensionPackage.zip パッケージ) をビルド用に **公開済みアーティファクト** のドロップ ロケーションにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="3887f-118">Scripts in the YAML file build the whole solution and upload the output (the CloudScaleUnitExtensionPackage.zip package) to the **Published Artifacts** drop location for the build.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-119">YAML ファイルはリポジトリのソリューション ファイルを検索し、ソリューションを構築して、CloudScaleUnitExtensionPackage.zip パッケージを検索します。</span><span class="sxs-lookup"><span data-stu-id="3887f-119">The YAML file looks for a solution file in the repo, builds the solution, and then looks for the CloudScaleUnitExtensionPackage.zip package.</span></span> <span data-ttu-id="3887f-120">したがって、拡張機能プロジェクトと梱包プロジェクトがソリューションにリンクされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3887f-120">Therefore, make sure that your extension and packaging projects are linked to a solution.</span></span> <span data-ttu-id="3887f-121">拡張プロジェクトをモデル化する方法については、[Dynamics365Commerce.ScaleUnit GitHub リポジトリ](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29) のサンプルを参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-121">For information about how to model your extension projects, see the samples in the [Dynamics365Commerce.ScaleUnit GitHub repo](https://github.com/microsoft/Dynamics365Commerce.ScaleUnit/tree/release/9.29).</span></span>

7. <span data-ttu-id="3887f-122">変更を保存し、キューにビルドを追加します。</span><span class="sxs-lookup"><span data-stu-id="3887f-122">Save your changes, and add the build to the queue.</span></span>
8. <span data-ttu-id="3887f-123">ビルドが完了すると、**公開済みアーティファクト** から **CloudScaleUnitExtensionPackage.zip** パッケージをダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="3887f-123">When the build is completed, you can download the **CloudScaleUnitExtensionPackage.zip** package from **Published Artifacts**.</span></span>

## <a name="set-up-a-release-pipeline-for-the-cloud-scale-unit-extension-package"></a><span data-ttu-id="3887f-124">Cloud Scale Unit 拡張パッケージのリリース パイプラインを設定</span><span class="sxs-lookup"><span data-stu-id="3887f-124">Set up a release pipeline for the Cloud Scale Unit extension package</span></span>

<span data-ttu-id="3887f-125">ベスト プラクティスとして、個別のビルド パイプラインとリリース パイプラインを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3887f-125">As a best practice, you should set up separate build and release pipelines.</span></span> <span data-ttu-id="3887f-126">個別のリリース パイプラインを作成する場合は、LCS の **資産のアップロード** を使い、CloudScaleUnitExtensionPackage.zip パッケージをアセット ライブラリにアップロードできます。</span><span class="sxs-lookup"><span data-stu-id="3887f-126">If you create a separate release pipeline, you can use the **Upload Asset** task in LCS to upload the CloudScaleUnitExtensionPackage.zip package to the Asset library.</span></span> <span data-ttu-id="3887f-127">別のリリース パイプラインにではなく、LCS にアップロードする場合は、タスクをビルド パイプラインの一部として追加できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-127">If you want to upload to LCS instead of to a separate release pipeline, you can add the task as part of your build pipeline.</span></span>

<span data-ttu-id="3887f-128">次の手順に従って、リリース パイプラインを設定して、CloudScaleUnitExtensionPackage.zip パッケージを LCS のアセット ライブラリにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="3887f-128">Follow these steps to set up the release pipeline to upload the CloudScaleUnitExtensionPackage.zip package to the Asset library in LCS.</span></span>

1. <span data-ttu-id="3887f-129">Azure DevOps で、**リリース** から **新しいパイプライン** を選び、**テンプレートの空のジョブ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-129">In Azure DevOps, select **Releases**, select **New pipeline**, and then select **Empty job in the template**.</span></span>
2. <span data-ttu-id="3887f-130">新しいリリース パイプラインの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="3887f-130">Enter a name for the new release pipeline.</span></span> <span data-ttu-id="3887f-131">既定の名前は、**アプリ パイプライン \> 新しいリリース パイプライン** です。</span><span class="sxs-lookup"><span data-stu-id="3887f-131">The default name is **App Pipelines \> New release pipeline**.</span></span>
3. <span data-ttu-id="3887f-132">パイプラインで、**コンポーネントを追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-132">In the pipeline, select **Add an artifact**.</span></span>
4. <span data-ttu-id="3887f-133">**コンポーネントを追加** ダイアログ ボックスでプロジェクトを選び、以前のセクションで作成したビルド パイプラインを選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-133">In the **Add artifact** dialog box, select your project, and then select the build pipeline that you created in the previous section.</span></span>
5. <span data-ttu-id="3887f-134">オプション: 作成したコンポーネントで **トリガー** ボタン (稲妻記号) を選択し、継続的配置トリガーを有効にしてから、ブランチなどを選択できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-134">Optional: In the artifact that you just created, you can select the **Trigger** button (lightning bolt symbol), enable a continuous deployment trigger, and then select your branch, and so on.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-135">リリース パイプラインには、リリースのトリガー時期と方法が指定できる他のオプションも用意されています。</span><span class="sxs-lookup"><span data-stu-id="3887f-135">The release pipeline also offers other options that let you specify how and when the release is triggered.</span></span>

6. <span data-ttu-id="3887f-136">**保存** を選択して、パイプラインを保存します。</span><span class="sxs-lookup"><span data-stu-id="3887f-136">Select **Save** to save your pipeline.</span></span> <span data-ttu-id="3887f-137">フォルダ名の入力を求めるメッセージが表示された場合は、任意のフォルダ名を入力します。</span><span class="sxs-lookup"><span data-stu-id="3887f-137">If you're prompted for a folder name, enter any folder name.</span></span>
7. <span data-ttu-id="3887f-138">**ステージ** を選び、ステージ 1 **LCS に資産をアップデート** の名前を変え、**ジョブ 1** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-138">Select **Stages**, rename stage 1 **Upload Assets to LCS**, and then select **1 Job**.</span></span>
8. <span data-ttu-id="3887f-139">**タスク** で、**エージェント ジョブ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-139">In **Tasks**, select **Agent job**.</span></span>
9. <span data-ttu-id="3887f-140">**タスクの追加** で、**Dynamics Lifecycle Services (LCS) 資産のアップロード** を検索し、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-140">In **Add tasks**, search for **Dynamics Lifecycle Services (LCS) Asset Upload**, and select **Add**.</span></span>
10. <span data-ttu-id="3887f-141">アップロード タスクを設定するには、[Azure Pipelines を使用して資産をアップロード](../../fin-ops-core/dev-itpro/dev-tools/pipeline-asset-upload.md) の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="3887f-141">Set up the upload task by following the steps in [Upload assets by using Azure Pipelines](../../fin-ops-core/dev-itpro/dev-tools/pipeline-asset-upload.md).</span></span> <span data-ttu-id="3887f-142">タスクで、次の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="3887f-142">In the task, set the following values:</span></span>

    - <span data-ttu-id="3887f-143">**資産のタイプ:** CloudScaleUnitExtensionPackage</span><span class="sxs-lookup"><span data-stu-id="3887f-143">**Type of asset:** CloudScaleUnitExtensionPackage</span></span>
    - <span data-ttu-id="3887f-144">**アップロードするファイル:** $(System.DefaultWorkingDirectory)/\_ScaleUnit-CI/drop/ScaleUnitPackage\_$(Release.Artifacts.\_ScaleUnit-CI.BuildNumber).zip</span><span class="sxs-lookup"><span data-stu-id="3887f-144">**File to Upload:** $(System.DefaultWorkingDirectory)/\_ScaleUnit-CI/drop/ScaleUnitPackage\_$(Release.Artifacts.\_ScaleUnit-CI.BuildNumber).zip</span></span>
    - <span data-ttu-id="3887f-145">**LCS 資産名:** ScaleUnitPackage\_$(Release.Artifacts.\_ScaleUnit-CI.BuildNumber)</span><span class="sxs-lookup"><span data-stu-id="3887f-145">**LCS Asset Name:** ScaleUnitPackage\_$(Release.Artifacts.\_ScaleUnit-CI.BuildNumber)</span></span>

        > [!NOTE]
        > <span data-ttu-id="3887f-146">資産名は、名前付けガイドラインに従って変更できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-146">You can change the asset name according to your naming guidelines.</span></span>

11. <span data-ttu-id="3887f-147">タスクの構成が完了したら、**保存** を選び、リリース パイプラインを保存します。</span><span class="sxs-lookup"><span data-stu-id="3887f-147">After you've finished configuring tasks, select **Save** to save the release pipeline.</span></span>
12. <span data-ttu-id="3887f-148">**パイプライン** タブでパイプラインを選び、**リリースの作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-148">On the **Pipelines** tab, select your pipeline, and then select **Create release**.</span></span>
13. <span data-ttu-id="3887f-149">**新しいリリースの作成** ダイアログ ボックスで、Cloud Scale Unit コンポーネントを選び、**作成** からリリースを手動でトリガーします。</span><span class="sxs-lookup"><span data-stu-id="3887f-149">In the **Create a new release** dialog box, select the Cloud Scale Unit artifact, and then select **Create** to manually trigger the release.</span></span>

<span data-ttu-id="3887f-150">リリース パイプラインを自動化するには、継続的ビルドを構成します。</span><span class="sxs-lookup"><span data-stu-id="3887f-150">To automate the release pipeline, configure continuous build.</span></span> <span data-ttu-id="3887f-151">詳細については、[パイプラインのリリース](/azure/devops/pipelines/release) ドキュメントを参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-151">For more information, see the [Release pipelines](/azure/devops/pipelines/release) documentation.</span></span>

## <a name="set-up-a-build-pipeline-in-azure-devops-to-generate-retail-self-service-packages"></a><span data-ttu-id="3887f-152">Retail セルフ サービス パッケージを生成するには、Azure DevOps のビルド パイプラインを設定</span><span class="sxs-lookup"><span data-stu-id="3887f-152">Set up a build pipeline in Azure DevOps to generate Retail self-service packages</span></span>

<span data-ttu-id="3887f-153">次の手順に従い、Retail Modern POS、Hardware Station および Cloud Scale Unit (セルフ ホスト) インストーラーを生成します。</span><span class="sxs-lookup"><span data-stu-id="3887f-153">Follow these steps to generate the Retail Modern POS, Hardware Station, and Cloud Scale Unit (self-hosted) installers.</span></span>

1. <span data-ttu-id="3887f-154">Azure DevOps 組織にサイン インします。</span><span class="sxs-lookup"><span data-stu-id="3887f-154">Sign in to your Azure DevOps organization.</span></span>
2. <span data-ttu-id="3887f-155">**パイプライン** を選び、**新しいパイプライン** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-155">Select **Pipeline**, and then select **New pipeline**.</span></span>
3. <span data-ttu-id="3887f-156">ソース リポジトリを選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-156">Select your source repo.</span></span>
4. <span data-ttu-id="3887f-157">**既存の Azure Pipelines YAML ファイル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-157">Select **Existing Azure Pipelines YAML file**.</span></span>
5. <span data-ttu-id="3887f-158">[ Dynamics365Commerce.InStore GitHub リポジトリの Pipeline/YAML\_Files ディレクトリから YAML ファイル (build-pipeline.yml)](https://github.com/microsoft/Dynamics365Commerce.InStore/blob/release/9.29/Pipeline/YAML_Files/build-pipeline.yml) を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-158">Select the [YAML file (build-pipeline.yml) from the Pipeline/YAML\_Files directory in the Dynamics365Commerce.InStore GitHub repo](https://github.com/microsoft/Dynamics365Commerce.InStore/blob/release/9.29/Pipeline/YAML_Files/build-pipeline.yml).</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-159">YAML ファイルは、[Dynamics365Commerce.InStore GitHub リポジトリの Pipeline/PowerShellScripts ディレクトリ](https://github.com/microsoft/Dynamics365Commerce.InStore/tree/release/9.29/Pipeline/PowerShellScripts) のスクリプトの一部を参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-159">The YAML file refers to some scripts in the [Pipeline/PowerShellScripts directory in the Dynamics365Commerce.InStore GitHub repo](https://github.com/microsoft/Dynamics365Commerce.InStore/tree/release/9.29/Pipeline/PowerShellScripts).</span></span> <span data-ttu-id="3887f-160">これら全てのスクリプトをリポジトリに含めてください。</span><span class="sxs-lookup"><span data-stu-id="3887f-160">Be sure to include all those scripts in your repo.</span></span> <span data-ttu-id="3887f-161">サンプル リポジトリをクローンする場合、すべてのスクリプトが既に含まれています。</span><span class="sxs-lookup"><span data-stu-id="3887f-161">If you clone the samples repo, all the scripts are already included.</span></span>

6. <span data-ttu-id="3887f-162">**続行** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-162">Select **Continue**.</span></span>

    <span data-ttu-id="3887f-163">YAML ファイルには、証明書を使用して Modern POS および Hardware Station インストーラーに署名する手順が示されています。</span><span class="sxs-lookup"><span data-stu-id="3887f-163">The YAML file has steps to sign the Modern POS and Hardware Station installers by using a certificate.</span></span> <span data-ttu-id="3887f-164">スクリプトでは、Azure Key Vault の証明書ファイルが検索され、その証明書ファイルが署名に使用されます。</span><span class="sxs-lookup"><span data-stu-id="3887f-164">The script will look for a certificate file in Azure Key Vault and use that certificate file for signing.</span></span> <span data-ttu-id="3887f-165">Azure Key Vault から証明書を読むには、アプリケーション ID、シークレット、証明書名およびタイムスタンプ サーバーの詳細 (タイムスタンプを使用して証明書に署名するために) を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3887f-165">To read the certificate from Azure Key Vault, you must provide the application ID, secret, certificate name, and timestamp server details (for signing the certificate by using a timestamp).</span></span> <span data-ttu-id="3887f-166">詳細については、[Azure Key Vault から Azure ポータルを使用して証明書を設定および取得](/azure/key-vault/certificates/quick-create-portal) を参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-166">For more information, see [Set and retrieve a certificate from Azure Key Vault using the Azure portal](/azure/key-vault/certificates/quick-create-portal).</span></span>

    <span data-ttu-id="3887f-167">パイプライン内のキー コンテナーとタイムスタンプ サーバーの詳細を表示するには、ビルド パイプラインの **変数** タブに次の変数を作成し、その値を指定します。</span><span class="sxs-lookup"><span data-stu-id="3887f-167">To view the details of the key vault and the timestamp server in the pipeline, create the following variables on the **Variables** tab in your build pipeline, and provide values for them.</span></span> <span data-ttu-id="3887f-168">変数のセキュリティを確保するには、変数タイプとして **シークレット** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-168">To help secure the variables, you can select **Secret** as the variable type.</span></span>

    - <span data-ttu-id="3887f-169">ApplicationId</span><span class="sxs-lookup"><span data-stu-id="3887f-169">ApplicationId</span></span>
    - <span data-ttu-id="3887f-170">AzureKeyVaultURI</span><span class="sxs-lookup"><span data-stu-id="3887f-170">AzureKeyVaultURI</span></span>
    - <span data-ttu-id="3887f-171">CertificateName</span><span class="sxs-lookup"><span data-stu-id="3887f-171">CertificateName</span></span>
    - <span data-ttu-id="3887f-172">SecretValue</span><span class="sxs-lookup"><span data-stu-id="3887f-172">SecretValue</span></span>
    - <span data-ttu-id="3887f-173">タイムスタンプ</span><span class="sxs-lookup"><span data-stu-id="3887f-173">Timestamp</span></span>

        <span data-ttu-id="3887f-174">この変数の値として、`http://timestamp.digicert.com` の通り、タイムスタンプ プロバイダを指定できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-174">You can specify any timestamp provider as the value of this variable, such as `http://timestamp.digicert.com`.</span></span>

    <span data-ttu-id="3887f-175">Azure に証明書を格納していない場合は、**セキュア タスク** オプションまたは Azure Pipelines がサポートする他のオプションを使用して、インストーラーに署名できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-175">If you aren't storing your certificate in Azure, you can sign the installers by using the **Secure task** option or other options that Azure Pipelines supports.</span></span>

    <span data-ttu-id="3887f-176">インストーラに署名する必要がな場合は、署名ステップを YAML ファイルから削除できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-176">If you don't want to sign the installers, you can remove the signing step from the YAML file.</span></span> <span data-ttu-id="3887f-177">YAML ファイルで、**PowerShell\@2** タスクを検索して、削除します。</span><span class="sxs-lookup"><span data-stu-id="3887f-177">In the YAML file, search for the **PowerShell\@2** task, and remove it.</span></span>

    <span data-ttu-id="3887f-178">YAML ファイルのスクリプトはソリューション全体を構築し、アウトプット (HardwareStation.Installer.exe および ModernPos.Installer.exe パッケージ) をビルド用に **公開済みアーティファクト** のドロップ ロケーションにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="3887f-178">Scripts in the YAML file build the whole solution and upload the output (the HardwareStation.Installer.exe and ModernPos.Installer.exe packages) to the **Published Artifacts** drop location for the build.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-179">YAML ファイルはリポジトリのソリューション ファイルを検索し、ソリューションを構築して、HardwareStation.Installer.exe および ModernPos.Installer.exe パッケージを検索します。</span><span class="sxs-lookup"><span data-stu-id="3887f-179">The YAML file looks for a solution file in the repo, builds the solution, and then looks for the HardwareStation.Installer.exe and ModernPos.Installer.exe packages.</span></span> <span data-ttu-id="3887f-180">したがって、拡張機能プロジェクトと梱包プロジェクトがソリューションにリンクされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3887f-180">Therefore, make sure that your extension and packaging projects are linked to a solution.</span></span> <span data-ttu-id="3887f-181">拡張プロジェクトをモデル化する方法については、[Dynamics365Commerce.InStore GitHub リポジトリ](https://github.com/microsoft/Dynamics365Commerce.InStore/tree/release/9.29) のサンプルを参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-181">For information about how to model your extension projects, see the samples in the [Dynamics365Commerce.InStore GitHub repo](https://github.com/microsoft/Dynamics365Commerce.InStore/tree/release/9.29).</span></span>

7. <span data-ttu-id="3887f-182">変更を保存し、キューにビルドを追加します。</span><span class="sxs-lookup"><span data-stu-id="3887f-182">Save your changes, and add the build to the queue.</span></span>
8. <span data-ttu-id="3887f-183">ビルドが完了すると、**公開済みアーティファクト** から **HardwarePos.Installer.exe** および **ModernPos.Installer.exe** パッケージをダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="3887f-183">When the build is completed, you can download the **HardwareStation.Installer.exe** and **ModernPos.Installer.exe** packages from **Published Artifacts**.</span></span>

## <a name="set-up-a-release-pipeline-for-retail-self-service-packages"></a><span data-ttu-id="3887f-184">Retail セルフサービス パッケージのリリース パイプラインの設定</span><span class="sxs-lookup"><span data-stu-id="3887f-184">Set up a release pipeline for Retail self-service packages</span></span>

<span data-ttu-id="3887f-185">ベスト プラクティスとして、個別のビルド パイプラインとリリース パイプラインを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3887f-185">As a best practice, you should set up separate build and release pipeline.</span></span> <span data-ttu-id="3887f-186">個別のリリース パイプラインを作成する場合は、LCS の **資産のアップロード** を使い、HardwareStation.Installer.exe および ModernPos.Installer.exe パッケージをアセット ライブラリにアップロードできます。</span><span class="sxs-lookup"><span data-stu-id="3887f-186">If you create a separate release pipeline, you can use the **Upload Asset** task in LCS to upload the HardwareStation.Installer.exe and ModernPos.Installer.exe packages to the Asset library.</span></span> <span data-ttu-id="3887f-187">別のリリース パイプラインにではなく、LCS にアップロードする場合は、タスクをビルド パイプラインの一部として追加できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-187">If you want to upload to LCS instead of to a separate release pipeline, you can add the task as part of your build pipeline.</span></span>

<span data-ttu-id="3887f-188">これらの手順に従い、リリース パイプラインを設定して、HardwareStation.Installer.exe および ModernPos.Installer.exe パッケージを LCS のアセット ライブラリにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="3887f-188">Follow these steps to set up the release pipeline to upload the HardwareStation.Installer.exe and ModernPos.Installer.exe packages to the Asset library in LCS.</span></span>

1. <span data-ttu-id="3887f-189">Azure DevOps で、**リリース** から **新しいパイプライン** を選び、**テンプレートの空のジョブ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-189">In Azure DevOps, select **Releases**, select **New pipeline**, and then select **Empty job in the template**.</span></span>
2. <span data-ttu-id="3887f-190">新しいリリース パイプラインの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="3887f-190">Enter a name for the new release pipeline.</span></span> <span data-ttu-id="3887f-191">既定の名前は、**アプリ パイプライン \> 新しいリリース パイプライン** です。</span><span class="sxs-lookup"><span data-stu-id="3887f-191">The default name is **App Pipelines \> New release pipeline**.</span></span>
3. <span data-ttu-id="3887f-192">パイプラインで、**コンポーネントを追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-192">In the pipeline, select **Add an artifact**.</span></span>
4. <span data-ttu-id="3887f-193">**コンポーネントを追加** ダイアログ ボックスで、リポジトリ プロジェクトを選び、以前のセクションで作成したビルド パイプラインを選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-193">In the **Add artifact** dialog box, select your repo project, and then select the build pipeline that you created in the previous section.</span></span>
5. <span data-ttu-id="3887f-194">オプション: 作成したコンポーネントで **トリガー** ボタン (稲妻記号) を選択し、継続的配置トリガーを有効にしてから、ブランチなどを選択できます。</span><span class="sxs-lookup"><span data-stu-id="3887f-194">Optional: In the artifact that you just created, you can select the **Trigger** button (lightning bolt symbol), enable a continuous deployment trigger, and then select your branch, and so on.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3887f-195">リリース パイプラインには、リリースのトリガー時期と方法が指定できる他のオプションも用意されています。</span><span class="sxs-lookup"><span data-stu-id="3887f-195">The release pipeline also offers other options that let you specify how and when the release is triggered.</span></span>

6. <span data-ttu-id="3887f-196">**保存** を選択して、パイプラインを保存します。</span><span class="sxs-lookup"><span data-stu-id="3887f-196">Select **Save** to save your pipeline.</span></span> <span data-ttu-id="3887f-197">フォルダ名の入力を求めるメッセージが表示された場合は、任意のフォルダ名を入力します。</span><span class="sxs-lookup"><span data-stu-id="3887f-197">If you're prompted for a folder name, enter any folder name.</span></span>
7. <span data-ttu-id="3887f-198">**ステージ** を選び、ステージ 1 **LCS に資産をアップデート** の名前を変え、**ジョブ 1** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-198">Select **Stages**, rename stage 1 **Upload Assets to LCS**, and then select **1 Job**.</span></span>
8. <span data-ttu-id="3887f-199">**タスク** で、**エージェント ジョブ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-199">In **Tasks**, select **Agent job**.</span></span>
9. <span data-ttu-id="3887f-200">**タスクの追加** で、**Dynamics Lifecycle Services (LCS) 資産のアップロード** を検索し、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-200">In **Add tasks**, search for **Dynamics Lifecycle Services (LCS) Asset Upload**, and select **Add**.</span></span>
10. <span data-ttu-id="3887f-201">アップロード タスクを完全に設定するには、[Azure Pipelines を使用して資産をアップロード](../../fin-ops-core/dev-itpro/dev-tools/pipeline-asset-upload.md) の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="3887f-201">Fully set up the upload task by following the steps in [Upload assets by using Azure Pipelines](../../fin-ops-core/dev-itpro/dev-tools/pipeline-asset-upload.md).</span></span> <span data-ttu-id="3887f-202">タスクで、次の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="3887f-202">In the task, set the following values:</span></span>

    - <span data-ttu-id="3887f-203">**資産のタイプ:** Retail Self-Service Package</span><span class="sxs-lookup"><span data-stu-id="3887f-203">**Type of asset:** Retail Self-Service Package</span></span>
    - <span data-ttu-id="3887f-204">**アップロードするファイル:** $(System.DefaultWorkingDirectory)/\_CommerceSDK-Signing-EXE/drop/Installer\_$(Release.Artifacts.\_CommerceSDK-Signing-EXE.BuildNumber).exe</span><span class="sxs-lookup"><span data-stu-id="3887f-204">**File to Upload:** $(System.DefaultWorkingDirectory)/\_CommerceSDK-Signing-EXE/drop/Installer\_$(Release.Artifacts.\_CommerceSDK-Signing-EXE.BuildNumber).exe</span></span>
    - <span data-ttu-id="3887f-205">**LCS 資産名:** Installer\_$(Release.Artifacts.\_CommerceSDK-Signing-EXE.BuildNumber)</span><span class="sxs-lookup"><span data-stu-id="3887f-205">**LCS Asset Name:** Installer\_$(Release.Artifacts.\_CommerceSDK-Signing-EXE.BuildNumber)</span></span>

11. <span data-ttu-id="3887f-206">タスクの構成が完了したら、**保存** を選び、リリース パイプラインを保存します。</span><span class="sxs-lookup"><span data-stu-id="3887f-206">After you've finished configuring tasks, select **Save** to save the release pipeline.</span></span>
12. <span data-ttu-id="3887f-207">**パイプライン** タブでパイプラインを選び、**リリースの作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3887f-207">On the **Pipelines** tab, select your pipeline, and then select **Create release**.</span></span>
13. <span data-ttu-id="3887f-208">**新しいリリースの作成** ダイアログ ボックスで、コンポーネントを選び、**作成** からリリースを手動でトリガーします。</span><span class="sxs-lookup"><span data-stu-id="3887f-208">In the **Create a new release** dialog box, select the artifact, and then select **Create** to manually trigger the release.</span></span>

<span data-ttu-id="3887f-209">リリース パイプラインを自動化するには、継続的ビルドを構成します。</span><span class="sxs-lookup"><span data-stu-id="3887f-209">To automate the release pipeline, configure continuous build.</span></span> <span data-ttu-id="3887f-210">詳細については、[パイプラインのリリース](/azure/devops/pipelines/release) ドキュメントを参照します。</span><span class="sxs-lookup"><span data-stu-id="3887f-210">For more information, see the [Release pipelines](/azure/devops/pipelines/release) documentation.</span></span>
