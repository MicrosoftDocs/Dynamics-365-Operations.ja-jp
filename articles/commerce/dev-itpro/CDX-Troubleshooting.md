---
title: Commerce Data Exchange のトラブルシューティング
description: このトピックでは、実装における CDX のトラブルシューティングに役立つ情報を提供します。
author: jashanno
ms.date: 08/26/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: RetailTerminalTable, RetailDevice
audience: IT Pro
ms.reviewer: sericks
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: Retail
ms.author: jashanno
ms.search.validFrom: 2020-08-31
ms.dyn365.ops.version: 10.0.12
ms.openlocfilehash: a3261341127c93c0e1c8759b8443328ba3fd95b3
ms.sourcegitcommit: 696796ca5635863850ae9ef16fc1fb0fc46ce8f0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/28/2021
ms.locfileid: "7441492"
---
# <a name="commerce-data-exchange-troubleshooting"></a>Commerce Data Exchange のトラブルシューティング

[!include[banner](../includes/banner.md)]

このトピックは、Microsoft Dynamics 365 Commerce 環境にデータ同期 (Commerce Data Exchange \[CDX\]) に関連する機能の実装を行う IT 担当者を対象としています。 ここでは、実装における CDX のトラブルシューティングに役立つ情報を提供します。

## <a name="overview"></a>概要

データの構成と同期は、正しい実装を行うにあたって非常に重要となります。 業務上の要件、IT インフラストラクチャ、全体的な準備のいずれであっても、データが正しく同期されていない場合は、環境全体が事実上役に立たないことになります。 したがって、コマース 本社から Commerce Scale Unit を通じて、従来の店舗 (オフラインのデータベースがある店舗とない店舗の両方)、およびその他の店舗内コンポーネントに至るまで、データ同期に関連する問題のトラブルシューティングのプロセスを理解しておくことが重要です。 このトピックでは、一部の問題を軽減または修正する方法についての一般的なガイダンスを提供します。 また、サポート依頼を作成するのに最適なタイミングや、サポート依頼を迅速に行う場合に最も重要となるデータなどの情報も提供しています。

このトピックに進む前に、チャネル (店舗)、レジスターとデバイス、および Modern POS オフライン データベースの概念を理解することが重要です。 したがって、このトピックの後半にある 「CDX 実装ガイダンス」や「コマース アーキテクチャの概要」などのリソースをご確認いただくことを推奨します。

## <a name="troubleshooting"></a>トラブルシューティング

次の表に含まれないエラーが発生した場合は、必要に応じて、Microsoft サポートが問題の解決を援助できるようにサポート依頼を作成してください。 このトピックでは、Microsoft サポートを使用せずに、直接修正可能な問題と、Microsoft サポートを使用せずに確認できるが、サポートなしでは修正できない問題について重点的に説明します。


| エラー | 説明 |
|-------|-------------|
| 次のエラーメッセージが表示されます。"System.ArgumentNullException: 値を null にすることはできません。パラメータ名 : Microsoft.Dynamics.Retail.CommerceDataExchange.SqlTargetRequestHandler の connectionString"。 | バッチジョブの状態に起因するエラーが発生しました。 (**ダウンロード セッション** のページでは、失敗したダウンロード ジョブのエラーを確認することができます。) **システム管理 \> 問い合わせ \> バッチジョブ** に移動し、ダウンロード ジョブが適用されるはずである Commerce Scale Unit に関連付けられているデータ書き込みバッチを探し、バッチジョブの状態を **保留** に変更します。 バージョン 10.0.12 よりも前の環境では、**レガシー** という名前のチャンネル データベース グループを作成し、**既定** のチャンネルデータベースをこの新しいグループに関連付け、続いてすべての配分スケジュールから新しいデータベース グループを除外することをお勧めします。 CDX ジョブが、**レガシー** グループの **既定** のチャンネル データベースに対して生成されないようにする必要があります。 |
| バッチ処理を使用しない限りは、**配分スケジュール** ページから **今すぐ実行** コマンドを実行できません。 | この変更は、環境が最も頻繁に使用されている時間帯にジョブが実行された場合に発生するパフォーマンス上の問題に対処する目的で、バージョン10.0.11 で意図的に実装されています。 この機能拡張の一環として行われた別の変更では、コマース本部の **チャネル データベース** ページから **完全データ同期** コマンド (フル ジョブ同期) が実行されると、繰り返し使用ができなくなっています。 実行できるのは 1 回のみです。 この動作は変更しないことをお勧めします。 ただし、開発環境を使用している場合は、**コマース共有パラメーター \> 構成パラメーター** に移動して、値が **1** となっている **CDX\_DISABLE\_FORCESCHEDULEINBATCH** に新しい名前を設定します。 |
| 次のエラーメッセージが表示されます : "Microsoft.Dynamics.Retail.CommerceDataExchange.SqlWriteRequestRunException: AX.\<TABLE NAME\> に対して SqlWriteRequestRunner の実行に失敗しました。" | 1つ以上の **DBO** テーブルの長さが拡張されたため、データの切り捨てが必要となり、エラーが発生しました。 そのため、切り捨てエラーが発生しました。 サポート要求を生成します。 ベスト プラクティスについては、[拡張を介してカスタム Commerce Data Exchange 同期を有効する](cdx-extensibility.md)を参照してください 。 これらのベストプラクティスには、編集中のテーブル フィールド上の拡張データ型 (EDT) の拡張機能を削除し、CDX 拡張テーブルを使用して必要な long (完全) 値を格納することが含まれます。 |
| ダウンロード セッションが失敗しています。 エラーメッセージ : 「... 試行回数が多すぎます」 | **小売とコマース \> バックオフィスの設定 \> パラメーター \> コマース スケジューラー パラメーター** に移動し、**試行回数** フィールドを **3** に設定します。 このフィールドの値が大きすぎる場合は、利用率の高い時間帯にダウンロード セッションが失敗する可能性があります。 この手順を完了すると、ジョブのステータスが  **キャンセル済** に設定され、再試行を停止します。 [Commerce Data Exchange のベストプラクティス](CDX-Best-Practices.md) を参照してください。 |
| 実行中の CDX ジョブはキャンセルできません。 | この問題が実稼動環境で発生した場合は、Microsoft Dynamics Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |
| LCS を使用すると、環境間でコマース本部のデータベースをコピーできますが、ターゲット環境でも、Commerce Scale Unit (クラウド) が使用されます (これまでは Retail Cloud Scale Unit と呼ばれていました) 。 | サポート要求を作成し、Commerce Scale Unit (クラウド) を削除して再プロビジョニングをするのか、現状のまま維持するのかを指定します。 どちらの場合も、ダウンタイムが必要となります。 |
| CDX または環境に関する問題は、機能プロファイルの **トランザクションが存在する日数** フィールドの値を変更した後に発生します。 | **トランザクションの存在日数** の値を大きく減らされた場合は、削除処理の間に1つ以上のテーブルがロックされる可能性があります。 この値を大量に削減する前に、サポート要求を生成することをお勧めします。 Microsoft サポートは、値を変更する前にデータを削除することができます。 これにより、変更によってデータベースに与えられる影響が最小限に抑えられます。 |
| 複数の POS ターミナルを追加すると、ダウンロード セッションに非常に長い時間がかかるか、またはコマース本部全体で大きな処理遅延が発生します。 | 最新の POS オフライン データベースを作成し、関連するチャネル データベース グループに追加すると、データベースの完全な同期が行われた後の既存のダウンロード セッションをすべて継承します。 可用性が高いタイミングであっても、発生する恐れある例外的なデータ生成が大きすぎる場合は、パフォーマンスに影響を与えることがあります。 稼働率の高い (最も忙しい時間) 時間帯の場合、環境のパフォーマンスが著しく損なわれる恐れがあります。 新たに生成された端末に割り当てる "ダミー" のデータベース グループ (どの配分スケジュール ジョブにも関連付けられていないグループ)、または **オフライン同期の一時停止** オプションが **はい** に設定されている特別なオフライン プロファイルのいずれかを持つことを強くお勧めします。 このようにして、データ生成は、必要なときにシステムが最も可用性が高い時に行うことができます。 (ただし、システムによっては、必要に応じて何度か一時停止する場合があります。)この方法では遅すぎる場合は、サポート要求を作成してください。 |
| 影響を受ける行数が少ない場合であっても、一般的に増分 (デルタ) 同期には非常に長い時間がかかります。 | 新しいチャネル (店舗) が作成された際には、すべてのデータを新しい店舗用に再作成する必要があるため、この問題が発生する可能性があります。 "ダミー" チャネルデータベース グループに関連付けられている "ダミー" チャンネルデータベースを用意し、新たに生成されたチャンネル (店舗) に割り当てることを強くお勧めします。 このようにして、データ生成は、必要なときにシステムが最も可用性が高い時に行うことができます。 この方法では遅すぎる場合は、サポート要求を作成してください。 |
| P-ジョブがアップロード セッションの作成に失敗し、次のエラーメッセージが表示されます : "System.Data.SqlClient.SqlException (0x80131904): 主キー制約違反 'PK\_UPLOADSESSION'。 重複するキーをオブジェクト 'crt.UPLOADSESSION' に挿入することはできません。" | この問題が実稼動環境で発生した場合は、 Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |
| コマース本部の **セッションのアップロード** ページからアップロード セッション パッケージのダウンロードを試みると、次のエラーメッセージが表示されます : "Id - \<Number\> のレコードが見つかりません" というメッセージが表示されます。 | サポート要求を作成する。 |
| CDX のダウンロード セッションの適用に失敗し、次のエラーメッセージが表示されます : "ダウンロード セッション パッケージの URI を取得できませんでした。" | この問題が実稼動環境で発生した場合は、 Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |
| ダウンロード セッションは適用されず、アップロード セッションは作成されません。 | この問題が実稼動環境で発生した場合は、 Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |
| アップロード セッションが失敗し、次のエラーメッセージが表示されます。"タスク既定の情報ログ: データの一括挿入中に P-0001 (....)エラーが発生ました。 ターゲット テーブル : RetailListingStatusLog。" | アップロード セッション パッケージが **RetailListingStatusLog** テーブル内に複数のレコードが存在するため、エラーが発生しました。 これらのレコードには、2つ以上の同じ **StatusDateTime** 値が設定されています。 この問題が実稼動環境で発生した場合は、 Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |
| レジ担当者がオフラインモードに切り替えようとした場合、または強制的にオフラインになった場合は、切り替えに失敗します。 | 多くの原因が考えられます。 まず、基本情報を確認してくだい : コンピュータのハードディスクの空き容量はありますか？ SQL Server Express を使用している場合、オフライン データベースのサイズは10 GB に制限されていますか？ レジスターのダウンロード セッションが保留されていませんか？ (保留中のダウンロード セッションがある場合、これはレジスターが最新の状態ではなくなったことを意味します。 したがって、オフラインの切り替えが一時的にできなくなる可能性があります。) また、Microsoft サポートにお問い合わせ頂くことをお勧めします。 この問題が実稼動環境で発生した場合は、 Lifecycle Services (LCS) にログインし、即時サポートの要求を作成してください。 実稼働環境以外の環境で問題が発生した場合は、サポート要求を作成します。 |

## <a name="resources"></a>リソース

- [Commerce Data Exchange ベスト プラクティス](CDX-Best-Practices.md)
- [Commerce Data Exchange 実装ガイダンス](implementation-considerations-cdx.md)
- [Commerce のオフライン実装とトラブルシューティング](implementation-considerations-offline.md)
- [Dynamics 365 Commerce アーキテクチャの概要](../commerce-architecture.md)
- [店舗内トポロジの選択](retail-in-store-topology.md)
- [デバイス管理実装ガイダンス](../implementation-considerations-devices.md)
- [Modern POS (MPOS) のコンフィギュレーション、インストール、および有効化](../retail-modern-pos-device-activation.md)
- [Commerce Scale Unit のコンフィギュレーションとインストール (自己ホスト)](retail-store-scale-unit-configuration-installation.md)

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
