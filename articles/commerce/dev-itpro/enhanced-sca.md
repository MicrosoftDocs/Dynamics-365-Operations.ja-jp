---
title: 店頭会計の支払を強化
description: この記事では、Microsoft Dynamics 365 Commerce での店舗チェックアウトの強化された強力な顧客認証 (SCA) サポートの概要を提供します。
author: BrianShook
ms.date: 06/09/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: brshoo
ms.search.validFrom: ''
ms.dyn365.ops.version: AX 7.0.1
ms.custom: 141393
ms.assetid: e23e944c-15de-459d-bcc5-ea03615ebf4c
ms.search.industry: Retail
ms.openlocfilehash: 1b0181727d5a43e75536449b420aeced287f7d3a
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/12/2022
ms.locfileid: "9279631"
---
# <a name="enhanced-payments-in-storefront-checkout"></a>店頭会計の支払を強化

[!include [banner](../includes/banner.md)]

この記事では、Microsoft Dynamics 365 Commerce での店舗チェックアウトの強化された強力な顧客認証 (SCA) サポートの概要を提供します。

## <a name="key-terms"></a>重要な用語

| 相談 | 説明 |
|---|---|
| SCA | 強力な顧客認証により、オンライン購入が試行されるときにカードを発行した銀行がカード所有者の ID を確認できます。 このプロセスは通常、店舗チェックアウト フローからカードの発行銀行によってホストされているページへのリダイレクトを介して完了します。 そこで、カード所有者の ID が確認されます。 その後、カード所有者は店舗チェックアウト フローに戻り、チェックアウトを介して注文が続行されます。 |
| リダイレクト | オンラインの買い物客の閲覧セッションを、販売者の店舗外に移動するアクション。 |
| カードのトークン | 実際の支払カード番号を参照するために使用されるエイリアス。 カード トークンを使用すると、実際の支払カードへの参照を保存できます。 同時に、実際の支払カード番号を保存するときに発生するセキュリティ問題を防ぐのに役立ちます。 |

従来、店舗チェックアウト プロセスでは、支払プロセッサに対して 2 つの異なる呼び出しが行われました。 最初の呼び出しは、チェックアウト時に支払プロセッサの埋め込み HTML iframe 要素に入力されたカード番号をトークン化するために使用されました。 呼び出し中に、SCA も有効になり、必要に応じてカード所有者をカードの発行銀行で認証できるようになりました。 2 番目の呼び出しでは、最初の呼び出しから取得したカード トークンを使用して、実際の承認応答を要求します。

支払い承認を取得するためのこの 2 回の呼び出し方法は、次の理由により、すべてのケースにおいて理想的ではありませんでした。

- 最初の呼び出しでは、金額ゼロの承認要求を使用して支払トークンを要求しました。 ただし、すべての支払プロセッサが金額ゼロの承認要求をサポートしているわけではありません。
- SCA は最初の呼び出し中に行われたため、SCA が付与した負債シフトは、実際の承認要求ではなく、トークン化要求でのみ明らかでした。

技術的な問題と別に、従来の店舗チェックアウト プロセスは、支払処理アクティビティを確認したときに金額ゼロの要求が多数見られたため、商社に混乱を引き起こしました。

これらの問題に対処するために、Commerce 店舗チェックアウトでの支払がリファクタリングされたので、1 回の要求のみが必要になりました。 この 1 つの要求で、支払処理に関連するすべての必要な機能を実行します。

- カード トークンがサポートされている場合は、承認の有効期限が切れて、フルフィルメントのために新しい承認が必要になった場合に、カード トークンを取得します。
- これは、実際の承認要求中に SCA をサポートします。 したがって、負債シフトは、支払金額の承認で明らかになります。

## <a name="key-changes-from-the-traditional-storefront-checkout-flow"></a>従来の店舗チェックアウト フローからの重要な変更

### <a name="no-order-review-step"></a>注文確認ステップなし

支払フローが開始された後は、注文を確認して送信する手順はありません。 支払詳細を入力した後、顧客は **注文** オプションのみ利用できます。 指定した支払方法で SCA が必要な場合、顧客は銀行の認証ページにリダイレクトされます。 認証が完了すると、顧客はチェックアウト ページに戻り、注文が処理されます。

説明したフローは、既定でリダイレクトされる支払方法 (PayPalなど) にも適用されます。 支払いの詳細が PayPal に提供された後、チェックアウト ページに戻って注文が開始されます。

従来のフローでは、埋め込み iFrame 要素に支払詳細を入力すると、**保存して続行** ボタンが使用可能になりました。 顧客がこのボタンを選択すると、トークン化された支払がチェックアウトに追加されました。 デモ環境では、顧客の電子メール アドレスを収集するか、顧客に使用条件に同意してもらう手順もあります。 新しいフローでは、顧客が最後の **保存して続行** ボタンを選択したときに以前に行われていた検証が、顧客が **注文** ボタンを選択したときに行われるようになりました。 したがって、顧客側で必要なクリックが 1 回少なくなり、ページの読み込みがチェックアウト フローから削除されます。

## <a name="payment-connector-support"></a>支払コネクタ サポート

既定では、Adyen と PayPal の既成の支払コネクタは、チェックアウト時の強化された支払フローをサポートしています。

> [!IMPORTANT]
> - Adyen コネクタ バージョン **V002** のみが、拡張 SCA をサポートします。 バージョン **V001** は、チェックアウトが拡張 SCA 用に構成されている場合でも機能します。 ただし、バックグラウンドでは、そのバージョンはまだ 2 つの呼び出しを行います。
> - 2021 年 1 月 1 日に欧州連合 (EU) で施行された SCA 要件のため、Adyen コネクタのバージョン **V001** は使用しなくまりました。 バージョン **V002** を使用するために Adyen コネクタを構成する方法については、[新しいクレジット カード用のプロセッサの設定](adyen-connector-setup.md#set-up-a-processor-for-new-credit-cards) を参照してください。

## <a name="enable-enhanced-payments-in-storefront-checkout-in-commerce-site-builder"></a>Commerce サイト ビルダーでの店舗チェックアウトでの拡張支払の有効化

Commerce サイト ビルダーで強化された支払機能を有効にするには、次の手順に従います。

1. 編集するサイトで、**サイトの設定** を展開します。
2. **拡張子** を選択します。
3. **カートとチェックアウト** まで下にスクロールし、**単一の支払承認チェックアウトを有効にする** チェック ボックスをオンにします。
4. **保存と公開** を選択します。

![Commerce サイト ビルダーでの店頭会計での強化された支払いを有効にする。](media/rfac.png)

## <a name="additional-resources"></a>追加リソース

[支払に関するよく寄せられる質問](payments-retail.md)

[PayPal 向け Dynamics 365 Payment Connector](../paypal.md)

[Adyen 向け Dynamics 365 Payment Connector](adyen-connector.md)

[Adyen リダイレクト](../adyen_redirect.md)

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
