---
title: Modern POS (MPOS) の画像の設定および管理
description: この記事は、Modern POS (MPOS) に表示されるさまざまなエンティティの設定および画像の管理に関連する手順について説明します。
author: athinesh99
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailChannelProfile, RetailMediaGallery, RetailImages,
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: 52851
ms.assetid: 5c21385e-64e0-4091-98fa-6a662eb33010
ms.search.region: global
ms.search.industry: Retail
ms.author: athinesh
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0, Retail July 2017 update
ms.openlocfilehash: aff3bee942f3443eb604311d1d804b66421e332d
ms.sourcegitcommit: 81a647904dd305c4be2e4b683689f128548a872d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/01/2020
ms.locfileid: "3023185"
---
# <a name="set-up-and-manage-images-for-modern-pos-mpos"></a>Modern POS (MPOS) の画像の設定および管理

[!include [banner](includes/banner.md)]

この記事は、Modern POS (MPOS) に表示されるさまざまなエンティティの設定および画像の管理に関連する手順について説明します。

## <a name="setting-up-the-media-base-url-and-defining-media-templates-to-configure-the-format-for-image-urls"></a>画像 URL 形式をコンフィギュレーションするメディア ベースの URL およびメディアのテンプレートの定義を設定します

Modern POS (MPOS) に表示される画像はコマースの外部でホストされている必要があります。 通常は、コンテンツ管理システム、コンテンツ配信ネットワーク (CDN)、またはメディア サーバーでホストされます。 製品およびカタログなど、適切なエンティティの画像は、MPOS がターゲット URL にアクセスし、フェッチして表示されます。 MPOS が、これらの外部でホストされている画像をフェッチするには、画像の正しい URL 形式が必要です。 チャンネル プロファイルの**メディア基準 URL**の値を設定、および各エンティティの**メディア テンプレートの定義**機能の設定により、画像の URL 形式をコンフィギュレーションできます。 また、エンティティのサブセットに対して標準 URL 形式を **Excel で編集**機能を使用して上書きできます。

> [!IMPORTANT]
> コマースの現在のバージョンでは、エンティティの**既定**属性グループで MPOS の**画像**属性 XML を使用して URL フォーマットを設定することはできなくなりました。 Microsoft Dynamics AX 2012 R3 を使い慣れていて、コマースの現在のバージョンを使用している場合は、イメージの設定に、新しい**メディア テンプレートの定義**機能を常に使用していることを確認してください。 製品を含む、エンティティ グループの**既定**属性で、**画像**属性を使用、または変更しないでください。 画像グループの**既定**属性での直接の変更は反映されません。 このオプションは、将来のリリースでは無効になります。

次の手順では、例として画像はカタログ エンティティに設定されます。 これらの手順で、正しい画像先のパスが共通のパスを使用するすべてのカタログ画像に対して暗黙的に設定されていることを保証するのに役立ちます。 たとえば、外部のメディアサーバーあるいは CDN を設定し、特定の店舗の MPOS に表示する画像を必要とする場合は、**メディア テンプレートの定義**機能が、MPOS が検索したり、画像を取得できるパスを設定するのに役立ちます。

> [!NOTE]
> このデモ データの例では、メディア サーバーは、Commerce Scale Unit サーバーに配置されます。 ただし、コマースの外部の任意の場所で配置できます。

### <a name="set-up-the-media-base-url-for-a-channel"></a>チャンネルにメディアベース URL を設定します。

1. コマース HQ ポータルを開きます。
2. **Retail とコマース** &gt; **チャネル設定** &gt; **チャネル プロファイル**の順にクリックします。

    [![ナビゲーション](./media/channel-profile1.png)](./media/channel-profile1.png)

3. 店舗で MPOS に使用するチャンネル プロファイルで、メディアサーバーあるいは CDN の基準 URLの**メディア基準 URL** フィールドを更新します。 ベース URL は別のエンティティのすべての画像のフォルダにより共有される URL の最初の部分です。

    [![チャネル プロファイル ページ](./media/channel-profile2.png)](./media/channel-profile2.png)

### <a name="define-the-media-template-for-an-entity"></a>エンティティのメディアのテンプレートを定義します。

1. **Retail とコマース** &gt; **カタログ管理** &gt; **カタログの画像**の順にクリックします。
2. **カタログ画像**ページの、アクション ウィンドウで、**メディア テンプレートの定義**をクリックします。 **エンティティ**フィールドの、**メディア テンプレートの定義**ダイアログボックスで、**カタログ**が既定でオンになっている必要があります。
3. **メディア パス**クイック タブで、画像の場所の残りのパスを入力します。 メディア パスは、**LanguageID** を変数としてサポートします。 たとえば、デモ データについては、メディア サーバーのメディア基準 URL 以下のすべてのカタログ画像に**カタログ** フォルダを作成できます (`https://testax3ret.cloud.test.dynamics.com/RetailServer/MediaServer`)。 各言語のフォルダが、en-US または fr-FR などである場合、各フォルダで適切な画像をコピーします。 さまざまな言語のための、さまざまな画像を所有していない場合、フォルダ構造から **LanguageID** 変数を省略でき、カタログ画像を含むカタログフォルダを直接設定できます。

    > [!NOTE]
    > コマースの現在のバージョンでは、カタログ、製品、およびカテゴリ エンティティの **{LanguageId}** トークンがサポートされます。 (**{LanguageID}** トークンは、Microsoft Dynamics AX 6.x. 以降有効な既存の標準に従って、顧客および作業者の場合はサポートされません)

4. 画像では、ファイル名の形式は、カタログ名にハードコーディングされ、変更することはできません。 従って、MPOS がそれらを正しく処理できるようにするため、適切なカタログ名となるように画像の名前を変更します。
5. **ファイル拡張子**フィールドで、画像のタイプに基いて必要なファイル拡張子を選択します。 たとえば、デモ データに対しては、カタログの画像に .jpg の拡張子が設定されます。 (画像ファイルは、カタログ名を持つように名前を変更されます)。
6. **OK** をクリックします。
7. 画像のメディアのテンプレートが、**カタログ画像**ページで、適切に保存されていることを確認するには、**メディア テンプレートの定義**をもう一度クリックします。 **メディア テンプレートの定義**ダイアログ ボックスを閉めないでテンプレートを検証するには、**Excel 用の画像 URL の生成**クイック タブを使用できます。 画像 URL の外観を確認し、URL が上記のテンプレートの標準に準拠していることを確認します。 **メディア テンプレートの定義**ダイアログ ボックスにより、この URL 共通のパスを使用するすべてのカタログ画像に画像のパスが暗黙的に配置されます。 上書きされない場合、この URL パスは、すべてのカタログ画像に適用されます。 画像のパスの最初の部分は、チャンネルのプロファイルで定義したメディアの基準 URL から取得されます。 パスに関する残りの部分は、メディアのテンプレートで定義したパスから取得されます。 画像の場所の URL 全体を提供するために 2 つの部分が連結されます。 たとえば、デモ データのカタログでは、Fabrikam の基本カタログが表示されます。 したがって、テンプレートでコンフィギュレーションされているカタログ名、および .jpg ファイル名拡張子を使用するため、画像の名前は Catalog.jpg Fabrikam である必要があります。 この場合、連結後の URL は `https://testax3ret.cloud.test.dynamics.com/RetailServer/MediaServer/Catalogs/en-US/Fabrikam Base Catalog.jpg` になります。
8. イメージにアクセスする場合に MPOS がテンプレートを使用するように、チャンネルのデータベースに新しいテンプレートをプッシュするため、同期ジョブを実行します。
9. チャネル側のカタログ画像のメディア テンプレートを更新するには、**Retail とコマース** &gt; **配送スケジュール**から**カタログ ジョブ 1150** を実行してください。

    [![メディア テンプレートの定義ダイアログ ボックス](./media/catalog1.png)](./media/catalog1.png)

## <a name="previewing-an-image-from-the-entity-level"></a>エンティティ レベルからの画像のプレビュー

1. HQ のエンティティの品目のページで、メディアのテンプレートから派生した画像 URL を使用する画像をプレビューできます。 この例では、適切なカタログに移動し、アクション ウィンドウで、**メディア** &gt; **画像** をクリックします。 チャンネルのさまざまなプロファイルがある異なる店舗を選択する場合でも、ドロップダウン リストを使用します。
2. 暗黙的なメディア テンプレートを編集、または削除するには、**カタログ画像**ページの**メディア テンプレートの定義**ダイアログ ボックスに戻る必要があります。
3. 暗黙的なテンプレートに基づき、特定の画像に使用されるパスを手動で変更するために、**追加**および**削除**ボタンを使用できます。 詳細については、この記事で後述する[エンティティ アイテムのメディア テンプレートの上書き](#overwriting-the-media-template-for-entity-items)セクションを参照してください。
4. 画像をプレビューし、必要な変更を加えることを完了したら、適切な店舗の MPOS のインスタンスを起動し、カタログの画像を表示するかどうかを確認します。

    [![ダイアログ ボックスの画像](./media/catalog4.png)](./media/catalog4.png)

> [!NOTE]
> サポートされている 5 つのエンティティ、作業者、顧客、カタログ、カテゴリ、および製品で同じ手順を使用できます。 「カタログ製品」 (カタログ レベルで設定された製品) および「チャンネル製品」 (チャンネル レベルで設定された製品) は、製品 エンティティで設定されたメディア テンプレートを使用します。 製品のメディア テンプレートでは、製品ごとに表示する製品画像の数を選択できます。 また、特定の製品に既定の画像を設定できます。 これにより、MPOS の空白の画像をなくしたり、画像を製品品目の既定の画像として使用するかどうかを制御できます。 次の例では、各製品に 5 つの画像があり、最初の画像は、既定の画像として設定されます。 バリアント製品はマスターの製品と同じ方法で処理されます。 イメージ ファイルのファイル名は製品番号に基づく必要があります。 ファイル名の生成中、一部の文字がエスケープします。 したがって、**Excel 用の画像 URL の生成**セクションを使用してファイル名を確認することをお勧めします。 この記事の後半の [Excel で編集を使用して上書き](#overwrite-by-using-edit-in-excel) を参照してください。

## <a name="synchronization-jobs-to-send-a-media-template-to-the-channel-side"></a>チャンネル側にメディアのテンプレートを送信するジョブを同期

サポートされている 5 つのエンティティすべて (作業者、顧客、カタログ、カテゴリ、および製品) で、画像を設定するために**メディア テンプレートの定義**ダイアログを更新する場合は常に、**Retail とコマース** &gt; **配送スケジュール**から、カタログジョブ (1150) の実行を確認します。 このジョブは、チャンネルに同期された更新されたメディア テンプレートを有効にし、MPOS で使用されます。 次のような変更を行った後、カタログジョブ (1150) を実行します:

- **カタログ画像** &gt; **メディア テンプレートの定義** からカタログ画像メディア テンプレートを更新します。
- **従業員の画像** &gt; **メディア テンプレートの定義** から従業員の画像メディア テンプレートを更新します。
- **顧客画像** &gt; **メディア テンプレートの定義** から顧客画像メディア テンプレートを更新します。
- **製品画像** &gt; **メディア テンプレートの定義** から製品画像メディア テンプレートを更新します。
- **カテゴリ画像** &gt; **メディア テンプレートの定義** からカテゴリ画像メディア テンプレートを更新します。 また、チャンネルを公開する必要があります。

## <a name="overwriting-the-media-template-for-entity-items"></a>エンティティ品目のメディア テンプレートを上書きします。

前のセクションで学んだように、特定のエンティティのメディア テンプレートは、一つの共通のパスのみサポートします。 このパスは、コンフィギュレーションされた基準 URL、および定義されたメディアのパスに基づきます。 ただし、多くの場合、小売業者はエンティティの品目のサブセットに対してさまざまなソースから画像が使用できることを希望します。 たとえば、店舗は、自己ホストのメディア サーバーを 1 つのセットのカタログ画像に使用しますが、別のセットには CDN の URL を使用します。 エンティティ レベルのエンティティ 画像のメディア テンプレートに基づく画像 URL を上書きするには、**プレビュー**ページの Excel および手動で編集機能を使用できます。

### <a name="overwrite-by-using-edit-in-excel"></a>Excel で編集を使用して上書き

1. **Retail とコマース** &gt; **カタログ管理** &gt; **カタログの画像**の順にクリックします。
2. **カタログ画像**ページで、**メディア テンプレートの定義**をクリックします。 **エンティティ**フィールドの、**メディア テンプレートの定義**ダイアログボックスで、**カタログ**がオンになっている必要があります。
3. **メディア パス**クイック タブで、画像の場所を通知します。
4. **Excel 用の画像 URL の生成**クイック タブで、**生成**をクリックします。

    > [!IMPORTANT]
    > メディア テンプレートが変更された場合、Excel で編集機能を使用する前に、**生成**をクリックする必要があります。

    最後に保存したメディア テンプレートに基づいて生成された、画像 URL がプレビュー表示されます。

    [![生成が選択された後の Excel 用の画像 URL の生成クイック タブ](./media/excel2.png)](./media/excel2.png)

    > [!NOTE]
    > Excel 用に生成された URL は、定義されているメディア テンプレートのパスと方式を使用します。 これらの方式には、ファイル名の方式も含まれます。 コマースの外部で現物画像を設定することが期待されており、画像は、先に定義したメディア テンプレートから派生する URL から取得することができます。 Excel で編集の機能を使用すると、これらの派生 URL を上書きできます。

5. **Excel で編集**をクリックします。
6. Microsoft Excel ワークシートを開き、メッセージが表示されたら、**編集の有効化**をクリックします。
7. メッセージが表示されたら、**このアドインを信頼します**を右ウィンドウでクリックし、インストールを完了するためにアドインを待機します。

    [![このアドインを信頼します](./media/excel4.jpg)](./media/excel4.jpg)

8. サインインするメッセージが表示されると、HQ のサインインに使用する資格情報を入力します。

    [![サインイン プロンプト](./media/excel5.png)](./media/excel5.png)

9. サインインした後、さまざまなカタログ エントリについて画像 URL の一覧を確認できます。
10. さまざまなエンティティ品目の画像 URL を編集、追加、および削除します。
11. 製品を除くすべてのエンティティに、画像 URL を上書きできます。 画像の新しい配送先 URL を使用し、ファイル名を画像ファイルの新しいファイル名に更新するために、既存の画像 URL を変更します。 レコードが一意であることを保証するために、ファイル名は一意である必要があります。

    [![Excel で画像 URL を上書き](./media/excel6.jpg)](./media/excel6.jpg)

    > [!NOTE]
    > Excel で編集の機能またはエンティティ品目ページを使用して製品エンティティの画像 URL を上書きすると、MPOS は上書きされた画像 URL とともに、すべてのメディア テンプレートの画像 URL を常に表示します。

12. 変更を加えることを完了した後、**Excel で公開**をクリックすると、新しい明示的 アソシエーション エントリが作成されます。
13. HQ に戻り、**OK**をクリックします。
14. エンティティの適切な同期ジョブを実行し、エンティティ ページ、あるいは MPOS のプレビューを確認します。

#### <a name="creating-new-records"></a>新しい記録の作成

Excel の新しいレコードを作成できます。 ただし、正しい情報を入力したことを確認します。 たとえば、カタログの新しいエントリを作成する場合、カタログ ID、およびカタログの名前が正しいことを確認し、一意のファイル名を入力してください。 固有のファイル名は、Excel のレコードの独自性が発行中に検証されるために非常に重要です。 最初に、新しいレコードを作成するカタログから詳細をコピーし、レコードをコピーします。 他の情報が同じであるため、ファイル名、URL を更新する必要があります。 製品エンティティの品目に新しいレコードを作成するには、同じ基本的な手順を使用します。 Excel ワークシートから、新しいレコードを作成する製品に既存のレコードをコピーし、画像 URL およびファイル名を置き換えます。 ファイル名は一意であることを確認します。

#### <a name="deleting-an-existing-record"></a>既存のレコードの削除

上書きした画像 URL のレコードのみ削除できます。 画像が削除され、同期が完了した後、画像は**プレビュー**ページ、または MPOS に表示されなくなります。 毎回これらのレコードはメディア テンプレートから常に派生するため、メディア テンプレートから派生した画像 URL レコードは削除できません。

### <a name="overwrite-from-the-entity-level-preview-page"></a>エンティティ レベル プレビュー ページを上書き

製品を除くすべてのエンティティは、**プレビュー**ページからのエンティティ レベルで、一部のエンティティ品目の画像 URL を上書きできます。 製品については、「カタログ製品」エンティティ ページを使用します。 この例では、カタログ画像を上書きする方法を示します。

1. **カタログ** &gt; **メディア** &gt; **画像** をクリックし、更新するカタログ画像を選択します。
2. **追加**をクリックし、メディア テンプレート URL に上書きする画像 URL を入力します。
3. この画像を MPOS でカタログに表示する場合、既定の画像として設定できます。
4. **OK** をクリックします 画像 URL は、このカタログ画像に更新され、プレビューが表示されます。

    [![新しい画像ダイアログ ボックスで更新された URL](./media/preview3.png)](./media/preview3.png)

5. すべてを上書きした画像 URL は、画像のプレビューを**カタログ画像**ギャラリー ページで表示できます。

    [![カタログ画像ギャラリー ページ](./media/preview-4.png)](./media/preview-4.png)

> [!NOTE]
> 現在のところ、ギャラリーはメディア テンプレートの画像 URL の画像のプレビューを表示しません。 カタログ、作業者、顧客、およびカテゴリエンティティに、ユーザーがこのページで明示的に URL を指定すると、Commerce Scale Unit のクライアントがカタログ、顧客、作業者、およびカテゴリごとに一つの画像のみを参照するため、既定の画像を指定することをお勧めします。 ユーザーが既定の画像を指定しないと、システムは既定の画像を確認し、コマース サービスの呼び出し元に送信します (MPOS または E コマース)。

### <a name="overwrite-the-image-url-for-catalog-product-images-from-the-preview-page"></a>プレビュー ページからカタログ製品画像の画像 URL を上書きします。

カタログ製品画像の画像 URL を上書きするために、**プレビュー**ページを使用する必要があります。 Excel で編集の機能を使用できません。

1. カタログのレベルで製品画像を上書きするには、カタログを選択し、画像を上書きする製品を選択します。
2. **属性**をクリックします。
3. 次のページで、**画像**を選択し、**編集**をクリックします。 **プレビュー** ページがスライダーのダイアログ ボックスとして開きます。
4. **追加**をクリックし、画像 URL を新しい URL で上書きします。
5. **OK** をクリックします これで、新しい画像をプレビュー表示し、既定の画像として設定できます。

    [![新しい画像ダイアログ ボックスの画像プレビュー](./media/cat3.png)](./media/cat3.png)

> [!NOTE]
> カテゴリ画像のアソシエーションの後、チャネルを発行し、チャネル データベースへの変更を公開することを保証するチャネル ジョブを実行する必要があります。

## <a name="setting-up-images-to-appear-in-offline-mode-for-mpos"></a>MPOS のオフライン モードで表示されるイメージの設定

MPOS はオンライン モード (MPOS が Commerce Scale Unit に接続される時)、またはオフライン モード (Commerce Scale Unit、またはネットワーク接続がない、およびトランザクションがローカル オフライン データベースに保存されている時) で実行できます。 MPOS をオフライン モードで実行すると、接続が失われるため、外部ファイル サーバーから、Commerce Scale Unit からの表示のための画像を取得することはできません。 ただし、MPOS がオフライン モードの実行時に表示するように、まだ画像を設定できます。

### <a name="set-up-product-images-to-appear-in-offline-mode-for-mpos"></a>MPOS のオフライン モードで表示される製品画像の設定

オフライン モードで使用する製品画像は、基本製品画像に必要な現物画像をアップロードすることで設定できます。

1. **製品情報管理** &gt; **製品** &gt; **製品** をクリックします。
2. オフライン画像に設定する製品を選択します。
3. **編集**をクリックし、右ウィンドウを表示するために角の右矢印をクリックします。
4. **製品画像**クイック タブで、**イメージの変更**をクリックし、オフライン モードで選択した製品に使用する、現物画像をアップロードします。
5. ページを保存して閉じる。
6. MPOS がオンライン モードの間に、データがオフライン データベースに 1 回以上の送信を行うかどうか確認するため、HQ でカタログジョブを実行します。
7. オフライン モードに MPOS を挿入します。 HQ の特定の製品にアップロードする画像を確認する必要があります。

    [![オフライン モードの製品画像](./media/offline1.png)](./media/offline1.png)

### <a name="set-up-catalog-category-employee-and-customer-images-to-appear-in-offline-mode-for-mpos"></a>MPOS のオフライン モードで表示するカタログ、カテゴリ、従業員、および顧客の画像を設定します。

オフライン モードで使用するカタログ、カテゴリ、従業員、および顧客の画像は、必要な画像のリンク先をギャラリーに追加し、選択したエンティティの既定の画像として画像を設定することで設定できます。

1. カタログに移動してから、アクション ウィンドウで、**メディア** &gt; **画像** をクリックします。
2. 外部 URL 画像を追加するには、[エンティティ レベル プレビュー ページを上書き](#overwrite-from-the-entity-level-preview-page)セクションの手順に従います。
3. チェック ボックスをオンにして、グリッドに表示する画像に対し、この画像をカタログの既定の画像としてマークします。
4. カタログジョブを実行します。 この画像は MPOS でカタログのオフラインの画像としてすぐに使用されます。
5. カテゴリ、従業員、および顧客など、他のエンティティの類似したプロセスに従います。

    [![オフライン画像](./media/offline2.png)](./media/offline2.png)
