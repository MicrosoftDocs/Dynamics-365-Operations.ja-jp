---
title: POS の出庫在庫操作
description: このトピックでは、販売時点管理 (POS) の出庫在庫操作の機能について説明します。
author: hhaines
ms.date: 07/30/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: josaw
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: Retail
ms.author: hhaines
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.9
ms.openlocfilehash: e29a5295cd3c334aef88dc7a2a36b2eb8a6f636b159c0f69874fc51298a1ab7c
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "6772281"
---
# <a name="outbound-inventory-operation-in-pos"></a>POS でのアウトバウンド在庫操作

[!include [banner](includes/banner.md)]


Microsoft Dynamics 365 Commerce バージョン 10.0.10 またはそれ以降では、販売時点管理 (POS) の入庫および出庫操作は、ピッキングおよび入荷の操作から置き換えられます。

> [!NOTE]
> バージョン 10.0.10 以降では、発注書および移動オーダーに対する店舗在庫の入荷に関連する POS アプリケーションの新しい機能が、入庫操作に追加されます。 現在、POS でピッキングとおよび入荷の操作を使用している場合は、その操作から新しい入荷および出庫操作に移行するための戦略を開発することをお勧めします。 ピッキングと入荷の操作は製品から削除されませんが、機能上またはパフォーマンス上の観点から、バージョン 10.0.9 以降の投資は予定されていません。

## <a name="prerequisite-configure-an-asynchronous-document-framework"></a>前提条件: 非同期ドキュメント フレームワークのコンフィギュレーション

出庫操作にはパフォーマンスの改善が含まれており、多くの店舗や企業での大量のレシート転記や大規模な在庫ドキュメントを持つユーザーが、タイムアウトやエラーを経験することなくそれらのドキュメントを Commerce 本社 (HQ) で処理できるようになっています。 これらの改良については、非同期ドキュメント フレームワークを使用する必要があります。

非同期ドキュメント フレームワークが使用されている場合は、出庫ドキュメントの変更を POS から Commerce 本社 (HQ) にコミットし、Commerce 本社 (HQ) への処理がバック グラウンドで行われている間に、他のタスクに進むことができます。 POS の **出庫操作** のドキュメント リスト ページのステータスを確認し、転記が成功したことを確認できます。 POS アプリケーションでは、出庫操作アクティブ ドキュメント リストを使用して、Commerce 本社 (HQ) に転記できなかったドキュメントを表示することもできます。 ドキュメントに障害が発生した場合、POS ユーザーはそれを修正してから、Commerce 本社 (HQ) への処理を再実行できます。

> [!IMPORTANT]
> 会社が POS で出庫操作を使用する前に、非同期ドキュメント フレームワークをコンフィギュレーションする必要があります。

非同期ドキュメント フレームワークをコンフィギュレーションするには、次の手順を実行します。

### <a name="create-and-configure-a-number-sequence"></a>番号順序の作成とコンフィギュレーション

1. **組織管理 \> 番号順序 \> 番号順序** の順に移動します。
2. **番号順序** のページで、番号順序を作成します。
3. **番号順序コード** と **名前** フィールドに、ユーザー定義の値を入力します。
4. **参照** クイック タブで、**追加** を選択します。
5. **エリア** フィールドで、**コマース パラメーター** を選択します。
6. **参照** フィールドで、**小売ドキュメントの操作 ID** を選択します。
7. **全般** クイック タブの **設定** セクションで、パフォーマンスの問題が発生しないように、**継続** オプションを **いいえ** に設定します。

### <a name="create-and-schedule-two-batch-jobs-for-the-document-processing-and-monitoring-tasks"></a>ドキュメント処理と監視作業用の 2 つのバッチ ジョブを作成およびスケジュールする

> [!NOTE]
> Commerce version 10.0.13 以降では、バッチ ジョブ フレームワークを通じてバッチ ジョブをコンフィギュレーションする必要はありません。 バッチ処理は、**Retail と Commerce > Retail および Commerce IT** メニューからコンフィギュレーションできます。 このバッチ ジョブをコンフィギュレーションするには、**小売ドキュメントの操作モニター** および **小売ドキュメントの操作処理** メニュー オプションを使用します

作成したバッチ ジョブは、失敗またはタイムアウトしたドキュメントを処理するために使用されます。また、POS から処理される有効な在庫ドキュメントの数がシステム コンフィギュレーションの値を超える場合にも使用されます。

1. **システム管理 \> 照会 \> バッチ ジョブ** の順に移動します。
2. **バッチ ジョブ** ページで、次の 2 つのバッチ ジョブを作成します。

    - **RetailDocumentOperationMonitorBatch** クラスを実行するよう 1 つのジョブをコンフィギュレーションします。
    - **RetailDocumentOperationProcessingBatch** クラスを実行するよう他のジョブをコンフィギュレーションします。

3. 新しいバッチ ジョブが定期的に実行されるようにスケジュールします。 たとえば、ジョブが 5 分ごとに実行されるようにスケジュールを設定します。

## <a name="prerequisite-add-outbound-operation-to-the-pos-screen-layout"></a>前提条件: 入庫操作を POS 画面レイアウトに追加する

組織で出庫操作機能を使用する前に、1 つ以上の [POS 画面レイアウト](/dynamics365/unified-operations/retail/pos-screen-layouts)に対して **出庫操作** の POS 操作を構成する必要があります。 新しい操作を実稼働環境に配置する前に、それを完全にテストして、使用できるようにユーザーをトレーニングしておく必要があります。

## <a name="overview"></a>概要

出庫操作により、POS ユーザーは次のタスクを実行できます。

- ユーザーの店舗が指定された出庫倉庫である場合、移動オーダー ドキュメントの出荷を転記します。
- 店舗で転記された移動オーダー出荷の履歴に関する情報を表示します。
- 新しい出庫移動オーダー要求を作成します。

POS アプリケーションから出庫操作を開始すると、リスト ページ ビューが表示されます。 このビューには、ユーザーの現在の店舗が出荷および履行予定の在庫明細行を含む、オープン移動オーダー ドキュメントが表示されます。 ユーザーはリストをスクロールするか検索機能を使用して、ドキュメントを検索して選択します。

出庫在庫ドキュメントのリストには次の 3 つのタブがあります。

- **有効** – このタブには、ステータスが **要求済** または **一部出荷済** の移動オーダーが表示されます。 注文には、ユーザーの現在の店舗から出荷する必要のある明細行または明細行上の数量が含まれます。 このタブには、ステータスが **HQ で処理中** (つまり、Commerce 本社 (HQ) からの正常な転記の確認を待っている) または **処理が失敗** (つまり、Commerce 本社 (HQ) への転記が失敗したので、ユーザーがデータを修正し注文を再度送信する必要がある) の注文も表示されます。
- **ドラフト** – このタブには、ユーザー店舗によって作成された新しい出庫移動オーダー要求が表示されます。 ただし、ドキュメントはローカルにのみ保存されています。 それらはまだ処理のために Commerce 本社 (HQ) に送信されていません。
- **完了** – このタブには、過去 7 日間に店舗が完全に出荷した移動オーダー ドキュメントのリストが表示されます。 このタブは情報提供のみを目的としています。 ドキュメントに関するすべての情報は、店舗の読み取り専用データです。

いずれかのタブでドキュメントを表示する場合、**ステータス** フィールドは、ドキュメントのステージを理解するのに役立ちます。

- **ドラフト** – 移動オーダー ドキュメントは、店舗のチャネル データベースのローカルにのみ保存されています。 移動オーダー要求に関する情報は、まだ Commerce 本社 (HQ) に送信されていません。
- **要求済** – 発注書または移動オーダーは Commerce 本社 (HQ) で作成され、完全に開かれています。 ユーザーの現在の店舗では、ドキュメントに対する出荷はまだ処理されていません。
- **一部出荷済** – 移動オーダー ドキュメントには、出庫倉庫から出荷されたときに転記された 1 つ以上の明細行または明細行の数量の一部が含まれます。 これらの出荷された明細行は、入荷操作を介して受信できます。
- **完全出荷済** – 移動オーダーには、出庫倉庫から出荷されたすべての明細行と完全な明細行の数量が転記されています。
- **処理中** – このステータスは、ドキュメントが別のユーザーによってアクティブに作業されていることをデバイス ユーザーに通知するために使用されます。
- **一時停止** – このステータスは、一時的に受信処理を停止するため **受信の一時停止** を選択した後に表示されます。
- **HQ で処理** – ドキュメントは POS アプリケーションから Commerce 本社 (HQ) に送信されましたが、まだ Commerce 本社 (HQ) には正常に転記されていません。 ドキュメントには非同期ドキュメント転記プロセスが実行されます。 ドキュメントが Commerce 本社 (HQ) に正常に転記されると、そのステータスは **受入完了** または **部分的に受入済** に更新される必要があります。
- **処理が失敗しました** – ドキュメントが Commerce 本社 (HQ) に転記され、拒否されました。 **詳細** ウィンドウに、転記が失敗した理由が表示されます。 データの問題を修正するためにドキュメントを編集し、その後、処理のために Commerce 本社 (HQ) に再送信する必要があります。

リストでドキュメント明細行を選択すると、**詳細** ウィンドウが表示されます。 このウィンドウには、出荷や日付の情報など、ドキュメントに関する追加情報が表示されます。 進行状況バーには、処理する必要がある品目の数が表示されます。 ドキュメントが Commerce 本社 (HQ) に正常に処理されなかった場合は、エラーに関連するメッセージも **詳細** ウィンドウに表示されます。

ドキュメント リスト ページのビューでは、アプリ バーの **注文の詳細** を選択して、ドキュメントの詳細を表示できます。 適格なドキュメント明細行で領収書処理を有効化することもできます。

ドキュメント リストのページ ビューでは、店舗に対する新しい出庫移動オーダー要求を作成することもできます。

## <a name="transfer-order-shipping-process"></a>移動オーダー出荷プロセス

**有効** タブで移動オーダー ドキュメントを選択した後、**注文の詳細** を選択してフルフィルメント プロセスを開始できます。 **フル オーダー リスト** ビューが表示されます。 このページには、品目を含むすべてのドキュメント明細行が表示されます。 また、注文済数量の詳細も示します。

バーコードをスキャンするたびに、**配送開始** フィールドの数量が 1 単位ずつ更新されます。 また、アプリ バーの **製品の出荷** を選択し、品目 ID を入力してから数量を入力することで、出荷数量を入力することもできます。 品目が場所によって管理されている場合は、ドキュメント明細行の出荷場所を確定または設定できます。

**フル オーダー リスト** ビューでは、リストの明細行を手動で選択して、**詳細** ウィンドウで選択した明細行の **配送開始** 数量を更新できます。

### <a name="over-delivery-shipping-validations"></a>超過配送の検証

検証は、ドキュメント明細行の入荷プロセス中に行われます。 これには、超過配送の検証が含まれます。 ユーザーが発注書で注文されたよりも多くの在庫を受け取ろうとしても、超過配送が設定されていないか、受け取った数量が発注書明細行に設定された超過配送許容値を超えている場合、ユーザーにはエラーが表示されます。超過した数量を受け取ることはできません。

### <a name="underdelivery-close-lines"></a>過少配送のクローズ ライン

Commerce のバージョン 10.0.12では、POS ユーザーが注文出荷中に、出荷倉庫が要求された数量を出荷できないと判断した場合に、残りの数量をクローズ、またはキャンセルできる機能が追加されました。 数量は、後でクローズまたはキャンセルすることもできます。 この機能を使用するには、転送注文の過少配送を許可する設定にする必要があります。 また、過少配送率は、在庫移動指示の明細行に対して定義されている必要があります。

会社が在庫移動指示の過少配送を許可する構成をするには、Commerce 本社 (HQ) で、**在庫管理 \> 設定 \> 在庫と倉庫管理パラメータ** に移動します。 **在庫と倉庫管理パラメータ** ページの **在庫移動指示** タブで、**過少配送の許可** パラメータをオンにします。 次に、**1070** 配布スケジューラー ジョブを実行して、パラメータの変更を店舗チャンネルに同期します。

在庫移動指示明細の過少配送率は、Commerce 本社の製品構成の一環として製品にあらかじめ定義されている場合があります。 また、Commerce 本社 (HQ) 内の特定の在庫移動指示明細行で設定または上書きすることもできます。

在庫移動指示の過少配送の構成が完了すると、ユーザーは POS の **出庫操作** を介して出庫在庫移動指示明細を選択した際に、**詳細** ウィンドウに新しい **残余数量を閉じる** オプションが表示されます。 ユーザーが **フルフィルメント完了** 操作を使用して出荷を完了した際に、残りの未出荷の数量をキャンセルするように Commerce 本部 (HQ) に要求を送信することができます。 ユーザーが残余数量を閉じた場合、Commerce はキャンセルされる数量が在庫移動指示明細行で定義された過少配送率の許容範囲内にあるかどうかの検証をおこないます。 過少配送の許容範囲を超えた場合、ユーザーはエラーメッセージを受信し、以前に出荷された量と "すぐに出荷する" 量が過少配送の許容範囲を満たすか、それを超えるまで残量を閉じることができません。

出荷を Commerce 本社 (HQ) に同期した後は、POS の在庫移動指示明細行の **すぐに出荷する** フィールドで定義されている数量が、Commerce 本社 (HQ) で出荷済ステータスに更新されます。 以前に "出荷残余" 数量 (後で出荷される数量) と見なされていた未出荷の数量は、キャンセルされた数量と見なされます。 在庫移動指示明細 「出荷残量」が **0** (ゼロ) に設定され、明細行が完全に出荷されたと見なされます。

### <a name="shipping-location-controlled-items"></a>場所によって制御されている品目の出荷

出荷される品目が場所によって制御されている場合、ユーザーは出荷プロセス中に、在庫を払出する場所を選択できます。 このプロセスを効率化するために、店舗倉庫の既定の払出場所をコンフィギュレーションすることをお勧めします。 既定の場所がコンフィギュレーションされている場合でも、ユーザーは必要に応じて、選択した明細行の払出場所を上書きできます。

この操作では、**場所** 保管分析コードの **受入時空白可** 構成が順守され、空白の受入が構成されている場合、場所分析コードを入力する必要はありますせん。 品目に対して受入場所の空白が許可されていない場合、POS アプリケーションはエラーを表示し、入庫を転記する前に場所を入力する必要があります。

### <a name="ship-all"></a>すべて出荷

必要に応じて、アプリ バーで **すべて出荷** を選択し、すべてのドキュメント明細行の **配送開始** 数量を、それらの明細行で満たすことができる最大値にすばやく更新することができます。

### <a name="cancel-fulfillment"></a>フルフィルメントをキャンセルする

ドキュメントから戻り、変更を保存したくない場合のみ、アプリ バーの **フルフィルメントをキャンセルする** 機能を使用します。 たとえば、最初に選択したドキュメントが間違っており、前の出荷データを保存する必要がない場合があります。

### <a name="pause-fulfillment"></a>フルフィルメントの一時停止

移動オーダーを履行している場合、**フルフィルメントの一時停止** 機能を使用してプロセスを停止することができます。 たとえば、顧客販売の呼び出しや、Commerce 本社 (HQ) への出荷の遅延など、POS から別の操作を実行したい場合があります。

**フルフィルメントの一時停止** を選択すると、ドキュメントのステータスが **一時停止** に変更されます。 したがって、ユーザーはドキュメントに入力されたデータを確認できますが、ドキュメントはまだコミットされていません。 フルフィルメント プロセスを再開する準備ができたら、一時停止したドキュメントを選択し **注文の詳細** を選択します。 以前に保存された **配送開始** 数量はすべて保持され、**フル オーダー リスト** ビューから表示できます。

### <a name="review"></a>レビュー

Commerce 本社 (HQ) に対する最終コミットメントの前に、**レビュー** 機能を使用して出庫ドキュメントの検証を行うことができます。 この機能は、処理に失敗する可能性のあるデータが欠落しているか間違っている可能性があることを警告し、フルフィルメント要求を提出する前に問題を修正する機会を提供します。 アプリバーの **確認** 機能を有効にするには、Commerce 本社 (HQ) の機能管理を使用して、**POS 入庫と出庫の在庫管理で検証を有効にする** 機能を有効にします。

**レビュー** 機能では、出庫ドキュメントの次の問題を検証します。
- **超過配送** - 現在の出荷数量が注文済数量を超えています。 この問題の重大度は、Commerce 本社 (HQ) の超過搬送コンフィギュレーションによって決まります。
- **配送不足** - 現在の出荷数量が注文済数量に満たない。 この問題の重大度は、Commerce 本社 (HQ) の入荷不足コンフィギュレーションによって決まります。
- **シリアル番号** - シリアル番号が指定されていないか、またはシリアル番号を在庫に登録する必要があるシリアル化品目に対して使用できません。
- **場所が未設定** - 場所を空白にすることが許可されていない場所管理対象の品目に対して、場所が指定されていません。
- **削除済明細行** - 注文には、POS アプリケーションに対しては基地でない Commerce 本社 (HQ) ユーザーによって削除された明細行があります。

**Commerce パラメーター** > **在庫** > **店舗在庫操作** で、**自動検証を有効にする** パラメーターを **はい** に設定する場合、**フルフィルメントの完了** 機能を選択すると自動的に検証が実行されます。

### <a name="finish-fulfillment"></a>フルフィルメントの完了

製品のすべての **配送開始** 数量の入力が完了したら、アプリ バーの **フルフィルメントの完了** を選択する必要があります。

非同期ドキュメント処理を使用する場合、レシートは非同期ドキュメント フレームワークを介して送信されます。 ドキュメントが転記されるまでの所要時間は、ドキュメントのサイズ (明細行数) とサーバーで発生する一般的な処理トラフィックによって異なります。 通常、このプロセスは数秒で行われます。 ドキュメントの転記に失敗した場合、ユーザーには **有効** タブの **出庫操作** ドキュメント リストを通して通知され、ドキュメント ステータスは **処理が失敗しました** に更新されます。 その後、ユーザーは失敗したドキュメントを POS で選択して、エラー メッセージとその理由を **詳細情報** のウィンドウに表示できます。 失敗したドキュメントは未転記のままであり、ユーザーは POS で **注文の詳細** を選択してドキュメント明細行に戻る必要があります。 その後、ユーザーはエラーに基づいてドキュメントを修正して更新する必要があります。 ドキュメントを修正した後で、ユーザーはアプリ バーの **フルフィルメントの完了** を選択して、ドキュメントの処理を再試行できます。

## <a name="create-an-outbound-transfer-order"></a>出庫移動オーダーを作成する

POS から、新しい移動オーダー ドキュメントを作成できます。 プロセスを開始するには、メインの **出庫操作** ドキュメント リストから、アプリ バーで **新規** を選択します。 次に、現在の店舗が在庫を発送する **移動先** の倉庫または店舗を選択するよう求められます。 値は、店舗のフルフィルメント グループのコンフィギュレーションで定義されている選択内容に限定されます。 出庫移動要求では、現在の店舗は常に移動オーダーの **移動元** 倉庫になります。 その値は変更できません。

必要に応じて、**出荷日**、**入庫日**、および **荷渡方法** フィールドに値を入力できます。 また、Commerce 本社 (HQ) のドキュメントへの添付ファイルとして、移動オーダー ヘッダーと共に保存されるメモを追加することもできます。

ヘッダー情報を作成した後、移動オーダーに製品を追加できます。 品目と要求された数量を追加するプロセスを開始するには、バーコードをスキャンするか、**製品の追加** を選択します。

出庫移動注文に明細行を入力した後に、**保存** を選択してドキュメントの変更をローカルに保存するか、**要求の送信** を選択して注文の詳細を Commerce 本社 (HQ) に送信してさらに処理する必要があります。 **保存** を選択すると、ドラフト ドキュメントはチャネル データベースに格納され、出庫倉庫では、**要求の送信** で正常に処理されるまでドキュメントを実行することはできません。 処理のために Commerce 本社 (HQ) に要求をコミットする準備ができていない場合にのみ、**保存** を選択する必要があります。

ドキュメントがローカルに保存されている場合は、**入庫操作** ドキュメント リストの **ドラフト** タブで確認できます。 ドキュメントが **ドラフト** ステータスの間は、**編集** を選択して編集できます。 必要に応じて、明細行を更新、追加、または削除できます。 **ドラフト** タブの **削除** を選択して、**ドラフト** ステータスにあるドキュメント全体を削除することもできます。

ドラフト ドキュメントが Commerce 本社 (HQ) に正常に送信されると、**有効** タブに表示され、ステータスが **要求済** になります。 この時点では、POS アプリケーションの **出庫操作** を選択することにより、出庫倉庫のユーザーのみがドキュメントを編集できます。 入庫倉庫のユーザーは、**入庫操作** ドキュメント リストの **有効** なタブで移動オーダーを確認できますが、編集および削除はできません。 この編集ロックにより、出庫荷主がアクティブに注文をピッキングして出荷するのと同時に、入庫要求者が移動オーダーを変更するため、競合が発生しないことが保証されます。 移動オーダーが送信された後に入庫店舗または倉庫からの変更が必要な場合は、出庫荷主に連絡して、変更を入力するように依頼する必要があります。

ドキュメントのステータスが **要求済** になったら、出庫倉庫のフルフィルメント処理の準備が整います。 出庫操作を使用して出荷が処理されると、移動オーダー ドキュメントのステータスが **要求済** から **完全出荷済** または **一部出荷済** に更新されます。 ドキュメントが **完全出荷済** または **一部出荷済** ステータスになった後、入庫店舗または倉庫は、入庫操作入荷プロセスを使用して入庫を転記できます。

完全出荷済の移動オーダーは、**出庫操作** ドキュメント リストの **完了** タブに移動されます。 それで、出庫店舗または倉庫のユーザーには、7日間、読み取り専用モードで表示されたままになります。

## <a name="related-topics"></a>関連トピック

[POS の入庫在庫操作](pos-inbound-inventory-operation.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]