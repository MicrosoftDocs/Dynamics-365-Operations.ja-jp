---
title: クライアンテリングの概要
description: この記事では、店舗のアプリケーションで使用できる新しいクライアンテリングの機能の概要を提供します。
author: bebeale
ms.date: 11/16/2022
ms.topic: overview
audience: Application User, Developer, IT Pro
ms.reviewer: josaw
ms.custom:
- "260624"
- intro-internal
ms.assetid: a4f9d315-9951-451c-8ee6-37f9b3b15ef0
ms.search.region: Global
ms.author: shajain
ms.search.validFrom: 2018-10-01
ms.openlocfilehash: fc7daeb27c25efa21fd34b0456af8892074056d5
ms.sourcegitcommit: 774f8f97a0b14cf1199bd1802178ccf536a25ade
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2022
ms.locfileid: "9785048"
---
# <a name="clienteling-overview"></a>クライアンテリングの概要

[!include [banner](includes/banner.md)]


多くの小売業者、特にハイエンドの専門小売業者は、店員に主な顧客との長期的な関係を形成させます。 店員は、顧客の好き嫌い、購買履歴、製品の好み、記念日や誕生日などの重要な日付について知っていることが期待されます。 店員はそのような情報をキャプチャし、必要なときに簡単に情報を見つけられる必要があります。 この情報が 1 つのビューで使用可能になると、店員は特定の条件に一致する顧客を簡単にターゲットにすることができます。 たとえば、ハンドバッグを購入したい顧客や、誕生日、記念日などの生活の重要なイベントが近づいている顧客などを探すことができます。

次のビデオでは、Dynamics 365 Commerce でのクライアンテリングのシナリオ例について説明します。


> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE5bMSP]

## <a name="client-book"></a>クライアント ブック

Microsoft Dynamics 365 Commerce では、小売業者はクライアント ブック機能を使用して、主な顧客との長期的な関係を築くよう店舗スタッフを支援することができます。

クライアントブックには、各顧客の連絡先情報を表わす顧客カードと、小売業者が定義し、本部で設定した3つのプロパティが含まれています。 小売業者は、顧客について店員が知っておくべき最も重要な事項を 3 つ決定できます。 例えば、宝石の小売業者は、記念日や誕生日などを最も重要な日付に含めることでしょう。これらの日付に、人々がより多くの宝石を購入する可能性があるからです。 同様に、ファッション小売業者は、顧客が好むショッピングの興味やブランドを含めることができます。

またクライアント ブックでは、店員が一覧をフィルタ処理して、特定の条件を満たす顧客のみを表示することもできます。 たとえば、靴の新しいコレクションが店舗に到着し、店員が靴を購入したい顧客に通知したいとします。 この場合、店員はクライアント ブックをフィルター処理して関連する顧客を見つけ、更にアクションを起こすことができます。

顧客が何らかの理由で主な顧客として見なされなくなり、厳密に管理する必要がなくなった場合、店員はクライアント ブックから彼らの情報を削除できます。

一部の小売業者は、顧客を店員レベルで管理したくない場合があります。 代わりに、店舗レベルでの主な顧客一覧の管理を希望します。 これらの小売業者は、店舗クライアント ブックから顧客を表示できます。 このオプションを使用すると、小売業者は、アドレス帳が現在の店舗のアドレス帳と一致するすべての店員のクライアント ブックから顧客を表示することができます。 このようにして、店員が法人の複数の店舗で働いている場合、クライアント ブックにはそれらの店舗の顧客が表示されます。 この機能は、追加機能をサポートします。 たとえば、ある店員から別の店員に顧客を再割り当てすることができます。 この機能は、店員が転勤または退職するときに役立ちます。

各店員は、法人ごとに 1 つのクライアント ブックを持つことができ、店員はクライアント ブックに 1 人以上の顧客を追加できます。 Commerce では現在、各顧客を 1 つのクライアント ブックにのみ追加できます。 ただし、Microsoft は、1 人の顧客を複数のクライアント ブックに追加する機能を追加することを計画しています。

> [!NOTE]
> 顧客検索とは異なり、クライアント ブックは、店舗のアドレス帳に基づいて顧客レコードをフィルタ処理することはありません。

## <a name="activities-and-notes"></a>活動とメモ

オンライン チャネルを使用すると、小売業者は顧客がこの情報を明示的に提供しなくても、顧客の好みを知ることができます。 一方、顧客が店員とやり取りする場合、顧客は好みに関する情報を明示的に共有します。 残念ながら、この情報は販売終了後に失われる可能性があります。 ただし、この情報が記録されるなら、小売業者は顧客をよりよく理解できるようになるため、さらに良いおすすめや、ショッピング体験を提供できるようになります。

顧客が共有する重要な情報を取得するために、店員はクライアント ブックの属性だけでなく、活動とメモの機能を使用することもできます。 小売業者は、店舗訪問、電子メールアドレス、電話番号、および予定に関する情報など、活動タイプをコンフィギュレーションできます。 店員が作成するアクティビティは、販売時点管理 (POS) でタイムライン形式で表示できます。 それらは、Headquarters の **すべての顧客 \> 一般** ページの **活動** タブでも表示できます。

店員は、メモを使用して、すべてのやり取りの前に参照できる一般的な顧客情報を取得することもできます。 これらのメモは、Headquarters に保存され、顧客プロファイルまたはコール センターの顧客詳細ページで表示できます。

> [!NOTE]
> 現在すべてのメモと活動は、法人に勤務し、顧客詳細のページを表示できる店員が閲覧できます。 メモと活動は、顧客をクライアント ブックに追加した店員に限定されません。

## <a name="integration-with-dynamics-365-customer-insights"></a>Dynamics 365 Customer Insights との統合

Dynamics 365 Customer Insights アプリケーションを使用することで、小売業者は、顧客が小売業者のブランドと接触する際に使用するさまざまなシステムからデータを集計できます。 その後、このデータを使用して顧客の単一のビューを生成し、洞察を導き出すことができます。 Customer Insights と Commerce の統合により、小売業者はクライアント ブックの顧客カードに表示する必要のある 1 つ以上の指標を選択できます。 たとえば、小売業者は Customer Insights のデータを使用して、顧客の「解約率」を計算し「次に優先するアクション」を定義することができます。 これらの値が指標として定義されている場合は顧客カードに表示され、店員に重要な情報を提供できます。 Customer Insights の詳細については、[Dynamics 365 Customer Insights](/dynamics365/ai/customer-insights/overview) を参照してください。 指標の詳細については、[指標](/dynamics365/ai/customer-insights/pm-measures)を参照してください。

## <a name="set-up-clienteling"></a>クライアンテリングの設定

環境内でクライアンテリング機能を有効にするには、次の手順を実行します。

1. **機能管理** ワークスペースで、**Retail と Commerce** モジュールによって機能をフィルタ処理します。

    ![Commerce モジュールの機能一覧のクライアンテリング。](./media/Enable_clienteling.png "Retail と Commerce モジュールの機能一覧のクライアンテリング")

2. **直ちに有効化** を選択して **クライアンテリング** 機能をオンにします。
3. **Commerce パラメーター** ページの **番号順序** タブで、**クライアント ブック識別子** の行を選択します。 次に、**番号順序コード** フィールドで、番号順序を選択します。 システムはこの番号順序を使用して、クライアント ブックに ID を割り当てます。
4. **保存** を選択します。
5. クライアント ブックで管理されている顧客用に取得する属性を含む、新しい属性グループを作成します。 手順については、[属性および属性グループ](./attribute-attributegroups-lifecycle.md)を参照してください。

    - 必須属性を **絞り込み可能** として定義します。 店員は、これらの属性を使用してクライアント ブックをフィルタ処理できます。
    - これらの属性の表示順序を設定します。 この表示順序によって、クライアント ブックの顧客カードに表示する属性が決まります。 表示順序 1 は、表示順序 2 より高いと見なされます。 したがって、表示順序が 1 の属性は、表示順序が 2 の属性よりも前に表示されます。

    > [!NOTE]
    > 同じページから Customer Insights を利用することができます。 ただし、認証のために Azure アプリケーションの ID とシークレットを作成する必要があります。 (要件の詳細については、この記事後半の [Customer Insights と Commerce の統合を有効にする](#turn-on-the-integration-of-customer-insights-with-commerce) を参照してください。) Customer Insights が有効になっていて、顧客カードに表示する必要がある指標を 1 つ以上選択すると、それらの指標が最初に表示されます。 次に、表示順序に基づいて、クライアント ブックの属性グループが表示されます。 たとえば、Customer Insights から 2 つの指標を選択した場合、これらの 2 つの指標と 1 つのクライアント ブック属性が顧客カードに表示されます。 表示されるクライアント ブック属性は、最も高い表示順序を持つ属性になります。

6. **Commerce パラメーター** ページの **クライアンテリング** タブの **クライアント ブック属性グループ** フィールドで、作成した属性グループを選択します。

    ![選択されたクライアント ブック属性グループ。](./media/Client%20book%20attributes.png "選択されたクライアント ブック属性グループ")

7. POS で発生する活動をキャプチャするには **活動タイプ** ページ (**Retail と Commerce \> 顧客 \> 活動タイプ**) で活動タイプを定義します。

    > [!NOTE]
    > 活動タイプは、Commerce Scale Unit が初めてリアルタイム呼び出しを行うときに、取り込まれます。 活動が取り込まれると、数時間キャッシュされます。 活動タイプを変更した場合は、キャッシュが無効になるまで待機します。 または、非運用環境の場合は、Commerce Scale Unit サービスを再起動します。

8. 適切な POS 画面レイアウトに 2 つのボタンを追加して、店員が自分のクライアント ブックと店舗のクライアント ブックを表示できるようにします。 (店舗のクライアント ブックには、その店舗とアドレス帳を共有するすべての店員のすべてのクライアント ブックのクライアントが含まれます。) 対応する操作の名前はそれぞれ、**クライアント ブックで顧客を表示** および **店舗クライアント ブックで顧客を表示** です。 クライアント ブックに関連する 3 つの追加操作が使用可能です。 これらの操作により、どの店員がクライアントブックから顧客を追加、削除、および再割り当てできるかが決まります。 これらはそれぞれ、**顧客をクライアント ブックに追加**、**顧客をクライアント ブックから削除**、および **顧客をクライアントブックに再割り当て** という名前が付けられます。
9. 次の配布スケジュール ジョブを実行します: 1040、1150、1110、および 1090。

この手順を完了すると、店員は POS で顧客の詳細ページを開き、顧客をクライアント ブックに追加し、顧客の活動とメモを取得し、顧客とクライアント ブックの属性を使用してクライアント ブックをフィルタ処理することにより、顧客をターゲットできます。 次の図は、クライアント ブックの例を示します。

![クライアント ブックの例。](./media/client_book.png "クライアント ブックの例")

## <a name="turn-on-the-integration-of-customer-insights-with-commerce"></a>Customer Insights と Commerce の統合を有効にする

Customer Insights と Commerce の統合を有効にするには、Commerce がプロビジョニングされるテナントに Customer Insights の有効なインスタンスがあることを確認する必要があります。 また、Azure サブスクリプションを持つ Azure Active Directory (Azure AD) ユーザー アカウントも必要です。

統合を設定するには、これらの手順に従います。

1. Azure ポータルで、新しいアプリケーションを登録し、アプリケーション名、アプリケーションID、シークレットをメモしておきます。 この情報は、Commerce と Customer Insights のサービス間の認証に使用されます。 シークレットは Key Vault で安全に保管する必要があることにご注意ください。 以下の例では、アプリケーション名、アプリケーションID、シークレットにそれぞれ CI_Access_name、CI_Access_AppID、CI_Access_Secret を使用しています。 詳細については、[クイックスタート : Microsoft ID プラットフォームにアプリケーションを登録する](/azure/active-directory/develop/quickstart-register-app) を参照してください。

    > [!IMPORTANT]
    > 期限が切れる前にシークレットを変更することを忘れないように、対策を講じてください。 そうでない場合、統合は予期せず停止します。

2. Customer Insights インスタンスに移動し、上記で作成したアプリケーションの名前 (この例では "CI_Access_name) を検索します。
3. Azure Key Vault を作成し、名前と URL をメモします (この例では、"KeyVaultName"、"KeyVault VAULT")。 手順については、[クイックスタート: Azure ポータルを使用して Azure Key Vault からシークレットを設定および取得する](/azure/key-vault/quick-create-portal)を参照してください。
4. KeyVault にシークレット (この例では "CI_Access_Secret) を保存します。 シークレット を KeyVault に保存すると、シークレットに名前が付けられます。 シークレットの名前をメモします (この例では 'SecretName')。
5. Azure Key Vault からシステムにアクセスするには、アプリケーション ID とアプリケーションで構成された別のアプリケーションを作成する必要があります (この例では、"KeyVault_Access_AppID"、"KeyVault_Access_Secret")。 安全上の観点から、シークレットは再表示されません。
6. API を使用して Commerce からキー コンテナーにアクセスするには、アプリケーションへのアクセス許可を付与する必要があります。 Azure portal のアプリケーション ページに移動します。 **管理** セクションで、 **API のアクセス許可** を選択します。 **Azure key vault** にアクセスするためのアクセス許可を追加します。 このアクセス許可については、**アクセス ポリシー** を選択します。 テンプレートに **シークレットの管理** を使用し、**取得**、**一覧**、**復号化**、**暗号化** オプションを選択します。 
5. Commerce Headquarters で、**システム管理 \> 設定 \> Key Vault パラメーター** に移動し、Key Vault に必要な情報を入力します。 次に、**Key Vault クライアント** フィールドに手順 4 で使用したアプリケーション ID を入力して、Commerce が Key Vault でシークレットにアクセスできるようにします。
6. ステップ 1 で作成したアプリケーションを安全なアプリケーション (セーフ リストとも呼ばれます) の一覧に追加するには、Customer Insights にアクセスして、アプリケーションへの **表示** アクセスを選択します。 手順については、[アクセス許可](/dynamics365/ai/customer-insights/pm-permissions)を参照してください。
7. Commerce HQ の **システム管理 > 設定 > Key Vault パラメーター** ページで、以下の説明に従ってフィールドを更新します。 

- **Key Vault URL** : "KeyVaultURL" (上記の手順 3 から)。
- **Key Vault クライアント** : "KeyVault_Access_AppID" (上記の手順 5 から)。
- **Key Vault 秘密鍵** : "KeyVault_Access_Secret" (上記の手順 5 から)。
- **シークレット** セクション:
    - **名前** : 任意の名前 ("CISecret" など)。
    - **説明** : 任意の値。
    - **シークレット**: **保管場所**: `//<Name of key vault>/<name of secret>>` この例では、次のようになります: `vault://KeyVaultName/SecretName`。

フィールドを更新した後、**検証** を選択して、Commerce アプリケーションからアクセス可能なことを確認してください。

8. **Commerce パラメータ** ページの Commerce で、**Dynamics 365 Customer Insights** クイックタブの **クライアント** タブで、**アプリケーション ID** を、"CI_Access_AppID" に設定します (上記の手順 1 から)。 **シークレット名** に、上記の手順 7 で入力したシークレット ("CISecret") を選択します。 **Customer Insights を有効化する** オプション **はい** に設定します。 何らかの理由で設定に失敗した場合は、エラー メッセージが表示され、このオプションは **いいえ** に設定されます。 

テスト環境や運用環境など、Customer Insights で複数の環境を持つことができます。 **環境 インスタンス ID** フィールドに、適切な環境を入力します。 **代替顧客 ID** フィールドに、顧客 ID 番号にマップされている Customer Insights のプロパティを入力します。 (Commerce では、顧客アカウント番号が顧客 ID となります。) 残りの 3 つのプロパティは、クライアント ブックの顧客カードに表示されるメジャーです。 顧客カードに表示する指標を 3 つまで選択することができます。 ただし、メジャーを選択する必要はありません。 前述のように、これらの値が最初に表示された後、クライアント ブックの属性グループの値が示されます。


[!INCLUDE[footer-include](../includes/footer-banner.md)]
