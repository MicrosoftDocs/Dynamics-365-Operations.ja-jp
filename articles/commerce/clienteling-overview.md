---
title: クライアンテリングの概要
description: このトピックでは、店舗のアプリケーションで使用できる新しいクライアンテリングの機能の概要を提供します。
author: bebeale
manager: AnnBe
ms.date: 02/01/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: josaw
ms.custom: 260624
ms.assetid: a4f9d315-9951-451c-8ee6-37f9b3b15ef0
ms.search.region: global
ms.search.industry: Retail
ms.author: shajain
ms.search.validFrom: 2018-10-01
ms.dyn365.ops.version: Version 10.0.7
ms.openlocfilehash: 8f3135d0a34086b67c6e5ce11a5af47a51479c92
ms.sourcegitcommit: 8a14eac1c27f10c2b1b02ac9ad82339f5e127602
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/05/2021
ms.locfileid: "5554997"
---
# <a name="clienteling-overview"></a><span data-ttu-id="fdbfe-103">クライアンテリングの概要</span><span class="sxs-lookup"><span data-stu-id="fdbfe-103">Clienteling overview</span></span>

[!include [banner](includes/banner.md)]


<span data-ttu-id="fdbfe-104">多くの小売業者、特にハイエンドの専門小売業者は、店員に主な顧客との長期的な関係を形成させます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-104">Many retailers, especially high-end specialty retailers, want their sales associates to form long-term relationships with their key customers.</span></span> <span data-ttu-id="fdbfe-105">店員は、顧客の好き嫌い、購買履歴、製品の好み、記念日や誕生日などの重要な日付について知っていることが期待されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-105">The associates are expected to know about these customers' likes and dislikes, purchase history, product preferences, and important dates, such as anniversaries and birthdays.</span></span> <span data-ttu-id="fdbfe-106">店員はそのような情報をキャプチャし、必要なときに簡単に情報を見つけられる必要があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-106">Associates need a place where they can capture this information and easily find it when it's required.</span></span> <span data-ttu-id="fdbfe-107">この情報が 1 つのビューで使用可能になると、店員は特定の条件に一致する顧客を簡単にターゲットにすることができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-107">If this information is available in a single view, the associates can easily target customers who meet specific criteria.</span></span> <span data-ttu-id="fdbfe-108">たとえば、ハンドバッグを購入したい顧客や、誕生日、記念日などの生活の重要なイベントが近づいている顧客などを探すことができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-108">For example, they can find all customers who prefer to shop for handbags, or customers who have an important event approaching, such as a birthday or anniversary.</span></span>

## <a name="client-book"></a><span data-ttu-id="fdbfe-109">クライアント ブック</span><span class="sxs-lookup"><span data-stu-id="fdbfe-109">Client book</span></span>

<span data-ttu-id="fdbfe-110">Microsoft Dynamics 365 Commerce では、小売業者はクライアント ブック機能を使用して、主な顧客との長期的な関係を築くよう店舗スタッフを支援することができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-110">In Microsoft Dynamics 365 Commerce, retailers can use the client book functionality to help store associates form long-term relationships with key customers.</span></span>

<span data-ttu-id="fdbfe-111">クライアントブックには、各顧客の連絡先情報を表わす顧客カードと、小売業者が定義し、本部で設定した3つのプロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-111">The client book includes customer cards that show contact information for each customer, together with three more properties that are defined by the retailer and configured in Headquarters.</span></span> <span data-ttu-id="fdbfe-112">小売業者は、顧客について店員が知っておくべき最も重要な事項を 3 つ決定できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-112">Retailers can decide the three most important things that sales associates should know about customers.</span></span> <span data-ttu-id="fdbfe-113">例えば、宝石の小売業者は、記念日や誕生日などを最も重要な日付に含めることでしょう。これらの日付に、人々がより多くの宝石を購入する可能性があるからです。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-113">For example, a jewelry retailer might want to include important dates such as anniversaries or birthdays, because these dates are occasions when people might buy more jewelry.</span></span> <span data-ttu-id="fdbfe-114">同様に、ファッション小売業者は、顧客が好むショッピングの興味やブランドを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-114">Similarly, a fashion retailer might want to include the customer's preferred shopping interests and brands.</span></span>

<span data-ttu-id="fdbfe-115">またクライアント ブックでは、店員が一覧をフィルタ処理して、特定の条件を満たす顧客のみを表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-115">The client book also lets sale associates filter the list so that it shows only customers who meet specific criteria.</span></span> <span data-ttu-id="fdbfe-116">たとえば、靴の新しいコレクションが店舗に到着し、店員が靴を購入したい顧客に通知したいとします。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-116">For example, a new collection of shoes has arrived in the store, and an associate wants to inform customers who like to buy shoes.</span></span> <span data-ttu-id="fdbfe-117">この場合、店員はクライアント ブックをフィルター処理して関連する顧客を見つけ、更にアクションを起こすことができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-117">In this case, the associate can filter the client book to find the relevant customers and then take further action.</span></span>

<span data-ttu-id="fdbfe-118">顧客が何らかの理由で主な顧客として見なされなくなり、厳密に管理する必要がなくなった場合、店員はクライアント ブックから彼らの情報を削除できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-118">If any customers are no longer considered key customers for some reason, and therefore should not be closely managed, sales associates can remove them from their client book.</span></span>

<span data-ttu-id="fdbfe-119">一部の小売業者は、顧客を店員レベルで管理したくない場合があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-119">Some retailers don't want to manage customers at the sales associate level.</span></span> <span data-ttu-id="fdbfe-120">代わりに、店舗レベルでの主な顧客一覧の管理を希望します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-120">Instead, they want to manage a list of key customers at the store level.</span></span> <span data-ttu-id="fdbfe-121">これらの小売業者は、店舗クライアント ブックから顧客を表示できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-121">These retailers can view customers from store client books.</span></span> <span data-ttu-id="fdbfe-122">このオプションを使用すると、小売業者は、アドレス帳が現在の店舗のアドレス帳と一致するすべての店員のクライアント ブックから顧客を表示することができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-122">By using this option, retailers can view the customers from the client books of all the sales associates whose address book matches the address book of the current store.</span></span> <span data-ttu-id="fdbfe-123">このようにして、店員が法人の複数の店舗で働いている場合、クライアント ブックにはそれらの店舗の顧客が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-123">In this way, if an associate works in multiple stores of the legal entity, the client book shows the customers from all those stores.</span></span> <span data-ttu-id="fdbfe-124">この機能は、追加機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-124">This functionality supports additional capabilities.</span></span> <span data-ttu-id="fdbfe-125">たとえば、ある店員から別の店員に顧客を再割り当てすることができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-125">For example, customers can be reassigned from one associate to another associate.</span></span> <span data-ttu-id="fdbfe-126">この機能は、店員が転勤または退職するときに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-126">This capability is useful when associates are transferred or leave the company.</span></span>

<span data-ttu-id="fdbfe-127">各店員は、法人ごとに 1 つのクライアント ブックを持つことができ、店員はクライアント ブックに 1 人以上の顧客を追加できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-127">Each sales associate can have one client book per legal entity, and associates can add one or more customers to their client book.</span></span> <span data-ttu-id="fdbfe-128">Commerce では現在、各顧客を 1 つのクライアント ブックにのみ追加できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-128">In Commerce, each customer can currently be added to only one client book.</span></span> <span data-ttu-id="fdbfe-129">ただし、Microsoft は、1 人の顧客を複数のクライアント ブックに追加する機能を追加することを計画しています。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-129">However, Microsoft plans to add functionality that lets a single customer be added to multiple client books.</span></span>

> [!NOTE]
> <span data-ttu-id="fdbfe-130">顧客検索とは異なり、クライアント ブックは、店舗のアドレス帳に基づいて顧客レコードをフィルタ処理することはありません。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-130">Unlike customer search, the client book doesn't filter customer records based on the store's address books.</span></span>

## <a name="activities-and-notes"></a><span data-ttu-id="fdbfe-131">活動とメモ</span><span class="sxs-lookup"><span data-stu-id="fdbfe-131">Activities and notes</span></span>

<span data-ttu-id="fdbfe-132">オンライン チャネルを使用すると、小売業者は顧客がこの情報を明示的に提供しなくても、顧客の好みを知ることができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-132">Online channels give retailers ways to learn about customer preferences without requiring that customers explicitly provide this information.</span></span> <span data-ttu-id="fdbfe-133">一方、顧客が店員とやり取りする場合、顧客は好みに関する情報を明示的に共有します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-133">By contrast, when customers interact with sales associates in the store, they explicitly share information about their preferences.</span></span> <span data-ttu-id="fdbfe-134">残念ながら、この情報は販売終了後に失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-134">Unfortunately, this information can be lost after the sale is over.</span></span> <span data-ttu-id="fdbfe-135">ただし、この情報が記録されるなら、小売業者は顧客をよりよく理解できるようになるため、さらに良いおすすめや、ショッピング体験を提供できるようになります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-135">However, if this information is recorded, it can help retailers better understand customers, and therefore help them provide better recommendations and a better overall shopping experience.</span></span>

<span data-ttu-id="fdbfe-136">顧客が共有する重要な情報を取得するために、店員はクライアント ブックの属性だけでなく、活動とメモの機能を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-136">To capture the critical information that customers share, sales associates can use not only the client book attributes, but also use the activities and notes functionality.</span></span> <span data-ttu-id="fdbfe-137">小売業者は、店舗訪問、電子メールアドレス、電話番号、および予定に関する情報など、活動タイプをコンフィギュレーションできます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-137">Retailers can configure the activity types, such as information about the store visit, email address, phone number, and appointments.</span></span> <span data-ttu-id="fdbfe-138">店員が作成するアクティビティは、販売時点管理 (POS) でタイムライン形式で表示できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-138">Activities that associates create can be viewed in a timeline format at the point of sale (POS).</span></span> <span data-ttu-id="fdbfe-139">それらは、Headquarters の **すべての顧客 \> 一般** ページの **活動** タブでも表示できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-139">They can also be viewed on the **Activities** tab on the **All customers \> General** page in Headquarters.</span></span>

<span data-ttu-id="fdbfe-140">店員は、メモを使用して、すべてのやり取りの前に参照できる一般的な顧客情報を取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-140">Sales associates can also use notes to capture generic customer information that can be referenced before every interaction.</span></span> <span data-ttu-id="fdbfe-141">これらのメモは、Headquarters に保存され、顧客プロファイルまたはコール センターの顧客詳細ページで表示できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-141">These notes are saved in Headquarters, and can be viewed in the customer profile or on the customer details page in the call center.</span></span>

> [!NOTE]
> <span data-ttu-id="fdbfe-142">現在すべてのメモと活動は、法人に勤務し、顧客詳細のページを表示できる店員が閲覧できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-142">Currently, all notes and activities can be viewed by any sales associate who works for the legal entity and can view customer details pages.</span></span> <span data-ttu-id="fdbfe-143">メモと活動は、顧客をクライアント ブックに追加した店員に限定されません。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-143">Notes and activities aren't limited to the associate who added a customer to the client book.</span></span>

## <a name="integration-with-dynamics-365-customer-insights"></a><span data-ttu-id="fdbfe-144">Dynamics 365 Customer Insights との統合</span><span class="sxs-lookup"><span data-stu-id="fdbfe-144">Integration with Dynamics 365 Customer Insights</span></span>

<span data-ttu-id="fdbfe-145">Dynamics 365 Customer Insights アプリケーションを使用することで、小売業者は、顧客が小売業者のブランドと接触する際に使用するさまざまなシステムからデータを集計できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-145">By using the Dynamics 365 Customer Insights application, retailers can aggregate data from the various systems that customers use to interact with the retailer's brand.</span></span> <span data-ttu-id="fdbfe-146">その後、このデータを使用して顧客の単一のビューを生成し、洞察を導き出すことができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-146">They can then use this data to generate a single view of the customer and derive insights.</span></span> <span data-ttu-id="fdbfe-147">Customer Insights と Commerce の統合により、小売業者はクライアント ブックの顧客カードに表示する必要のある 1 つ以上の指標を選択できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-147">The integration of Customer Insights with Commerce lets retailers select one or more measures that should be shown on the customer card in the client book.</span></span> <span data-ttu-id="fdbfe-148">たとえば、小売業者は Customer Insights のデータを使用して、顧客の「解約率」を計算し「次に優先するアクション」を定義することができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-148">For example, retailers can use the data in Customer Insights to calculate the "churn probability" for a customer and define the "next best action."</span></span> <span data-ttu-id="fdbfe-149">これらの値が指標として定義されている場合は顧客カードに表示され、店員に重要な情報を提供できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-149">If these values are defined as measures, they can be shown on the customer card and can provide crucial information to sales associates.</span></span> <span data-ttu-id="fdbfe-150">Customer Insights の詳細については、[Dynamics 365 Customer Insights](https://docs.microsoft.com/dynamics365/ai/customer-insights/overview) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-150">For more information about Customer Insights, see the [Dynamics 365 Customer Insights](https://docs.microsoft.com/dynamics365/ai/customer-insights/overview) documentation.</span></span> <span data-ttu-id="fdbfe-151">指標の詳細については、[指標](https://docs.microsoft.com/dynamics365/ai/customer-insights/pm-measures)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-151">For more information about measures, see [Measures](https://docs.microsoft.com/dynamics365/ai/customer-insights/pm-measures).</span></span>

## <a name="set-up-clienteling"></a><span data-ttu-id="fdbfe-152">クライアンテリングの設定</span><span class="sxs-lookup"><span data-stu-id="fdbfe-152">Set up clienteling</span></span>

<span data-ttu-id="fdbfe-153">環境内でクライアンテリング機能を有効にするには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-153">To turn on the clienteling functionality in your environment, follow these steps.</span></span>

1. <span data-ttu-id="fdbfe-154">**機能管理** ワークスペースで、**Retail と Commerce** モジュールによって機能をフィルタ処理します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-154">In the **Feature management** workspace, filter the features by the **Retail and commerce** module.</span></span>

    <span data-ttu-id="fdbfe-155">![Commerce モジュールの機能一覧のクライアンテリング](./media/Enable_clienteling.png "Retail と Commerce モジュールの機能一覧のクライアンテリング")</span><span class="sxs-lookup"><span data-stu-id="fdbfe-155">![Clienteling in the list of features for the Commerce module](./media/Enable_clienteling.png "Clienteling in the list of features for the Retail and commerce module")</span></span>

2. <span data-ttu-id="fdbfe-156">**直ちに有効化** を選択して **クライアンテリング** 機能をオンにします。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-156">Turn on the **Clienteling** feature by selecting **Enable now**.</span></span>
3. <span data-ttu-id="fdbfe-157">**Commerce パラメーター** ページの **番号順序** タブで、**クライアント ブック識別子** の行を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-157">On the **Commerce Parameters** page, on the **Number sequence** tab, select the **Client book identifier** row.</span></span> <span data-ttu-id="fdbfe-158">次に、**番号順序コード** フィールドで、番号順序を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-158">Then, in the **Number sequence code** field, select a number sequence.</span></span> <span data-ttu-id="fdbfe-159">システムはこの番号順序を使用して、クライアント ブックに ID を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-159">The system will use this number sequence to assign an ID to client books.</span></span>
4. <span data-ttu-id="fdbfe-160">**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-160">Select **Save**.</span></span>
5. <span data-ttu-id="fdbfe-161">クライアント ブックで管理されている顧客用に取得する属性を含む、新しい属性グループを作成します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-161">Create a new attribute group that contains the attributes that you want to capture for customers who are managed in client books.</span></span> <span data-ttu-id="fdbfe-162">手順については、[属性および属性グループ](https://docs.microsoft.com/dynamics365/retail/attribute-attributegroups-lifecycle)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-162">For instructions, see [Attributes and attribute groups](https://docs.microsoft.com/dynamics365/retail/attribute-attributegroups-lifecycle).</span></span>

    - <span data-ttu-id="fdbfe-163">必須属性を **絞り込み可能** として定義します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-163">Define the required attributes as **Can be refined**.</span></span> <span data-ttu-id="fdbfe-164">店員は、これらの属性を使用してクライアント ブックをフィルタ処理できます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-164">Sales associates can then use these attributes to filter their client book.</span></span>
    - <span data-ttu-id="fdbfe-165">これらの属性の表示順序を設定します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-165">Set the display order for these attributes.</span></span> <span data-ttu-id="fdbfe-166">この表示順序によって、クライアント ブックの顧客カードに表示する属性が決まります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-166">This display order determines which attributes should be shown on the customer card in the client book.</span></span> <span data-ttu-id="fdbfe-167">表示順序 1 は、表示順序 2 より高いと見なされます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-167">A display order of 1 is considered higher than a display order of 2.</span></span> <span data-ttu-id="fdbfe-168">したがって、表示順序が 1 の属性は、表示順序が 2 の属性よりも前に表示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-168">Therefore, the attribute that has a display order of 1 will be shown before to the attribute that has a display order of 2.</span></span>

    > [!NOTE]
    > <span data-ttu-id="fdbfe-169">同じページから Customer Insights を利用することができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-169">You can make Customer Insights available from the same page.</span></span> <span data-ttu-id="fdbfe-170">ただし、認証のために Azure アプリケーションの ID とシークレットを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-170">However, an Azure application ID and secret must be created, for authentication purposes.</span></span> <span data-ttu-id="fdbfe-171">(要件の詳細については、このトピック後半の [Customer Insights と Commerce の統合を有効にする](#turn-on-the-integration-of-customer-insights-with-commerce)を参照してください。) Customer Insights が有効になっていて、顧客カードに表示する必要がある指標を 1 つ以上選択すると、それらの指標が最初に表示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-171">(For information about the requirements, see the [Turn on the integration of Customer Insights with Commerce](#turn-on-the-integration-of-customer-insights-with-commerce) section later in this topic.) If Customer Insights is turned on, and you select one or more measures that should be shown on the customer card, those measures will be shown first.</span></span> <span data-ttu-id="fdbfe-172">次に、表示順序に基づいて、クライアント ブックの属性グループが表示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-172">Next, client book attribute groups will be shown, based on the display order.</span></span> <span data-ttu-id="fdbfe-173">たとえば、Customer Insights から 2 つの指標を選択した場合、これらの 2 つの指標と 1 つのクライアント ブック属性が顧客カードに表示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-173">For example, if you select two measures from Customer Insights, those two measures and one client book attribute will be shown on the customer card.</span></span> <span data-ttu-id="fdbfe-174">表示されるクライアント ブック属性は、最も高い表示順序を持つ属性になります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-174">(The client book attribute that is shown will be the attribute that has the highest display order.)</span></span>

6. <span data-ttu-id="fdbfe-175">**Commerce パラメーター** ページの **クライアンテリング** タブの **クライアント ブック属性グループ** フィールドで、作成した属性グループを選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-175">On the **Commerce parameters** page, on the **Clienteling** tab, in the **Client book attribute group** field, select the attribute group that you just created.</span></span>

    <span data-ttu-id="fdbfe-176">![選択されたクライアント ブック属性グループ](./media/Client%20book%20attributes.png "選択されたクライアント ブック属性グループ")</span><span class="sxs-lookup"><span data-stu-id="fdbfe-176">![Client book attribute group selected](./media/Client%20book%20attributes.png "Client book attribute group selected")</span></span>

7. <span data-ttu-id="fdbfe-177">POS で発生する活動をキャプチャするには **活動タイプ** ページ (**Retail と Commerce \> 顧客 \> 活動タイプ**) で活動タイプを定義します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-177">To capture activities that occur at the POS, define the activity types on the **Activity types** page (**Retail and Commerce \> Customers \> Activity types**).</span></span>

    > [!NOTE]
    > <span data-ttu-id="fdbfe-178">活動タイプは、Commerce Scale Unit が初めてリアルタイム呼び出しを行うときに、取り込まれます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-178">Activity types are pulled by the Commerce Scale Unit when it makes a real-time call for the first time.</span></span> <span data-ttu-id="fdbfe-179">活動が取り込まれると、数時間キャッシュされます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-179">After the activities are pulled, they are cached for a few hours.</span></span> <span data-ttu-id="fdbfe-180">活動タイプを変更した場合は、キャッシュが無効になるまで待機します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-180">If you change the activity types, wait until the cache is no longer valid.</span></span> <span data-ttu-id="fdbfe-181">または、非実稼働環境の場合は、Commerce Scale Unit サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-181">Alternatively, for non-production environments, restart the Commerce Scale Unit service.</span></span>

8. <span data-ttu-id="fdbfe-182">適切な POS 画面レイアウトに 2 つのボタンを追加して、店員が自分のクライアント ブックと店舗のクライアント ブックを表示できるようにします。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-182">Add two buttons to the appropriate POS screen layout, so that sales associates can view their own client book and the store client book.</span></span> <span data-ttu-id="fdbfe-183">(店舗のクライアント ブックには、その店舗とアドレス帳を共有するすべての店員のすべてのクライアント ブックのクライアントが含まれます。) 対応する操作の名前はそれぞれ、**クライアント ブックで顧客を表示** および **店舗クライアント ブックで顧客を表示** です。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-183">(Store client books include clients from all client books of all associates who share an address book with the store.) The corresponding operations are named **View customers in client book** and **View customers from store client books**, respectively.</span></span> <span data-ttu-id="fdbfe-184">クライアント ブックに関連する 3 つの追加操作が使用可能です。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-184">Three additional operations that are related to client books are available.</span></span> <span data-ttu-id="fdbfe-185">これらの操作により、どの店員がクライアントブックから顧客を追加、削除、および再割り当てできるかが決まります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-185">These operations determine which associates can add, remove, and reassign customers from the client book.</span></span> <span data-ttu-id="fdbfe-186">これらはそれぞれ、**顧客をクライアント ブックに追加**、**顧客をクライアント ブックから削除**、および **顧客をクライアントブックに再割り当て** という名前が付けられます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-186">They are named **Add customer to client book**, **Remove customers from client book**, and **Reassign customers to a client book**, respectively.</span></span>
9. <span data-ttu-id="fdbfe-187">次の配布スケジュール ジョブを実行します: 1040、1150、1110、および 1090。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-187">Run the following distribution schedule jobs: 1040, 1150, 1110, and 1090.</span></span>

<span data-ttu-id="fdbfe-188">この手順を完了すると、店員は POS で顧客の詳細ページを開き、顧客をクライアント ブックに追加し、顧客の活動とメモを取得し、顧客とクライアント ブックの属性を使用してクライアント ブックをフィルタ処理することにより、顧客をターゲットできます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-188">After you've completed this procedure, sales associates can open the customer details page at the POS, and add customers to their client book, view and capture activities and notes for customers, and target customers by using customer and client book attributes to filter the client book.</span></span> <span data-ttu-id="fdbfe-189">次の図は、クライアント ブックの例を示します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-189">The following illustration shows an example of a client book.</span></span>

<span data-ttu-id="fdbfe-190">![クライアント ブックの例](./media/client_book.png "クライアント ブックの例")</span><span class="sxs-lookup"><span data-stu-id="fdbfe-190">![Example of a client book](./media/client_book.png "Example of a client book")</span></span>

## <a name="turn-on-the-integration-of-customer-insights-with-commerce"></a><span data-ttu-id="fdbfe-191">Customer Insights と Commerce の統合を有効にする</span><span class="sxs-lookup"><span data-stu-id="fdbfe-191">Turn on the integration of Customer Insights with Commerce</span></span>

<span data-ttu-id="fdbfe-192">Customer Insights と Commerce の統合を有効にするには、Commerce がプロビジョニングされるテナントに Customer Insights の有効なインスタンスがあることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-192">To turn on the integration of Customer Insights with Commerce, you must make sure that you have an active instance of Customer Insights in the tenant where Commerce is provisioned.</span></span> <span data-ttu-id="fdbfe-193">また、Azure サブスクリプションを持つ Azure Active Directory (Azure AD) ユーザー アカウントも必要です。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-193">You must also have an Azure Active Directory (Azure AD) user account that has an Azure subscription.</span></span>

<span data-ttu-id="fdbfe-194">統合を設定するには、これらの手順に従います。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-194">Follow these steps to set up the integration.</span></span>

1. <span data-ttu-id="fdbfe-195">Azure ポータルで、新しいアプリケーションを登録し、アプリケーション名、アプリケーションID、シークレットをメモしておきます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-195">In the Azure portal, register a new application and make a note of the application name, application ID, and secret.</span></span> <span data-ttu-id="fdbfe-196">この情報は、Commerce と Customer Insights のサービス間の認証に使用されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-196">This information will be used for service-to-service authentication between Commerce and Customer Insights.</span></span> <span data-ttu-id="fdbfe-197">シークレットは Key Vault で安全に保管する必要があることにご注意ください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-197">Note the secret safely, as it will be required to save it in the key vault.</span></span> <span data-ttu-id="fdbfe-198">以下の例では、アプリケーション名、アプリケーションID、シークレットにそれぞれ CI_Access_name、CI_Access_AppID、CI_Access_Secret を使用しています。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-198">For the following example, use CI_Access_name, CI_Access_AppID, CI_Access_Secret for the application name, application ID, and secret respectively.</span></span> <span data-ttu-id="fdbfe-199">詳細については、[クイックスタート : Microsoft ID プラットフォームにアプリケーションを登録する](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-199">For more information, see [Quickstart: Register an application with the Microsoft identity platform](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app).</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="fdbfe-200">期限が切れる前にシークレットを変更することを忘れないように、対策を講じてください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-200">Take steps so that you will remember to change the secret before it expires.</span></span> <span data-ttu-id="fdbfe-201">そうでない場合、統合は予期せず停止します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-201">Otherwise, the integration will unexpectedly stop.</span></span>

2. <span data-ttu-id="fdbfe-202">Customer Insights インスタンスに移動し、上記で作成したアプリケーションの名前 (この例では "CI_Access_name) を検索します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-202">Go to your Customer Insights instance and search for the name of the application created above (in this example, "CI_Access_name").</span></span>
3. <span data-ttu-id="fdbfe-203">Azure Key Vault を作成し、名前と URL をメモします (この例では、"KeyVaultName"、"KeyVault VAULT")。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-203">Create an Azure key vault, and take a note of the name and URL (in this example, "KeyVaultName", "KeyVaultURL").</span></span> <span data-ttu-id="fdbfe-204">手順については、[クイックスタート: Azure ポータルを使用して Azure Key Vault からシークレットを設定および取得する](https://docs.microsoft.com/azure/key-vault/quick-create-portal)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-204">For instructions, see [Quickstart: Set and retrieve a secret from Azure Key Vault using the Azure portal](https://docs.microsoft.com/azure/key-vault/quick-create-portal).</span></span>
4. <span data-ttu-id="fdbfe-205">KeyVault にシークレット (この例では "CI_Access_Secret) を保存します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-205">Save the secret (in this example, "CI_Access_Secret") in the vault.</span></span> <span data-ttu-id="fdbfe-206">シークレット を KeyVault に保存すると、シークレットに名前が付けられます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-206">When this secret is stored in the vault, the secret gets a name.</span></span> <span data-ttu-id="fdbfe-207">シークレットの名前をメモします (この例では 'SecretName')。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-207">Note the secret name (in this example, 'SecretName").</span></span>
5. <span data-ttu-id="fdbfe-208">Azure Key Vault からシステムにアクセスするには、アプリケーション ID とアプリケーションで構成された別のアプリケーションを作成する必要があります (この例では、"KeyVault_Access_AppID"、"KeyVault_Access_Secret")。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-208">To access the secret from Azure Key Vault, you need to create another application with an application ID and secret (in this example, "KeyVault_Access_AppID" and "KeyVault_Access_Secret").</span></span> <span data-ttu-id="fdbfe-209">安全上の観点から、シークレットは再表示されません。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-209">Note the secret safely, as it will not be displayed again.</span></span>
6. <span data-ttu-id="fdbfe-210">API を使用して Commerce からキー コンテナーにアクセスするには、アプリケーションへのアクセス許可を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-210">Next, you need to give permissions to the application to access the Key Vault from Commerce using APIs.</span></span> <span data-ttu-id="fdbfe-211">Azure portal のアプリケーション ページに移動します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-211">Go to the application page in Azure portal.</span></span> <span data-ttu-id="fdbfe-212">**管理** セクションで、 **API のアクセス許可** を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-212">Under the **Manage** section, select **API permissions**.</span></span> <span data-ttu-id="fdbfe-213">**Azure key vault** にアクセスするためのアクセス許可を追加します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-213">Add the permission to access **Azure key vault**.</span></span> <span data-ttu-id="fdbfe-214">このアクセス許可については、**アクセス ポリシー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-214">For this permission, select **Access policy**.</span></span> <span data-ttu-id="fdbfe-215">テンプレートに **シークレットの管理** を使用し、**取得**、**一覧**、**復号化**、**暗号化** オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-215">Select the template as **Secret management**, and select the **Get**, **List**, **Decrypt**, and **Encrypt** options.</span></span> 
5. <span data-ttu-id="fdbfe-216">Commerce Headquarters で、**システム管理 \> 設定 \> Key Vault パラメーター** に移動し、Key Vault に必要な情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-216">In Commerce headquarters, go to **System administration \> Setup \> Key Vault parameters**, and enter the required information for the key vault.</span></span> <span data-ttu-id="fdbfe-217">次に、**Key Vault クライアント** フィールドに手順 4 で使用したアプリケーション ID を入力して、Commerce が Key Vault でシークレットにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-217">Then, in the **Key Vault client** field, enter the application ID that you used in step 4, so that Commerce can access the secrets in the key vault.</span></span>
6. <span data-ttu-id="fdbfe-218">ステップ 1 で作成したアプリケーションを安全なアプリケーション (セーフ リストとも呼ばれます) の一覧に追加するには、Customer Insights にアクセスして、アプリケーションへの **表示** アクセスを選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-218">To add the application that you created in step 1 to the list of safe applications (sometimes referred to as a safe list), go to Customer Insights, and select **View** access to the application.</span></span> <span data-ttu-id="fdbfe-219">手順については、[アクセス許可](https://docs.microsoft.com/dynamics365/ai/customer-insights/pm-permissions)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-219">For instructions, see [Permissions](https://docs.microsoft.com/dynamics365/ai/customer-insights/pm-permissions).</span></span>
7. <span data-ttu-id="fdbfe-220">Commerce HQ の **システム管理 > 設定 >  Key Vault パラメーター** ページで、以下の説明に従ってフィールドを更新します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-220">On the **System administration > Setup > Key Vault parameters** page in Commerce HQ, update the fields as described below:</span></span> 

- <span data-ttu-id="fdbfe-221">**Key Vault URL** : "KeyVaultURL" (上記の手順 3 から)。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-221">**Key Vault url**: "KeyVaultURL" (from step 3 above).</span></span>
- <span data-ttu-id="fdbfe-222">**Key Vault クライアント** : "KeyVault_Access_AppID" (上記の手順 5 から)。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-222">**Key Vault client**: "KeyVault_Access_AppID" (from step 5 above).</span></span>
- <span data-ttu-id="fdbfe-223">**Key Vault 秘密鍵** : "KeyVault_Access_Secret" (上記の手順 5 から)。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-223">**Key Vault secret key**: "KeyVault_Access_Secret" (from step 5 above).</span></span>
- <span data-ttu-id="fdbfe-224">**シークレット** セクション:</span><span class="sxs-lookup"><span data-stu-id="fdbfe-224">Under **Secrets** section:</span></span>
    - <span data-ttu-id="fdbfe-225">**名前** : 任意の名前 ("CISecret" など)。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-225">**Name**: Any name, for example "CISecret".</span></span>
    - <span data-ttu-id="fdbfe-226">**説明** : 任意の値。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-226">**Description**: Any value.</span></span>
    - <span data-ttu-id="fdbfe-227">**シークレット** : **vault**://<Name of key vault>/<name of secret>> この例では、"vault://KeyVaultName/SecretName" です。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-227">**Secret**: **vault**://<Name of key vault>/<name of secret>> In this  example it will be "vault://KeyVaultName/SecretName".</span></span>

<span data-ttu-id="fdbfe-228">フィールドを更新した後、**検証** を選択して、Commerce アプリケーションからアクセス可能なことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-228">After you update the fields, select **Validate** to ensure the secret can be accessed by the Commerce application.</span></span>

8. <span data-ttu-id="fdbfe-229">**Commerce パラメータ** ページの Commerce で、**Dynamics 365 Customer Insights** クイックタブの **クライアント** タブで、**アプリケーション ID** を、"CI_Access_AppID" に設定します (上記の手順 1 から)。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-229">In Commerce, on the **Commerce parameters** page, on the **Clienteling** tab, on the **Dynamics 365 Customer Insights** FastTab, set the **Application ID** to "CI_Access_AppID" (from step 1 above).</span></span> <span data-ttu-id="fdbfe-230">**シークレット名** に、上記の手順 7 で入力したシークレット ("CISecret") を選択します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-230">For **Secret name**, select the name of the secret entered in step 7 above ("CISecret").</span></span> <span data-ttu-id="fdbfe-231">**Customer Insights を有効化する** オプション **はい** に設定します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-231">Set the **Enable Customer Insights** option to **Yes**.</span></span> <span data-ttu-id="fdbfe-232">何らかの理由で設定に失敗した場合は、エラー メッセージが表示され、このオプションは **いいえ** に設定されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-232">If the setup is unsuccessful for any reason, an error message will be displayed, and this option will be set to **No**.</span></span> 

<span data-ttu-id="fdbfe-233">テスト環境や実稼動環境など、Customer Insights で複数の環境を持つことができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-233">You can have multiple environments in Customer Insights, such as test and production environments.</span></span> <span data-ttu-id="fdbfe-234">**環境 インスタンス ID** フィールドに、適切な環境を入力します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-234">In the **Environment instance ID** field, enter the appropriate environment.</span></span> <span data-ttu-id="fdbfe-235">**代替顧客 ID** フィールドに、顧客 ID 番号にマップされている Customer Insights のプロパティを入力します。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-235">In the **Alternate customer ID** field, enter the property in Customer Insights that is mapped to the customer account number.</span></span> <span data-ttu-id="fdbfe-236">(Commerce では、顧客アカウント番号が顧客 ID となります。) 残りの 3 つのプロパティは、クライアント ブックの顧客カードに表示されるメジャーです。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-236">(In Commerce, the customer account number is the customer ID.) The remaining three properties are the measures that will be shown on the customer card in the client book.</span></span> <span data-ttu-id="fdbfe-237">顧客カードに表示する指標を 3 つまで選択することができます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-237">You can select up to three measures to show on the customer card.</span></span> <span data-ttu-id="fdbfe-238">ただし、メジャーを選択する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-238">However, you are not required to select any measures.</span></span> <span data-ttu-id="fdbfe-239">前述のように、これらの値が最初に表示された後、クライアント ブックの属性グループの値が示されます。</span><span class="sxs-lookup"><span data-stu-id="fdbfe-239">As mentioned previously, the system shows these values first, and then it shows the values for the client book attribute group.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]
