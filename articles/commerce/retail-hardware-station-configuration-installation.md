---
title: Retail ハードウェア ステーションのコンフィギュレーションとインストール
description: このトピックでは、セルフサービスを使用して Retail ハードウェア ステーションを構成、ダウンロード、およびインストールする方法について説明します。 また、Retail ハードウェア ステーションをアンインストールする方法についても説明します。
author: jashanno
manager: AnnBe
ms.date: 09/24/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailHardwareStation
audience: IT Pro
ms.reviewer: josaw
ms.custom: 27161
ms.assetid: eb164a9d-5538-4b6f-81ad-87e05d92eca5
ms.search.region: Global
ms.search.industry: Retail
ms.author: jashanno
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0, Retail July 2017 update
ms.openlocfilehash: a9013b5943a135be8a446e0bd2b1d54d8345d7d8
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/15/2021
ms.locfileid: "4979634"
---
# <a name="configure-and-install-retail-hardware-station"></a>Retail ハードウェア ステーションのコンフィギュレーションとインストール

[!include [banner](includes/banner.md)]

このトピックでは、セルフサービスを使用して Retail ハードウェア ステーションを構成、ダウンロード、およびインストールする方法について説明します。 また、Retail ハードウェア ステーションをアンインストールする方法についても説明します。

> [!IMPORTANT]
> このコンポーネントはサーバー証明書を利用することに注意してください。 有効期限に対してサーバー証明書を管理する必要があります。 既定では、証明書は 1 つの暦年 (365 日) で期限切れになります。

## <a name="download-retail-hardware-station-by-using-self-service"></a>セルフサービスを使い、Retail ハードウェア ステーションをダウンロード

### <a name="configure-a-new-retail-hardware-station"></a>新しい Retail Hardware Station のコンフィギュレーション

> [!NOTE]
> Retail (初回リリース) のアップグレードされていないバージョンである 2016 年 2 月を実行している場合は、手順 6 はスキップします。

1. Azure AD 証明書を使用して、Retail トライアル版にサインインします。
2. **ようこそ** ページで、左上隅のメニューを使用して、**小売** &gt; **チャンネル** &gt; **小売店舗** &gt; **すべての小売店舗** に移動します。
3. **すべての小売店舗** ページで、目的の店舗の小売チャネル ID を選択します。 店舗の詳細ビューが表示されます。

    > [!NOTE]
    > Houston 店舗は、デモ データ内の最も十分に用意されたストアです。

4. **小売店舗詳細** ページや、**ハードウェア ステーション** クイック タブで、**追加** を選択します。

    > [!NOTE]
    > 選択した店舗に使用される Retail Server URL は読み取り専用です。 この URL は、Retail ハードウェア ステーションのインストール時に重要になります。

5. **ハードウェア ステーション タイプ** フィールドで、**共有** を選択して、このハードウェア ステーションが Internet Information Services (IIS)、外部の販売時点管理 (POS) システムによって使用されるインストール済みのハードウェア ステーションであることを示します。

    > [!NOTE]
    > 値 **Shared** は、インストールが真に共有されているハードウェア ステーションのインストールであり、HTTPS 通信を介して機能することを示します。 対照的に、**専用** という値はハードウェア ステーションが Modern POS の一部であり、プロセス間通信を通じて機能していることを示します。

6. ハードウェア ステーションのプロファイルを選択します。

7. Retail ハードウェア ステーションをインストールするコンピュータのホスト名を入力します。 また、商業口座情報のコンピューターに関連付けられている電子決済 (EFT) ターミナル ID を入力します。

8. 一括配置を使用して構成ファイルまたは初期インストールを活用するには、次のセクションの詳細説明にあるように、インストール中に使用する証明書の拇印を入力します。

### <a name="download-the-retail-hardware-station-installer"></a>Retail ハードウェア ステーション インストーラーをダウンロード

1. Azure AD 資格情報を使用して、Retail Headquarters または Retail トライアル版にサインインします。
2. **ようこそ** ページで、左上隅のメニューを使用して、**小売** &gt; **チャンネル** &gt; **小売店舗** &gt; **すべての小売店舗** に移動します。
3. **すべての小売店舗** ページで、目的の店舗の小売チャネル ID を選択します。 店舗の詳細ビューが表示されます。

    > [!NOTE]
    > Houston 店舗は、デモ データ内の最も十分に用意されたストアです。

4. **小売店舗詳細** ページで、**ハードウェア ステーション** クイック タブを選択します。

    > [!NOTE]
    > 選択した店舗に使用される Retail Server URL は読み取り専用です。 この URL は、Retail ハードウェア ステーションのインストール時に重要になります。

5. ダウンロードするハードウェア ステーションを選択し、**ダウンロード** を選択します。

    > [!NOTE]
    > - ブラウザーは、生成されたダウンロード ポップアップをブロックする可能性があります。 **1 回許可** または **このサイトのオプション** &gt; **常に許可** を選択します。 その後、再度 **ダウンロード** を選択します。

6. Internet Explorer ウィンドウの下部に表示される通知バーで、**保存** を選択します。 (通知バーは、他のブラウザでは別の場所に表示される場合があります。)
7. 一括配置またはコマンド ラインからの配置に必要な場合は、構成ファイルのダウンロードに対して上記の手順を繰り返します。これは、選択した **ダウンロード** ボタンの横にあるボタンです。

    > [!NOTE]
    > - ダウンロードした構成ファイル名が、インストーラーのベース ファイル名と同じでない場合は、XML 構成ファイルを同じベース名に変更するか、コマンド ラインを使用してインストーラーを実行し、構成ファイルを指定します。
    > - Commerce ハードウェア ステーションのインストールには、構成ファイルは必要ありません。

8. ファイルを保存したら、インストーラーを実行します。 (この手順はブラウザによって異なる場合があります。)

### <a name="run-the-installer"></a>インストーラーを実行

> [!NOTE]
> Retail ハードウェア ステーション インストーラーを実行する前に、すべての[システム要件](../fin-and-ops/get-started/system-requirements.md)が満たされていることを確認してください。

Retail ハードウェア ステーション インストーラーは、まず関連付けられているファイルを抽出し、インストールを開始します。

1. インストーラーは、すべての前提条件が満たされていることを検証します。 サイドローディング キーが必要な場合は、インストーラーがそれを要求します。 このキーは、各デバイスの **一般** の下にある **デバイス** ページにあります。

    > [!NOTE]
    > - システムの再起動が必要な場合は、インストーラーでこれに関する要件を確認できますが、通常インストールを続行できます。
    > - 小売販売時点管理の Object Linking and Embedding (OPOS) 標準に基づいたハードウェアを使用する前に、OPOS コモン コントロール オブジェクトをインストールする必要があります。 インストールされていない場合は、インストーラーでこれに関する要件を確認できますが、通常インストールを続行できます。

2. Retail Server URL を入力し (たとえば、`https://MyCompanyNameret.axcloud.dynamics.com/Commerce`)、**次** を選択します。

    > [!NOTE]
    > Retail Server の URL は **小売店舗詳細** ページ上の **ハードウェア ステーション** クイック タブの最上部で見つけることができます。

3. HTTPS 通信に使用する、有効な Secure Sockets Layer (SSL) 証明書を選択します。

    > [!NOTE]
    > 証明書は秘密キー ストレージを使用する必要があり、サーバー認証は拡張キー使用プロパティにリストされている必要があります。 また、証明書はローカルに信頼される必要があり、期限切れにすることはできません。 ローカル コンピューターの個人用証明書格納場所に保存する必要があります。

4. 次のページでは、IIS アプリケーション プールで使用する必要があるユーザーを要求します。 バージョン 1611 以降の既定では、インストーラーが自動的にサービス アカウントを作成して使用することができます。 ドメインを使用している場合や特定のコントロールが必要な場合は、チェックボックスをオフにして、アプリケーション プールが実行するユーザー名とパスワードを入力します。
5. 使用する HTTPS ポートを入力します。

    > [!NOTE]
    > - Retail で HTTPS ポートを検索することができます。 (このトピックで前述したコンフィギュレーションの指示を参照してください)。
    > - インストーラーは自動的にホスト名を入力します。 何らかの理由で、インストールのためにホスト名を変更する必要がある場合は、ここで変更できます。 ホスト名はシステムの完全修飾ドメイン名 (FQDN) でなければなりません。また、選択したハードウェア ステーション エントリの **ホスト名** フィールドに入力する必要があります。

6. インストーラーは Retail ハードウェア ステーションをインストールし、インストールが成功したかどうかを示します。
7. インストールが完了したら、支払商社情報のインストール ツールが起動する場合があります。 このインストーラーは、環境に接続し、選択したハードウェア ステーションの販売者の口座情報 (EFT IDなど) をインストールします。

    > [!NOTE]
    > - インストールされているハードウェア ステーションが支払に関連する作業の使用されない場合、残りの手順を終了せずに **商社の情報をインストール** ウィンドウを閉じません。 このインストールが正常に完了しないと、ハードウェア ステーションは機能しません。
    
    > - バージョン 10.0.6 以降では、Install マーチャント情報ツールは使用されなくなりました。 代わりに、ハードウェア ステーションのマーチャント情報は、ログオン時またはハードウェア ステーションが有効になったときに POS によって設定されます。 ハードウェア ステーションを有効にした後にも Retail サーバーを使用できない場合は、最後の商社プロパティが、Retail サーバーへの接続が再確立されるまでの間に使用されます。 ハードウェア ステーションの更新と同時に、POS クライアントがバージョン 10.0.6 に更新されていないと、POS クライアントが同じまたはそれ以降のバージョンに更新されるまで、商社プロパティは更新されません。 

8. 支払商社情報のインストール ツールは、Azure AD 資格情報を要求する可能性があります。 Retail ハードウェア ステーションをインストールするユーザーの Azure AD 資格情報を入力します。
9. Retail Server URL は、Retail ハードウェア ステーションのインストールによって決定され、自動的に入力されます。 インストーラーは、この URL を使用して、ユーザーがアドレス帳を介して接続している店舗のリストをロードします。
10. ハードウェア ステーションがインストールされた小売店舗を選択します。
11. 現在のコンピューターにインストールされていたハードウェア ステーションに一致するハードウェア プロファイルを選択します。
12. 現在のコンピューターおよび Retail で既に完了している Retail ハードウェア ステーション構成に基づいて、ホスト名と EFT ターミナル ID が正しいことを確認します。 この情報を検証した後、**インストール** を選択します。
13. 商業口座情報が正しくインストールされたことを示すメッセージが表示されたら **閉じる** ボタンを選択してインストーラーを終了します。

## <a name="help-secure-retail-hardware-station"></a>Retail ハードウェア ステーションのセキュリティを強化する

現在のセキュリティ基準では、実稼動環境で次のオプションを設定する必要があります。

> [!NOTE]
> ハードウェア ステーションのインストーラーは、セルフサービスによるインストールの一部として、これらのレジストリの編集を自動的に行います。

- SSL を無効にする必要があります。
- Transport Layer Security (TLS) version 1.2 (または現行最新バージョン) のみを有効にして使用する必要があります。

    > [!NOTE]
    > 既定では、SSL および TLS 1.2 を除くすべてのバージョンの TLS は無効になります。 これらを値の編集または有効化するには、次の手順に従います。
    >
    > 1. Windows ロゴキーと R キーを同時に押して、**実行** ウィンドウを開きます。
    > 2. **開く** フィールドに、**Regedit** と入力してから **OK** を選択します。
    > 3. **ユーザー アカウント コントロール** ウィンドウが現われたら、**はい** を選択します。
    > 4. 新しい **レジストリ エディター** ウィンドウで、**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\SecurityProviders\\SCHANNEL\\Protocols** に移動します。 TLS 1.2 のみを有効にするために、以下のキーは自動的に挿入されています:
    >
    >    - TLS 1.2\\Server:Enabled=1
    >    - TLS 1.2\\Server:DisabledByDefault=0
    >    - TLS 1.2\\Client:Enabled=1
    >    - TLS 1.2\\Client:DisabledByDefault=0
    >    - TLS 1.1\\Server:Enabled=0
    >    - TLS 1.1\\Client:Enabled=0
    >    - TLS 1.0\\Server:Enabled=0
    >    - TLS 1.0\\Client:Enabled=0
    >    - SSL 3.0\\Server:Enabled=0
    >    - SSL 3.0\\Client:Enabled=0
    >    - SSL 2.0\\Server:Enabled=0
    >    - SSL 2.0\\Client:Enabled=0

- 知られている特定の理由で必要とされない限り、追加のネットワーク ポートを開かないでください。
- クロスオリジンのリソース共有を無効にし、許可され承認されたオリジンを指定する必要があります。
- 信頼された証明機関のみ、Retail ハードウェア ステーションを実行するコンピューター上で使用される証明書の調達に使用されます。

> [!IMPORTANT]
> - ほどんどの一般的な下位セキュリティ ソフトウェアおよびサービスはすべての下位セキュリティ基準が無効になった後に動作を停止します。 それらを再使用するには、前述のレジストリ キーに移動し、**有効** キーを **0** から **1** に設定します。
> - IIS と Payment Card Industry (PCI) の要件向けのセキュリティ ガイドラインを確認することが重要です。

## <a name="troubleshooting"></a>トラブルシューティング

### <a name="modern-pos-can-detect-the-hardware-station-in-its-list-for-selection-but-it-cant-complete-the-pairing"></a>Modern POS は、選択リストにあるハードウェア ステーションを検出できますが、ペアリングを完了することはできません

**ソリューション:** 以下の潜在的障害ポイントを確認してください:

- Modern POS を実行しているコンピュータは、Retail ハードウェア ステーションを実行しているコンピュータで使用される証明書を信頼します。

    - Web ブラウザーでこの設定を確認するには、次のURL `https://<Computer Name>:<Port Number>/HardwareStation/ping` に移動します。
    - この URL は ping を使用してコンピュータにアクセスできるかどうかを確認し、ブラウザは証明書が信頼できるかどうかを示します。 (たとえば、Internet Explorer ではカギのシンボルがアドレス バーに表示されます。 このシンボルを選択すると、Internet Explorer は証明書が現在信頼されているかどうかを確認します。 表示される証明書の詳細を見ることで、ローカル コンピュータに証明書をインストールできます)。

- Retail ハードウェア ステーションを実行するコンピュータで、ハードウェア ステーションで使用されるポートはファイアウォールで開かれます。
- 小売ハードウェア ステーションのインストールの最後に実行される支払商社情報インストール ツールを使用して、小売ハードウェア ステーションに支払商社情報が正しくインストールされます。

### <a name="modern-pos-cant-detect-the-hardware-station-in-its-list-for-selection"></a>Modern POS が選択リストにあるハードウェア ステーションを検出できない

**ソリューション:** 次の要素のいずれかによりこの問題が生じることがあり得ます。

- Retail ハードウェア ステーションがコマース バックオフィスに正しく設定されていません。 このトピックで説明した手順を使用して、ハードウェア ステーションのプロファイルとハードウェア ステーションが正しく入力されていることを確認します。
- チャンネル構成を更新するジョブが実行されていません。 この場合、チャンネル構成用に 1070 のジョブを実行します。
- そのコンピューターからハードウェア ステーションにアクセスすることはできません。 Web ブラウザーからハードウェア ステーション URL ping テストを利用できることを確認します。 この URL は、ハードウェア ステーション インストーラーの最後にあり、`https://<Computer Name>:<Port Number>/HardwareStation/ping` の形式です

## <a name="uninstall-retail-hardware-station"></a>Retail ハードウェア ステーションのアンインストール

Microsoft Windows でコントロール パネルを使用して Retail ハードウェア ステーションをアンインストールすることができます。

1. Windows ロゴ キーを押し、検索ボックスに **コントロール パネル** と入力します。 検索結果の一覧で、**コントロール パネル** を選択します。
2. コントロール パネルで、**プログラム** &gt; **プログラムのアンインストール** を選択します。 **プログラムと機能** ウィンドウが開きます。
3. **Microsoft Dynamics 365 for Retail ハードウェア ステーション** を選択し、プログラムの一覧の上にある **アンインストール** を選択します。
4. アンインストールがプログラムの削除を完了するまで待ちます。
