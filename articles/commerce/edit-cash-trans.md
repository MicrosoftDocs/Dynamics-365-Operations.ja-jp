---
title: 現金売りトランザクションと現金管理トランザクションの編集と監査
description: このトピックでは、Microsoft Dynamics 365 Commerce で現金売りトランザクションと現金管理トランザクションを編集および監査する方法について説明します。
author: josaw1
manager: AnnBe
ms.date: 11/04/2020
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2018-11-15
ms.dyn365.ops.version: ''
ms.openlocfilehash: c809f379dbd6824542d0b1768cfbf44f37461f4c
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/15/2021
ms.locfileid: "5010202"
---
# <a name="edit-and-audit-cash-and-carry-and-cash-management-transactions"></a>現金売りトランザクションと現金管理トランザクションの編集と監査

[!include [banner](../includes/banner.md)]

このトピックでは、Microsoft Dynamics 365 Commerce で現金売りトランザクションと現金管理トランザクションを編集および監査する方法について説明します。

## <a name="overview"></a>概要

Dynamics 365 Commerce のお客様は、ファースト パーティの販売時点管理 (POS) アプリケーションとサード パーティの POS アプリケーションの両方を使用します。 ファースト パーティのアプリケーションの場合、店舗トランザクションは、バッチ処理を通じてチャンネルから Commerce 本社に取り込まれます。 サード パーティのアプリケーションの場合、トランザクションは統合によって Commerce 本社に取り込まれます。 どちらの場合も、トランザクションを Commerce 本社に取り込んだ後に、整合性チェックプロセスを実行する必要があります。 このプロセスでは、トランザクションに対して複数の検証が実行され、正常に検証されたトランザクションのみが、Commerce 本社に転記できるように明細書に取り込まれます。

さまざまな理由でコマース トランザクションの検証が失敗することがあります。 統合コードまたは POS アプリケーションのバグにより、データ不整合が発生することがあります。 また、ユーザー エラーによってデータ不整合が発生することもあります。 たとえば、ユーザーがチャネルに同期された後に製品を削除したり、ユーザーがその期間のトランザクションを転記せずに会計年度期間を締めたとします。 これらのトランザクションにフラグが設定され明細書から除外されますが、お客様が日々の売上を財務に転記する日々のプロセスを妨害する可能性があります。 Commerce では、すべての変更の監査を管理しながら、検証に失敗したトランザクションを編集できます。

## <a name="edit-transactions"></a>トランザクションの編集

Commerce バージョン 10.0.5 では、売上や返品のような現金売りトランザクションのみ編集できます。 顧客注文とオンライン注文は編集できません。 Commerce バージョン 10.0.6 では、現金管理トランザクションも編集できます。

Commerce 本社でトランザクションを編集するには、次の手順に従います。

1. [Microsoft Dynamics Office Add-in](https://appsource.microsoft.com/product/office/WA104379629?tab=Overview) をインストールします。
1. Commerce 本社で、**店舗の財務** ワークスペースを開きます。 **トランザクションの検証エラー** タイルでは、1 つ以上の検証ルールに当てはまらなかった、トランザクション ページの事前にフィルターされたビューが使用できます。
1. トランザクション ページを開き、検証に失敗したレコードを選択し、**Office アドイン**、**選択したトランザクションの編集** の順に選択します。 選択したトランザクションの詳細を示す Excel ファイルが開きます。 このファイルには、次のワークシートが含まれます。

    - **明細行** – このワークシートには、トランザクションのヘッダーや製品明細行と、トランザクションの関連データが表示されます。
    - **支払** – このワークシートには、トランザクションの支払明細行の詳細が含まれます。
    - **割引** – このワークシートには、トランザクションの割引に関する詳細が含まれます。
    - **税金** – このワークシートには、トランザクションの税金に関する詳細が含まれます。
    - **諸費用** – このワークシートには、トランザクションの諸費用に関する詳細が含まれます。

1. Excel ファイルで適切なフィールドを変更してから、Dynamics Excel アドインの公開機能を使用してデータをアップロードして Commerce 本社に戻します。 データの公開後、変更がシステムに反映されます。 公開時には、ユーザーが行った変更に対する検証は行われません。
1. 変更の完全な監査証跡を表示するには、ヘッダーレベル変更用の **小売トランザクション** ヘッダー、および適切なトランザクション ページの該当するセクションやレコードにある **監査追跡の表示** を選択します。 たとえば、販売明細行に関連するすべての変更は、**販売トランザクション** ページに表示され、支 に関連するすべての変更は、**支払トランザクション** ページに表示されます。 変更については、次の監査の詳細が維持されます。

    - 変更日時
    - フィールド
    - 元の値
    - 新しい値
    - 変更者

1. 変更して公開した後、**店舗トランザクションの検証** を度実行して、それらの変更に一貫性があり有効であるかを検証します。

> [!NOTE]
> 検証に失敗したトランザクションのみを編集できます。 検証に合格したトランザクションを編集する場合は、トランザクションの検証状態を **エラー** または **なし** に変更して、変更を公開します。 その後、トランザクションのヘッダーまたはその他の子レコードのデータを編集して、ヘッダーまたはレコードを公開できます。

## <a name="bulk-edit-transactions-that-are-linked-to-a-statement"></a>明細書にリンクされているトランザクションの一括編集

Commerce バージョン 10.0.6 以降のバージョンでは、明細書レベルでトランザクションを一括編集できるオプションがサポートされています。

Commerce 本社で明細書にリンクされているトランザクションを一括編集するには、次の手順に従います。

1. **明細書** ページを開き、編集が必要なトランザクションを含む明細書を選択します。
1. **Microsoft Office で開く** ボタンを選択します。
1. 編集する対象に応じて、次のいずれかのオプションを選択します。

    - **現金売りトランザクションの編集** – このオプションを選択すると、明細書に含まれるすべての現金売りトランザクションを編集できます。 次の Excel ワークシートを使用できます。

        - **トランザクション** – このワークシートには、販売トランザクションのヘッダーレベルの情報がすべて含まれます。
        - **販売トランザクション** – このワークシートには、販売トランザクションの行レベルの情報がすべて含まれます。
        - **支払トランザクション** – このワークシートには、販売トランザクションの支払行レベルの情報がすべて含まれます。
        - **割引トランザクション** – このワークシートには、販売トランザクションの割引行レベルの情報がすべて含まれます。
        - **税金トランザクション** – このワークシートには、販売トランザクションの税金行レベルの情報がすべて含まれます。
        - **諸費用トランザクション** – このワークシートには、販売トランザクションの諸費用行レベルの情報がすべて含まれます。

    - **現金管理トランザクションの編集** – このオプションを選択すると、明細書に含まれるすべての現金管理トランザクションを編集できます。 次の Excel ワークシートを使用できます。

        - **トランザクション** – このワークシートには、現金管理トランザクションのヘッダーレベルの情報がすべて含まれます。
        - **銀行支払/入金トランザクション** – このワークシートには、すべての銀行入金トランザクションの詳細が含まれます。
        - **金庫保管支払/入金トランザクション** – このワークシートには、すべての金庫保管入金トランザクションの詳細が含まれます。
        - **支払/入金申告** – このワークシートには、すべての支払/入金申告トランザクションの詳細が含まれます。
        - **収入および経費トランザクション** – このワークシートには、すべての収入および経費トランザクションの明細行の詳細が含まれます。
        - **支払トランザクション** – このワークシートには、**請求書の支払** 処理と収入および経費トランザクションの支払いに関連する情報が含まれます。

1. 必要なトランザクションを編集します。

    > [!NOTE]
    > 編集されたトランザクションを一括公開する場合、検証は実行されません。 すべての編集が正確であることを確認し、ワークシート全体のデータの忠実性を維持する必要があります。 たとえば、未処理のトランザクションの会計期間または在庫期間が終了するシナリオを管理できるようにトランザクションの日付を変更する場合は、**営業日** 列を含むすべての Excel ワークシートの日付を変更する必要があります。 **明細書** ページにある **再検証トランザクション** を選択して、編集されたトランザクションを検証できます。 検証ジョブの実行が完了するまで待ってから、明細書を転記してください。

1. 集計が既に生成されている場合は、**集計トランザクション** ページを開き、**販売注文 xml の再生成** を選択します。

## <a name="bulk-edit-transactions-that-arent-linked-to-a-statement"></a>明細書にリンクされていないトランザクションの一括編集

Commerce バージョン 10.0.10 以降では、明細書にリンクされていない検証に失敗したトランザクションを一括編集するためのオプションがサポートされています。

Commerce 本社で明細書にリンクされていないトランザクションを一括編集するには、次の手順に従います。

1. **すべての店舗** ページを開き、トランザクションの編集が必要な店舗を選択します。
1. **Microsoft Office で開く** ボタンを選択し、**現金売りトランザクションの編集** を選択します。
1. 必要なトランザクションを編集し、公開します。

## <a name="additional-resources"></a>追加リソース

[オンライン注文トランザクションと非同期顧客注文トランザクションの編集と監査](edit-order-trans.md)

[小売トランザクションの財務分析コードの編集](edit-financial-dim.md)

[小売トランザクションを編集するために Excel ブックを作成する](create-excel-edit.md)

[小売トランザクションを編集するために Excel ブックにフィールドを追加する](add-fields-excel.md)
