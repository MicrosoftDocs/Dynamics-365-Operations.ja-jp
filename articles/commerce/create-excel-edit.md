---
title: 小売トランザクションを編集するために Excel ブックを作成する
description: このトピックでは、Microsoft Dynamics 365 Commerce で小売トランザクションを編集できるように、Excel ブックを作成する方法について説明します。
author: josaw1
manager: AnnBe
ms.date: 11/04/2020
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2018-11-15
ms.dyn365.ops.version: ''
ms.openlocfilehash: 73a3387d1e7251168002ff683b5b58e0c82a620c
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/15/2021
ms.locfileid: "4965380"
---
# <a name="create-an-excel-workbook-to-edit-retail-transactions"></a>小売トランザクションを編集するために Excel ブックを作成する

[!include [banner](../includes/banner.md)]

このトピックでは、Microsoft Dynamics 365 Commerce で小売トランザクションを編集できるように、Excel ブックを作成する方法について説明します。

## <a name="overview"></a>概要

事前定義された Excel テンプレートがあり、顧客はシステムのさまざまな部分からアクセスでき、小売トランザクションを編集および監査するために使用できます。 ただし、顧客は、この目的のためにカスタムの Excel ブックを作成することもできます。

## <a name="create-and-configure-an-excel-workbook"></a>Excel ブックの作成と構成

小売トランザクションを編集できるように、Excel ブックを作成して構成するには、次の手順に従います。

1. Excel を開き、空白のブックを作成します。
1. **挿入** タブで **個人用アドイン** を選択します。
1. 右ウィンドウで、**サーバー情報の追加** リンクを選択します。
1. サーバーの URL を入力して **OK** をクリックします。
1. 「アプレットの登録が見つかりません」というエラー メッセージが表示された場合は、次の手順に従って問題を解決します。

    1. Commerce で、**システム管理 \> 設定 \> Office アプリのパラメータ** の順に選択します。
    1. **アプリケーション パラメータ** クイックタブで **アプリのパラメーターの初期化** を選択します。
    1. 確認のメッセージボックスで **OK** を選択します。
    1. **登録済みアプレット** クイックタブで **アプレットの登録の初期化** を選択します。
    1. 必要に応じて前の 3 つの手順を繰り返します。

1. **デザイン** を選択してから **テーブルの追加** を選択します。
1. 変更する必要のあるデータに基づいて、編集のために Excel ブックに追加する必要があるエンティティを選択します。 次のテーブルを参照として使用します。

    | トランザクション タイプ | 使用するデータ エンティティ |
    |------------------|----------------------|
    | 現金売りトランザクション、オンライン注文、非同期顧客注文、非同期顧客見積 | トランザクション (監査可能)、販売トランザクション (監査可能)、支払トランザクション (監査可能)、税金トランザクション (監査可能)、割引トランザクション (監査可能)、諸費用トランザクション (監査可能) |
    | 銀行入金 | トランザクション (監査可能)、銀行入支払/入金トランザクション (監査可能) |
    | 金庫保管 | トランザクション (監査可能)、金庫保管支払/入金トランザクション (監査可能) |
    | 支払/入金申告 | トランザクション (監査可能)、支払/入金申告トランザクション (監査可能) |
    | 収入、経費 | トランザクション (監査可能)、収入/経費トランザクション (監査可能)、支払トランザクション (監査可能) |
    | 開始金額の申告、支払/入金の削除、釣銭入力、釣銭支払/入金、請求書の支払、顧客預金 | トランザクション (監査可能)、支払トランザクション (監査可能) |

    > [!NOTE]
    > 各 Excel ブックにデータ エンティティを 1 つだけ追加することが重要です。 また、鍵の記号でマークされているすべてのフィールドを、関連するブックに追加する必要があります。

1. ブックを構成した後、必要なフィルターを適用します。 ファイル内のすべてのワークシートに同じフィルターを適用してください。 Excel ファイルに大量のデータを読み込まないようにしてください。 そうしない場合、パフォーマンスが影響を受けたり、Excel とシステムの速度が低下する可能性があります。 ファイルのフィルターとして、常に "会社" と "明細書番号" または "トランザクション番号" を使用することをお勧めします。
1. フィルターを構成した後、**更新** を選択してデータを読み込みます。
1. 必要なデータを編集し、公開します。 **公開** ボタンを使用できない場合、一部の重要なフィールドが Excel ブックに追加されないことがあります。

## <a name="additional-resources"></a>追加リソース

[現金売りトランザクションと現金管理トランザクションの編集と監査](edit-cash-trans.md)

[オンライン注文トランザクションと非同期顧客注文トランザクションの編集と監査](edit-order-trans.md)

[小売トランザクションの財務分析コードの編集](edit-financial-dim.md)

[小売トランザクションを編集するために Excel ブックにフィールドを追加する](add-fields-excel.md)
