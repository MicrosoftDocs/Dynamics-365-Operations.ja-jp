---
title: IoT インテリジェンスのシナリオ設定
description: このトピックでは、IoT インテリジェンスの Supply Chain Management のシナリオを構成する方法について説明します。
author: robinarh
manager: AnnBe
ms.date: 08/16/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: ''
ms.search.scope: Core, Operations
ms.custom: ''
ms.search.region: Global
ms.author: ''
ms.search.validFrom: 2020-04-04
ms.dyn365.ops.version: 10.0.5
ms.openlocfilehash: b87a9b73f49e73fe13b98fb11da939c9b30e0f6e
ms.sourcegitcommit: 261b70ea358b2c231e20f320ed8bd6adc1e7d715
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2020
ms.locfileid: "3386534"
---
# <a name="scenario-setup-for-iot-intelligence"></a>IoT インテリジェンスのシナリオ設定

[!include [banner](../../includes/banner.md)]

このトピックでは、IoT インテリジェンスの Supply Chain Management のシナリオを構成する方法について説明します。 シナリオを設定する前に、[LCS を設定する](iot-lcs-setup.md)必要があります。

このトピックでは、マシンが停止した際に Supply Chain Management で通知を生成する、**装置のダウンタイム**のシナリオを構成します。

## <a name="configure-the-equipment-downtime-scenario-in-supply-chain-management"></a>Supply Chain Management における **装置のダウンタイム**シナリオの構成

**装置のダウンタイム** シナリオでは、パーツ アウト信号をマシンの警告しきい値にマッピングします。 シナリオでマシンが選択されていて、Supply Chain Management で動作するように設定されている場合にのみ、監視がされます。 マシンが最後に受信したパーツ アウト信号からの時間が、警告のしきい値よりも大きい場合、**マシンの停止** 通知がトリガーされます。 マシンがまだ動作している場合は、次の**パーツ アウト**信号を受け取ったときに、**マシンの起動**通知がトリガーされます。 マシンが 30 分間停止した場合は、新たな **マシンの停止** 通知がトリガーされます。

**装置のダウンタイム**のシナリオには、次のような依存関係があります:

+ 警告をトリガーするには、マッピングされたマシンで製造オーダーを実行する必要があります。
+ マッピングされたマシンのパーツ アウト信号を表す信号は、一意のプロパティ名で IoT ハブに送信する必要があります。
+ IoT ハブ メッセージに Unix ミリタイム スタンプ プロパティが存在する必要があります。

このシナリオを構成するには、次の手順に従います:

1. Supply Chain Management にログインします。
2. IoT インテリジェンス機能のフラグを有効化します。 詳細については [機能管理の概要](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) を参照してください。
3. メトリックを構成します。 構成方法の詳細については、[メトリックの構成方法](iot-metrics-setup.md#configure-metrics)を参照してください。
4. **生産管理**に移動します。
5. **設定 \> IoT インテリジェンス \> シナリオ管理** に移動します。
6. **装置のダウンタイム**タイルで **構成** をクリックします。 構成ウィザードで、**装置のセンサーのスキーマを定義する** ページが開きます。 ここでは、IoT メッセージの JSON 形式に合わせて Supply Chain Management のスキーマを設定することです。 複数のメッセージ スキーマを定義することができます。 詳細については、[IoT ハブが使用するメッセージス キーマの形式](iot-schema-format.md)を参照してください。 この例では、メッセージ ペイロードに次の形式のメッセージがまとめて含まれています:

    ```json
    {
        "timestamp": 1576016821614,
        "payload": [
            {
                "id": "IoTInt.Machine1225.PartOut",
                "timestamp": 1576016821614,
                "value": True
            },
            {
                "id": "IoTInt.Machine1226.PartOut",
                "timestamp": 1576016991616,
                "value": True
            }
        ]
    }
    ```

7. テーブルに行を追加します。

    1. **スキーマ名称**に **ID** を設定します。
    2. **スキーマのパス** に **/payload[\*]/id** を設定します。
    3. **メッセージ ID** に**説明**を設定します。

8. テーブルに行を追加します。

    1. **スキーマ名称**に **タイムスタンプ** を設定します。
    2. **スキーマのパス** に **/payload[\*]/timestamp** を設定します。
    3. **メッセージのタイムスタンプ** に**説明**を設定します。

9. テーブルに行を追加します。

    1. **スキーマ名称**に **値** を設定します。
    2. **スキーマのパス** に **/payload[\*]/value** を設定します。
    3. **メッセージの値** に**説明**を設定します。

    メッセージ内のすべてのプロパティを定義する必要はありません。必要なものだけを定義してください。 この例では、**ルート タイムスタンプ**の行を作成していません。 **ルート タイムスタンプ**のパスは **/timestamp** です。
  
10. **次へ** をクリックして、 **装置センサーのスキーマ マッピング** ページに移動し ます。
11. **装置リソース ID** の行で、**スキーマ名称** を **ID** に設定し ます。 有効な値が、ドロップダウン テーブルに表示されます。
12. **UTC 時間**の行で、**スキーマ名称**を **Timestamp** に設定し ます。 有効な値が、ドロップダウン テーブルに表示されます。
13. **パーツ生成信号** の行で、**スキーマ名称** を **値** に設定し ます。 有効な値が、ドロップダウン テーブルに表示されます。
14. **装置リソース ID の構成** ページで **次へ** をクリックします。
15. このステップでは、IoT ハブ メッセージの値を Supply Chain Management のリソースにマッピングします。

    1. **信号データ値の値** テーブルで、新たな行を追加し、**値**に **IoTInt.Machine1225.PartOut** を入力します。 **IoTInt.Machine1225.PartOut** の値は、IoT ハブ メッセージの JSON **id**プロパティから取得されます。
    2. **保存**をクリックします。
    3. **業務レコードのマッピング**テーブルで、**新規** をクリックします。 **業務レコード タイプ**の既定値は自動入力されるため、変更する必要はありません。
    4. **業務レコード**列で、この信号の値を送信する Supple Chain Management マシンのリソースを選択します。
    5. **保存**をクリックします。
    6. **Machine1226**に新たな業務レコード マッピングを追加し、これらの手順を繰り返します。 Supply Chain Management では、複数の信号データの値を 1 つのレコードにマッピングすることができます。

16. 処理するマシンを選択するには、**選択済** 列を使用します。 すべての信号の値を定義する必要はなく、すべてのマシンを選択する必要もありません。
17. **次へ**をクリックし て、**パーツ生成信号の構成**ページに移動します。
18. **信号データ値** テーブルで、行を追加し、**値**を **True** に設定します。 **True** の値は、IoT ハブ メッセージの JSON **値**プロパティから取得されます。 シナリオに必要な数だけ値を追加することができます。
19. **保存**をクリックします。
20. **次へ** をクリックして、 **装置ダウンタイムのしきい値** ページに移動し ます。 一覧に表示されているマシンは、既に信号の値にマッピングされているマシンです。 この手順では、マシンが停止しているかどうかを判断するしきい値を定義します。 たとえば、しきい値を 10 に設定した場合、10分間マシンからメッセージが出ていない場合は Supply Chain Management が通知が生成します。
21. **次へ** をクリックして **シナリオの有効化** ページに進みます。 スライダーを切替えてシナリオを有効化します。
22. **完了** をクリックします。

シナリオの設定が完了しました。 IoT インテリジェンスでは、IoT ハブ メッセージの処理が自動的に開始されます。

## <a name="configure-the-product-quality-scenario-in-supply-chain-management"></a>Supply Chain Management における **製品の品質**シナリオの構成

**製品の品質**シナリオでは、品目の属性が指定された範囲外の場合に通知を生成します。 たとえば、センサーで各品目の重量を IoT ハブに送信することができます。 Supply Chain Management では、品目が重すぎる、または軽すぎる場合に通知が生成されます。

このシナリオには、次のような依存関係があります:

+ 警告を発生させるには、マッピングされたマシンで製造オーダーを実行し、マッピングされたバッチ属性を持つ製品を生産する必要があります。
+ マッピングされたマシンのバッチ属を表す信号は、一意のプロパティ名で IoT ハブに送信する必要があります。
+ IoT ハブ メッセージに Unix ミリ秒のタイムスタンプ プロパティが存在する必要があります。

## <a name="configure-the-production-delays-scenario-in-supply-chain-management"></a>Supply Chain Management における **生産遅延**シナリオの構成

**生産遅延**シナリオでは、生産の処理能力がしきい値を下回った場合に通知が生成されます。 このシナリオでは、生産されたアイテムごとに **パーツアウト** 信号が IoT ハブに送信されます。 Supply Chain Managementでは、注文の遅延は、製造オーダーの実行がスケジュールされている期間、生成される品目の数、ジョブの実行期間、受信した**パーツアウトt**信号の数に基づいて計算されます。 ジョブに対する **パーツアウト** 信号の数が想定されるしきい値を下回った場合に、遅延通知が生成されます。

このシナリオには、次のような依存関係があります:

+ 警告をトリガーするには、マッピングされたマシンで製造オーダーが実行されている必要があります。
+ マッピングされたマシンのパーツ アウト信号を表す信号は、一意のプロパティ名で IoT ハブに送信する必要があります。
+ IoT ハブ メッセージに Unix ミリ秒のタイムスタンプ プロパティが存在する必要があります。

## <a name="how-to-disable-a-scenario"></a>シナリオを無効にする方法

次の手順に従い、シナリオを無効化します:

1. Supply Chain Management で、**生産管理 \> 設定 \> IoT インテリジェンス \> シナリオ管理** に移動します。
2. シナリオの **構成** をクリックします。
3. **次へ** をクリックし て、最後のウィザード タブを表示します。
4. スライダーを切替えてシナリオを無効化します。
