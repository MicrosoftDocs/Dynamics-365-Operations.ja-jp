---
title: 計画オーダーの確定
description: このトピックでは、計画オーダーを確定する方法について説明します。 計画オーダーが確定されると、それらは実際の発注書、移動オーダー、または製造オーダーになります。
author: ChristianRytt
ms.date: 04/22/2021
ms.search.form: ReqTransPo, ReqTransFirmLog
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: crytt
ms.search.validFrom: 2021-04-22
ms.dyn365.ops.version: 10.0.19
ms.openlocfilehash: a4f882f1abc9f758aca77b137b28aa973f925ea9
ms.sourcegitcommit: 08ce2a9ca1f02064beabfb9b228717d39882164b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/11/2021
ms.locfileid: "6019497"
---
# <a name="firm-planned-orders"></a>計画オーダーの確定

[!include [banner](../../includes/banner.md)]

計画オーダーは、マスター プラン プロセスの一部として *確定済* (つまり、リリース済) である必要があります。 計画オーダーが確定されると、それらは実際の発注書、移動オーダー、または製造オーダーになります。 これらの注文は、*リリース済注文* または *オープン注文* とも呼ばれます。

計画オーダーを確定するための 3 つの方法があります:

- **手動による確定** – 一覧で特定の計画オーダーを選択してから、手動でプロセスを開始します。
- **自動確定** – 補充グループ、個々の品目、および品目とマスター プランの組み合わせに対する既定の確定タイム フェンスを定義します。 その後、マスター プランの実行時に、注文日付が確定用に指定されたタイム フェンス内である場合は、計画オーダーが自動的に確定されます。
- **クエリベースの確定** – プロパティに基づいて計画オーダーを選択するクエリを定義します。 バッチ ジョブを設定して、定期的にクエリを実行し、一致する注文を確定できます。

このトピックでは、各方法について詳細に説明します。

## <a name="enable-the-features-that-are-described-in-this-topic"></a><a name="enable-features"></a>このトピックで説明されている機能を有効にする

計画オーダー機能のほとんどは、計画の最適化を使用する Microsoft Dynamics 365 Supply Chain Management のすべての標準インストールで利用できます。 ただし、このトピックで説明する機能のいくつかは、使用前に機能管理で有効にする必要があります。

### <a name="enable-parallelized-firming-of-planned-orders"></a>計画オーダーの確定並列化を有効にする

確定並列化により、複数のスレッド間で並列処理することで、確定プロセスの時間を高速化できます。 この方法は、多くの計画オーダーを確定する場合に便利です。

この機能をシステムで使用するには、[機能管理](../../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)に移動して、*計画オーダーの確定並列化* 機能を有効にします。

### <a name="enable-planned-order-firming-with-filtering"></a>フィルター処理を使用した計画オーダーの確定を有効にする

フィルター処理を使用した計画オーダーの確定により、確定する計画オーダーを選択するロジック基準を定義できます。 選択した計画オーダーをプレビューしたり、プロセスをバックグラウンドで実行したり、またはバッチ ジョブとしてスケジュールしたりもできます。

この機能をシステムで使用するには、[機能管理](../../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)に移動して、*フィルター処理を使用した計画オーダーの確定* 機能を有効にします。

### <a name="enable-auto-firming-for-planning-optimization"></a>計画最適化の自動確定を有効にする

自動確定により、計画オーダーを確定のタイム フェンス内でマスター プラン プロセスの一部として確定できます。 Supply Chain Management に組み込まれている計画エンジンでは、常に自動確定がサポートされています。 ただし、計画の最適化でも使用するには、この機能を有効にする必要があります。

この機能をシステムで使用するには、[機能管理](../../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)に移動して、*計画最適化の自動確定* 機能を有効にします。

## <a name="manually-firm-planned-orders"></a>計画オーダーを手動で確定する

計画オーダーを手動で確定するには、確定する計画オーダーを検索して選択してから、手動で確定プロセスを開始します。

1. [計画オーダー リスト ページを開きます](approved-planned-order.md#view-planned-orders)。
1. **フィルター** フィールド、**計画** フィールド、および列見出しを使用して一覧をフィルター処理および並べ替えをし、検索している計画オーダーを見つけられるようにします。
1. 確定する各計画オーダー明細行のチェック ボックスを選択します。 (適用したフィルターに基づいて) 現在ページに一覧表示されているすべての計画オーダーを確定する場合は、この手順を省略します。
1. アクション ウィンドウで、次のボタンのいずれかを選択します:

    - **確定** – 選択した計画オーダーのみを確定します。
    - **すべて確定** – 選択されたチェック ボックスに関係なく、(適用したフィルターに基づいて) 現在ページに一覧表示されているすべての計画オーダーを確定します。 このオプションは、多数の計画オーダーを確定する場合に役立ちます。

1. **確定** ダイアログ ボックスの、**パラメーター** クイック タブで、次のフィールドを設定します。 (これらのフィールドの多くは、**マスター プラン パラメーター** ページの **標準更新** タブから既定値を取得します。)

    - **マーキングの更新** – 計画オーダーの確定時に使用する在庫のマーキング ポリシーを選択します。
    - **エラーが発生した場合は確定を中止** – このオプションを *はい* に設定すると、計画オーダーの 1 つでエラーが発生した場合にすべての計画オーダーの確定が停止されます。 **確定並列化** オプションが *はい* に設定されている場合は、このオプションが *いいえ* に設定される必要があります。
    - **確定並列化** – このオプションは、システムで [*計画オーダーの確定並列化* 機能](#enable-features)が有効になっている場合、および確定する複数の計画オーダーを選択した場合にのみ使用できます。 確定プロセスを並列で実行するには、このオプションを *はい* に設定します。 確定並列化により、パフォーマンスが向上します。
    - **スレッド数** – このオプションは、システムで [*計画オーダーの確定並列化* 機能](#enable-features)が有効になっている場合、および **確定並列化** オプションを *はい* に設定した場合にのみ使用できます。 確定プロセスを並列化するのに使用するスレッドの数を入力します。 このオプションをマスター プランで使用する方法については、[マスター プランのパフォーマンスの改善](../master-planning-performance.md#number-of-threads)を参照してください。

        > [!NOTE]
        > **スレッド数** フィールドの *0* (ゼロ) の値により、マスター プランの実行時間が長くなります。 そのため、このフィールドに常に 0 より大きい値を設定することをお勧めします。

    - **仕入先ごとにグループ化** – このオプションを *はい* に設定すると、計画発注書がグループ化され、確定時に仕入先ごとに 1 つの発注書が作成されます。 また、1 つの発注書を作成し、その計画オーダーごとに 1 つの行があるようにすることもできます。
    - **購入担当者グループごとにグループ化** – このオプションを *はい* に設定すると、計画発注書がグループ化され、仕入先と購入担当者グループを組み合わせた 1 つの発注書が作成されます。 このオプションを使用するには、**仕入先ごとにグループ化** オプションも *はい* に設定する必要があります。
    - **期間ごとにグループ化** (**発注書** セクション) – 計画発注書をグループ化する期間を選択します。 このオプションを使用するには、**仕入先ごとにグループ化** オプションも選択する必要があります。
    - **期間ごとにグループ化** (**移動** セクション) – 移動オーダーをグループ化する期間を選択します。 注文は、**移動元倉庫** および **移動先倉庫** の値に基づいてグループ化されます。

    ![確定ダイアログ ボックスのパラメーター クイック タブ](./media/manual-firming.png "確定ダイアログ ボックスのパラメーター クイック タブ")

1. **バックグラウンドで実行** クイック タブで、ジョブを設定してバッチ モードで実行されるようにします。 ただし、手動で確定する場合は、繰り返しスケジュールを設定しても意味がありません。 これらのフィールドは、Supply Chain Management の他の種類の[バックグラウンド ジョブ](../../../fin-ops-core/dev-itpro/sysadmin/batch-processing-overview.md)と同様に機能します。 ただし、手動確定の場合、バッチ ジョブでは現在選択されている計画オーダーのみが処理されます。 ページで現在適用されているフィルターに適合する注文は処理されません。
1. **OK** を選択して設定を適用し、確定注文を生成します。

## <a name="auto-firm-planned-orders"></a>計画オーダーを自動確定する

自動確定を使用して、マスター プラン プロセスの一部として計画オーダーを確定できます。 補充グループ、個々の品目、および品目とマスター プランの組み合わせに対する既定の確定タイム フェンスを定義できます。 その後、マスター プランの実行時に、注文日付が確定用に指定されたタイム フェンス内である場合は、計画オーダーが自動的に確定されます。 計画の最適化と組み込みマスター プラン操作により生成される計画オーダーは、注文日 (開始日) を異なる方法で処理します。

> [!NOTE]
> 計画発注書の自動確定は、仕入先に関連付けられている品目に対してのみ発生します。
> 
> 確定された派生オーダー (つまり、外注発注書) は、変更追跡が有効になっている場合は、状態が *確認中* と表示されます。

> [!IMPORTANT]
> このセクションで説明されている機能を計画の最適化で使用する前に、このトピックで前述したように、システムで [*計画の最適化の自動確定* 機能](#enable-features)を有効にする必要があります。 自動確定は、常に組み込みマスター プラン エンジンで使用できます。

### <a name="auto-firming-with-planning-optimization-vs-the-built-in-planning-engine"></a>計画の最適化による自動確定と組み込み計画エンジンによる自動確定の比較

計画の最適化および組み込み計画エンジンの両方とも、計画オーダーの自動確定に使用できます。 ただし、重要な違いがいくつかあります。 たとえば、計画の最適化は注文日 (つまり、開始日) を使用して確定する計画オーダーを決定しますが、組み込み計画エンジンは、要求期日 (つまり、終了日) を使用します。 次の表では、違いについて要約します。

| | 計画の最適化 | 組み込み計画エンジン |
|---|---|---|
| **日付基準** | 自動確定は注文日 (開始日) に基づきます。 | 自動確定は要求期日 (終了日) に基づきます。 |
| **リード タイム** | 注文日 (開始日) によって確定がトリガーされるため、確定タイム フェンスの一部としてリード タイムを考慮する必要はありません。 | 注文が時間通りに確定されるようにするには、確定タイム フェンスはリード タイムよりも長くする必要があります。 |
| **現在の週の注文** | 現在の週に開始する必要があるすべての注文を確定するには、確定タイム フェンスを 1 週間にする必要があります。 | 現在の週に開始する必要があるすべての注文を確定するには、確定タイム フェンスはリードタイム + 1 週間にする必要があります。 |

### <a name="set-up-auto-firming-and-the-firming-time-fence"></a>自動確定および確定タイム フェンスを設定する

このセクションで後述するように、自動確定タイム フェンスを関連する補充設定に割り当てることにより、自動確定を有効にします。 補充設定に対して自動確定を有効になっていない場合、またはリリース済製品の **正味必要量** ページなど、特定のページから計画を開始している場合は、自動確定プロセスは省略されます。

自動確定のグループ化およびマーキング オプションでは、**マスター プラン パラメーター** ページの **標準更新** タブからその値を取得します。

自動確定タイム フェンスは、関連する補充設定に対して入力する日数により定義されます。 自動確定を有効にして、次の方法で確定タイム フェンスを制御できます。

- 補充グループの既定の確定タイム フェンスを定義するには、**マスター プラン \> 設定 \> 補充 \> 補充グループ** の順に移動し、補充グループを選択します。 次に、**その他** クイック タブの **自動確定タイム フェンス (日)** フィールドに、日数を入力します。
- 特定の品目の補充グループに対して定義されている確定タイム フェンスを上書きするには、**製品情報管理 \> リリース済製品** に移動します。 アクション ウィンドウで、**計画** を選択し、**品目補充** を選択します。 **一般** タブで、**タイム フェンスの上書き** を選択してから、**自動確定タイム フェンス (日)** フィールドに日数を入力します。
- 特定のマスター プランの補充グループおよび品目補充に対して定義される確定タイム フェンスを上書きするには、**マスター プラン \> 設定 \> マスター プラン** の順に移動し、マスター プランを選択します。 次に、**タイム フェンス (日数)** クイック タブで、**確定** オプションを *はい* に設定して、日数を入力します。

前述のタイム フェンスをすべて *0* (ゼロ) に設定すると、関連する補充済品目に対して自動確定は事実上無効になります。

## <a name="firm-planned-orders-by-using-a-query"></a>クエリを使用して計画オーダーを確定する

[!INCLUDE [preview-banner-section](../../../includes/preview-banner-section.md)]

クエリ ベースの確定により、事前に定義された基準に基づいて確定を計画できます。 自動確定とは異なり、クエリ ベースの確定では、異なる時点での注文の異なるサブセットの自動確定を実行できます。 また、手動または自動のいずれかの操作を使用して、さまざまなタイプの計画オーダーを確定できます。 設定に基づいて選択された確定注文をプレビューすることもできます。 したがって、選択内容が予想に適合していることを確認できます。

自動確定は、クエリ ベースの確定と組み合わせることができます。 たとえば、クエリ ベースの確定ジョブには、一致する自動確定補充コンフィギュレーションのタイム フェンスより長いフォワード タイム フェンスがあります。 したがって、クエリ ベースの確定ジョブは、自動確定がトリガーされる前に計画オーダーを処理します。 この動作を利用して、特定の仕入先への注文を、他の仕入先からの同様の製品の注文とは異なる方法でスケジュールできます。

> [!IMPORTANT]
> このセクションで説明されている機能を使用する前に、このトピックで前述したように、システムで [*フィルター処理を使用した計画オーダーの確定* 機能](#enable-features)を有効にする必要があります。

クエリ ベースの確定プロセスを使用して計画オーダーを確定するには、次の手順に従います。

1. **マスター プラン \> マスター プラン \> 実行 \> 計画オーダーの確定** の順に移動します。
1. **計画オーダーの確定** ダイアログ ボックスの、**パラメーター** クイック タブで、基本処理、マーキング、およびグループ化のオプションを設定します。 これらのオプションは、**確定** ダイアログ ボックスで実行するのと同様に機能します。 (説明については、前のセクションを参照してください。) 次に **計画** セクションで、**計画オーダーの確定** ダイアログ ボックスに固有である次のフィールドを設定します。

    - **計画** – このクエリによって検出される計画オーダーの確定時に適用するマスター プランを選択します。
    - **確定タイム フェンスの繰越日数** – さまざまな要件やその他の考慮事項を、将来どの程度までマスター プランで計算する必要があるかを選択します。
    - **確定タイム フェンスの逆算日数** – さまざまな要件やその他の考慮事項を、過去どの程度までマスター プランで計算する必要があるかを選択します。

    ![計画オーダーの確定ダイアログ ボックスのパラメーター クイック タブ](./media/planned-order-firming-main-1.png "計画オーダーの確定ダイアログ ボックスのパラメーター クイック タブ")

1. 注文に含めるレコードを指定するには、**対象に含めるレコード** クイック タブの **フィルター** ボタンを選択します。 標準クエリ ダイアログが表示され、選択基準、並べ替え基準、および結合を定義できます。 このフィールドは、Supply Chain Management の他の種類のクエリの実行と同様に機能します。 このフィールドは読み取り専用であり、クエリに関連する値を表示します。

    ![計画オーダーの確定ダイアログ ボックスの対象に含めるレコード クイック タブ](./media/planned-order-firming-main-2.png "計画オーダーの確定ダイアログ ボックスの対象に含めるレコード クイック タブ")

1. **プレビュー** を選択すると、これまでの設定に基づいて、確定注文の内容がプレビューできます。 確定される計画オーダーの一覧がメッセージとして表示されます。 その後、プレビューに意図したとおりに確定注文が表示されるまで、必要に応じて設定を調整できます。

    ![確定注文プレビューの例](./media/planned-order-firming-preview.png "確定注文プレビューの例")

    > [!WARNING]
    > この機能により、フィルター条件に一致するすべての計画オーダーが確定されます。 計画オーダーの無意味な確定によって、不要な購入、移動、および製造オーダーが大量に作成される可能性があります。 続行する前に、**プレビュー** ボタンを常に使用して、含めるレコードを検証します。

1. **バックグラウンドで実行** クイック タブで、バッチ モードで実行されるようにジョブを設定するか、定期的なスケジュールを設定します。 このフィールドは、Supply Chain Management の他の種類の[バックグラウンド ジョブ](../../../fin-ops-core/dev-itpro/sysadmin/batch-processing-overview.md)で実行されるのと同様に機能します。
1. **OK** を選択して設定を適用し、確定注文を生成します。

## <a name="track-firmed-orders"></a>確定注文を追跡する

確定された計画オーダーを追跡するには、次の手順に従います。

1. [計画オーダー リスト ページを開きます](approved-planned-order.md#view-planned-orders)。
1. 追跡する計画オーダーを開くか選択します。
1. アクション ペインウィンドウの **表示** タブの、**表示** グループで、**確定履歴** を選択します。

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
