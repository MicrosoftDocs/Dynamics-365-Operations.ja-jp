---
title: 小型パーセルの出荷
description: このトピックでは、小型パーセルの出荷 (SPS) 機能に関する情報を提供します。 この機能は、Microsoft Dynamics 365 Supply Chain Management を有効にして、梱包コンテナに関する詳細を配送業者に送信した後、配送業者から出荷ラベル、出荷レート、追跡番号を受け取ります。
author: Mirzaab
ms.date: 01/08/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: TMSRateEngine, TMSCarrier, CustTable, TMSShippingCarrierCustomerAccount, TMSSmallParcelShippingFeature
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2021-01-08
ms.dyn365.ops.version: Release 10.0.16
ms.openlocfilehash: d6b24446a5944eb82334dc5dc1f0b15656f83a12
ms.sourcegitcommit: c08a9d19eed1df03f32442ddb65a2adf1473d3b6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/06/2021
ms.locfileid: "6358029"
---
# <a name="small-parcel-shipping"></a>小型パーセルの出荷

[!include [banner](../../includes/banner.md)]

小型パーセルの出荷 (SPS) 機能により、Microsoft Dynamics 365 Supply Chain Management は配送業者 API を介した通信のフレームワークを提供することにより、出荷の配送業者と直接やり取りできます。 この機能は、コンテナの出荷かトラックより少ない (LTL) 出荷を使用する代わりに、個々の販売注文を業務用の配送業者経由で出荷する場合に役立ちます。

SPS 機能は、専用の *レート エンジン* を通じて配送業者とやりとりします。 配送業者または配送業者のサービスと協力して、このレート エンジンを開発している必要があります。 このレート エンジンは、Supply Chain Management を有効にして、梱包コンテナに関する詳細を配送業者に送信した後、配送業者から出荷ラベル、出荷レート、追跡番号を受け取ります。

返品される出荷レートは、関連付けられている販売注文に雑費として追加されます。 その後、返品された出荷ラベルは、Zebra Programming Language (ZPL) プリンターを使用して自動的に印刷され、出荷に適用されます。 配送業者は、倉庫で梱包を取り出す際に、この出荷ラベルをスキャンします。

## <a name="prepare-your-system-to-support-sps"></a>SPS をサポートするシステムの準備

SPS 機能を使用する前に、機能管理で SPS 機能を有効にし、レート エンジンを追加し、**輸送管理** モジュールと **倉庫管理** モジュールを設定して、それをサポートする必要があります。

### <a name="turn-on-the-sps-feature"></a>SPS 機能をオンにする

この SPS 機能を使用するには、システム上で有効化する必要があります。 管理者は、[機能の管理](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) ワークスペースを使用して、この機能の状態を確認し、必要に応じて有効にすることができます。 この機能は、次のようにして表示されます。

- **モジュール:** *輸送管理*
- **機能名:** *小型パーセルの出荷*

### <a name="deploy-and-set-up-rate-engines"></a>レート エンジンの配置と設定

Supply Chain Management にはレート エンジンは含まれていません。 必要なレートを取得または作成し、システムに追加する必要があります。 ただし、テスト用に使用できるデモ レート エンジンが Microsoft に提供されています。

#### <a name="download-and-deploy-the-demo-rate-engine"></a>デモ レート エンジンのダウンロードと配置

デモ レート エンジンを利用するには、次の手順に従います。

1. GitHub で、[デモ レート エンジン用の Dynamic-link ライブラリ (DLL)](https://github.com/microsoft/Dynamics-365-FastTrack-Implementation-Assets/tree/master/SCM/SPS) をダウンロードします。
1. Supply Chain Management サーバーで、DLL in the **\\AOSService\\PackagesLocalDirectory\\ApplicationSuite\\bin** フォルダに DLL を保存します。

#### <a name="create-and-deploy-functional-rate-engines"></a>機能レート エンジンを作成および配置する

生産環境またはテスト環境で使用できるような機能レート エンジンを作成して配置する方法については、次のトピックを参照してください。

- [新しい輸送管理エンジンの作成](../transportation/create-new-transportation-management-engine.md)
- [輸送管理エンジンの設定](/dynamicsax-2012/appuser-itpro/set-up-transportation-management-engines)

SPS レート エンジンの作成方法の詳細については、次のブログ投稿: [小型パーセルの出荷: Microsoft Dynamics 365 で小型パーセルの出荷の出荷機能を活用する方法](https://hub.bhsolutions.com/creating-a-mock-parcel-engine-in-d365?submissionGuid=46a1fccf-80b0-4b70-a6a0-4bf45a8756b5) を示しています。

#### <a name="set-up-a-rate-engine-in-supply-chain-management"></a>Supply Chain Management でのレート エンジンの設定

SPS のレート エンジンを作成して配置したら、次の手順に従ってセットアップします。

1. **輸送管理 \> 設定 \> エンジン \> レート エンジン** の順に移動します。
1. アクション ウィンドウで **新規** を選択して、行をグリッドに追加します。
1. 新しい行で、次のフィールドを設定します。

    - **評価エンジン** - レート エンジンの一意の名前を入力します。 デモ レート エンジンを使用している場合は、*デモ レート エンジン* を入力します。
    - **名前** - レート エンジンの簡単な説明を入力します。 デモ レート エンジンを使用している場合は、*デモ レート エンジン* を入力します。
    - **評価メタデータ ID** - レートの計算に使用する基準を選択します。 たとえば、レートが距離に基づいて計算される場合があります。 デモ レート エンジンを使用する場合は、このフィールドを空白のままにしておきます。
    - **エンジン アセンブリ** - 配置した DLL パッケージのファイル名を入力します。 デモ レート エンジンを使用している場合は、*TMSSmallParcelShippingEngine.dll* と入力します。
    - **エンジン クラス** - レート エンジンに対して設定されたクラス名を入力します。 デモ レート エンジンを使用している場合は、*TMSSmallParcelShippingEngine.SmallParcelShippingRateEngine* と入力します。

## <a name="example-scenario"></a>シナリオ例

このシナリオの例では、このトピックの説明に従って、システムを準備した後に SPS を設定して使用する方法を示します。 このシナリオでは、前述のデモ レート エンジンを使用します。

### <a name="make-demo-data-available"></a>デモ データを有効化する

ここで指定されたデモ レコードと値を使用してシナリオを実行するには、標準 [デモ データ](../../fin-ops-core/dev-itpro/deployment/deploy-demo-environment.md) がインストールされているシステムを使用する必要があります。 また、開始する前に **USMF** 法人を選択する必要があります。

### <a name="set-up-the-scenario"></a>シナリオを設定する

このシナリオの例では、デモの配送業者、配送業者グループ、梱包ポリシー、梱包プロファイルが必要です。 次のサブセクションでは、シナリオに必要なレコードの準備方法について説明します。 生産シナリオでは、一般に、ここで説明しているプロセスと似て設定プロセスが使用されます。 ただし、異なる値を設定します。

#### <a name="set-up-carriers"></a>配送業者の設定

配送業者を設定するには、次の手順に従います。

1. **輸送管理 \> 設定 \> 配送業者 \> 出荷の配送業者** に移動します。
1. アクション ペインで、**新規** を選択して、配送業者を追加します。
1. ヘッダーで、次の値を設定します。

    - **出荷の配送業者:** *デモ配送業者*
    - **名前:** *デモ配送業者*
    - **モード:** *陸送*

1. **概要** クイック タブで、次の値を設定します。

    - **出荷配送業者をアクティブにする:** *はい*
    - **配送業者評価をアクティブにする:** *はい*

1. **サービス** クイック タブで、**新規** を選択してグリッドにサービスを追加します。
1. 新しいサービスで、次の値を設定します。

    - **配送業者サービス:** *デモ配送業者サービス*
    - **名前:** *デモ配送業者サービス*
    - **輸送方法:** *陸送*

    必要に応じて、その他のすべてのフィールドに任意の値を入力します。 (新しい出荷の配送業者レコードを保存すると、新しい荷渡方法が作成され、**配送方法** フィールドは自動的に設定されます。)

1. **評価プロファイル** クイックタブで、**新規** を選択して、評価プロファイルをグリッドに追加します。
1. 新しいプロファイルで、次の値を設定します。

    - **評価プロファイル:** *デモ配送業者サービス*
    - **名前:** *デモ配送業者サービス*
    - **レート エンジン:** *デモ レート エンジン*

    必要に応じて、その他のすべてのフィールドに任意の値を入力します。

1. アクション ウィンドウで、**保存** を選択します。

配送業者の設定方法の詳細については、[出荷配送業者の設定](../transportation/tasks/set-up-shipping-carriers.md) を参照してください。

#### <a name="set-up-carrier-service-accounts"></a>配送業者サービス アカウントの設定

配送業者のサービス アカウントを設定するには、次の手順に従います。

1. **輸送管理 \> 設定 \> 評価 \> 配送業者サービスアカウント** の順に移動します。
1. アクション ペインで、**新規** を選択して、配送業者サービス アカウントを追加します。
1. 新しいアカウントで、次の値を設定します。

    - **出荷の配送業者:** *デモ配送業者*
    - **配送業者サービス:** *デモ配送業者サービス*
    - **配送業者の顧客アカウント番号:** 出荷の配送業者への接続を検証および認証するために使用される配送業者顧客アカウント番号。 あなたの配送業者がこの値を指定します。 デモ サービスを使用する場合は、任意の値を入力できます。
    - **サイト:** *6*
    - **倉庫:** *62*

    > [!NOTE]
    > 多くの場合、接続を認証するために必要な値は、**配送業者の顧客アカウント番号** の値のみです。 ただし、配送業者に認証パラメータを追加する必要がある場合は、必要に応じて組織でこのページをカスタマイズし、追加のフィールドを追加する必要があります。

#### <a name="set-up-a-container-packing-policy"></a>コンテナー梱包ポリシーの設定

コンテナー梱包ポリシーを設定するには、次の手順に従います。

1. ZPL プリンター定義をまだ設定していない場合は、ドキュメント ルート指定アプリケーションを使用して設定します。 詳細については、[ドキュメント印刷の概要](../../fin-ops-core/dev-itpro/analytics/print-documents.md) と関連トピックを参照してください。
1. **倉庫管理 \> 設定 \> コンテナ― \> コンテナ―梱包ポリシー** の順に移動します。
1. アクション ペインで、**新規** を選択して、コンテナー梱包ポリシーを追加します。
1. 新規ポリシーのヘッダーで、次の値を設定します。

    - **コンテナー梱包ポリシー:** *デモ梱包ポリシー*
    - **説明:** ポリシーの説明

1. **概要** クイック タブで、次の値を設定します。

    - **倉庫:** *62*
    - **最終出荷の既定の場所:** *Baydoor*
    - **重量単位:** *KG*
    - **コンテナーのクロージング ポリシー:** *自動リリース*
    - **コンテナー リリース ポリシー:** *最終的な出荷場所で使用可能にする*

1. **コンテナー マニフェスト** クイック タブで、次の値を設定します。

    - **コンテナーのクローズ時の自動マニフェスト:** *はい*
    - **コンテナーのマニフェスト要件:** *輸送管理*
    - **コンテナー内容の印刷:** *なし*

1. **配送業者ラベル印刷** クイック タブで、次の値を設定します。

    - **コンテナー出荷ラベルの印刷:** *常に*
    - **印刷名:** 出荷ラベルを印刷する ZPL プリンターの名前

#### <a name="set-up-a-packing-profile"></a>梱包プロファイルの設定

梱包プロファイルを設定するには、次の手順に従います。

1. **倉庫管理 \> 設定 \> 梱包 \> 梱包プロファイル** の順に移動します。
1. アクション ペインで、**新規** を選択して、梱包プロファイルをグリッドに追加します。
1. 新しいプロファイルで、次の値を設定します。

    - **梱包プロファイル ID:** *デモ梱包プロファイル*
    - **説明:** ポリシーの説明
    - **コンテナー梱包ポリシー:** *デモ梱包ポリシー*
    - **コンテナー ID モード:** *自動*
    - **コンテナー タイプ:** *SmallBox*

#### <a name="set-up-a-customer-to-use-the-sps-carrier"></a>SPS 配送業者を使用する顧客の設定

作成した配送業者を使用できるよう顧客を設定するには、次の手順に従います。

1. **売掛金勘定 \> 顧客 \> すべての顧客** の順に移動します。
1. グリッドで、顧客 *US-027* を見つけ、選択します。
1. アクション ペインで、**一般** タブの **設定** グループで、**配送業者顧客アカウント** を選択します。
1. **配送業者の顧客アカウント** ページで、アクション ペイン上で、**新規** を選択して、グリッドにアカウントを追加します。
1. 新しいアカウントで、次の値を設定します。

    - **出荷の配送業者:** *デモ配送業者*
    - **配送業者の顧客番号:** *12345* (このシナリオでは値の変更は重要ではなく、次のセクションで参照します。)

### <a name="go-through-the-example-scenario"></a>シナリオ例を確認する

前のセクションの説明に従ってサンプル データすべての設定が完了し、サンプル シナリオを実行できます。

#### <a name="create-a-sales-order-and-process-the-work"></a>販売注文を作成して、作業を処理する

これらの手順に従って、販売注文を作成します。

1. **販売とマーケティング \> 販売注文 \> すべての販売注文** の順に移動します。
1. **新規** を選択して新しい販売注文を作成します。
1. **販売注文の作成** ダイアログ ボックスで、**顧客アカウント** フィールドを、*US-027* に設定します。
1. **OK** を選択して販売注文を作成し、ダイアログ ボックスを閉じます。
1. 新しい販売注文が開かれます。 **販売注文ヘッダー** クイック タブで、**配送業者顧客勘定番号** フィールドを、先にこの顧客に対して選択した値 (*12345*) に設定します。
1. **販売注文明細行** セクションで、販売明細行を追加し、次の値を設定します。

    - **品目番号:** *A0002*
    - **数量:** *1*
    - **サイト:** *6*
    - **倉庫:** *62*

1. **ヘッダー** 表示に切り替えます。
1. **出荷** クイック タブで、次の値を設定します。

    - **出荷の配送業者:** *デモ配送業者*
    - **配送業者サービス:** *デモ配送業者サービス*

1. **明細行** ビューに戻ります。 販売明細行の配送方法を更新するように求めるメッセージが表示された場合は、**はい** を選択します。
1. **販売注文明細行** セクションで、上で設定した注文明細行を選択し、**在庫 \> 予約** を選択します。
1. **引当** ページで、**引当ロット** を選択して、選択した明細行の全数量を倉庫に引当します。
1. **引当** ページを閉じて、販売注文に戻ります。
1. アクション ウィンドウの **倉庫** タブで、**倉庫へのリリース** を選択します。

    ピッキング場所から梱包明細に品目を移動する作業が作成されます。

1. **販売注文明細行** セクションで、**倉庫 \> 出荷の詳細** を選択します。
1. **出荷の詳細** ページで、出荷 ID をメモします。 これは、梱包ステーションで出荷を梱包する際に必要となります。
1. **出荷の詳細** ページを閉じて、販売注文に戻ります。
1. 販売注文番号をメモしてから、**倉庫管理 \> 作業 \> すべての作業** に移動します。
1. 販売注文番号を使用して、注文に対して作成された作業を検索および選択します。
1. アクション ペインの、**作業** タブで、**作業の完了** を選択します。
1. **作業完了** ページで、**ユーザー ID** フィールドで、ユーザー ID を選択します。 その後、アクション ペインで、**作業の検証** を選択します。
1. その作業が検証を合格したら、アクション ペインで、**作業の完了** を選択します。

    梱包計画に対する品目の移動をシミュレートするために、作業が完了とマークされています。

#### <a name="pack-the-shipment"></a>出荷を梱包する

出荷を梱包するには、これらの手順に従います。

1. **倉庫管理 \> 設定 \> 作業者** の順に移動し、ユーザー アカウントが倉庫管理の作業者勘定に関連付けられていることを確認します。
1. **倉庫管理 \> 梱包とコンテナー詰め \> 梱包** の順に移動します。
1. **梱包ステーションの選択** ダイアログ ボックスで、次の値を設定します。

    - **サイト:** *6*
    - **倉庫:** *62*
    - **場所:** *梱包*
    - **梱包プロファイル ID:** *デモ梱包プロファイル*

1. **OK** を選択します。
1. **梱包** ページが表示されます。 生産のシナリオでは、作業員がライセンス プレートか出荷 ID をスキャンします。 ただし、このシナリオでは、**すべての出荷** ページを開き、作成した出荷の出荷番号を参照します。 次に、**梱包** ページの **ライセンス プレートまたは出荷** フィールドにこの値を入力します。 または、以前にメモした出荷 ID を入力します。
1. アクション ウィンドウで、**新規コンテナ―** を選択します。
1. 表示されるダイアログ ボックスには、新しいコンテナーに関する詳細が表示されます。 既定の値はそのままにして、**OK** を選択します。
1. **梱包** ページの **品目梱包** クイック タブの **ID** フィールドで、その品目を梱包する *A0002* を選択します。 品目がコンテナーに追加されます。
1. アクション ペインで、**出荷のコンテナー** を選択します。

    表示される **出荷のコンテナー** ページには、今作成したコンテナーの行があります。 ただし、配送業者からまだ出荷ラベルと追跡番号を受け取っていないので、その行の **コンテナのマニフェスト ID** フィールドは空白です。

1. アクション ウィンドウで、**コンテナ―を閉じる** を選択します。
1. **コンテナーを閉じる** ダイアログ ボックスで、**総重量** フィールドを *1 kg* に設定し、**OK** を選択します。

    先に選択した ZPL プリンターに出荷ラベルが印刷されます。 これは次の例に類似しているはずです。

    ![出荷ラベルの例。](media/sps-label-example.png "出荷ラベルの例")

1. **コンテナーのマニフェスト ID** と **運賃合計** の値が、配送業者から受信したとして追加されました。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]