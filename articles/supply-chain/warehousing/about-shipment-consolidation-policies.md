---
title: 出荷連結ポリシー
description: このトピックでは、出荷連結ポリシーの柔軟な構成を実現する機能の概要について説明します。
author: GarmMSFT
ms.date: 05/12/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: WHSShipConsolidationPolicy, WHSShipConsolidationWorkbench, WHSShipConsolidationError, WHSShipConsolidationSetShipment, WHSShipConsolidationPolicySelect, WHSShipPlanningListPage, TMSCarrierGroup, WHSShipConsolidationTemplate, WHSShipConsolidationTemplateApply, WHSShipConsolidationTemplateCreate
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-05-01
ms.dyn365.ops.version: 10.0.3
ms.openlocfilehash: 11ee4beefed02425d4650de3e896e608d3d00ef5
ms.sourcegitcommit: 3b87f042a7e97f72b5aa73bef186c5426b937fec
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/29/2021
ms.locfileid: "7577963"
---
# <a name="shipment-consolidation-policies"></a>出荷連結ポリシー

[!include [banner](../includes/banner.md)]

出荷連結ポリシーを使用した出荷連結のプロセスを使用することで、倉庫への自動リリースと手動リリースの処理にて自動出荷連結が可能となります。 この機能が導入される前の自動連結では、フィールドがハードコーディングされており、これは倉庫対して設定されていた **倉庫にリリースされた出荷を連結する** フィールドをベースにしていました。

出荷連結ポリシーは、次の機能に対して使用されます：

- 自動バッチジョブかされた「倉庫へのリリース」機能
- 販売注文または在庫の移管指示における **倉庫へのリリース** コマンド
- **倉庫へのリリース** 専用ページ
- **積荷計画ワークベンチ** ページ上の **倉庫へのリリース** コマンド
- **出荷の連結** と **出荷の連結ワークベンチ** ページ上での出荷の手動連結

出荷連結ポリシーが導入される前は、この連結機能は、倉庫レベルの設定メニューに存在していました。 倉庫が処理するあらゆる注文に対する連結要件の区別が困難な状態でした。 出荷連結ポリシーでは、組織によって異なる出荷連結要件を運用するシナリオに対応しています。

クエリは、適用される出荷統合ポリシーを特定するために使用され、編集可能な一連のフィールドによって、出荷レベルでの積荷ラインのグループ化が決定されます。 (このパターンは、ウェーブのテンプレートが従うパターンと共通しています) また、**既存の出荷を含む連結**  オプションが各ポリシーに追加されました。 このオプションをオンにすると、*倉庫へのリリース* の手順では、同じ連結ポリシーに基づいて作成された既存の出荷の中から連結対象の出荷を検索して、連結対象の出荷を検出します。 この場合、システムは新規出荷を作成するのではなく、既存の出荷または積荷を選択します。 ただし、システムでは、*未処理* 状態の既存の出荷のみを連結し、*リリース済* または "高" の状態となっているウェーブ リリースに属する出荷は、連結の対象とはなりません。

出荷の連結ポリシーを有効化すると、 これまで **倉庫** の設定ページで選択可能となっていた、**倉庫にリリースされた出荷を連結する** の設定が非表示になります。 新たな出荷連結機能への移行を簡易化する目的で、**出荷連結ポリシー** ページの機能によって、既存の倉庫の古い設定を自動的に含む既定のポリシーが作成されます。 既定のポリシーが作成されると、 **在庫** の設定ページ内の **倉庫にリリースされた出荷を連結する** 設定が反映されなくなります。

**倉庫へのリリース** ページを使用すると、フルフィルメント ポリシーを上書きするのと同じ方法で、該当する連結ポリシーを手動で上書きできます。

**積荷計画ワークベンチ** ページの **リリース \>倉庫へのリリース** コマンドを使用することで、倉庫へのリリースを行う前に、販売注文と在庫移動指示明細に基づいて出荷積荷を作成することができます。 これらの積荷は、出荷ポリシーの連結と共に導入されたものと同じ連結ロジックを使用しています。

**出荷連結ワークベンチ** ページを使用して、既に倉庫にリリースされている未確定の既存の出荷を連結することができます。 この機能は、独自の出荷連結を含む自動リリースプロセスが1日に複数回実行されるケースで、かつ確認プロセス中に運送業者への出荷完了前に、追加の連結が手動で識別される可能性があるシナリオに対応します。 この機能を使用すると、販売注文または在庫移動指示明細から作成された出荷積荷を、倉庫にリリースされてから出荷が確定する前の任意のタイミングでまとめて出荷することができます。

**出荷統合ワークベンチ** ページでは、複数の出荷を同時に評価して、特定の出荷に非連結注文を割り当てることができる積荷構築ワークベンチと同様に機能します。 出荷連結テンプレートを適用して、提案された連結を複数回評価して確認することができます。 一部のルールは、許可されていない連結を防止し、エラーの発生を警告する目的で使用されます。

## <a name="overview-of-new-functionality"></a>新しい機能の概要

このセクションでは、*出荷連結ポリシー* 機能を有効化して使用する際に変更あるいは追加される、ページ、コマンド、機能について説明します。

### <a name="shipment-consolidation-policies-page"></a>出荷連結方針のページ

ポリシーは、作業指示のタイプ別に区別されます。 **販売注文** のタイプは _販売注文_ の出荷を表し、**在庫の移管指示** のタイプは _移管の発令_ の出荷を表します。

すべての出荷連結ポリシーには、適用のタイミングを定義するクエリと、実行順序を決定するシーケンス番号があります。 連結は、選択したフィールドの一意の組み合わせごとに適用されます。 追加されたパラメータは、既存の (オープンな) 出荷との連結に使用されます。 このポリシーは、ウェーブ処理の前に新規出荷が作成されるたびに評価され、適用されます。

ポリシーに必須のフィールドがない場合、または禁止されているフィールドが含まれている場合、そのポリシーは **選択済** セクションで [無効] としてマークされ ます。 必須フィールドと禁止フィールドの一覧はハードコーディングされており、拡張することができます。

以下のリストに、必須のフィールドを示します。 出荷は常にこれらのフィールドに基づいて分割されるため、これらフィールドに異なる値を持つ複数の出荷をグループ化することはできません。

- 販売注文用:

    - **アカウント番号 :**_WHSShipmentTable.AccountNum_
    - **配送の受取人 :**_WHSShipmentTable.DeliveryName_
    - **住所 (RecId) :**_WHSShipmentTable.DeliveryPostalAddress_
    - **倉庫 :**_WHSShipmentTable.InventLocationId_

- 在庫の移管指示:

    - **起点倉庫 :**_InventTransferTable.InventLocationIdFrom_
    - **宛先倉庫 :**_InventTransferTable.InventLocationIdTo_

以下のフィールドは、ドキュメント タイプによっては使用できない場合があります。 以下のフィールドはユーザー インターフェイス (UI) 上には表示されず、また、連結に使用することもできません。

- **出荷ID :**_WHSShipmentTable.ShipmentId_
- **状態 :**_WHSShipmentTable.ShipmentStatus_
- **出荷連結ポリシー :**_WHSShipmentTable.ShipConsolidationPolicyName_
- **作業トランザクション タイプ :**_WHSShipmentTable.WorkTransType_
- **ウェーブ ID :**_WHSShipmentTable.WaveId_
- **積荷 ID :**_WHSShipmentTable.LoadId_
- **出荷 ID :**_WHSLoadLine.ShipmentId_
- **積荷 ID :**_WHSLoadLine.LoadId_

既定では、ポリシーを作成すると、一連の必須フィールドが連結フィールドとして使用されます。 ただし、一覧を変更するには、左方向ボタンや右方向キーを使用してください。 (このプロセスは、ウェーブのテンプレートでメソッドを選択するプロセスと共通しています)

これらのフィールドに対してユーザーが選択した値は、新たに作成されたすべての出荷に対して使用されるか、これらの出荷との連結時に既存の出荷に追加されます。 2 つの出荷が、それら出荷の連結を目的として選択されたフィールドで同じ値を持っている場合、その出荷は連結されます。 選択されたすべての連結フィールドにこれと同じ原則が適用されます。 値が異なる場合は、2つ目の出荷が破棄され、新たな出荷に対して選択されます。 自動連結のプロセスでは、出荷連結フィールドの値のすべての一意の組み合わせを作成し、続いて関連する組み合わせに出荷を割り当てます。

連結のプロセスでは、未選択のフィールドは無視されます。 2つの出荷で選択したフィールドの値が異なる場合、フィールドはクリアされます (空白になります)。 選択されていないフィールドに対して両方の出荷の値が同じ場合、このフィールドには値が入力されます。

連結フィールドの一覧 (値が異なる場合にクリアされるフィールド) はハードコーディングされています。 この一覧には、新たな出荷が作成されたときに販売注文または在庫移動指示明細によって初期化されたすべてのフィールドが含まれます。 つまり、販売注文または在庫移動指示明細によって初期化されないフィールドは、既存の出荷に新たなデータが追加された場合は無視されます。

### <a name="release-to-warehouse-page"></a>倉庫へのリリース ページ

- グリッドの下部にある新規フィールドには、適用された連結ポリシーが表示されます。
- 新しいボタンを使用すると、連結ポリシーを手動で選択したり、上書きすることができます。

### <a name="release-to-warehouse-command-on-the-load-planning-workbench-page"></a>[積荷計画ワークベンチ] ページ上の [倉庫へのリリース] コマンド

- 適用された連結ポリシーが使用されるようにロジックが調整されました。
- このリリースでは、出荷が1つの積荷内でのみ連結されるようになりました。

### <a name="consolidate-shipments-page"></a>出荷の連結ページ

- 類似性のある出荷 (連結の候補) の検索については、出荷連結ポリシーで選択されたフィールドを使用するように変更されました。
- 出荷ごとに値が異なるフィールドには、空白が設定されます。 (これまでは、選択された "基本" 出荷の値が使用されていました。)

### <a name="shipment-consolidation-workbench-page"></a>出荷連結ワークベンチのページ

- 新しい機能では、手動による連結のプロセスをより大きな規模で繰り返すことができます。
- このリリースでは、このページを **倉庫管理** モジュールの **倉庫へのリリース** メニューから開くことができます。
- このアルゴリズムは、未出荷の既存の出荷を分析します。 続いて、連結ポリシーで選択されたフィールドに基づいて連結を提案します。

## <a name="comparison-of-functionality"></a>機能の比較

以下の表では、出荷連結ポリシーを使用していない場合、あるいは使用する場合に、出荷連結がどのように機能するかをまとめています。

| 出荷連結方針を使用しない | 出荷連結方針を使用する |
|---|----|
| 該当なし | 連結対象として選択されている販売注文または在庫移動指示の出荷は、作成される出荷と同一の連結ポリシーを使用するか、または、オープン出荷に割り当てられている必要があります(**既存の出荷と連結** オプションがオンになっている場合)。 |
| *倉庫へのリリース* の手順では、既存の出荷を検索して連結の対象とする出荷を検索することはできません。 *倉庫へのリリース* の手順では、現行のインスタンスが作成した出荷のみが、連結に使用する出荷の検索に使用することができます。 | 現在使用されている連結ポリシーで **既存の出荷と連結** オプションがオンになっている場合、*倉庫へのリリース* の手順では、同じ連結ポリシーに基づいて作成された既存の出荷の中から連結対象の出荷を検索して、連結対象の出荷を検出します。 そのため、2つのポリシーが存在する場合、ポリシー 2 に基づいて作成された出荷は、ポリシー 1 に基づいて作成された出荷とは連結されません。 |
| 該当なし | 連結ポリシー フィールドの一覧が空の場合、またはポリシーが見つからない場合は、販売注文または在庫移動指示明細ごとに新たな出荷が作成されます。 |
| 以下の連結フィールドは、 *在庫移動明細* の出荷の連結に使用される固有の値の組み合わせを定義しています。 (ここに記載されていないすべてのフィールドは無視されます)<ul><li>注文番号 (OrderNum)</li></ul> | 以下の連結フィールドは、 *在庫移動明細* の出荷の連結に使用される固有の値の組み合わせを定義しています。 (ここに記載されていないすべてのフィールドは無視されます)<ul><li>注文番号 (OrderNum)</li><li>配送先の受取人 (DeliveryName)</li><li>配送先住所 (DeliveryPostalAddress)</li><li>ISO 国 コード (CountryRegionISOCode)</li><li>住所 (Address)</li><li>サイト (InventSiteId)</li><li>倉庫 (InventLocationId)</li><li>配送業者 (CarrierCode)</li><li>配送業者サービス (CarrierServiceCode)</li><li>配送方法 (ModeCode)</li><li>配送業者グループ (CarrierGroupCode)</li><li>配送条件 (DlvTermId)</li></ul>これらのフィールドは、新たな出荷を作成する際に使用可能となり、初期化される唯一のフィールドです。 |
| 以下の連結フィールドは、 *販売明細* の出荷の連結に使用される固有の値の組み合わせを定義しています。 (ここに記載されていないすべてのフィールドは無視されます)<ul><li>注文番号 (OrderNum)</li><li>顧客の参照情報 (CustomerRef)</li><li>顧客要件 (CustomerReq)</li><li>配送条件 (DlvTermId)</li></ul> | 以下の連結フィールドは、 *販売明細* の出荷の連結に使用される固有の値の組み合わせを定義しています。 (ここに記載されていないすべてのフィールドは無視されます)<ul><li>注文番号 (OrderNum)</li><li>アカウント番号 (AccountNum)</li><li>配送先の受取人 (DeliveryName)</li><li>配送先住所 (DeliveryPostalAddress)</li><li>ISO 国 コード (CountryRegionISOCode)</li><li>住所 (Address)</li><li>サイト (InventSiteId)</li><li>倉庫 (InventLocationId)</li><li>配送業者 (CarrierCode)</li><li>配送業者サービス (CarrierServiceCode)</li><li>配送方法 (ModeCode)</li><li>配送業者グループ (CarrierGroupCode)</li><li>ブローカー ID (BrokerCode)</li><li>指示 (LoadDirection)</li><li>配送条件 (DlvTermId)</li><li>顧客の参照情報 (CustomerRef)</li><li>顧客要件 (CustomerReq)</li></ul>これらのフィールドは、新たな出荷を作成する際に使用可能となり、初期化される唯一のフィールドです。 |
| 該当なし | *販売明細* では次の連結フィールドが必須となっており、削除することはできません。<ul><li>アカウント番号 (AccountNum)</li><li>配送先の受取人 (DeliveryName)</li><li>配送先住所 (DeliveryPostalAddress)</li><li>倉庫 (InventLocationId)</li></ul>既定では、これらのフィールドは、新しいポリシーが作成される際に割り当てられます。 これらを削除することはできません。 |
| **積荷計画ワークベンチ** ページの *倉庫の積荷のリリース* を使用すると、出荷とウェーブを作成する独立したコードが使用されます。 | 連結の評価がされるフィールドの決定には、出荷連結ポリシーが適用されます。 出荷は1つの積荷内でのみ連結されます。 |
| **すべての出荷** ページで **出荷の連結** を手動で選択し、続いて対象の "基本" の出荷を選択します。 複数のキー フィールドに一致する値を持つ既存の出荷がすべて提案されます。 | **すべての出荷** ページで **出荷の連結** を手動で選択し、続いて対象の "基本" の出荷を選択します。 システムでは、関連する出荷連結ポリシーに対して構成されているいくつかの主要なフィールドの値を照合することで、既存の出荷を提案します。 |
| **すべての出荷** ページの **出荷の連結** コマンドは、1つの出荷に対してのみ使用できます。 | **出荷連ワークベンチ** ページでは、未出荷状態の出荷の組み合わせを簡単に見つけることができます。 これらの出荷は、出荷連結ポリシーで構成されているいくつかのキーフィールドに基づいて分析されます。 連結をするにあたっては、これらフィールドの値が一致している出荷が提案されます。<p>提案された連結から出荷を削除、追加することによって、手動で連結を管理することも可能です。 いくつかのタイプのエラーが発生する場合がありますが、オーバーライドが可能な場合があります。</p> |
| **デザイン ノート :** *倉庫間の販売注文の自動リリース* では、販売明細行がグループに分割されます。 各グループは、固有の **ReleaseToWarehouseId** 値を持ち、 *倉庫へのリリース* の手順によって個別処理されます。 この手順では、ワーク ブレイクの設定に関わらず、新規作業を作成します。 | **デザイン ノート :** *販売注文の倉庫への自動リリース* では、同一の **ReleaseToWarehouseId** 値が処理中のすべての販売明細行に割り当てられます。 すべての販売明細行は、*倉庫へのリリース* 手順で同時に処理されます。 以前の動作を実現するには、出荷 ID ごとにワーク ブレイクを構成する必要があります。 |

## <a name="additional-resources"></a>追加リソース

- [出荷連結ポリシーを構成する](configure-shipment-consolidation-policies.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]