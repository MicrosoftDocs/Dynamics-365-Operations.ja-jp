---
title: Power Apps からキャンバス アプリを埋め込む
description: このトピックでは、Microsoft Power Apps のキャンバス アプリをクライアントに埋め込み、製品の機能を拡張する方法について説明します。
author: jasongre
ms.date: 08/09/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: FormRunConfigurationAddPAControl, FormRunConfigurationEditPAControl
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2018-02-28
ms.dyn365.ops.version: Platform update 14
ms.openlocfilehash: 37ef6101a5a69e9c820347dd6f61c987467d40b3
ms.sourcegitcommit: b9c2798aa994e1526d1c50726f807e6335885e1a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/13/2021
ms.locfileid: "7344532"
---
# <a name="embed-canvas-apps-from-power-apps"></a>Power Apps からキャンバス アプリを埋め込む

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]

Microsoft Power Apps は開発者と技術者以外のユーザーがコードを記述せずにモバイル デバイス、タブレット、および Web 用のカスタム ビジネス アプリを構築できるようにするサービスです。 Finance and Operations アプリは Power Apps との統合をサポートします。 ユーザー、組織、またはより幅広いエコシステムが開発するキャンバス アプリは、製品の機能を拡張するために Finance and Operations アプリに組み込むことができます。 たとえば、別のシステムから取得した情報で Finance and Operations アプリを補完するために、Power Apps からキャンバス アプリを構築できます。

キャンバス アプリの埋め込みに関する詳細については、[キャンバス アプリを組み込む方法](https://www.youtube.com/watch?v=x3qyA1bH-NY) のショート ビデオをご覧ください。

## <a name="adding-an-embedded-canvas-app-from-power-apps-to-a-page"></a>埋め込みキャンバス アプリを Power Apps からページに追加する

Power Apps からクライアントにキャンバス アプリを埋め込む前に、目的のビジュアルまたは機能を備えたアプリを見つけるか構築する必要があります。 このトピックには、アプリを構築するプロセスの詳細な説明は含まれていません。 初めて Power Apps を使用する場合は、[Power Apps ドキュメント](/powerapps/) を参照してください。

キャンバス アプリを Finance and Operations アプリに埋め込む方法は 3 つあります。 シナリオに最適なアプローチを使用できます。 

- ページの標準アクション ペインの **Power Apps** ボタンにキャンバス アプリを埋め込む。 この方法で追加したアプリは **Power Apps** メニュー ボタンの項目として表示され、アプリはサイド ペインに開きます。 
- 既存のページに、キャンバス アプリを新しいタブ ページ (ピボット タブ、クイック タブ、ブレード、またはワークスペースのセクション) として埋め込む。
- ダッシュボードから、キャンバス アプリの新しいフル ページ エクスペリエンスを作成する。

埋め込みキャンバス アプリを構成するときに、アプリへのコンテキストとして送信する単一のフィールドを選択できます。 この手順により、現在表示しているデータに基づいてアプリが応答できるようになります。

> [!NOTE]
> このメカニズムを使用してモデル駆動型アプリを埋め込むことはできません。

### <a name="embedding-a-canvas-app-on-an-existing-page"></a>既存のページにキャンバス アプリを埋め込む

次の手順では、Power Apps から既存のページにキャンバス アプリを埋め込む方法を示します。

1. キャンバス アプリを埋め込むページに移動します。 このページは、入力としてアプリに渡す必要があるデータを含むページです。
2. **Power Apps からアプリを追加** ウィンドウを開きます。

    - ページにアプリを直接埋め込む場合は、**オプション** \> **このページのパーソナライズ** \> **詳細** を選択し、次のいずれかの手順に従います:

        - **フル ページ アプリ** 機能が有効になっている場合は、**ページの追加** を選択し、アプリを追加したい地域を選択します。 **Power Apps** メニュー ボタンにアプリを埋め込むには、アクション ペインを選択します。 ページに直接アプリを埋め込むには、適切なタブ、クイック タブ、ブレード、またはセクション (ワークスペースにいる場合) を選択します。 次に、**アプリを追加** ペインで、**Power Apps** を選択します。
        - **フル ページ アプリ** 機能が無効になっている場合は、**Power Apps からアプリを追加** を選択し、アプリを追加したい地域を選択します。 **Power Apps** メニュー ボタンにアプリを埋め込むには、アクション ペインを選択します。 ページに直接アプリを埋め込むには、適切なタブ、クイック タブ、ブレード、またはセクション (ワークスペースにいる場合) を選択します。

    - **Power Apps** メニュー ボタンを使用してアプリにアクセスする場合、標準のアクション ペインの **Power Apps** メニュー ボタンをクリックし、**アプリの追加** を選択します。

3. 埋め込み型アプリを構成します。 詳細については、このトピック後述の[キャンバス アプリを構成する](#configuring-a-canvas-app)を参照してください。
4. 構成が正しいことを確認した後、**挿入** を選択します。

    - **保存されたビュー** 機能を無効にした場合、埋め込みアプリを表示するためにブラウザを更新するよう求められます。
    - **保存されたビュー** 機能を有効にした場合、変更を保持するためにビューを保存する必要があります。

### <a name="embedding-a-canvas-app-as-a-full-page-experience-from-the-dashboard"></a>ダッシュボードからのフル ページ エクスペリエンスとしてキャンバス アプリを埋め込む

アプリが既存のページに関連していない場合や、Finance and Operations アプリ内でフル ページ エクスペリエンスとして表面化したいだけの場合に、ダッシュボードからキャンバス アプリを埋め込むことができます。

> [!NOTE]
> この機能を使用可能にするには、機能管理の **フル ページ アプリ** 機能を有効にする必要があります。 

1. ダッシュボードを開きます。
2. ページを選択したまま (または右クリック) にしてから、**個人設定** を選択して、**ページを追加** を選択します。
3. **ページを追加** ウィンドウで **Power Apps** を選択します。
4. 埋め込み型アプリを構成します。 詳細については、このトピック後述の[キャンバス アプリを構成する](#configuring-a-canvas-app)を参照してください。
5. **保存** を選択して、アプリを新しいタイルとしてダッシュボードに追加します。
6. ダッシュボードの新しいタイルを選択し、キャンバス アプリが予定通り表示されるかを確認します。

### <a name="configuring-a-canvas-app"></a>キャンバス アプリを構成する

キャンバス アプリを埋め込む際は、次のパラメーターを設定する必要があります:

- **名前** – 埋め込みアプリを含めるタブまたはボタンに表示するテキストを入力します。 多くの場合、このフィールドでアプリの名前を繰り返すことができます。
- **アプリ ID** – 埋め込むキャンバス アプリのグローバル一意識別子 (GUID) を指定します。 この値を取得するには、[make.powerapps.com](https://make.powerapps.com) でアプリを検索し、**詳細** の **アプリ ID** フィールドを確認します。
- **アプリのコンテキストを入力する** – 必要に応じて、アプリに入力として渡すデータが含まれているフィールドを選択することができます。 アプリが Finance and Operations アプリから送信されるデータにアクセスする方法の詳細については、このトピックの後半の [Finance and Operations アプリから送信されたデータを活用するアプリの構築](#building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps)のセクションを参照してください。

    バージョン 10.0.19 では、現在の法人も **cmp** URL パラメーターを介してコンテキストとしてキャンバス アプリに渡されます。 この動作は、ターゲットのキャンバス アプリが情報を使用するまでアプリには影響しません。

- **アプリケーション サイズ** – 埋め込むアプリのタイプを選択します。 モバイル デバイス用に作成されたアプリに対しては **シン** を選択し、タブレット用に作成されたアプリに対しては **ワイド** を選択します。 このパラメーターにより、埋め込みアプリに十分な容量を確保できます。
- **法人** – アプリを使用できる法人を選択できます。 既定では、すべての法人がアプリを使用できます。 このオプションは、既存のページに直接埋め込み、**[保存されているビュー](saved-views.md)** 機能が無効になっている場合にのみ使用できます。

## <a name="sharing-an-embedded-app"></a>埋め込まれたアプリの共有

ページにキャンバス アプリを埋め込み、正しく動作することを確認したら、システム内の他のユーザーとアプリを共有できます。 埋め込みキャンバス アプリを共有するには、次の手順を実行します。

1. 適切なユーザーと[Power Apps でキャンバス アプリを共有](/powerapps/maker/canvas-apps/share-app)して、 Power Apps から直接アプリにアクセスできるようにします。
2. 埋め込みアプリに関連付けられた個人用設定を、目的のユーザーと共有します。 次のアプローチのいずれかを使用できます:

    - **ビューを公開する (推奨):** **[保存されているビュー](saved-views.md)** 機能が有効な場合、推奨される方法は、埋め込みキャンバス アプリを含むビューを作成し、目的のユーザーに公開することです。 このアプローチを使用すると、公開されたビューの対象となるセキュリティ ロールを持つすべてのユーザーがページ上でキャンバス アプリを確認できるようになります。

        ダッシュボードからフル ページ エクスペリエンスとして埋め込まれたキャンバス アプリを公開することもできます。 ダッシュボードで、アプリに関連付けられているタイルを選択したまま (または右クリック) にして、**個人用設定** を選択してから、**ページを公開する** を選択します。 *ビューの公開* エクスペリエンスと似たエクスペリエンスが表示され、公開するセキュリティ ロールを選択できます。 更新プログラム 10.0.21 以降で、**保存されたビューに対する改善された法人サポート** が有効になっている場合は、目的の法人にアプリを公開することもできます。

    - **保存されているビュー** 機能を無効にした場合、システム管理者は、**個人用設定** ページでキャンバス アプリを含む個人用設定を適切な一連のユーザーに与えることができます。 また、ページの個人用設定をエクスポートして、1 人または複数のユーザーに送信することもできます。 これらの各ユーザーは、個人用設定をインポートできます。 個人用設定のツールバーには、個人用設定をエクスポートおよびインポートするためのボタンがあります。

> [!NOTE]
> キャンバス アプリが外部ユーザーと共有されている場合、これらのユーザーは、Finance and Operations アプリ内の埋め込みアプリを使用できません。 ただし、Power Apps 内でアプリに直接アクセスできます。 外部ユーザーには、Finance and Operations アプリが配置されている Microsoft 365 Azure ディレクトリに属さないゲストとユーザーが含まれます。

製品での個人用設定の機能について、およびそれらの使用方法の詳細については、[ユーザー エクスペリエンスのパーソナライズ](personalize-user-experience.md) を参照してください。

## <a name="building-a-canvas-app-that-uses-data-that-is-sent-from-finance-and-operations-apps"></a>Finance and Operations アプリから送信されるデータを使用するキャンバス アプリの構築

Finance and Operations アプリに埋め込まれるキャンバス アプリを構築する場合、プロセスの重要な部分の 1 つは、Finance and Operations アプリからの入力データを使用することです。 Power Apps 開発経験から、Finance and Operations アプリから渡される入力データには、**Param("EntityId")** 変数を使用してアクセスできます。 また、バージョン 10.0.19 以降、現在の法人も **Param("cmp")** 変数を介してコンテキストとしてキャンバス アプリに渡されます。 

たとえば、アプリの OnStart 機能では、Finance and Operations アプリから次のような変数に入力データを設定することができます。

``` Power Apps
If(!IsBlank(Param("EntityId")), Set(FinOpsInput, Param("EntityId")), Set(FinOpsInput, ""));

If(!IsBlank(Param("cmp")), Set(FinOpsLegalEntity, Param("cmp")), Set(FinOpsLegalEntity, ""));
```

## <a name="viewing-a-canvas-app"></a>キャンバス アプリの表示

Finance and Operations アプリのページに埋め込みキャンバス アプリを表示するには、埋め込みアプリがあるページに移動するだけです。 標準アクション ペインの **Power Apps** ボタンを使用してアプリにアクセスできることに注意してください。 または、新しいタブ、クイック タブ、あるいはブレードとして、またはワークスペースの新しいセクションとしてページに直接表示することもできます。 ユーザーがページに最初にアプリを読み込もうとすると、サインインするように求められます。 この手順により、ユーザーはアプリを使用するための適切なアクセス許可を持っていることを確認します。

## <a name="editing-an-embedded-app"></a>埋め込まれたアプリの編集

アプリがページに埋め込まれた後、そのアプリの設定をいくつか変更する必要がある場合があります。 たとえば、埋め込まれたアプリに関連付けられたラベルを変更したり、アプリの新しいバージョンが作成された場合に、アプリ ID を最新の時点のものに更新したりする必要があります。

埋め込まれたアプリのコンフィギュレーションを編集するには、次の手順に従います。

1. **アプリの編集** ウインドウに移動します。

    - 埋め込みアプリが Power Apps メニュー ボタンによりアクセスされた場合、Power Apps メニュー ボタンを選択したまま (または右クリック) にし、**パーソナライズ** を選択します。 **アプリの選択** ドロップダウン メニューから構成するアプリを選択します。
    - 埋め込み型のアプリがページに直接表示されたら、**オプション** を選択し、**このページのパーソナライズ** を選択します。 **選択** ツールを使用し、埋め込まれたアプリをクリックします。
    - 埋め込みアプリがダッシュボードから追加された場合は、ダッシュボードを開き、そのキャンバス アプリに関連付けられているタイルを選択したまま (または右クリック) にし、**パーソナライズ** を選択して、**ページの編集** を選択します。

2. アプリ コンフィギュレーションに必要な変更を行ない、**保存** をクリックします。

## <a name="removing-an-app"></a>アプリの削除

アプリがページに埋め込まれた後、必要に応じて削除するにはいくつかの方法があります。

- このトピックの前半にある [埋め込みアプリの編集](#editing-an-embedded-app) セクションからの手順を使用して、**アプリの編集** ウィンドウに移動します。 ウィンドウに、削除する埋め込み型アプリの情報が表示されていることを確認してから、**削除** ボタンをクリックします。
- 埋め込みアプリがダッシュボードから追加された場合は、ダッシュボードを開き、そのキャンバス アプリに関連付けられているタイルを選択したまま (または右クリック) にし、**パーソナライズ** を選択して、**ページの削除** を選択します。 
- 埋め込まれたアプリは、個人用設定データとして保存されるため、ページの個人用設定をクリアすると、そのページの埋め込まれたアプリも削除されます。 ページの個人用設定をクリアするのは、永久的なもので元に戻すことはできないことに注意してください。 ページの個人用設定を削除するには、**オプション** を選択して **このページのパーソナライズ**、最後に **クリア** ボタンをクリックします。 ブラウザを更新した後、このページの以前のすべての個人用設定は、削除されます。 個人用設定を使用してページを最適化する方法の詳細については、[ユーザー エクスペリエンスのパーソナライズ](personalize-user-experience.md)を参照してください。

## <a name="appendix"></a>付録

### <a name="developer-modeling-a-canvas-app-on-a-form"></a>[開発者] フォーム上のアプリをモデル化する

このトピックでは、個人用設定を通じてキャンバス アプリを埋め込む方法に焦点を当てていますが、開発者は Visual Studio 開発エクスペリエンスを使用して、フォームにキャンバス アプリを追加することもできます。 これを行うには、PowerAppsHostControl をフォームに追加します。 コントロールで使用できるメタデータ プロパティは、個人用設定のエクスペリエンスと同じ機能を提供します。

### <a name="developer-specifying-where-an-app-can-be-embedded"></a>[開発者] アプリの埋め込み先の指定

既定では、ユーザーは、Power Apps メニュー ボタンの下または、タブ、クイック タブ、ブレード、またはワークスペースの新しいセクションとして任意のページに直接をアプリを埋め込むことができます。 ただし、必要に応じて開発者が次の方法を実装することで、アプリの埋め込みを特定のページのみに許可するようこの機能を構成することもできます。

- **isPowerAppPersonalizationEnabled** ー このメソッドが、特定のページに対して false を返す場合、Power Apps メニュー ボタンは表示されず、ユーザーは、タブを含むこのページのどこにもアプリを埋め込むことができません。
- **isPowerAppTabPersonalizationEnabled** ー このメソッドが、特定のページに対して false を返す場合、タブ、クイック タブ、またはパノラマ セクションとしてページに直接アプリを埋め込むことはできません。 ページで埋め込みが許可されている場合でも、ユーザーは Power Apps メニュー ボタンを使用してアプリを埋め込むことができます。

次の例は、アプリを埋め込むための構成をするために必要な 2 つのメソッドを持つ新しいクラスを示しています。

```powerapps
[ExtensionOf(classStr(FormRunConfigurationPowerAppsConfiguration))]

public final class ClassTest_Extension
{
    public static boolean isPowerAppPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppPersonalizationEnabled(pageName);
        return result;
    }
    
    public static boolean isPowerAppTabPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppTabPersonalizationEnabled(pageName);
        return result;
    }
}
```

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
