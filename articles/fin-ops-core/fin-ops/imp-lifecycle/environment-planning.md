---
title: 環境計画
description: この記事では、プロジェクトの環境を計画するときに考慮する必要があるさまざまな側面の概要を示します。
author: laneswenka
ms.date: 02/01/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: IT Pro
ms.reviewer: sericks
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: laswenka
ms.search.validFrom: 2018-08-01
ms.dyn365.ops.version: Finance and Operations
ms.openlocfilehash: 731527412e21c0c86ce757d9b7fc15a60e28d740
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/03/2022
ms.locfileid: "8848710"
---
# <a name="environment-planning"></a>環境計画

[!include[banner](../includes/banner.md)]

この記事では、プロジェクトの環境を計画するときに考慮する必要があるさまざまな側面の概要を示します。 正常なクラウド実装を保証するには、プロジェクトの早い段階で環境について話し合い、計画することは重要です。

## <a name="environment-planning-overview"></a>環境計画の概要

最初に、いくつかの重要な概念を以下に示します。

- **環境の目的**: 環境が存在する理由。 例には、開発、システムのテスト、ユーザー受け入れテスト (UAT)、および工程が含まれます。
- **環境トポロジ**: 環境と目的の構成。 例としては、第 1 層環境の **開発** および **ビルドとテスト** があります。
- **環境層**: 環境のタイプやカテゴリ。 例には、第 1 層環境と第 2 層環境が含まれます。

さまざまな環境と層の詳細については、[クラウド配置の概要](../../dev-itpro/deployment/cloud-deployment-overview.md)を参照し、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド* をダウンロードしてください。

### <a name="environment-types"></a>環境タイプ

プロジェクトでは次のタイプの環境を使用できます。

- **標準**: この環境は、標準的なオファーに含まれ、Microsoft サブスクリプションで Microsoft が管理します。 標準環境には、運用環境、レベル 2 スタンダード承認テスト環境が含まれます。
- **アドオン**: アドオン環境は、標準的なオファーに加えて、顧客が購入している Microsoft 管理のサブスクリプションにあります。 たとえば、アドオン環境は、パフォーマンスをテストするための追加のレベル 4 環境の場合があります。
- **クラウド ホスト** - クラウド ホスト環境は、Microsoft Azure サブスクリプションの顧客またはパートナーである顧客またはパートナーによって管理されている追加の環境です。 クラウド ホスト環境には、レベル 1 デモ環境を含めることができます。
- **環境イメージ (VHD)** - これら追加のレベル 1 環境は、[Microsoft Dynamics Lifecycle Services (LCS)](https://lcs.dynamics.com/v2) からダウンロードできる仮想ハード ディスク (VHD) を使用してオンプレミスにホストされます。

> [!IMPORTANT]
> *顧客またはパートナーの Azure サブスクリプション* では、評価および開発目的でのみ、顧客またはパートナーが独自の Azure サブスクリプションをもって環境をそのサブスクリプションに配置します。 顧客やパートナーは、Azure サブスクリプションに展開されるリソースに対して支払います。 顧客やパートナーの支払額は、Azure 価格リストに基づきます。 対照的に、*Microsoft サブスクリプション* では、顧客がライセンスを購入し、Microsoft によって管理されている Azure サブスクリプションに環境を配置することができます。 したがって、顧客に別個の Azure の請求はありません。

### <a name="tier-1-vs-tier-2-and-higher"></a>レベル 1 とレベル 2 以上の比較

| レベル 1 | レベル 2 以上 |
|--------|-------------------|
| シングルボックス環境 | マルチボックス環境 |
| すべてのコンポーネントは、同じサーバーにインストールされます。 これらのコンポーネントには、アプリケーション オブジェクト サーバー (AOS)、データベース、Dynamics 365 Commerce、および Management Reporter が含まれます。 | コンポーネントは、複数のサーバーにインストールされます。 |
| Microsoft SQL Server で使用 | [Azure SQL データベース](/azure/sql-database/)が使用されます。 |
| この構造は運用環境の構造によって異なり、これは開発チームの効率性を最大限に高めることを意図しています。 | アーキテクチャは、運用環境のアーキテクチャと同じです。ただし、このような環境はサイズがさまざまで、災害復旧に対応していません。 |
| この環境は、クラウドホストとして使用することも、環境イメージ (VHD) として配置することもできます。 | 環境は、標準環境またはアドオン環境としてのみ展開することができます。 クラウド ホストにすることはできません。 |
| この環境は、UAT またはパフォーマンス テストに適していません。 | この環境は、UAT およびパフォーマンス テストに適しています。 |

## <a name="standard-cloud-offer"></a>標準クラウド サービス

標準クラウド サービスには、2 つの環境が含まれます。

- **レベル 2 環境: 標準承認テスト**: サブスクリプションの期間用に標準承認テスト (UAT) インスタンスが 1 つ用意されています。 このインスタンスは、ユーザーが UAT、統合テスト、トレーニングに使用できる非運用環境マルチボックス インスタンスです。 追加のサンドボックス/ステージング インスタンスは、オプションのアドオンとして別途購入することができます。
- **運用環境**: テナントあたり 1 つの運用インスタンスが用意されています。 生産マルチ ボックス インスタンスには、障害復旧と高可用性が含まれています。 実装が運用段階に近づき、Microsoft Dynamics Lifecycle Services (LCS) 手法の必要なアクティビティと正常な運用評価が完了するとプロビジョニングされます。 また、いくらかのファイル ストレージとデータベース ストレージはサービスに含まれます。

    - **ファイル ストレージ:** すべての顧客は、ファイルおよびバイナリ データ用のファイル/Azure blob クラウド ストレージの一定の量を受け取ります。 その他のファイル/blob ストレージは購入することができます。
    - **データベース ストレージ:** すべてのサブスクリプションには、追加料金なしで顧客ごとに一定の量の Azure SQL データベース ストレージが含まれています。 ユーザーとデバイス サービス ライセンスの数が増えると、組織には無償で追加のストレージ容量が提供されます。 さまざまな環境とさまざまな種類のストレージ、および現在含まれている無料のファイルとストレージ容量の詳細については、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド* をダウンロードしてください。
    
> [!IMPORTANT]
> Microsoft は、サービスとデータの高い可用性をお約束するとともに、運用環境の Dynamics 365 ソフトウェアライセンス契約 (SLA) の一環として、サービスのダウンタイムを最小限に抑えることを約束しています。 SLA の対象は、非運用環境には適用されません。

### <a name="provisioning-of-standard-environments"></a>標準環境のプロビジョニング

さまざまな時点で、標準環境がプロビジョニングされます。 次の表は、標準クラウド サービスにおける環境の推奨されるタイミングを示しています。

| 環境                     | プロビジョニングが行われるタイミング | セルフサービスかどうか |
|---------------------------------|-------------------------------|---------------------|
| レベル 2 標準承認テスト | LCS でプロジェクトのオンボードが完了した直後 | あり |
| 運用                      | 生産システムの準備完了時 | Go-Live 評価は、LCS で運用配置要求をコンフィギュレーションする前に完了する必要があります。|

> [!IMPORTANT]
> 常に、**名前のない** アカウントを使用して環境を配置します。 このアカウントは、`dynadmin@customer.com` または `dynadmin@customer.onmicrosoft.com` など、顧客ドメインからのアカウントである必要があります。 すべての環境で、同じ専用の環境の管理者アカウントを使用することを強くお勧めします。  ISV ライセンスは、環境の配置に使用されるアカウントのドメインに対して発行される必要があり、異なる環境で `dynadmin@customer.com` および `dynadmin@customer.onmicrosoft.com` 両方を使用すると、ISV ライセンスに問題が発生する可能性があります。 

### <a name="production-system-readiness"></a>生産システムの準備

プロジェクトで初回 Go-Live の準備ができたら、運用環境を展開することができます。 詳細については、「[Go-Live の準備](prepare-go-live.md)」を参照してください。

生産システムの準備には、次の条件が含まれますがこれに限定されません。

- 最新のサブスクリプション見積もりが有効化されます。これについては [Lifecycle Services (LCS) のサブスクリプション見積もりツール](../../dev-itpro/lifecycle-services/subscription-estimator.md) で解説されています。
- コード、構成、およびデータの切替準備が整っている。
- エンジニアリング プロセスが重要な修正プログラムを管理するために配置されている。
- 顧客は、ソリューションと UAT にサインオフしている。
- 切替計画が設定されている。

顧客は、ソリューションをビルドするのではなく **運用** するために運用環境を使用する必要がある。 運用環境が業務の遂行に合ったサイズになっている。 サイズ決定は、サブスクリプションの見積とパフォーマンス テストの診断データに基づいて行われます。 展開後、顧客は運用環境でモック切替および最終的な一連の検証を行うことができ、その必要があります。 最終切替の前に、顧客はポイント イン タイム復元を要求し、運用環境をクリーンなスナップショット (最大 28 日前) に復元できます。

運用環境の適切なデータ センターを選択するには、ビジネスが運営されている地理的な場所から待機時間を検討してください。 [PsPing](/sysinternals/downloads/psping) や [Azure Speed Test](https://azurespeedtest.azurewebsites.net/) などのツールを使って、Azure データ センターの待機時間をテストします。

次の図は、環境計画プロセスを示しています。

![環境計画プロセス フロー。](./media/environment-planning-1-process-flow.png)

## <a name="additional-environments"></a>追加の環境

追加の環境は、アドオンとして購入するか、クラウド ホスト環境として展開することができます。 次の図は、実装の複雑さに基づく標準および追加の環境の *サンプル* 概要を示しています。

![環境の目的と複雑度。](./media/environment-planning-2-purpose-complexity-matrix.png)

> [!IMPORTANT]
> 常に、`dynadmin@customer.com` などの **名前のない** アカウントを使用して環境を配置します。 環境に、ステータスと保守を担当する所有者を割り当てます。 すべての環境で、同じ専用の環境の管理者アカウントを使用することを強くお勧めします。 Go-Live 後、新しいリリースで作業する場合、生産をサポートするために追加のレベル 2 以上の環境を取得します。

### <a name="deployment-considerations-for-development-environments"></a>開発環境での配置に関する考慮事項

開発環境には、次の 2 つの配置オプションがあります。

- **クラウド ホスト**: 環境は、顧客/パートナーにより顧客/パートナーの Azure サブスクリプションで管理されます。
- **環境イメージ (ダウンロード可能な VHD)**: 環境はオンプレミスにホストされます。

> [!NOTE]
> 開発者ごとに 1 つの開発環境を割り当てる必要があります。

次の表では、展開オプションを比較します。

| 能力                            | クラウド ホスト | 環境イメージ |
|---------------------------------------|--------------|-------------------|
| パブリック URL                            | ✓ | サポートされていません |
| 統合開発               | ✓ | 追加の設定が必要です。 (たとえば、管理者ユーザー プロビジョニング ツールを実行します。) |
| Azure DevOps                          | ✓ | 追加の設定が必要です。 (たとえば、コンピューター名を変更します。) |
| LCS から配置可能なパッケージを適用 | 自動化 | コマンド ライン Runbook (AxUpdateInstaller.exe ツール) |
| LCS からデータ パッケージを展開      | ✓ | サポートされていません |
| 管理                           | お客様/パートナーが管理 | お客様/パートナーが管理 |
| コスト モデル                            | 従量課金制 (環境が 8 時間の場合、8 時間分お支払い。)。 コストは、選択した仮想マシン サイズ、ディスク サイズと設定、およびプレミアム ストレージ設定に基づきます | ハードウェア関連 |
| 制限                           | なし。 VM スペック、ディスク サイズ、およびストレージの設定を完全に制御できます。 VM への管理者アクセスがあります。 | None |

### <a name="selecting-the-correct-tier-2-or-higher-environment"></a>正しいレベル 2 以上の環境の選択

環境の用途によって、正しいレベル 2 以上の環境を選択することが重要です。 次の図に記載されているガイダンスは、*ベースライン* です。 特定のビジネス シナリオと、ユーザーの種類、複雑さ、およびボリュームなどの要因に基づいて、実装パートナーと協力してこのガイドを調整してください。

![環境レベル。](./media/environment-planning-3-environment-tiers.png)

サブスクリプション見積が有効になると、次の図に示すように、LCS で 1 時間あたりのトランザクション明細行を表示できます。

![サブスクリプション見積。](./media/environment-planning-4-subscription-estimate.png)

### <a name="purchasing-add-on-environments"></a>アドオン環境の購入

アドオン環境を購入する場合、クラウド ソリューション プロバイダーまたはライセンス サービス再販業者に相談することをお勧めします。 発注してから環境が展開されるまでに発生する可能性のあるリード タイムを考慮してください。

次の図では、アドオン環境を購入するためのプロセスを表示します。

![アドオンの調達。](./media/environment-planning-5-procuring-add-on.png)

> [!IMPORTANT]
> マイクロソフト ボリューム ライセンス契約をお持ちの場合、Microsoft の製品およびサービス契約 (MPSA) ライセンス プログラムを通じて月間ベースでアドオン環境にサブスクライブできます。 または、Microsoft クラウド ソリューション プロバイダー (CSP) プログラムからサブスクライブすることができます。 さまざまな環境と層の詳細については、[Dynamics 365 の価格設定](https://dynamics.microsoft.com/pricing/)から最新の *Microsoft Dynamics 365 ライセンス ガイド* をダウンロードしてください。

## <a name="environments-plan"></a>環境計画

実装の早い段階で環境の計画を作成します。

1. 環境を必要とするプロジェクトの活動を識別します。 これらの活動には、カスタマイズの開発や高品質の構成データの保守が含まれますが、これだけではありません。
2. *アクティビティ ライフライクル* を見分けて *環境ライフサイクル* を見分けます。 この手順で確認する必要がある質問の例を示します。

    - 環境に必要なタイミングと長さはどれくらいか?
    - Go-Live の後に環境が必要か?

3. 必要な環境の種類とトポロジを決定します。
4. マトリックスに必要な環境の一覧をまとめています。

環境を識別した後は、アプリケーション ライフサイクル管理 (ALM) フローを構造化するために環境計画を使用できます。 たとえば、環境計画が完成したら、環境間でのコードおよびデータの構築と移動のためのフローを定義できます。


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
