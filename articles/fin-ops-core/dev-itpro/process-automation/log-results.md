---
title: 結果とメッセージを記録する
description: このトピックでは、プロセスの自動化から結果およびメッセージを記録する方法について説明します。
author: RyanCCarlson2
ms.date: 09/10/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.custom: ''
ms.search.region: Global
ms.author: rcarlson
ms.search.validFrom: 2020-09-10
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 569c3f27a7d3aba05c3ee3ea00066c4cf0aed5ef
ms.sourcegitcommit: e4992c57eea4c15ac052e9d65dddae625e3528f9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2021
ms.locfileid: "5866128"
---
# <a name="log-results-and-messages"></a><span data-ttu-id="b9571-103">結果とメッセージを記録する</span><span class="sxs-lookup"><span data-stu-id="b9571-103">Log results and messages</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="b9571-104">プロセス自動化フレームワークでは、結果およびメッセージのログ記録がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="b9571-104">The process automation framework supports logging of results and messages.</span></span> <span data-ttu-id="b9571-105">プロセスが結果とメッセージを記録するには、次の 2 つの理由があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-105">There are two reasons why a process should log results and messages:</span></span>

- <span data-ttu-id="b9571-106">結果とメッセージ ログは、プロセスの状態をシステム管理者またはアクセス権を持つその他のロールに伝達します。</span><span class="sxs-lookup"><span data-stu-id="b9571-106">Results and the message log communicate the state of a process to the system admin or other roles that have access.</span></span> <span data-ttu-id="b9571-107">プロセスの結果を監視して、他のユーザーに表示することが重要です。</span><span class="sxs-lookup"><span data-stu-id="b9571-107">It's important that process results be monitored and seen by someone.</span></span> <span data-ttu-id="b9571-108">障害が発生した場合は、修復するか、プロセスの所有者との間で問題を提起することができます。</span><span class="sxs-lookup"><span data-stu-id="b9571-108">If failures occur, they can be fixed, or an issue can be raised with the process owner.</span></span>
- <span data-ttu-id="b9571-109">結果は、プロセスで行われた内容を伝達する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-109">Results should communicate what the process did.</span></span> <span data-ttu-id="b9571-110">たとえば、プロセスが仕入先請求書を転記する場合、結果にはすべての仕入先請求書が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-110">For example, if the process posts vendor invoices, the results can show all the vendor invoices.</span></span> <span data-ttu-id="b9571-111">この場合、各結果には、仕入先請求書へのステータスとリンクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-111">In this case, each result will show the status and a link to the vendor invoice.</span></span>

<span data-ttu-id="b9571-112">結果およびメッセージは、複数レベルのログ システムです。</span><span class="sxs-lookup"><span data-stu-id="b9571-112">Results and messages are a multilevel logging system.</span></span> <span data-ttu-id="b9571-113">プロセスには 1 つ以上の結果があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-113">A process has one or more results.</span></span> <span data-ttu-id="b9571-114">各結果には、それに固有のメッセージが 1 つ以上含まれます。</span><span class="sxs-lookup"><span data-stu-id="b9571-114">Each result has one or more messages that are specific to it.</span></span> <span data-ttu-id="b9571-115">メッセージは、結果の合成子です。</span><span class="sxs-lookup"><span data-stu-id="b9571-115">A message is a composition child of the result.</span></span> <span data-ttu-id="b9571-116">結果は通常、プロセスが処理しているものです。</span><span class="sxs-lookup"><span data-stu-id="b9571-116">A result is typically something that the process is processing.</span></span> <span data-ttu-id="b9571-117">たとえば、プロセスが仕入先請求書を転記する場合、結果として各仕入先請求書をログに記録します。</span><span class="sxs-lookup"><span data-stu-id="b9571-117">For example, if the process posts vendor invoices, you log each vendor invoice as a result.</span></span> <span data-ttu-id="b9571-118">その後、各仕入先請求書を転記するたびに、その結果に関連付けられている複数のメッセージをログに記録できます。</span><span class="sxs-lookup"><span data-stu-id="b9571-118">Then, for each posting of each vendor invoice, you can log multiple messages that are associated with that result.</span></span> <span data-ttu-id="b9571-119">仕入先請求書が正常に転記された場合、ユーザーが結果を参照すると操作の成功が明らかなので、メッセージ ログを空白のままにできます。</span><span class="sxs-lookup"><span data-stu-id="b9571-119">If a vendor invoice is successfully posted, it's OK to leave the message log blank, because the success of the operation should be obvious when users look at the result.</span></span> <span data-ttu-id="b9571-120">警告が発生した場合は、転記が成功した場合でも警告をメッセージ ログに書き込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-120">If warnings occur, you should write them to the message log, even if posting was successful.</span></span> <span data-ttu-id="b9571-121">これらのメッセージによって透明度が提供され、ユーザーは各プロセスの実行内容や結果を確認することができます。</span><span class="sxs-lookup"><span data-stu-id="b9571-121">These messages provide transparency, so that users can see what each process is doing and what the results are.</span></span>

<span data-ttu-id="b9571-122">スケジュールされたプロセスとポーリングされたプロセスは共に、結果とメッセージのログ記録をサポートします。</span><span class="sxs-lookup"><span data-stu-id="b9571-122">Both scheduled processes and polled processes support logging of results and messages.</span></span> <span data-ttu-id="b9571-123">すべてのプロセスは、結果を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-123">All processes should create a result.</span></span> <span data-ttu-id="b9571-124">少なくとも、結果はすべて成功したという事実を伝える必要があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-124">At a minimum, the result should communicate the fact that everything was successful.</span></span> <span data-ttu-id="b9571-125">ユーザーの作業に影響を与え、ユーザーに表示される作業を行うプロセスは、より詳細な結果を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-125">Processes that do work that affects user work and is visible to users should create more detailed results.</span></span> <span data-ttu-id="b9571-126">以前に使用された仕入先請求書の転記の例では、ユーザーは請求書が転記されていることを確認する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-126">For the vendor invoice posting example that was used earlier, users might want to see that their invoices have been posted.</span></span> <span data-ttu-id="b9571-127">情報が他の方法で使用可能な場合でも、情報が混乱する可能性がある結果は表示しません。</span><span class="sxs-lookup"><span data-stu-id="b9571-127">Results that don't show that information can cause confusion, even if the information is available in other ways.</span></span>

<span data-ttu-id="b9571-128">次の図は、結果ビューを示しています。</span><span class="sxs-lookup"><span data-stu-id="b9571-128">The following illustration shows the result view.</span></span>

![結果の状態、時間、およびメッセージ](media/execution-results.png)

<span data-ttu-id="b9571-130">次の図は、メッセージ ビューを示しています。</span><span class="sxs-lookup"><span data-stu-id="b9571-130">The following illustration shows the message view.</span></span> <span data-ttu-id="b9571-131">このビューを開くには、結果ビューで **ログ** 列の **ログの表示** を選択します。</span><span class="sxs-lookup"><span data-stu-id="b9571-131">To open this view, select **View log** in the **Log** column in the result view.</span></span>

![個々のメッセージの例外タイプとメッセージ](media/execution-message-log.png)

## <a name="processexecutionsourcelink-table"></a><span data-ttu-id="b9571-133">ProcessExecutionSourceLink テーブル</span><span class="sxs-lookup"><span data-stu-id="b9571-133">ProcessExecutionSourceLink table</span></span>

<span data-ttu-id="b9571-134">**ProcessExecutionSourceLink** テーブルには、処理の実行中に作成された結果が含まれます。</span><span class="sxs-lookup"><span data-stu-id="b9571-134">The **ProcessExecutionSourceLink** table contains the results that are created while the processing is running.</span></span> <span data-ttu-id="b9571-135">このテーブルには、**RefTableId** と **RefRecId** フィールドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b9571-135">This table contains **RefTableId** and **RefRecId** fields.</span></span> <span data-ttu-id="b9571-136">これらのフィールドは、Microsoft SQL Server 内の任意のソース レコードにリンクされており、通常はプロセスが処理しているものです。</span><span class="sxs-lookup"><span data-stu-id="b9571-136">These fields are links to any source record in Microsoft SQL Server and are typically something that the process is processing.</span></span> <span data-ttu-id="b9571-137">このテーブルには、**ヘッダー** および **メッセージ** フィールドも含まれます。</span><span class="sxs-lookup"><span data-stu-id="b9571-137">This table also contains **Header** and **Message** fields.</span></span> <span data-ttu-id="b9571-138">**ヘッダー** フィールドは、結果グリッドの列として表示されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-138">The **Header** field will be shown as a column in the result grid.</span></span> <span data-ttu-id="b9571-139">メッセージは任意のものにすることができます。</span><span class="sxs-lookup"><span data-stu-id="b9571-139">The message can be anything that you want it to be.</span></span>

<span data-ttu-id="b9571-140">たとえば、仕入先支払提案が支払仕訳帳を作成している場合、**RefTableId** 値は **LedgerJournalTable** テーブルのテーブル ID です。</span><span class="sxs-lookup"><span data-stu-id="b9571-140">For example, if vendor payment proposal is creating a payment journal, the **RefTableId** value is the table ID of the **LedgerJournalTable** table.</span></span> <span data-ttu-id="b9571-141">**RefRecId** 値は、実行中のプロセスによって作成された支払仕訳帳の **LedgerJournalTable** レコードの **RecId** 値です。</span><span class="sxs-lookup"><span data-stu-id="b9571-141">The **RefRecId** value is the **RecId** value of the **LedgerJournalTable** record that the payment journal created by the running process.</span></span> <span data-ttu-id="b9571-142">この場合、**ヘッダー** フィールドを仕訳帳番号に設定できます。</span><span class="sxs-lookup"><span data-stu-id="b9571-142">In this case, you can set the **Header** field to the journal number.</span></span> <span data-ttu-id="b9571-143">この値をジャンプ参照に設定して、ユーザーが支払仕訳帳に直接移動するための仕訳帳番号を選択できるようにすることもできます。</span><span class="sxs-lookup"><span data-stu-id="b9571-143">You can even make this value a jump reference, so that users can select the journal number to go directly to the payment journal.</span></span> <span data-ttu-id="b9571-144">**支払仕訳帳が正常に作成された** など、表示したい任意のメッセージに **メッセージ** フィールドを設定できます。</span><span class="sxs-lookup"><span data-stu-id="b9571-144">You can set the **Message** field to any message that you want to show, such as **Payment journal created successfully**.</span></span>

<span data-ttu-id="b9571-145">多数の品目を処理するプロセス (たとえば、多数の請求書を転記している場合など) では、各請求書に対して **ProcessExecutionSourceLink** レコードを作成できます。</span><span class="sxs-lookup"><span data-stu-id="b9571-145">If the process is processing many items (for example, if it's posting many invoices), you can create a **ProcessExecutionSourceLink** record for each invoice.</span></span>

<span data-ttu-id="b9571-146">プロセスが処理している品目の数が非常に多く (数百万単位)、また、ユーザーが各品目の詳細を確認する必要がない場合は、それらの品目をバッチに要約することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="b9571-146">If the number of items that the process is processing is very large (in the millions), and users don't have to see the details of each item, consider summarizing the items into batches.</span></span> <span data-ttu-id="b9571-147">たとえば、一般会計に対する補助元帳の転送のプロセスでは、転送された各伝票に対してではなく、一般会計に転送された各転送 ID に対して **ProcessExecutionSourceLink** レコードが作成されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-147">For example, the process for subledger transfer to the general ledger creates a **ProcessExecutionSourceLink** record for each transfer ID that is transferred to the general ledger, not for each voucher that is transferred.</span></span>

| <span data-ttu-id="b9571-148">メソッド</span><span class="sxs-lookup"><span data-stu-id="b9571-148">Method</span></span> | <span data-ttu-id="b9571-149">説明</span><span class="sxs-lookup"><span data-stu-id="b9571-149">Description</span></span> |
|---|---|
| `public static void insertSourceLinks(ProcessScheduleTypeName _typeName, ProcessExecutionSourceLinkTmp _tmp)` | <span data-ttu-id="b9571-150">このメソッドはバージョン 10.0.14 の新機能です。</span><span class="sxs-lookup"><span data-stu-id="b9571-150">This method is new in version 10.0.14.</span></span> <span data-ttu-id="b9571-151">セットベースの挿入を使用して、**ProcessExecutionSourceLink** テーブルに多数の結果を挿入します。</span><span class="sxs-lookup"><span data-stu-id="b9571-151">It inserts many results into the **ProcessExecutionSourceLink** table by using set-based insert.</span></span> |
| `public static ProcessExecutionSourceLink insertSourceLink(ProcessExecutionSourceLinkItem _sourceLinkItem)` | <span data-ttu-id="b9571-152">このメソッドは、**ProcessExecutionSourceLink** テーブルにレコードを挿入します。</span><span class="sxs-lookup"><span data-stu-id="b9571-152">This method inserts a record into the **ProcessExecutionSourceLink** table.</span></span> |

## <a name="processexecutionsourcelinkitem-class"></a><span data-ttu-id="b9571-153">ProcessExecutionSourceLinkItem クラス</span><span class="sxs-lookup"><span data-stu-id="b9571-153">ProcessExecutionSourceLinkItem class</span></span>

<span data-ttu-id="b9571-154">**ProcessExecutionSourceLinkItem** クラスをインスタンス化し、ソース品目を正しく表示するために必要な値を入力します。</span><span class="sxs-lookup"><span data-stu-id="b9571-154">Instantiate the **ProcessExecutionSourceLinkItem** class, and fill it with values that are required to correctly show your source item.</span></span>

| <span data-ttu-id="b9571-155">メソッド</span><span class="sxs-lookup"><span data-stu-id="b9571-155">Method</span></span> | <span data-ttu-id="b9571-156">説明</span><span class="sxs-lookup"><span data-stu-id="b9571-156">Description</span></span> |
|---|---|
| `public static ProcessExecutionSourceLinkItem newFromProcessScheduleWorkItemAndStatus(ProcessScheduleWorkItem _workItem, ProcessExecutionSourceStatus _status)` | <span data-ttu-id="b9571-157">このコンストラクターを使用して、**ProcessExecutionSourceLinkItemの** インスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="b9571-157">Use this constructor to create an instance of **ProcessExecutionSourceLinkItem**.</span></span> <span data-ttu-id="b9571-158">このメソッドは、**processscheduleworkitem** から必要なフィールドの多くを正しく初期化します。</span><span class="sxs-lookup"><span data-stu-id="b9571-158">This method correctly initializes many of the required fields from **ProcessScheduleWorkItem**.</span></span> |
| `public static ProcessExecutionSourceLinkItem newFromProcessExecutionSourceLink(RefRecId _processExecutionSourceLinkRecId)` | <span data-ttu-id="b9571-159">このメソッドは、**ProcessExecutionSourceLinkItem** のインスタンスを構築し、**ProcessExecutionSourceLink** レコードの指定されたレコード ID を使用してインスタンスを初期化し ます。</span><span class="sxs-lookup"><span data-stu-id="b9571-159">This method constructs an instance of **ProcessExecutionSourceLinkItem** and initializes the instance by using the specified record ID of a **ProcessExecutionSourceLink** record.</span></span> |
| `public RefRecId parmSourceRecId(RefRecId _sourceRecId = sourceRecId)` | <span data-ttu-id="b9571-160">ソース レコードのレコード ID を設定します。</span><span class="sxs-lookup"><span data-stu-id="b9571-160">Set the record ID of the source record.</span></span> <span data-ttu-id="b9571-161">たとえば、この値は、仕入先請求書ヘッダー テーブルのレコード ID である場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-161">For example, this value might be the record ID of the vendor invoice header table.</span></span> |
| `public RefTableId parmSourceTableId(RefTableId _sourceTableId = sourceTableId)` | <span data-ttu-id="b9571-162">ソース テーブルのテーブル ID を設定します。</span><span class="sxs-lookup"><span data-stu-id="b9571-162">Set the table ID of the source table.</span></span> <span data-ttu-id="b9571-163">たとえば、この値は、仕入先請求書ヘッダー テーブルのテーブル ID である場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-163">For example, this value might be the table ID of the vendor invoice header table.</span></span> |
| `public ProcessExecutionSourceLinkHeader parmHeader(ProcessExecutionSourceLinkHeader _header = header)` | <span data-ttu-id="b9571-164">ヘッダー フィールドの値を設定します。</span><span class="sxs-lookup"><span data-stu-id="b9571-164">Set the value for the header field.</span></span> <span data-ttu-id="b9571-165">以前に使用された仕入先請求書の転記の例では、この値は請求書番号である場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-165">For the vendor invoice posting example that was used earlier, this value might be the invoice number.</span></span> |
| `public ProcessExecutionSourceLinkMessage parmMessage(ProcessExecutionSourceLinkMessage _message = message)` | <span data-ttu-id="b9571-166">メッセージを設定します。</span><span class="sxs-lookup"><span data-stu-id="b9571-166">Set the message.</span></span> <span data-ttu-id="b9571-167">以前に使用された仕入先請求書の転記の例では、この値は **転記成功** である場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9571-167">For the vendor invoice posting example that was used earlier, this value might be **Posting successful**.</span></span> |
| `public ProcessExecutionId parmExecutionId(ProcessExecutionId _executionId = executionId)` | <span data-ttu-id="b9571-168">このメソッドは、実行 ID を設定します。</span><span class="sxs-lookup"><span data-stu-id="b9571-168">This method sets the execution ID.</span></span> <span data-ttu-id="b9571-169">この値は、**ProcessAutomationTask** インターフェイスの実装で **processscheduleworkitem** を介して提供されています。</span><span class="sxs-lookup"><span data-stu-id="b9571-169">This value was provided via **ProcessScheduleWorkItem** in the implementation of the **ProcessAutomationTask** interface.</span></span> |

## <a name="processexecutionmessagelog-table"></a><span data-ttu-id="b9571-170">ProcessExecutionMessageLog テーブル</span><span class="sxs-lookup"><span data-stu-id="b9571-170">ProcessExecutionMessageLog table</span></span>

<span data-ttu-id="b9571-171">**ProcessExecutionMessageLog** テーブルには、単一の **ProcessExecutionSourceLink** レコードに関連するメッセージが含まれています。</span><span class="sxs-lookup"><span data-stu-id="b9571-171">The **ProcessExecutionMessageLog** table contains messages that are related to a single **ProcessExecutionSourceLink** record.</span></span> <span data-ttu-id="b9571-172">このテーブルには、任意のタイプのメッセージを書き込むことができます。</span><span class="sxs-lookup"><span data-stu-id="b9571-172">You can write any type of message to this table.</span></span> <span data-ttu-id="b9571-173">その後、メッセージがユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-173">The message will then be shown to users.</span></span>

| <span data-ttu-id="b9571-174">メソッド</span><span class="sxs-lookup"><span data-stu-id="b9571-174">Method</span></span> | <span data-ttu-id="b9571-175">説明</span><span class="sxs-lookup"><span data-stu-id="b9571-175">Description</span></span> |
|---|---|
| `public static void insertMessages(ProcessScheduleTypeName _typeName, ProcessExecutionMessageLogTmp _tmp)` | <span data-ttu-id="b9571-176">このメソッドでは、セット ベースの挿入を使用して、**ProcessExecutionMessageLog** テーブルにメッセージを挿入します。</span><span class="sxs-lookup"><span data-stu-id="b9571-176">This method inserts messages into the **ProcessExecutionMessageLog** table by using a set-based insert.</span></span> |
| `public static ProcessExecutionMessageLog insertMessage(ProcessExecutionMessageLogItem _errorLogItem)` | <span data-ttu-id="b9571-177">このメソッドは、メッセージをメッセージログに挿入します。</span><span class="sxs-lookup"><span data-stu-id="b9571-177">This method inserts a message into the message log.</span></span> |

## <a name="processexecutionmessagelogitem-class"></a><span data-ttu-id="b9571-178">ProcessExecutionMessageLogItem クラス</span><span class="sxs-lookup"><span data-stu-id="b9571-178">ProcessExecutionMessageLogItem class</span></span>

<span data-ttu-id="b9571-179">メッセージ ログには、メッセージが文字列とラベル ID の両方ろして格納されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-179">The message log stores messages as both strings and label IDs.</span></span> <span data-ttu-id="b9571-180">両方の値を設定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b9571-180">You don't have to set both values.</span></span> <span data-ttu-id="b9571-181">ラベル ID は、メッセージ ログのユーザー インターフェイス (UI) 内のメッセージの変換をサポートしているので、推奨されます。</span><span class="sxs-lookup"><span data-stu-id="b9571-181">Label IDs are preferred, because they support translation of messages in the user interface (UI) for the message log.</span></span> <span data-ttu-id="b9571-182">ただし、メッセージは、ラベル ID のログをサポートしないプロセスとの下位互換性のために提供されています。</span><span class="sxs-lookup"><span data-stu-id="b9571-182">However, the messages are provided for backward compatibility with processes that don't support logging of label IDs.</span></span>

<span data-ttu-id="b9571-183">シナリオに応じて適切なコンストラクターを使用します。</span><span class="sxs-lookup"><span data-stu-id="b9571-183">Use the appropriate constructor for your scenario.</span></span>

| <span data-ttu-id="b9571-184">メソッド</span><span class="sxs-lookup"><span data-stu-id="b9571-184">Method</span></span> | <span data-ttu-id="b9571-185">説明</span><span class="sxs-lookup"><span data-stu-id="b9571-185">Description</span></span> |
|---|---|
| `public static ProcessExecutionMessageLogItem newFromProcessExecutionSourceLinkAndMessage(RefRecId _processExecutionSourceLinkRecId, Exception _exception, ProcessExecutionMessage _message)` | |
| `public static ProcessExecutionMessageLogItem newFromProcessExecutionSourceLinkAndLabel(RefRecId _processExecutionSourceLinkRecId, Exception _exception, LabelId _labelId, container _labelParameters)` | |


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]