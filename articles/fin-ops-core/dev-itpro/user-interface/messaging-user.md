---
title: Finance and Operations アプリのメッセージング システム
description: このトピックでは、Finance and Operations アプリの豊富で強力なメッセージング システムについて説明します。
author: jasongre
manager: AnnBe
ms.date: 03/05/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.search.scope: Operations
ms.custom: 50401
ms.assetid: ce9d2312-c02e-4649-a7e4-33c3a06dfbd4
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: acf1ea3be267afea4910678714cbe175b9c0ba4e
ms.sourcegitcommit: 1789a78de1cbeac19d96767812df653a191c67e9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/05/2020
ms.locfileid: "3100295"
---
# <a name="messaging-system-for-finance-and-operations-apps"></a><span data-ttu-id="3a5b7-103">Finance and Operations アプリのメッセージング システム</span><span class="sxs-lookup"><span data-stu-id="3a5b7-103">Messaging system for Finance and Operations apps</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="3a5b7-104">このトピックでは、Finance and Operations アプリの豊富で強力なメッセージング システムについて説明します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-104">This topic describes the rich, powerful messaging system in Finance and Operations apps.</span></span>

<span data-ttu-id="3a5b7-105">このエクスペリエンスを改善するために、Finance and Operations アプリ用に新しいメッセージング システムが作成されました。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-105">A new messaging system was created for Finance and Operations apps to improve this experience.</span></span> <span data-ttu-id="3a5b7-106">以前のバージョンと比較すると、Finance and Operations アプリのメッセージング システムには次の機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-106">Compared to earlier versions, the messaging system for Finance and Operations apps includes the following features:</span></span>

+ <span data-ttu-id="3a5b7-107">コンテキストのあるメッセージの関連性が強化されました (フォームとグローバル)。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-107">Improved association of a message with its context (form versus global).</span></span>
+ <span data-ttu-id="3a5b7-108">中断のレベル (なし、軽微、および中断) を強化しました。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-108">Improved level of interruption (none, subtle, and interrupting).</span></span>
+ <span data-ttu-id="3a5b7-109">メッセージの種類間での明確さと、その用途が強化されました。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-109">Improved clarity between types of messages and their use.</span></span>
+ <span data-ttu-id="3a5b7-110">メッセージを表示するために使用されるコントロールは、フォーム コンテキストに基づいて deterministic です。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-110">The control that is used to display messages is deterministic and based on form context.</span></span>

## <a name="where-can-messages-be-surfaced-to-users"></a><span data-ttu-id="3a5b7-111">ユーザーにメッセージを提示できる場所は?</span><span class="sxs-lookup"><span data-stu-id="3a5b7-111">Where can messages be surfaced to users?</span></span> 
<span data-ttu-id="3a5b7-112">Finance and Operations アプリのメッセージは、通常、メッセージバー、アクション センター、またはメッセージ ボックスのいずれかの場所に表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-112">Messages in Finance and Operations apps are generally shown in one of these places: message bars, the Action center, or message boxes.</span></span>  

### <a name="message-bars--messages-for-synchronous-tasks-on-the-current-page"></a><span data-ttu-id="3a5b7-113">メッセージ バー – 現在のページの同期タスクのメッセージ</span><span class="sxs-lookup"><span data-stu-id="3a5b7-113">Message bars – Messages for synchronous tasks on the current page</span></span>
<span data-ttu-id="3a5b7-114">メッセージ バーは、基本ページやドロップ ダイアログおよびスライダー ダイアログで利用できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-114">Message bars are available on primary pages, and in drop dialogs and slider dialogs.</span></span> <span data-ttu-id="3a5b7-115">メッセージ バーは、主にデータ検証に使用されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-115">Message bars are used primarily for data validation.</span></span> <span data-ttu-id="3a5b7-116">また、日付有効性のために使用されるメッセージなど、ページまたはデータの状態に関するメッセージの通信にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-116">They can also be used to communicate messages about the state of a page or data, such as messages that are used for date effectivity.</span></span> <span data-ttu-id="3a5b7-117">メッセージ バーでは、**情報**、**警告**、および**エラー**のステータスを表示できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-117">Message bars can express **info**, **warning**, and **error** statuses.</span></span> <span data-ttu-id="3a5b7-118">すぐにユーザーの注目が必要なメッセージには、メッセージ バーを使用しないください。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-118">Message bars should not be used for messages that require the user's immediate attention.</span></span> <span data-ttu-id="3a5b7-119">メッセージ バーは、メッセージが最初に受け取られたときに表示されます。また、現在のページに関してのみのメッセージを伝達するのに使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-119">A message bar appears when a message is first received and must be used to communicate messages only about the current page.</span></span> <span data-ttu-id="3a5b7-120">メッセージ バーに送信されるメッセージは、現在のページに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-120">Messages that are sent to message bars are associated with the current page.</span></span> <span data-ttu-id="3a5b7-121">したがって、ユーザーがメッセージ バーを含むページから離れて移動すると、それらのメッセージは新しいページに表示されません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-121">Therefore, when the user navigates away from a page that includes message bars, those messages won't appear on the new page.</span></span> <span data-ttu-id="3a5b7-122">ただし、ユーザーが元のページに戻ってくる場合、ページのメッセージが再度表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-122">However, if the user navigates back to the original page, the page's messages will once again appear.</span></span> <span data-ttu-id="3a5b7-123">メッセージに次の情報を含めます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-123">Include the following information in messages:</span></span>

-   <span data-ttu-id="3a5b7-124">このメッセージを生成した条件。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-124">The condition that generated the message.</span></span>
-   <span data-ttu-id="3a5b7-125">ユーザーがメッセージを生成した状態を解決せずに続行した場合の結果。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-125">The result if the user continues without resolving the condition that generated the message.</span></span>

### <a name="examples"></a><span data-ttu-id="3a5b7-126">例</span><span class="sxs-lookup"><span data-stu-id="3a5b7-126">Examples</span></span>

```Console
This customer is marked as inactive.
```

```Console
Customer validation has failed.
```

```Console
The transaction on voucher do not balance.
```

### <a name="presentation"></a><span data-ttu-id="3a5b7-127">プレゼンテーション</span><span class="sxs-lookup"><span data-stu-id="3a5b7-127">Presentation</span></span>

![メッセージ バーのスクリーン ショット](./media/messaging_messagebartypes.jpg)

### <a name="action-center--messages-from-asynchronous-tasks"></a><span data-ttu-id="3a5b7-129">アクション センター - 非同期タスクからのメッセージ</span><span class="sxs-lookup"><span data-stu-id="3a5b7-129">Action center – Messages from asynchronous tasks</span></span>
<span data-ttu-id="3a5b7-130">アクション センターは、ナビゲーション バーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-130">The Action center is located in the navigation bar.</span></span> <span data-ttu-id="3a5b7-131">ユーザーによる迅速なアクションを必要とせず、現在の作業を続行するために必要ではないメッセージが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-131">It contains messages that don't require any immediate action by the user and aren't required for the current task to continue.</span></span> <span data-ttu-id="3a5b7-132">一般的な例にとしては、バッチ ジョブやレポート完了などのバック グラウンド処理からのフィードバックがあります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-132">Typical examples include feedback from background processes such as a batch job or report completion.</span></span> <span data-ttu-id="3a5b7-133">アクション センターでは、**情報**、**警告**、および **エラー** の各ステータスを表示できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-133">The Action center can express **info**, **warning**, and **error** statuses.</span></span> <span data-ttu-id="3a5b7-134">アクション センターは、開かれる前に前回開いたときから受信したメッセージの数を示します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-134">Before it's opened, the Action center indicates the number of messages that have been received since last time that it was opened.</span></span>

<span data-ttu-id="3a5b7-135">アクション センターには、最大で 500 件のメッセージを保持できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-135">The Action center can hold up to 500 messages.</span></span> <span data-ttu-id="3a5b7-136">その後、メッセージは最初に表示されたものから順にサイクルします。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-136">Messages are then cycled on a first in, first out basis.</span></span>

### <a name="message-boxes--errors-and-immediate-notifications-completed-synchronous-operations"></a><span data-ttu-id="3a5b7-137">メッセージ ボックス – エラーや即時の通知 (完了した同期操作)</span><span class="sxs-lookup"><span data-stu-id="3a5b7-137">Message boxes – Errors and immediate notifications (completed synchronous operations)</span></span>
<span data-ttu-id="3a5b7-138">メッセージ ボックスを使用して、すぐに注意が必要な問題についてユーザーに警告します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-138">Use message boxes to alert users about issues that require immediate attention.</span></span> <span data-ttu-id="3a5b7-139">メッセージ ボックスはユーザーを中断して、メッセージが読み取られたり消されるまでユーザーの続行が妨げられるため、ユーザーが後で処理できないメッセージに対してのみ使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-139">Because message boxes interrupt users and prevent them from continuing until the message is read and dismissed, they should be used only for messages that users can't handle later.</span></span> <span data-ttu-id="3a5b7-140">メッセージ ボックスに表示されるエラー メッセージに次の情報を含めます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-140">Include the following information in error messages that appear in message boxes:</span></span>

-   <span data-ttu-id="3a5b7-141">発生したエラー。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-141">The error that occurred.</span></span>
-   <span data-ttu-id="3a5b7-142">エラーの原因。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-142">The cause of the error.</span></span>
-   <span data-ttu-id="3a5b7-143">エラーを解決する方法に関する情報。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-143">Information about how to resolve the error.</span></span>

<span data-ttu-id="3a5b7-144">エラー メッセージは次の 2 つのコンポーネントを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-144">An error message should include the following two components:</span></span>

-   <span data-ttu-id="3a5b7-145">**主要な命令** – このテキストは太字で表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-145">**The main instruction** – This text appears in bold.</span></span>
-   <span data-ttu-id="3a5b7-146">**メッセージの詳細** – このテキストは主要な命令の下に表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-146">**The message details** – This text appears below the main instruction.</span></span>

### <a name="examples"></a><span data-ttu-id="3a5b7-147">例</span><span class="sxs-lookup"><span data-stu-id="3a5b7-147">Examples</span></span>

-   <span data-ttu-id="3a5b7-148">参照番号がバージョン %1 で使用されるので、参照番号を削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-148">You can’t delete the reference number because the reference number is used in version %1.</span></span>
-   <span data-ttu-id="3a5b7-149">このエクスポートを実行するのに十分な権限があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-149">You have insufficient rights to perform this export.</span></span>
-   <span data-ttu-id="3a5b7-150">カタログ インポート処理用のルート フォルダーが構成されていません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-150">The root folder for catalog import processing is not configured.</span></span> <span data-ttu-id="3a5b7-151">仕入先カタログ インポート パラメータ フォームを使用してルート フォルダをコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-151">Configure the root folder using the Vendor catalog import parameters form.</span></span>

### <a name="presentation"></a><span data-ttu-id="3a5b7-152">プレゼンテーション</span><span class="sxs-lookup"><span data-stu-id="3a5b7-152">Presentation</span></span>

![エラー メッセージの例](./media/messaging_boxapi.jpg) 

<span data-ttu-id="3a5b7-154">**エラー** タイプのメッセージでは、メッセージを含むモーダルの「明るい色のボックス」で現在のページにオーバーレイすることでユーザーの操作をブロックします。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-154">Messages of the **error** type block the user’s interaction by overlaying the current page with a modal “light box” that contains the message.</span></span>

## <a name="should-i-show-the-user-a-notification-a-warning-or-an-error"></a><span data-ttu-id="3a5b7-155">通知、警告、またはエラーをユーザーに表示する必要がありますか。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-155">Should I show the user a notification, a warning, or an error?</span></span>
<span data-ttu-id="3a5b7-156">Finance and Operations アプリの以前のバージョンでは、これまで、**情報**、**警告** (**checkFailed**)、および **エラー** の状態は、シナリオ間で常に一貫して使用されていませんでした。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-156">In earlier versions of Finance and Operations apps, the **info**, **warning** (**checkFailed**), and **error** statuses weren't always used consistently across scenarios.</span></span> <span data-ttu-id="3a5b7-157">メッセージは、あるシナリオでは警告として、別のシナリオではエラーとして報告される場合があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-157">A message might be reported as a warning in one scenario but as an error in another scenario.</span></span> <span data-ttu-id="3a5b7-158">表す状態を決定するとき、次の定義を使用します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-158">When you're deciding which status to express, use these definitions:</span></span>

-   <span data-ttu-id="3a5b7-159">**通知** – 通知は、現在のユーザー活動に関係する可能性のあるイベントまたは関係しない可能性のあるイベントについてユーザーに通知します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-159">**Notification** – A notification informs the user about events that might or might not be related to the current user activity.</span></span> <span data-ttu-id="3a5b7-160">この通知は、ユーザー アクションまたはシステム イベントによって発生する場合があります。または、有用なプログラムからの情報を提供することができます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-160">A notification can be caused by a user action or a system event, or it can provide information from the program that might be useful.</span></span> <span data-ttu-id="3a5b7-161">通知は通常、即時のユーザー操作を必要としません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-161">Typically, a notification doesn't require immediate user action.</span></span> <span data-ttu-id="3a5b7-162">**info()** アプリケーション プログラミング インターフェイス (API) を使用してユーザーに通知します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-162">You notify the user by using the **info()** application programming interface (API).</span></span>
-   <span data-ttu-id="3a5b7-163">**警告** – 警告は、今後問題が発生する可能性のある状態についてユーザーに警告します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-163">**Warning** – A warning alerts the user about a condition that might cause an issue in the future.</span></span> <span data-ttu-id="3a5b7-164">具体的には、警告は無効な状態のデータに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-164">Specifically, a warning is used for data that is in an incorrect state.</span></span> <span data-ttu-id="3a5b7-165">無効なデータを使用するとエラーが発生するかもしれませんが、現状データの間違いを示すエラー状態ではなく、*ユーザーはデータの不適切な状態についてのみ警告する必要があります*。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-165">Although any attempt to use this invalid data might produce an error, the fact that the current state of the data is incorrect isn't an error condition, and *the user should only be warned about the incorrect state of the data*.</span></span> <span data-ttu-id="3a5b7-166">データ検証の問題を表現するには、**warning()** または **checkFailed()** API を使用します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-166">You express data validation issues by using the **warning()** or **checkFailed()** API.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3a5b7-167">システムが検証メッセージのクリーンアップを処理する方法により、**warning()** または **checkFailed()** API が使用される際、**validate()** の戻り値は*常に* **false** に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-167">Because of the way that the system handles the cleanup of validation messages, when the **warning()** or **checkFailed()** API is used, the return value of **validate()** should *always* be set to **false**.</span></span> <span data-ttu-id="3a5b7-168">それ以外の場合は、警告メッセージがユーザーに表示されない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-168">Otherwise, warning messages might not be shown to the user.</span></span>

-   <span data-ttu-id="3a5b7-169">**エラー** - すでに発生した問題についてエラーがユーザーに警告します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-169">**Error** – An error alerts the user about a problem that has already occurred.</span></span> <span data-ttu-id="3a5b7-170">失敗したユーザー アクションは、エラー状態です。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-170">A user action that has failed is an error condition.</span></span> <span data-ttu-id="3a5b7-171">エラーには、*非中断* (*パッシブ*) または*中断*を使用できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-171">Errors can be *non-interrupting* (*passive*) or *interrupting*.</span></span> <span data-ttu-id="3a5b7-172">中断のないエラーでは、ユーザーは問題の修正を試みる前に他のアクティビティを実行できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-172">In a non-interrupting error, users can perform other activities before they try to correct the issue.</span></span> <span data-ttu-id="3a5b7-173">中断エラーでは、ユーザーはエラー状態を修正するまで続行したりタスクを完了したりできません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-173">In an interrupting error, users can't proceed or complete the task until they correct the error condition.</span></span> <span data-ttu-id="3a5b7-174">パッシブ (非中断) エラーを表現するには、**error()** API を使用します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-174">You express a passive (non-interrupting) error by using the **error()** API.</span></span> <span data-ttu-id="3a5b7-175">中断エラーを表現するには、 **box::** API を使用します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-175">You express an interrupting error by using the **box::** API.</span></span>

## <a name="should-this-message-interrupt-the-user"></a><span data-ttu-id="3a5b7-176">このメッセージがユーザーに割り込むことを確認しますか?</span><span class="sxs-lookup"><span data-stu-id="3a5b7-176">Should this message interrupt the user?</span></span>
<span data-ttu-id="3a5b7-177">(バッチ ジョブまたはその他の操作) のタスクが失敗した場合は、ユーザーに受動的に通知することが適切な場合があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-177">If a task (batch job or other operation) fails, it's often appropriate to notify the user passively.</span></span> <span data-ttu-id="3a5b7-178">ユーザーはいつでも問題を修正して操作を再試行できるので、すぐに通知する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-178">Because the user can correct the issue and retry the operation at any time, he or she doesn't have to be notified immediately.</span></span> <span data-ttu-id="3a5b7-179">そのような場合、**error()** API は適切であり、ユーザーは割り込みダイアログを受け取りません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-179">In these cases, the **error()** API is appropriate, and the user doesn't receive an interrupting dialog.</span></span> <span data-ttu-id="3a5b7-180">ただし、それ以外の場合、ユーザーは問題が修正されるまでは続行できません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-180">However, in other cases, the user can't proceed until the issue is corrected.</span></span> <span data-ttu-id="3a5b7-181">たとえば、まだ無効なデータを保持しているページをユーザーが保存しようとする場合、クライアントはエラー ダイアログを表すことにより、ユーザーを中断させます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-181">For example, if the user tries to save a page that still has invalid data, the client interrupts the user by presenting an error dialog.</span></span> <span data-ttu-id="3a5b7-182">これらのケースでは、ダイアログを提示することにより、ユーザーを中断させる方が適切である場合、**ボックス::** を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-182">In these cases where it's more appropriate to interrupt the user by presenting a dialog, the **box::** API should be used.</span></span> 

![Box API の例](./media/messaging_boxapi.jpg)


## <a name="will-my-message-end-up-in-a-message-bar-or-in-the-action-center"></a><span data-ttu-id="3a5b7-184">私のメッセージは最終的にメッセージ バーまたはアクション センターに表示されますか。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-184">Will my message end up in a message bar or in the Action center?</span></span> 
<span data-ttu-id="3a5b7-185">メッセージング システムは、*確定的* です。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-185">The messaging system is *deterministic*.</span></span> <span data-ttu-id="3a5b7-186">つまり、ユーザーにメッセージを表示するための最善の方法を決定するために、メッセージング システムは呼び出しのコンテキストを使用します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-186">In other words, the messaging system uses the context of the call to determine the best way to show the message to the user.</span></span> <span data-ttu-id="3a5b7-187">メッセージは、ページの上部に表示されるメッセージ バーまたはナビゲーション バーに表示されるメッセージ センターに表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-187">Messages are shown either in a message bar that appears at the top of pages or in the Action center, which appears in the navigation bar.</span></span> <span data-ttu-id="3a5b7-188">メッセージの場所は、メッセージの送信元コードによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-188">The location of the message depends on where in code the message is sent from.</span></span>

<span data-ttu-id="3a5b7-189">一般:</span><span class="sxs-lookup"><span data-stu-id="3a5b7-189">In general:</span></span>
-   <span data-ttu-id="3a5b7-190">メッセージが同期のページ アクション (つまり、ユーザーが結果を待つ必要がある) によって発生した場合、結果は現在のページのメッセージ バーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-190">If the message is caused by a page action that is synchronous (that is, the user must wait for the result), the result is shown in a message bar on the current page.</span></span> <span data-ttu-id="3a5b7-191">(例外は、アクションが開始された後すぐに終了したスライダー ダイアログです。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-191">(The exception is a slider dialog that was closed immediately after the action was started.</span></span> <span data-ttu-id="3a5b7-192">スライダー ダイアログのメッセージが親のページにバブル アップします。)</span><span class="sxs-lookup"><span data-stu-id="3a5b7-192">Messages for slider dialogs "bubble up" to the parent page.)</span></span>
-   <span data-ttu-id="3a5b7-193">メッセージが同期 (切断) のアクション (たとえば、バッチジョブ) によって発生し、ユーザーが他のタスクを実行できる場合、またはそのアクションの処理中にも別のタスクにさえ移動できる場合は、メッセージはアクション センターにルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-193">If the message is caused by an action (for example, a batch job) that is asynchronous (disconnected) and the user can continue to perform other tasks or even navigate to another page while that action is being processed, the message is routed to the Action center.</span></span>

### <a name="messaging-from-asynchronous-or-long-running-background-tasks"></a><span data-ttu-id="3a5b7-194">同期からのメッセージングまたは実行時間の長いバックグラウンド タスク</span><span class="sxs-lookup"><span data-stu-id="3a5b7-194">Messaging from asynchronous or long-running background tasks</span></span> 
<span data-ttu-id="3a5b7-195">ページ上部にあるメッセージ バーは、何時間も前に開始されたバックグラウンド タスクではなく、現在のページに関する情報を表示するために使用されるため、(潜在的に) 長時間実行されているタスクはユーザーにメッセージ バーを表示しません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-195">A (potentially) long-running task should not present a message bar to the user, because message bars at the top of a page are used to present information about the current page, not some background task that might have started hours earlier.</span></span> <span data-ttu-id="3a5b7-196">場合によっては、多くのバックグラウンド タスクを実行しているユーザーは、タスクを完了しているときにページ間を移動し続けます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-196">In some cases, a user who has many background tasks running continues to navigate between pages while the tasks are being completed.</span></span> <span data-ttu-id="3a5b7-197">したがって、現在のページに表示され、バックグラウンド タスクについてユーザーに通知されるメッセージは、見落とされたり無視されたりします。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-197">Therefore, messages that are presented on the current page to notify the user about background tasks are easily overlooked or ignored.</span></span> <span data-ttu-id="3a5b7-198">したがって、設計上、バックグラウンド タスクはアクション センターにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-198">Therefore, by design, background tasks send their messages to the Action center.</span></span> <span data-ttu-id="3a5b7-199">アクション センターに新しいメッセージが表示されると、非同期タスクの結果を待っている可能性のあるユーザーに通知が送信されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-199">When a new message appears in the Action center, a notification informs the user, who might be waiting for the results of an asynchronous task.</span></span>

### <a name="messaging-from-dialogs-and-slider-dialogs"></a><span data-ttu-id="3a5b7-200">ダイアログおよびスライダー ダイアログからのメッセージング</span><span class="sxs-lookup"><span data-stu-id="3a5b7-200">Messaging from dialogs and slider dialogs</span></span>
<span data-ttu-id="3a5b7-201">確定的なメッセージング システムが、現在のページにメッセージを送信しようとします。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-201">The deterministic messaging system tries to send messages to the current page.</span></span> <span data-ttu-id="3a5b7-202">ただし、すべてのダイアログまたはスライダー ダイアログからの呼び出しが、そのダイアログまたはスライダーにルーティングされるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-202">However, not every call from a dialog or slider dialog is routed to that dialog or slider.</span></span> <span data-ttu-id="3a5b7-203">場合によっては、メッセージング システムが代わりに親ページにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-203">In some cases, the messaging system sends the message to the parent page instead.</span></span> <span data-ttu-id="3a5b7-204">この現象は、ダイアログまたはスライダが閉じられているときにメッセージング システムが呼び出されると発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-204">This behavior can occur when the messaging system is called while the dialog or slider is being closed.</span></span> <span data-ttu-id="3a5b7-205">場合によっては、ダイアログまたはスライダーが閉じるプロセスを開始するときにメッセージング システムを呼び出せますが、クライアントが有効な理由から閉じるプロセスを中断します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-205">In some cases, the messaging system can be called when the close process for the dialog or slider is started, but the client interrupts the close process for valid reasons.</span></span> <span data-ttu-id="3a5b7-206">したがって、「不可逆地点」があり、その時点を過ぎると、メッセージング システムはもはやダイアログまたはスライダー にメッセージを送信しようとせず、メッセージを親ページに送信します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-206">Therefore, there is a "point of no return," after which the messaging system no longer tries to send a message to the dialog or slider, and instead sends the message to the parent page.</span></span> <span data-ttu-id="3a5b7-207">ユーザーがフォーム上の **OK** ボタンクリックすると、下記のコード例に示すように、終了シーケンスに入ります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-207">When the user clicks the **OK** button on the form is entering its closing sequence, shown in the code example that follows.</span></span>

```xpp
closeOK()
{
    // current form
    super(); // calls close()
    // parent or message center
}
Close()
{
    // current form
    super();// point of no return
    // parent or message center
}
```

<span data-ttu-id="3a5b7-208">クライアントが **closeOK()** または **close()** を直接呼び出す場合、最終的な結果がページまたは親ページである可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-208">If the client calls **closeOK()** or **close()** directly, then the final result might be the page or the parent page.</span></span>

## <a name="when-are-validation-messages-cleaned-up"></a><span data-ttu-id="3a5b7-209">検証メッセージをクリーンアップする場合は?</span><span class="sxs-lookup"><span data-stu-id="3a5b7-209">When are validation messages cleaned up?</span></span> 
<span data-ttu-id="3a5b7-210">Finance and Operations アプリにメッセージング システムを使用している場合は、検証メッセージ (同じ API を使用して呼びだしされる) がページ自体のメッセージバーに受動的に表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-210">With the messaging system in use for Finance and Operations apps, the validation message (called using the same APIs) appears in a message bar on the page itself in a passive manner.</span></span> <span data-ttu-id="3a5b7-211">無効な値は残っていますが、無効なフラグが立てられています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-211">The invalid value remains but is flagged as invalid.</span></span> <span data-ttu-id="3a5b7-212">ユーザーは引き続きデータを入力でき、データが保存される前の任意の時点で検証の問題を修正することができます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-212">The user can continue to enter data and can correct the validation issue at any point before the data is saved.</span></span>

<span data-ttu-id="3a5b7-213">検証の問題が修正されると、メッセージ バーの対応するメッセージは無効になり、メッセージング システムがメッセージを削除します。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-213">When a validation issue has been corrected so that the corresponding message in the message bar is no longer valid, the messaging system removes the message.</span></span> <span data-ttu-id="3a5b7-214">メッセージ削除のタイミングは、検証ロジックが定義されているレベルによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-214">The timing of message removal depends on the level where the validation logic is defined.</span></span>

-   <span data-ttu-id="3a5b7-215">検証ロジックがコントロールまたはフィールド レベルで定義されている場合、コントロールまたはフィールドに有効な値が入力されると、メッセージは削除されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-215">If the validation logic is defined at the control or field level, the message is removed when a valid value is entered in the control or field.</span></span>
-   <span data-ttu-id="3a5b7-216">検証ロジックがテーブル レベルで定義されている場合、次回ユーザーが保存境界を超えるときにメッセージが削除されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-216">If the validation logic is defined at the table level, the message is removed the next time that the user crosses a save boundary.</span></span>

<span data-ttu-id="3a5b7-217">UI からメッセージを削除する際に、開発者が詳細な制御を必要とする場合は、**メッセージ ()** API を使用できます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-217">If the developer needs more control over when a message needs to be removed from the UI, the **Message()** API can be utilized.</span></span> <span data-ttu-id="3a5b7-218">詳細については、[メッセージング API](messaging-api-center-bar-details.md) 記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-218">See the [Messaging APIs](messaging-api-center-bar-details.md) article for more details.</span></span>  

## <a name="im-migrating-from-an-older-version-how-do-i-change-my-existing-code-to-use-the-new-messaging-system"></a><span data-ttu-id="3a5b7-219">私は古いバージョンからの移行をおこなっています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-219">I'm migrating from an older version.</span></span> <span data-ttu-id="3a5b7-220">新しいメッセージング システムを使用して既存のコードをどのように変更できますか。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-220">How do I change my existing code to use the new messaging system?</span></span>
<span data-ttu-id="3a5b7-221">*多くの場合、変更は必要ありません。*</span><span class="sxs-lookup"><span data-stu-id="3a5b7-221">*In many cases, no changes are required.*</span></span> <span data-ttu-id="3a5b7-222">メッセージング フレームワークは、多くの一般的なシナリオの下位互換性を革新し維持するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-222">The messaging framework was designed to innovate and maintain backward compatibility for many common scenarios.</span></span> <span data-ttu-id="3a5b7-223">場合によっては、プログラムがメッセージの内容を改善させることがあります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-223">In some cases, the program might improve the wording of messages.</span></span> <span data-ttu-id="3a5b7-224">または、使用法のガイダンスに合わせるために**警告()** の代わりに**エラー()**、または**エラー()** の代わりに**警告()** を使用するかもしれません (警告は無効なデータ、エラーは失敗したアクションのためのものです)。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-224">Alternatively, the program might use **error()** instead of **warning()**, or **warning()** instead of **error()**, to better align with the usage guidance (warnings are for data that isn't valid, whereas errors are for failed actions).</span></span> <span data-ttu-id="3a5b7-225">それ以外の場合、スライダーのダイアログに表示されるメッセージが親ページに適していると判断できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-225">In other cases, you might decide that messages that appear on a slider dialog are more appropriate for the parent page.</span></span>

## <a name="how-to-create-a-collection-of-related-messages"></a><span data-ttu-id="3a5b7-226">関連メッセージのコレクションの作成方法</span><span class="sxs-lookup"><span data-stu-id="3a5b7-226">How to create a collection of related messages?</span></span>  
<span data-ttu-id="3a5b7-227">**SetPrefix()** を使用して関連するメッセージのコレクションを作成するための詳細は、[メッセージング API](messaging-api-center-bar-details.md) を **Setprefix ()** ご覧ください。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-227">You use **SetPrefix()** to create collections of related messages [See the [Messaging APIs](messaging-api-center-bar-details.md) for more details on **SetPrefix()**.</span></span> <span data-ttu-id="3a5b7-228">この API は主に下位互換性がありますが、中断のない方法で表示されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-228">This API is largely backward compatible but is presented in a non-interrupting manner.</span></span> <span data-ttu-id="3a5b7-229">結果ウィンドウを直接開くことはできません。代わりに、ユーザーは、結果メッセージをコレクションにグループ化するために**setprefix ()** APIを使用したタスクを開始したアクション センターメッセージまたはページ上のメッセージバーによって、受動的に通知を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-229">A results window isn't opened directly; instead, the user is passively notified by either an Action center message or a message bar on the page that started the task that used the **SetPrefix()** API to group the result messages into a collection.</span></span> <span data-ttu-id="3a5b7-230">ユーザーに対して表示されるメッセージの重大度は、コレクション内の最も重要なメッセージの重大度レベルを反映しています。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-230">The message severity shown to the user reflects the severity of the most critical message in the collection.</span></span> <span data-ttu-id="3a5b7-231">たとえば、コレクションにエラーまたは警告が含まれていない場合、メッセージ バーは**情報**タイプです。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-231">For example, if the collection contains no errors or warnings, the message bar is of the **info** type.</span></span> 

![情報タイプ メッセージ バーの例](./media/messaging_messagedetailsmessagebar.jpg) 

<span data-ttu-id="3a5b7-233">コレクションに 1 つまたは複数の **warning()** への呼び出しが含まれている場合、メッセージ バーは、**警告**タイプです。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-233">If the collection contains one or more calls to **warning()**, the message bar is of the **warning** type.</span></span> 

![警告タイプ メッセージ バーの例](./media/messaging_messagedetailswarningmessagebar.jpg) 

<span data-ttu-id="3a5b7-235">コレクションに 1 つまたは複数の **error()** への呼び出しが含まれている場合、メッセージ バーは、**エラー** タイプです。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-235">If the collection contains one or more calls to **error()**, the message bar is of the **error** type.</span></span> 

![エラー タイプ メッセージ バーの例](./media/messaging_messagedetailserrormessagebar.jpg) 

<span data-ttu-id="3a5b7-237">**SetPrefix()** の使用も確定的です。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-237">The use of **SetPrefix()** is also deterministic.</span></span> <span data-ttu-id="3a5b7-238">つまり、**SetPrefix()** を使用して、ページ コンテキスト (たとえば、非同期バッチ操作) が存在しない場合、結果の通知はページに関連付けられていないアクション センターに送信されます。</span><span class="sxs-lookup"><span data-stu-id="3a5b7-238">In other words, if you use **SetPrefix()**, and there is no page context (for example, an asynchronous batch operation), the notification of results is sent to the Action center, which isn't associated with any page.</span></span>



