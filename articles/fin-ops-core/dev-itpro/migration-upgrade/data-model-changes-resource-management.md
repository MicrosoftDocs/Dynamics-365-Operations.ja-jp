---
title: プロジェクト リソースのスケジューリング データ モデル
description: このトピックでは、プロジェクト リソースのスケジューリング データ モデルについて説明します。
author: ShylaThompson
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.custom: 202281
ms.assetid: 46d23d3e-b5ef-43a7-ae9d-a1e202cc8abc
ms.search.region: Global
ms.author: sericks
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: fe6d577b30fd54ab77de5d2e2e813a93738e5d71
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2020
ms.locfileid: "4679974"
---
# <a name="project-resource-scheduling-data-model"></a>プロジェクト リソースのスケジューリング データ モデル

[!include [banner](../includes/banner.md)]

このトピックでは、プロジェクト リソースのスケジューリング データ モデルについて説明します。

## <a name="physical-data-model-for-project-resource-scheduling"></a>プロジェクト リソースのスケジューリングの物理データ モデル

次の図は、プロジェクト リソース スケジューリング物理データ モデルのデータ設計構造を表しています。   [![リソース管理データ モデル](./media/resource-management-data-model.jpg)](./media/resource-management-data-model.jpg)

## <a name="tables"></a>テーブル
次のテーブルに、リソース管理データ モデルをサポートする追加のテーブルの一覧を示します。

| テーブル                        | 説明       |
|---------------------------------|-----------------------|
|     ResResourceIdentifier     |                                                                                                                                                                                                                                    すべてのリソースとレコードのサブセット、リソースとして指定されている <strong>WrkCtrTable</strong> テーブルから格納します。 リソースが追加されると、レコードが <strong>WrkCtrTable **テーブルに追加されます。レコードは、**WrkCtrTable</strong> テーブル内の新規レコードへの外部キー参照によって、このテーブルにも追加されます。                                                                                                                                                                                                                                     |
|         ResourceSetup         |                                                                                                                                                                                                                                                                                                                                                 リソースのプロパティを指定します。 このテーブルは、Dynamics AX 2012 の <strong>ProjWorkerSetup</strong> テーブルに取って代わりました。                                                                                                                                                                                                                                                                                                                                                 |
|          ResBooking           |                                                                                                                                                                                                                                                                                                                     すべてのリソースの予約タイプの引当を格納します。 このテーブルは、Dynamics AX 2012 の <strong>PSASchedEmplReservation</strong> テーブルに格納されている情報の一部に取って代わりました。                                                                                                                                                                                                                                                                                                                     |
|         ResAssignment         |                                                                                                                                                                                                                                                                                                                   すべてのリソースの割り当てタイプの引当を格納します。 このテーブルは、Dynamics AX 2012 の <strong>PSASchedEmplReservation</strong> テーブルに格納されている情報の一部に取って代わりました。                                                                                                                                                                                                                                                                                                                    |
| ResourceResourceCategorySetup |                                                                                                                                                                                                       時間範囲ごとに検証されるリソースの既定のプロジェクト ロールの関連付けを保存します。 これは、<strong>ResResourceIdentifier.RecId</strong> への外部キーと <strong>ValidFrom</strong> と <strong>ValidTo</strong> フィールドによる <strong>PSASchedRole.RecId</strong> への外部キーを持つ時間有効なテーブルです。 <strong>PSASchedRole</strong> テーブルは、プロジェクト ロールを格納するために使用されます。                                                                                                                                                                                                        |
|      ResCalendarCapacity      |                                                                                                                                                                   これは、<strong>WorkCalendarTable</strong>、<strong>WorkCalendarDate</strong>、および<strong>WorkCalendarDateLine</strong> に基づいてリソースの容量を計算するデータ非正規化テーブルです。 この計算は、<strong>WorkCalendarDataLine</strong> 表で指定されている、リソース関連のカレンダー日付の行定義に基づいています。 この表のデータは、<strong>リソース能力のロールアップを同期</strong> バッチ ジョブを実行して生成できます。                                                                                                                                                                    |
|       ResRollUpCalendar       |                                                                                                                                                                                                                 これは、<strong>ResCalendarCapacity</strong> に基づくデータ非正規化テーブルです。 このテーブルのデータは、リソースレコードを <strong>ResRollup</strong> テーブルに追加する処理を高速化するために、<strong>ResRollUpWriter</strong> クラスによって使用されます。 この表のデータは、<strong>リソース能力のロールアップを同期</strong> バッチ ジョブを実行して生成できます。                                                                                                                                                                                                                  |
|           ResRollUp           | これは、パフォーマンス改善のための <strong>ResBooking</strong>、<strong>ResAssignment</strong>、および <strong>ResRollUpCalendar</strong> に基づくデータ非正規化テーブルです。 このテーブルには、すべてのリソースに関するすべてのキャパシティおよび予約データが、曜日、週、月、四半期、および半年を含むタイム スケールで含まれています。 このデータは、<strong>AvailabilityView</strong> のコントロールによってアクセスされますが、<strong>リソースの可用性</strong> フォームなど、このコントロールを含むリソース スケジューリング X++ フォームに含まれています。 この表のデータは、<strong>リソース能力のロールアップを同期</strong> バッチ ジョブを実行して生成できます。 データは、新しいリソースの追加、予約、割り当て、および予約の取り消しなどのリソース予約アクションごとに更新されます。 |

## <a name="views"></a>ビュー
次のテーブルは、リソース管理データ モデルにアクセスするために使用できる最も有益なビューの一覧です。

| 表示                        | 説明       |
|---------------------------------|-----------------------|
| ResResourceWorkCenterView       | このビューは **WrkCtrTable** に参加する **ResResourceIdentifier** に基づいており、リソース管理に必要なフィールドだけをキャプチャします。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ResourceView                    | このビューは、**ResResourceWorkCenterView** にのみ基づいている **ResResourceIdentifier** に基づいています。 今後のリリースでは、リソース レコードを **ResResourceWorkCenterView** 以外に保存する場合に、**ResResourceWorkCenterView** 以外にも拡張できるようになります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ResourceWorkerView              | このビューは、**ResResourceIdentifier** に基づいている **HcmWorker** テーブルに置き換わります。 **WrkCtrTable** には、**HcmWorkerTable** への外部キーである作業者フィールドがあります。 このビューには、作業者フィールドが 0 ではない、すべての **WrkCtrTable** リソースが含まれます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ResourceLegalEntityView         | このビューは **HcmEmployment** テーブルに置き換わります。 これは **ResourceWorkerLegalEntityView** と **ResourceOtherLegalEntityView** の和集合であるリソース法人エンティティ (LE) ビューです。 このビューの目的は、リソース法人および関連する発効日と有効終了日を検索することです。 たとえば、**HcmWorker** リソースは、異なる ValidFrom および ValidTo を持つ複数の LE によって採用されます。 作業者が複数の LE に雇用されている場合、このワーカー リソースにはこのビューの複数のレコードが存在するようになります。 リソースが **HcmWorker** ではない場合、このリソースには 1 つのレコード、**validFrom** = **minDate** および **ValidTo** = **maxDate** のみが含まれます。                                                      |
| ResourceCalendarView            | このビューは **WorkCalendarTable** に置き換わります。 このビューには、リソースのカレンダー **RecId** が含まれています。 これは、**ResourceWorkerCalendarView**、R **esourceOtherCalendarView**、および **ResourceGroupResourceCalendarView** の UNION ビューです。 リソース カレンダーを検索するには、最初に **ResourceLegalEntityview** を検索する必要があります。 これは、リソースの法人によって、リソースが異なるカレンダーを持つ必要があるためです。 最初に、**ResourceLegalEntityView** からレコードを探し、**RefRecId** および **RefTableId** フィールドを取得します。 次に、**ResourceLegalEntityRefRecId** = **ResourceLegalView.RefRecId** および **ResourceLegalEntityRefTableId** = **ResourceLegalView.RefTableId** を設定して **ResourceCalendarView** を検索します。 |
| ResourceCategoryView            | このビューには、**PSASchedRole** テーブルに基づくリソース カテゴリ（作業者リソースのリソース ロール）が表示されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ResSkillHcmView                 | このビューは **HcmSkill** に基づいており、**HcmSkills** テーブルで定義されているすべてのスキルを取得します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ResCertificateHcmView           | このビューは **HcmCertificateType** に基づいており、**HcmCertificateType** テーブルで定義されているすべての証明書を取得します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ResEducationHcmView             | このビューは **HcmEducationDiscipline** に基づいており、**HcmEducationDiscipline** テーブルで定義されているすべての教育分野を取得します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ResProjectHcmView               | このビューは **ProjTable** に基づいており、**ProjTable** テーブルで定義されているすべてのプロジェクトを取得します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ResRoleView                     | このビューは **ResourceCategoryView** に基づいており、リソースのすべてのカテゴリを取得します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ResCharacteristicView           | このビューは、**ResSkillHcmView**、**ResCertificateHcmView**、**ResEducationHcmView**、**ResProjectHcmView**、および **ResRoleView** の UNION ビューです。 このビューは、リソース検索機能の選択可能な基準として定義されているすべての特性を収集するために使用されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ResResourceCharacteristicView   | このビューは、**ResResourceCharacteristicHcmView**、**ResResourceResourceCategoryView**、**ResResourceNameView**、および **ResResourceRoleCharacteristicView** の UNION ビューです。 このビューは、リソース検索機能のリソースに関連付けられている特性を識別するために使用されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ResCalendarCapacityView         | このビューは **ResCalendarCapacity** に基づいており、**WorkCalendarTable** で容量の詳細を指定したカレンダーが含まれています。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ResCapacityView                 | このビューには、1 時間あたりのリソースのキャパシティが表示されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ResResourceCapacityWorkDaysView | このビューは **ResCapacityView** に基づいており、1 日あたりのリソース キャパシティが表示されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ResAssignmentView               | このビューはテーブル **ResAssignment** に基づいており、プロジェクトまたは見積作業分解構造 (WBS) タスクへの活動 リソースの割り当てを格納します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ResBookingView                  | このビューはテーブル **ResBooking** に基づいており、アクティビティ リソースの予約をプロジェクトまたは見積書に格納します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

## <a name="changes-that-will-affect-tables-and-fields"></a>テーブルとフィールドに影響する変更

これらのセクションには、プロジェクト リソースのスケジューリングに関連する機能の実装の一部である、テーブルおよびフィールドのコード変更に関する情報が含まれています。

### <a name="resource-scheduling"></a>リソース スケジューリング
テーブル <strong>PSASchedEmplReservation</strong> は、リソースの予約の保存には使用されなくなりました。 その代わり、予約は <strong>ResAssignment</strong> および <strong>ResBooking **テーブルに保存されます。**活動リソース</strong> フィールドの外部キーを <strong>PSAProjSchedRole.RecId</strong> に対して使用してリソースの予約を保存します。 <strong>PSAProjSchedRole</strong> テーブルは、どのリソースがプロジェクト チームまたは見積チームのメンバーであるかを識別するために、<strong>ResourceView.RecId</strong> への <strong>Resource</strong> フィールド外部キーと <strong>CompanyInfo.RecId</strong> への <strong>ResourceLegalEntity</strong> フィールド外部キーを持つプロジェクト チーム テーブルです。 <strong>PSAProjSchedRole.Resource</strong> フィールド = 0 の場合、この活動のリソースは計画リソースとなります。 計画されているリソースは、実際のリソースではサポートされないシャドウ リソースです。 <strong>PSAProjSchedRole.ResourceCategory</strong> は、このチームメンバーのロールを格納する <strong>PSASchedRole</strong> の外部キーです。 <strong>ResourceResourceCategorySetup</strong> テーブルは、既定の時間効率の良いリソース/役割の関連付けを保存します。 ただし、<strong>ResourceResourceCategorySetup</strong> テーブルの既定のロール定義を無視し、<strong>PSAProjSchedRole.ResourceCategory</strong> により定義された任意のロールにリソースを引当できます。 WBS バージョン管理については、テーブル <strong>ProjPlanVersions</strong> および <strong>ProjPlanVersionDetails</strong> に WBS タスク バージョンが保存されます。 最初、すべての WBS タスク データは、ユーザーが WBS タスクの内容を編集しているときにこれらのテーブルに保存されます。 ユーザーが <strong>発行</strong> ボタンをクリックすると、タスクのデータは元の階層テーブルにプッシュされます (<strong>smmActivities</strong> および <strong>PSAActivitySetup</strong>) 。 リソース管理機能では、元の階層テーブルにデータが必要で、公開された WBS が必要です。

### <a name="price-by-resource-and-resource-category"></a>リソースおよびリソース カテゴリ別の価格
価格決定テーブル、**ProjCostPriceExpense**、**ProjCostSalesPrice**、および **ProjRevenueSalesPrice** には、**ResourceView.RecId** からの外部キーがあります。 テーブル **ProjHourCostPrice**、**ProjHourSalesPrice**、**ProjTransferPrice** には、**ResourceView.RecId** からの外部キーがあります。 フィールド **ResourceCategory** は、**ResourceCategoryView.RecId** の外部キーの一部です。 これは、価格設定が作業者ではなくリソースに基づいており、リソース カテゴリによる価格設定が可能になるように行われます。

### <a name="common-methods-to-get-resource-field-and-lookup-resources"></a>リソース フィールドおよびルックアップ リソースを取得する一般的なメソッド
**ResourceFacade** クラスにはいくつかのリソース メソッドがあります。 次のテーブルに、最も一般的なメソッドのいくつかが含まれています。

| クラス メソッド                        | **説明**       |
|---------------------------------|-----------------------|
| ResourceFacade.findByWorker()         | **HcmWorker** レコード ID でリソース レコード ID を検索します。                                                                                                                                                                                                                                                                                    |
| ResourceFacade.findOrCreateByWorker() | **HcmWorker** レコード ID でリソース レコード ID を検索します。  リソース レコード ID が見つからない場合、リソース レコード ID は **ResResourceIdentifier** テーブルに追加され、そのリソース レコード ID は返されます。                                                                                                               |
| ResourceFacade.findByResourceID()     |  リソース ID でリソース レコード ID を検索します。                                                                                                                                                                                                                                                                                               |
| ResourceFacade.get…                   | **ResourceFacade** クラスには、リソースに対してサポートされている get メソッドが多数あります。 **Resource ID**、**Resource calendar**、**Resource legal entity**、**Resource period** などのリソース関連の値は、**ResourceView**、**ResourceLegalEntityView**、**ResourceCalendarView**、および **ResourceSetup** テーブルから照会されます。 |

### <a name="facade-classes"></a>ファサード クラス
次のテーブルに、リソース管理データ モデルとやりとりするための開始点として使用できるファサード クラスを示します。

| クラス                        | 説明       |
|---------------------------------|-----------------------|
| ActivityFacade         | **ID**、**見積 ID**、**プロジェクト ID**、**予約済み/割り当て済のキャパシティ**、**残余キャパシティ**、**カレンダー**、**活動番号** および **ルート プロジェクト活動** を含む活動プロパティを取得するメソッドが含まれています。 |
| ActivityResourceFacade | **カレンダー**、**名前**、**リソース カテゴリ**、**リソース法人**、**一般的なリソース** および **チーム メンバー** を含むアクティビティのリソース プロパティを取得するメソッドが含まれています。                                |
| PeriodFacade           | **開始日および終了日**、**期間 ID** および **期間名** を含む期間プロパティを取得するメソッドが含まれています。                                                                                                               |
| ResourceCalendarFacade | **カレンダー データ エリア ID**、**カレンダー ID**、**カレンダー RecID**、**キャパシティ** および **日付** を含むリソースのカレンダー プロパティを取得するメソッドが含まれています。                                                             |
| ResourceCategoryFacade | リソースの既定のリソースである、**カテゴリ**、**ID**、**名前** および **タイプ** を取得するメソッドが含まれています。                                                                                                                         |
| ResourcePeriodFacade   | リソースの期間の日付範囲を取得し、期間メソッドを更新するメソッドが含まれています。                                                                                                                                        |
| ResourceWorkerFacade   | **雇用** タイプを取得するメソッドが含まれています。                                                                                                                                                                              |

 





[!INCLUDE[footer-include](../../../includes/footer-banner.md)]