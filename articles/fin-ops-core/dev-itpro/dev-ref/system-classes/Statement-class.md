---
title: Statement クラス
description: このトピックでは、Statement クラスについて説明します。
author: robinarh
manager: tonyafehr
ms.date: 06/25/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.search.scope: Operations
ms.search.region: Global
ms.author: rhaertle
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 85fe4a09e8c6b0f041869418da5921a489b95fd9
ms.sourcegitcommit: 7b0cec2e898ef8ee33baf72f18cdd9cba0e9399c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2020
ms.locfileid: "3502796"
---
# <a name="class-statement"></a><span data-ttu-id="20873-103">クラスの明細書</span><span class="sxs-lookup"><span data-stu-id="20873-103">Class Statement</span></span>

[!include [banner](../../includes/banner.md)]

```xpp
class Statement extends Object
```

<span data-ttu-id="20873-104">Statement クラスは、静的 SQL ステートメントを実行し、生成された結果を取得します。</span><span class="sxs-lookup"><span data-stu-id="20873-104">The Statement class executes a static SQL statement and obtains the results it produces.</span></span>

## <a name="remarks"></a><span data-ttu-id="20873-105">備考</span><span class="sxs-lookup"><span data-stu-id="20873-105">Remarks</span></span>

<span data-ttu-id="20873-106">明細書ごとに 1 つだけ、任意の時点で開くことができます。</span><span class="sxs-lookup"><span data-stu-id="20873-106">Only one per Statement can be open at any point in time.</span></span> <span data-ttu-id="20873-107">したがって、1 つの ResultSet の読み込みが別の ResultSet の読み込みとインターリーブされている場合は、それぞれ異なるステートメントによって生成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="20873-107">Therefore, if the reading of one ResultSet is interleaved with the reading of another, each must have been generated by different Statements.</span></span> <span data-ttu-id="20873-108">レコードとフィールド レベルのセキュリティは、明細書クラスでは適用されません。</span><span class="sxs-lookup"><span data-stu-id="20873-108">Record and field level securities are not enforced on the Statement class.</span></span> <span data-ttu-id="20873-109">したがって、明示的なセキュリティ検証を行わずにユーザーに返されるデータを公開していないことを、確認してください。</span><span class="sxs-lookup"><span data-stu-id="20873-109">Therefore, make sure you are not exposing data returned to the user without doing explicit security validation.</span></span> <span data-ttu-id="20873-110">すべての実行可能な明細メソッドは現在 ResultSet で開いている場合明細書は暗黙的に閉じます。</span><span class="sxs-lookup"><span data-stu-id="20873-110">All statement executed methods implicitly close a statement's current ResultSet if an open one exists.</span></span>

## <a name="examples"></a><span data-ttu-id="20873-111">例</span><span class="sxs-lookup"><span data-stu-id="20873-111">Examples</span></span>

```xpp
static void example() 
{ 
    Connection Con; 
    Statement Stmt; 
    ResultSet R; 
    SqlStatementExecutePermission perm; 
    str sql = 'SELECT VALUE FROM SQLSYSTEMVARIABLES'; 
    Con = new Connection(); 
    Stmt = Con.createStatement(); 
    perm = new SqlStatementExecutePermission(sql); 
    perm.assert(); 
    R = Stmt.executeQuery(sql); 
    while ( R.next() ) 
    { 
        print R.getString(1); 
    } 
}
```

## <a name="methods"></a><span data-ttu-id="20873-112">メソッド</span><span class="sxs-lookup"><span data-stu-id="20873-112">Methods</span></span>

| <span data-ttu-id="20873-113">方法</span><span class="sxs-lookup"><span data-stu-id="20873-113">Method</span></span>                                       | <span data-ttu-id="20873-114">説明</span><span class="sxs-lookup"><span data-stu-id="20873-114">Description</span></span>                                                                                       |
|----------------------------------------------|---------------------------------------------------------------------------------------------------|
| <span data-ttu-id="20873-115">public ResultSet executeQuery(str statement)</span><span class="sxs-lookup"><span data-stu-id="20873-115">public ResultSet executeQuery(str statement)</span></span> | <span data-ttu-id="20873-116">インスタンスの the を返す SQL ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-116">Executes an SQL statement that returns an instance of the .</span></span>                                       |
| <span data-ttu-id="20873-117">public int executeUpdate(str statement)</span><span class="sxs-lookup"><span data-stu-id="20873-117">public int executeUpdate(str statement)</span></span>      | <span data-ttu-id="20873-118">SQL INSERT、UPDATE、または DELETE ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-118">Executes a SQL INSERT, UPDATE, or DELETE statement.</span></span>                                               |
| <span data-ttu-id="20873-119">public int getLastError()</span><span class="sxs-lookup"><span data-stu-id="20873-119">public int getLastError()</span></span>                    | <span data-ttu-id="20873-120">最後の SQL 操作の SQL データベース バックエンドによって返されたエラー コードを取得します。</span><span class="sxs-lookup"><span data-stu-id="20873-120">Retrieves the error code returned by the SQL database backend for the last SQL operation.</span></span>         |
| <span data-ttu-id="20873-121">public str getLastErrorText()</span><span class="sxs-lookup"><span data-stu-id="20873-121">public str getLastErrorText()</span></span>                | <span data-ttu-id="20873-122">最後の SQL 操作の SQL データベース バックエンドによって返されたエラー テキストを取得します。</span><span class="sxs-lookup"><span data-stu-id="20873-122">Retrieves the error text that is returned by the SQL database backend for the last SQL operation.</span></span> |
| <span data-ttu-id="20873-123">public int getMaxFieldSize()</span><span class="sxs-lookup"><span data-stu-id="20873-123">public int getMaxFieldSize()</span></span>                 | <span data-ttu-id="20873-124">現在の列の最大サイズ制限を返します (ある場合)。</span><span class="sxs-lookup"><span data-stu-id="20873-124">Returns the current maximum column size limit, if any.</span></span>                                            |
| <span data-ttu-id="20873-125">public void close()</span><span class="sxs-lookup"><span data-stu-id="20873-125">public void close()</span></span>                          | <span data-ttu-id="20873-126">ステートメント オブジェクトのデータベースのリソースを解放します。</span><span class="sxs-lookup"><span data-stu-id="20873-126">Releases the database resources of a statement object.</span></span>                                            |
| <span data-ttu-id="20873-127">public void setMaxFieldSize(int max)</span><span class="sxs-lookup"><span data-stu-id="20873-127">public void setMaxFieldSize(int max)</span></span>         | <span data-ttu-id="20873-128">列の最大サイズ制限を設定します。</span><span class="sxs-lookup"><span data-stu-id="20873-128">Sets the maximum column size limit.</span></span>                                                               |

## <a name="method-executequery"></a><span data-ttu-id="20873-129">メソッド executeQuery</span><span class="sxs-lookup"><span data-stu-id="20873-129">Method executeQuery</span></span>

<span data-ttu-id="20873-130">インスタンスの the を返す SQL ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-130">Executes an SQL statement that returns an instance of the .</span></span>

```xpp
public ResultSet executeQuery(str statement)
```

### <a name="parameters---executequery"></a><span data-ttu-id="20873-131">パラメーター - executeQuery</span><span class="sxs-lookup"><span data-stu-id="20873-131">Parameters - executeQuery</span></span>

<span data-ttu-id="20873-132">明細書</span><span class="sxs-lookup"><span data-stu-id="20873-132">statement</span></span>  
<span data-ttu-id="20873-133">結果セットを取得するために使用される SQL ステートメントを含む文字列。</span><span class="sxs-lookup"><span data-stu-id="20873-133">The string that contains the SQL statement that is used to retrieve the result set.</span></span>

### <a name="return-value---executequery"></a><span data-ttu-id="20873-134">戻り値 - executeQuery</span><span class="sxs-lookup"><span data-stu-id="20873-134">Return Value - executeQuery</span></span>

<span data-ttu-id="20873-135">クエリから返されたデータを含むオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="20873-135">The object that contains the data returned from the query.</span></span>

### <a name="remarks---executequery"></a><span data-ttu-id="20873-136">備考 - executeQuery</span><span class="sxs-lookup"><span data-stu-id="20873-136">Remarks - executeQuery</span></span>

<span data-ttu-id="20873-137">ユーザーが executeQuery メソッドへの入力を制御すると、SQL インジェクション攻撃が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="20873-137">If users control input to the executeQuery method, an SQL injection threat can occur.</span></span> <span data-ttu-id="20873-138">したがって、このメソッドは、コード アクセス セキュリティで実行されます。</span><span class="sxs-lookup"><span data-stu-id="20873-138">Therefore, this method runs under Code Access Security.</span></span> <span data-ttu-id="20873-139">サーバー上でこのメソッドを呼び出すには、 からのアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="20873-139">Calls to this method on the server require permission from the .</span></span> <span data-ttu-id="20873-140">SQL ステートメントを実行するための安全な方法は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="20873-140">The following are safer alternatives for executing SQL statements:</span></span>

-   <span data-ttu-id="20873-141">クエリ</span><span class="sxs-lookup"><span data-stu-id="20873-141">Queries</span></span>
-   <span data-ttu-id="20873-142">ビュー</span><span class="sxs-lookup"><span data-stu-id="20873-142">Views</span></span>
-   <span data-ttu-id="20873-143">X++ select ステートメント</span><span class="sxs-lookup"><span data-stu-id="20873-143">X++ select statements</span></span>

<span data-ttu-id="20873-144">レコード レベル セキュリティは、明細書クラスでは適用されません。</span><span class="sxs-lookup"><span data-stu-id="20873-144">Record level security is not enforced on the Statement class.</span></span> <span data-ttu-id="20873-145">データがユーザーに公開されている場合は、明示的セキュリティ検証を実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-145">If data is exposed to the user, perform explicit security validation.</span></span>

### <a name="examples---executequery"></a><span data-ttu-id="20873-146">例 - executeQuery</span><span class="sxs-lookup"><span data-stu-id="20873-146">Examples - executeQuery</span></span>

<span data-ttu-id="20873-147">次の例では、サーバー上で実行される、CustTable で SQL クエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-147">The following example performs an SQL query on CustTable, which runs on the server.</span></span> <span data-ttu-id="20873-148">クエリの結果は、resultSet オブジェクトに格納されます。</span><span class="sxs-lookup"><span data-stu-id="20873-148">The result of the query is stored in the resultSet object.</span></span>

```xpp
server static void main(Args _args) 
{ 
    DictTable  dictTable; 
    Connection connection; 
    Statement  statement; 
    str        sql; 
    ResultSet  resultSet; 
    SqlStatementExecutePermission perm; 
    dictTable = new DictTable(tableNum(CustTable)); 
    if (dictTable != null) 
        { 
           connection = new Connection(); 
           sql = strfmt( "SELECT * FROM %1", dictTable.name(DbBackend::Sql) ); 
           perm = new SqlStatementExecutePermission(sql); 
           // Check for permission to use the statement. 
           perm.assert(); 
           statement = connection.createStatement(); 
           resultSet = statement.executeQuery(sql); 
           // End the scope of the assert call. 
           CodeAccessPermission::revertAssert(); 
        } 
}
```

## <a name="method-executeupdate"></a><span data-ttu-id="20873-149">メソッド executeUpdate</span><span class="sxs-lookup"><span data-stu-id="20873-149">Method executeUpdate</span></span>

<span data-ttu-id="20873-150">SQL INSERT、UPDATE、または DELETE ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-150">Executes a SQL INSERT, UPDATE, or DELETE statement.</span></span>

```xpp
public int executeUpdate(str statement)
```

### <a name="parameters---executeupdate"></a><span data-ttu-id="20873-151">パラメーター - executeUpdate</span><span class="sxs-lookup"><span data-stu-id="20873-151">Parameters - executeUpdate</span></span>

<span data-ttu-id="20873-152">明細書</span><span class="sxs-lookup"><span data-stu-id="20873-152">statement</span></span>  
<span data-ttu-id="20873-153">データベースに渡される SQL ステートメントを含む文字列。</span><span class="sxs-lookup"><span data-stu-id="20873-153">The string that contains the SQL statement being passed to the database.</span></span>

### <a name="return-value---executeupdate"></a><span data-ttu-id="20873-154">戻り値 - executeUpdate</span><span class="sxs-lookup"><span data-stu-id="20873-154">Return Value - executeUpdate</span></span>

<span data-ttu-id="20873-155">更新された行数。それ以外は、何も返さない SQL ステートメントの 0 (ゼロ)。</span><span class="sxs-lookup"><span data-stu-id="20873-155">An updated row count; otherwise, 0 (zero) for SQL statements that return nothing.</span></span>

### <a name="remarks---executeupdate"></a><span data-ttu-id="20873-156">備考 - executeUpdate</span><span class="sxs-lookup"><span data-stu-id="20873-156">Remarks - executeUpdate</span></span>

<span data-ttu-id="20873-157">SQLDDL ステートメントなど、何も返さない SQL ステートメントを実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="20873-157">SQL statements that return nothing, such as SQLDDL statements, can also be executed.</span></span> <span data-ttu-id="20873-158">ユーザーが executeUpdate メソッドへの入力を制御すると、SQL インジェクション攻撃が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="20873-158">If users control input to the executeUpdate method, an SQL injection thread can occur.</span></span> <span data-ttu-id="20873-159">したがって、このメソッドは、コード アクセス セキュリティで実行されます。</span><span class="sxs-lookup"><span data-stu-id="20873-159">Therefore, this method runs under Code Access Security.</span></span> <span data-ttu-id="20873-160">サーバー上でこのメソッドを呼び出すには、 からのアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="20873-160">Calls to this method on the server require permission from the .</span></span> <span data-ttu-id="20873-161">データベースとやり取りするための安全な方法は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="20873-161">The following are safer alternatives for interacting with the database:</span></span>

-   <span data-ttu-id="20873-162">クエリ</span><span class="sxs-lookup"><span data-stu-id="20873-162">Queries</span></span>
-   <span data-ttu-id="20873-163">ビュー</span><span class="sxs-lookup"><span data-stu-id="20873-163">Views</span></span>
-   <span data-ttu-id="20873-164">X++ select ステートメント</span><span class="sxs-lookup"><span data-stu-id="20873-164">X++ select statements</span></span>

<span data-ttu-id="20873-165">レコード レベル セキュリティは、明細書クラスでは適用されません。</span><span class="sxs-lookup"><span data-stu-id="20873-165">Record level security is not enforced on the Statement class.</span></span> <span data-ttu-id="20873-166">データがユーザーに公開されている場合は、明示的セキュリティ検証を実行します。</span><span class="sxs-lookup"><span data-stu-id="20873-166">If data is exposed to the user, perform explicit security validation.</span></span>

## <a name="method-getlasterror"></a><span data-ttu-id="20873-167">メソッド getLastError</span><span class="sxs-lookup"><span data-stu-id="20873-167">Method getLastError</span></span>

<span data-ttu-id="20873-168">最後の SQL 操作の SQL データベース バックエンドによって返されたエラー コードを取得します。</span><span class="sxs-lookup"><span data-stu-id="20873-168">Retrieves the error code returned by the SQL database backend for the last SQL operation.</span></span>

```xpp
public int getLastError()
```

### <a name="return-value---getlasterror"></a><span data-ttu-id="20873-169">戻り値 - getLastError</span><span class="sxs-lookup"><span data-stu-id="20873-169">Return Value - getLastError</span></span>

<span data-ttu-id="20873-170">最後の SQL 操作の SQL データベース バックエンドによって返されたエラー コード。成功の場合は 0 です。</span><span class="sxs-lookup"><span data-stu-id="20873-170">The error code returned by the SQL database backend for the last SQL operation; or 0 for success.</span></span>

### <a name="examples---getlasterror"></a><span data-ttu-id="20873-171">例 - getLastError</span><span class="sxs-lookup"><span data-stu-id="20873-171">Examples - getLastError</span></span>

```xpp
static void StatementGetLastError()  
{ 
    str sql, sql2; 
    UserConnection Connection = new UserConnection(); 
    Statement Statement = Connection.createStatement(); 
    boolean clear_infolog = false; 
    print "-Delete-a-non-existing-record-(valid statement)-----------"; 
    sql = "delete from zipcode where Recid = 2"; 
    new SqlStatementExecutePermission(sql).assert(); 
    Statement.executeUpdate(sql); 
    print " Error code was: ", Statement.getLastError(); 
    print " Error message was '", Statement.getLastErrorText(), "'"; 
    try 
    { 
        print "\n"; 
        print "-Delete-from-a-non-existing-table-(invalid statement)---    --"; 
        sql2 = "delete from StrangeTable07"; 
        new SqlStatementExecutePermission(sql2).assert(); 
        Statement.executeUpdate(sql2); 
    } 
    catch (exception::Error) 
    { 
        print "Exception was caught:"; 
        print " Error code was: ", Statement.getLastError(); 
        print " Error message was '", Statement.getLastErrorText(), "'"; 
    } 
    CodeAccessPermission::revertAssert(); 
    pause; 
}
```

## <a name="method-getlasterrortext"></a><span data-ttu-id="20873-172">メソッド getLastErrorText</span><span class="sxs-lookup"><span data-stu-id="20873-172">Method getLastErrorText</span></span>

<span data-ttu-id="20873-173">最後の SQL 操作の SQL データベース バックエンドによって返されたエラー テキストを取得します。</span><span class="sxs-lookup"><span data-stu-id="20873-173">Retrieves the error text that is returned by the SQL database backend for the last SQL operation.</span></span>

```xpp
public str getLastErrorText()
```

### <a name="return-value---getlasterrortext"></a><span data-ttu-id="20873-174">戻り値 - getLastErrorText</span><span class="sxs-lookup"><span data-stu-id="20873-174">Return Value - getLastErrorText</span></span>

<span data-ttu-id="20873-175">最後の SQL 操作の SQL データベースによって提供されるエラー テキスト。</span><span class="sxs-lookup"><span data-stu-id="20873-175">The error text that is provided by the SQL database for the last SQL operation.</span></span>

## <a name="method-getmaxfieldsize"></a><span data-ttu-id="20873-176">メソッド getMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-176">Method getMaxFieldSize</span></span>

<span data-ttu-id="20873-177">現在の列の最大サイズ制限を返します (ある場合)。</span><span class="sxs-lookup"><span data-stu-id="20873-177">Returns the current maximum column size limit, if any.</span></span>

```xpp
public int getMaxFieldSize()
```

### <a name="return-value---getmaxfieldsize"></a><span data-ttu-id="20873-178">戻り値 - getMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-178">Return Value - getMaxFieldSize</span></span>

<span data-ttu-id="20873-179">現在の列の最大サイズ制限。0 は無制限を意味します。</span><span class="sxs-lookup"><span data-stu-id="20873-179">The current maximum column size limit; 0 means unlimited.</span></span>

### <a name="remarks---getmaxfieldsize"></a><span data-ttu-id="20873-180">備考 - getMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-180">Remarks - getMaxFieldSize</span></span>

<span data-ttu-id="20873-181">maxFieldSize の制限 (バイト単位) は、任意の列の値に対して返されるデータの最大量です。binary、varbinary、longvarbinary、char、varchar、および longvarchar 列にのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="20873-181">The maxFieldSize limit (in bytes) is the maximum amount of data returned for any column value; it only applies to binary, varbinary, longvarbinary, char, varchar, and longvarchar columns.</span></span> <span data-ttu-id="20873-182">制限を超過した場合、余分なデータは通知なしに破棄されます。</span><span class="sxs-lookup"><span data-stu-id="20873-182">If the limit is exceeded, the excess data is silently discarded.</span></span>

## <a name="method-close"></a><span data-ttu-id="20873-183">メソッド close</span><span class="sxs-lookup"><span data-stu-id="20873-183">Method close</span></span>

<span data-ttu-id="20873-184">ステートメント オブジェクトのデータベースのリソースを解放します。</span><span class="sxs-lookup"><span data-stu-id="20873-184">Releases the database resources of a statement object.</span></span>

```xpp
public void close()
```

## <a name="method-setmaxfieldsize"></a><span data-ttu-id="20873-185">メソッド setMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-185">Method setMaxFieldSize</span></span>

<span data-ttu-id="20873-186">列の最大サイズ制限を設定します。</span><span class="sxs-lookup"><span data-stu-id="20873-186">Sets the maximum column size limit.</span></span>

```xpp
public void setMaxFieldSize(int max)
```

### <a name="parameters---setmaxfieldsize"></a><span data-ttu-id="20873-187">パラメーター - setMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-187">Parameters - setMaxFieldSize</span></span>

<span data-ttu-id="20873-188">最大</span><span class="sxs-lookup"><span data-stu-id="20873-188">max</span></span>  
<span data-ttu-id="20873-189">列の新しい最大サイズ制限。0 は無制限を意味します。</span><span class="sxs-lookup"><span data-stu-id="20873-189">The new max column size limit; 0 means unlimited.</span></span>

### <a name="remarks---setmaxfieldsize"></a><span data-ttu-id="20873-190">備考 - setMaxFieldSize</span><span class="sxs-lookup"><span data-stu-id="20873-190">Remarks - setMaxFieldSize</span></span>

<span data-ttu-id="20873-191">maxFieldSize の制限 (バイト単位) は、任意の列の値に対して返されるデータのサイズを制限するように設定されています。binary、varbinary、longvarbinary、char、varchar、および longvarchar フィールドにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="20873-191">The maxFieldSize limit (in bytes) is set to limit the size of data that can be returned for any column value; it only applies to binary, varbinary, longvarbinary, char, varchar, and longvarchar fields.</span></span> <span data-ttu-id="20873-192">制限を超過した場合、余分なデータは通知なしに破棄されます。</span><span class="sxs-lookup"><span data-stu-id="20873-192">If the limit is exceeded, the excess data is silently discarded.</span></span> <span data-ttu-id="20873-193">最大可搬性については、256 より大きい値を使用します。</span><span class="sxs-lookup"><span data-stu-id="20873-193">For maximum portability, use values greater than 256.</span></span>

