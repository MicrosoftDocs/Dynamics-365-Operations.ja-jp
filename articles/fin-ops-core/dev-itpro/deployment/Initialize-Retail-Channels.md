---
title: Commerce Scale Unit (クラウド) の初期化
description: このトピックでは、Commerce Scale Unit (クラウド) を初期化する方法について説明します。
author: AamirAllaq
manager: AnnBe
ms.date: 08/10/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: aamiral
ms.search.validFrom: 2018-4-30
ms.dyn365.ops.version: 8
ms.openlocfilehash: a581da3c6090ff971ea908a9eacd41300ec7d0cb
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2020
ms.locfileid: "4681075"
---
# <a name="initialize-commerce-scale-unit-cloud"></a>Commerce Scale Unit (クラウド) の初期化

[!include[banner](../includes/banner.md)]

アプリケーション バージョン 8.1.2.x 以降を持つレベル 2 サンドボックスまたは運用環境を使用している場合、販売時点管理 (POS) 操作またはクラウド内の Retail サーバーを使用する電子商取引操作に Retail チャネル機能を使用する前に、Commerce Scale Unit (クラウド) を初期化する必要があります。 初期化では、Commerce Scale Unit (クラウド) が配置されます。

このトピックでは、Commerce Scale Unit (クラウド) を初期化する手順について説明します。

> [!IMPORTANT]
> クラウドで小売チャネル機能を使用している既存の顧客の場合、業務の継続的かつ中断のないサポートを確保するには、Commerce Scale Unit を使用する小売チャネルの更新を行う必要があります。 Commerce Scale Unit を使用せずに配置された新しい環境は、クラウド ホストの小売チャンネル コンポーネントの品質とサービスの更新を受けられなくなります。 Commerce Scale Unit (自己ホスト) を独占して使用している顧客に対しては、アクションは必要ありません。  延長が必要な場合は、Microsoft FastTrack ソリューション アーキテクトまでご連絡ください。

## <a name="prerequisites"></a>必要条件

1. アプリケーション バージョン 8.1.2.x またはそれ以降を持つレベル 2 サンドボックスまたは運協環境を配置します。
2. Microsoft Dynamics Lifecycle Services (LCS) 内の環境ごとに複数の RCSU を必要とする場合は、サポート要求を作成し、**複数の Commerce Cloud Scale Unit に対するアクセス要求** を入力し、環境 ID、CSU の数、および対応するデータセンター リージョンを指定します。 要求は、5 営業日以内に完了されます。 環境ごとに複数の CSU を必要としない場合は、サポート要求を作成する必要はありません。 

## <a name="region-availability"></a>地域の可用性
Commerce Scale Unit は、次の地域に配置することができます。

| グローバルの場所 | 領域              | 使用可能性        |
|-----------------|---------------------|---------------------|
| 南北アメリカ        | 米国東部             | 一般に入手可能 |
| 南北アメリカ        | 米国東部 2           | 一般に入手可能 |
| 南北アメリカ        | 米国中北部    | 一般に入手可能 |
| 南北アメリカ        | 米国中南部    | 一般に入手可能 |
| 南北アメリカ        | 米国中部          | 一般に入手可能 |
| 南北アメリカ        | 米国西部             | 一般に入手可能 |
| 南北アメリカ        | 米国西部 2           | 一般に入手可能 |
| 南北アメリカ        | カナダ中部      | 能力上限    |
| 南北アメリカ        | カナダ東部         | 能力上限    |
| 南北アメリカ        | 西中央アメリカ     | 能力上限    |
| APAC            | オーストラリア東部      | 一般に入手可能 |
| APAC            | 東南アジア      | 一般に入手可能 |
| APAC            | 東日本          | 一般に入手可能 |
| APAC            | 西日本          | 一般に入手可能 |
| APAC            | オーストラリア南東部 | 能力上限    |
| APAC            | 東アジア           | 能力上限    |
| APAC            | インド南部         | 能力上限    |
| APAC            | インド中部       | 能力上限    |
| EMEA            | 西ヨーロッパ         | 一般に入手可能 |
| EMEA            | 北ヨーロッパ        | 一般に入手可能 |
| EMEA            | イギリス南部            | 能力上限    |
| EMEA            | イギリス西部             | 能力上限    |

制限能力地域での配置の許容範囲にはかなり制約があります。 配置要求は、状況に応じて評価されます。 制限されたキャパシティ地域での配置に関して説得力のあるビジネス ニーズがある場合は、待機リストに追加するサポート要求を提出することができます。

![地域の利用可能性を示すマップ](media/Commerce-Scale-Unit-Region-Availability.png "地域の利用可能性を示すマップ")

## <a name="initialize-commerce-scale-unit-as-part-of-a-new-environment-deployment"></a>Commerce Scale Unit を新しい環境の展開の一部として初期化します

本社が使用可能か確認してください。 これは、初期化プロセス中にスケール ユニットを本社に登録するために必要です。 サービス プロセスで利用できなくなる可能性があるため、本社がサービス中の場合はスケール ユニットの初期化をお勧めしません。

1. 本社環境が使用可能で [メンテナンス モード](../sysadmin/maintenance-mode.md) でないことを確認してください。
2. LCS の環境の詳細 ページで、**環境機能 \> Retail** を選択します。
3. Retail 設定配置ページで、**初期化** を選択します。
4. 初期化する Commerce Scale Unit のバージョンを選択します。
5. 地域を選択して Commerce Scale Unit を初期化します。

## <a name="configure-retail-channels-to-use-commerce-scale-unit"></a>Commerce Scale Unit を使用するための小売チャンネルのコンフィギュレーション

1. Commerce Scale Unit が展開された後で、本社のクライアントで **Retail とコマース > Retail Headquarters > Retail スケジューラの設定 > チャンネル データベース** の順に移動して、この Commerce Scale Unit のためにデータベースを使用するように小売りチャンネルが構成されていることを確認します。
2. 各小売りチャンネルに移動して、対応する Commerce Scale Unit のチャンネル プロファイルを選択します。

### <a name="database-refresh-and-commerce-scale-units"></a>データベースの更新と Commerce Scale Unit

始める前に [コマース機能を使用する環境でデータベースを更新した後に完了する手順](../database/database-refresh.md) に精通していることを確認して下さい。

データベース更新の一部として (チャネル データベース フォームで) スケール ユニット チャネル データベース レコードを環境を越えて移動できません。 これはレコードが環境固有のコンフィギュレーションを表すためです。

データベース更新後、LCS でスケール ユニットの再展開を発行して、スケール ユニットのチャネル データベース レコードを再生成できます。 スケール ユニットで配置やサービス操作を行うと、登録が行われていないことが検出された場合に、本社でスケール ユニットが登録されます。

スケール ユニットがすでに存在するのと同じバージョンの展開を選択することで、コンポーネントを変更することなくスケール ユニットの再配置を発行できます。 これは次の手順により LCS で行うことができます:

1. LCS の環境の詳細 ページで、**環境機能 \> Retail** を選択します。
2. 設定の配置ページで再配置するスケール ユニットを選択します。
3. スケール ユニットの操作メニューで **更新** を選択します。
4. スライダーの **バージョンの選択** のドロップダウンで **バージョンの指定** オプションを選択します。
5. **バージョンの指定** の下のテキスト ボックスに、スケール ユニットの **現在のバージョン** ラベルの横に表示されたバージョンを入力します。
6. **更新** ボタンをクリックします。

以前に拡張を適用した場合でも、スケール ユニットを更新するときに最後に適用された拡張パッケージが自動的に選択されるため、**拡張機能の更新** を選択する必要はありません。

複数のスケール ユニットがある場合は、各スケール ユニットに対して上記の操作を実行する必要があります。 必要に応じて、これらの操作を並行して実行できます。

## <a name="deploy-additional-commerce-scale-units-optional"></a>追加の Commerce Scale Unit の配置 (オプション)

最初の Commerce Scale Unit (CSU) を初期化した後、追加のクラウド スケール ユニットが必要な場合はサポート要求を入力します。 サポート要求で、必要な RCSU の数、環境名、希望するリージョンを明記します。

展開する追加の RCSU ごとに、チャネル データ ベースグループを 個別に作成することもお勧めします。 これを行うには、次の手順に従います。

1. コマース バックオフィスで、**Retail とコマース > Retail Headquarters > Retail スケジューラの設定 > チャネル データベース グループ** の順に移動します。
2. 新しいチャネル データベース グループを作成します。
3. **Retail とコマース> Retail Headquarters > Retail スケジューラの設定 > チャネル データベース** フォームの順に移動し、新しく作成された RCSU に対応するチャネル データベースを選択します。
4. **編集** を選択して、新しいチャンネル データベース グループを選択します。
5. **保存** を選択します。
6. 選択したチャンネル データベースに対して **完全データ同期の実行** を選択します。

## <a name="additional-considerations-if-you-initialize-cloud-hosted-commerce-channel-components-in-an-existing-environment"></a>既存の環境でクラウドにホストされたコマース チャネル コンポーネントを初期化する場合の追加の考慮事項

環境でクラウドでホストされているコマース チャネル コンポーネントを既に使用している場合、Commerce Scale Unit の初期化はそれらのコンポーネントの更新時にダウンタイムを減らすのに役立ちます。 Commerce Scale Unit の初期化を行う前に、追加の計画が必要です。

クラウドでホストされたコマース チャネル コンポーネントを使用する環境で最初の Commerce Scale Unit を初期化するときに、初期化プロセスではクラウドでホストされたチャネル コンポーネントに関連付けられているチャネルを最初のスケール ユニットに移行します。 店舗スケール ユニットに関連付けられたチャンネルは影響を受けません。

移行プロセスはチャネルに対して透過的です。 スケール ユニットの初期化が始まった後、次の操作が自動的に実行されます。

1. 新しい Commerce Scale Unit が作成され、環境に関連付けられます。
2. Commerce Scale Unit は、本社で利用可能なチャンネル データベースとして登録されます。
3. 本社で **既定** のチャネル データベースにマップされたすべてのチャネルは、新しい Commerce Scale Unit にマップするように更新されます。
4. Commerce Data Exchange (CDX) 完全データ同期は、チャンネル データを新しいスケール ユニットに取り込むために実行されます。

原則として、**Commerce Scale Unit の初期化の計画とテストを行う** には、店舗業務や、小売りサーバーやクラウドの販売時点管理を使用する E コマース チャネル業務のダウンタイムを 5 時間程度想定した計画を立てる必要があります。

1. 運用環境からサンドボックス UAT 環境へのデータベースの更新を実行します。 
2. サンドボックス UAT 環境で Commerce Scale Unit を初期化します。 
3. Commerce Scale Unit の初期化時間を記録します。 これは、運用環境でこの操作にかかる時間に相当するもので、その間は店舗の操作や電子商取引が利用できなくなります。

Commerce Scale Unit を初期化する前に、次の追加手順を実行する必要があります。

- **すべての POS シフトを閉じる** - 移行の完了後、POS ユーザーは移行プロセス中に有効だったシフトを閉じることができなくなります。
- **すべての P ジョブが正常に完了していることを検証する** - CSUを初期化する前に、保留中のトランザクションを同期させる P-ジョブが完了していることが推奨されています。
- **すべての POS デバイスからサインアウトする** - 移行中の POS 操作には対応していません。
- **POS で中断されたすべてのトランザクションを取り消して無効化する** - 中断されたトランザクションは、初期化の一部として保持されません。

> [!IMPORTANT]
> Commerce Scale Unit の初期化の一環として、以前に中断されたトランザクションは失われ、取り消すことはできません。 

初期化期間中に実行される内容を以下に示します。

- POS オフライン機能を有効にしない限り、クラウドでホストされたコマース チャネルは機能しません。
- オフライン機能がオンになっている POS デバイスは機能が制限されます。
- Retail サーバーに依存しているすべての電子商取引クライアントが中断されます。
- Commerce Scale Unit (自己ホスト) にホストされているチャンネルは影響を受けません。
- 本店機能は影響を受けません。

初期化が完了した後に起きる事柄を示します。

- 有効化されたすべての POS デバイスのデバイス有効化状態は保持されます。つまり、デバイスを再有効化する必要はありません。
- スタンドアロン ハードウェア ステーション インスタンスは引き続き機能します。
- POS チャンネル側のレポートはリセットされ、データを初期化する前に表示されません。
- 仕訳帳の処理の表示もリセットされるため、初期化前のデータは表示されません。
