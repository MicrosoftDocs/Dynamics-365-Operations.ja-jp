---
title: Power BI にデータをプルするよう電子申告 (ER) を構成する
description: このトピックでは、電子申告 (ER) コンフィギュレーションを使用してインスタンスから Power BI サービスへのデータ転送を調整する方法について説明します。
author: NickSelin
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 6e4bdb7be83bff8fc9491e360a480f44189730d2
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/09/2021
ms.locfileid: "5568704"
---
# <a name="configure-electronic-reporting-er-to-pull-data-into-power-bi"></a><span data-ttu-id="2d992-103">Power BI にデータをプルするよう電子申告 (ER) を構成する</span><span class="sxs-lookup"><span data-stu-id="2d992-103">Configure Electronic reporting (ER) to pull data into Power BI</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="2d992-104">このトピックでは、電子申告 (ER) コンフィギュレーションを使用してインスタンスから Power BI サービスへのデータ転送を調整する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="2d992-104">This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance to Power BI services.</span></span> <span data-ttu-id="2d992-105">たとえば、このトピックでは、転送する必要があるビジネス データとしてのイントラスタット トランザクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="2d992-105">As an example, this topic uses Intrastat transactions as business data that must be transferred.</span></span> <span data-ttu-id="2d992-106">Power BI マップの視覚化は、このイントラスタット トランザクション データを使用して Power BI レポートで会社のインポート/エクスポート活動の分析のためのビューを表示します。</span><span class="sxs-lookup"><span data-stu-id="2d992-106">The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.</span></span>

## <a name="overview"></a><span data-ttu-id="2d992-107">概要</span><span class="sxs-lookup"><span data-stu-id="2d992-107">Overview</span></span>

<span data-ttu-id="2d992-108">Microsoft Power BI は、外部のデータ ソースを一貫性、視覚的な没入型、および対話型の洞察に変換するソフトウェア サービス、アプリ、コネクタの集合です。</span><span class="sxs-lookup"><span data-stu-id="2d992-108">Microsoft Power BI is a collection of software services, apps, and connectors that work together to turn external sources of data into coherent, visually immersive, and interactive insights.</span></span> <span data-ttu-id="2d992-109">電子申告 (ER) を使用すると、ユーザーは簡単にデータ ソースを構成し、アプリケーションから Power BI へのデータ転送を手配できます。</span><span class="sxs-lookup"><span data-stu-id="2d992-109">Electronic reporting (ER) lets users easily configure data sources and arrange the transfer of data from the application to Power BI.</span></span> <span data-ttu-id="2d992-110">データは、OpenXML ワークシート (Microsoft Excel ワークブックのファイル) 形式のファイルとして転送されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-110">The data is transferred as files in the OpenXML worksheet (Microsoft Excel workbook file) format.</span></span> <span data-ttu-id="2d992-111">転送されたファイルは、その目的のためにコンフィギュレーションされた Microsoft SharePoint Server に保存されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-111">The transferred files are stored on a Microsoft SharePoint Server that has been configured for that purpose.</span></span> <span data-ttu-id="2d992-112">保存されたファイルは、視覚化 (テーブル、グラフ、マップなど) を含むレポートを作成し、Power BI で使用されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-112">The stored files are used in Power BI to make reports that include visualizations (tables, charts, maps, and so on).</span></span> <span data-ttu-id="2d992-113">Power BI レポートは、Power BI ユーザーの間で共有され、Power BI ダッシュボード、またアプリケーション ページでアクセスされます。</span><span class="sxs-lookup"><span data-stu-id="2d992-113">Power BI reports are shared with Power BI users, and they are accessed in Power BI dashboards and on the application pages.</span></span> <span data-ttu-id="2d992-114">ここでは、次のタスクについて説明します:</span><span class="sxs-lookup"><span data-stu-id="2d992-114">This topic explains the following tasks:</span></span>

- <span data-ttu-id="2d992-115">Microsoft Dynamics 365 Finance をコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="2d992-115">Configure Microsoft Dynamics 365 Finance.</span></span>
- <span data-ttu-id="2d992-116">財務アプリケーションからデータを取得するために、ER 形式のコンフィギュレーションを準備します。</span><span class="sxs-lookup"><span data-stu-id="2d992-116">Prepare your ER format configuration to get data from the Finance application.</span></span>
- <span data-ttu-id="2d992-117">Power BI にデータを転送するために ER 環境をコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="2d992-117">Configure the ER environment to transfer data to Power BI.</span></span>
- <span data-ttu-id="2d992-118">Power BI レポートを作成するために転送されたデータを使用します。</span><span class="sxs-lookup"><span data-stu-id="2d992-118">Use transferred data to create a Power BI report.</span></span>
- <span data-ttu-id="2d992-119">Power BI レポートが財務にアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="2d992-119">Make the Power BI report accessible in Finance.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="2d992-120">必要条件</span><span class="sxs-lookup"><span data-stu-id="2d992-120">Prerequisites</span></span>
<span data-ttu-id="2d992-121">このトピックの例を完了するには、次のアクセスが必要です:</span><span class="sxs-lookup"><span data-stu-id="2d992-121">To complete the example in this topic, you must have the following access:</span></span>

- <span data-ttu-id="2d992-122">次のいずれかのロールへのアクセス:</span><span class="sxs-lookup"><span data-stu-id="2d992-122">Access for one of the following roles:</span></span>

    - <span data-ttu-id="2d992-123">電子申告開発者</span><span class="sxs-lookup"><span data-stu-id="2d992-123">Electronic reporting developer</span></span>
    - <span data-ttu-id="2d992-124">電子申告機能コンサルタント</span><span class="sxs-lookup"><span data-stu-id="2d992-124">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="2d992-125">システム管理者</span><span class="sxs-lookup"><span data-stu-id="2d992-125">System administrator</span></span>

- <span data-ttu-id="2d992-126">アプリケーションで使用するために構成されたされた SharePoint サーバーへのアクセス</span><span class="sxs-lookup"><span data-stu-id="2d992-126">Access to the SharePoint Server that is configured for use with the application</span></span>
- <span data-ttu-id="2d992-127">Power BI フレームワークへのアクセス</span><span class="sxs-lookup"><span data-stu-id="2d992-127">Access to the Power BI framework</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="2d992-128">ドキュメント管理パラメーターのコンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="2d992-128">Configure document management parameters</span></span>
1. <span data-ttu-id="2d992-129">**ドキュメント管理パラメーター** ページで、サインインしている会社 (この例では DEMF 会社) が使用する SharePoint Serverへのアクセスをコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="2d992-129">On the **Document management parameters** page, configure access to the SharePoint Server that will be used in the company that you're signed in to (the DEMF company in this example).</span></span>
2. <span data-ttu-id="2d992-130">アクセス権があることを確認するために、SharePoint Server への接続をテストします。</span><span class="sxs-lookup"><span data-stu-id="2d992-130">Test the connection to the SharePoint Server to make sure that you've been granted access.</span></span>

    <span data-ttu-id="2d992-131">[![ドキュメント管理パラメーター ページ](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-131">[![Document management parameters page](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)</span></span>

3. <span data-ttu-id="2d992-132">コンフィギュレーションされた SharePoint サイトを開きます。</span><span class="sxs-lookup"><span data-stu-id="2d992-132">Open the configured SharePoint site.</span></span> <span data-ttu-id="2d992-133">Power BI データセットのソースとして Power BI レポートに必要なビジネス データがある Excel ファイルを ER が格納する新しいフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-133">Create a new folder where ER will store Excel files that have the business data that the Power BI reports require as a source of Power BI datasets.</span></span>
4. <span data-ttu-id="2d992-134">**ドキュメント タイプ** ページで、作成した SharePoint フォルダーにアクセスするために使用される新しいドキュメント タイプを作成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-134">On the **Document types** page, create a new document type that will be used to access the SharePoint folder that you just created.</span></span> <span data-ttu-id="2d992-135">**グループ** フィールドに **ファイル** を入力し、**場所** フィールドに **SharePoint** を入力し、SharePoint フォルダーのアドレスを入力します。</span><span class="sxs-lookup"><span data-stu-id="2d992-135">Enter **File** in the **Group** field and **SharePoint** in the **Location** field, and then enter the address of the SharePoint folder.</span></span>

    <span data-ttu-id="2d992-136">[![ドキュメント タイプ ページ](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-136">[![Document types page](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)</span></span>

## <a name="configure-er-parameters"></a><span data-ttu-id="2d992-137">ER パラメーターのコンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="2d992-137">Configure ER parameters</span></span>
1. <span data-ttu-id="2d992-138">**電子申告** のワークスペースで、**電子申告パラメーター** のリンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-138">In the **Electronic reporting** workspace, click the **Electronic reporting parameters** link.</span></span>
2. <span data-ttu-id="2d992-139">**添付ファイル** タブで、すべてのフィールドの **ファイル** ドキュメント タイプを選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-139">On the **Attachments** tab, select the **File** document type for all the fields.</span></span>
3. <span data-ttu-id="2d992-140">**電子申告** のワークスペースで、**有効日に設定** をクリックして必要なプロバイダーを有効にします。</span><span class="sxs-lookup"><span data-stu-id="2d992-140">In the **Electronic reporting** workspace, make the required provider active by clicking **Set active**.</span></span> <span data-ttu-id="2d992-141">詳細については、**ER サービス プロバイダーの選択** のタスク ガイド を再生してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-141">For more information, play the **ER Select service provider** task guide.</span></span>

## <a name="use-an-er-data-model-as-the-source-of-data"></a><span data-ttu-id="2d992-142">データのソースとして ER データ モデルを使用</span><span class="sxs-lookup"><span data-stu-id="2d992-142">Use an ER data model as the source of data</span></span>
<span data-ttu-id="2d992-143">Power BI レポートで使用されるビジネス データのソースとして、ER データ モデルが必要です。</span><span class="sxs-lookup"><span data-stu-id="2d992-143">You must have an ER data model as the source of business data that will be used on Power BI reports.</span></span> <span data-ttu-id="2d992-144">このデータ モデルは、ER コンフィギュレーション リポジトリからアップロードされます。</span><span class="sxs-lookup"><span data-stu-id="2d992-144">This data model is uploaded from the ER configurations repository.</span></span> <span data-ttu-id="2d992-145">詳細については、「[Lifecycle Services の電子申告コンフィギュレーションのダウンロード](download-electronic-reporting-configuration-lcs.md)」、または **Lifecycle Services からのコンフィギュレーションの ER インポート** を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-145">For more information, see [Download Electronic reporting configurations from Lifecycle Services](download-electronic-reporting-configuration-lcs.md), or play the **ER Import a configuration from Lifecycle Services** task guide.</span></span> <span data-ttu-id="2d992-146">選択した ER コンフィギュレーション リポジトリからアップロードされるデータ モデルとして、**イントラスタット** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-146">Select **Intrastat** as the data model that will be uploaded from the selected ER configurations repository.</span></span> <span data-ttu-id="2d992-147">(この例では、モデルのバージョン 1 が使用されています)。**コンフィギュレーション** のページで、**イントラスタット** ER モデル コンフィギュレーションにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="2d992-147">(In this example, version 1 of the model is used.) You can then access the **Intrastat** ER model configuration on the **Configurations** page.</span></span>

<span data-ttu-id="2d992-148">[![構成ページ](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-148">[![Configurations page](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)</span></span>

## <a name="design-an-er-format-configuration"></a><span data-ttu-id="2d992-149">ER 形式のコンフィギュレーションをデザイン</span><span class="sxs-lookup"><span data-stu-id="2d992-149">Design an ER format configuration</span></span>
<span data-ttu-id="2d992-150">ビジネス データのソースとして **イントラスタット** データ モデルを使用する新しい ER 形式のコンフィギュレーションを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2d992-150">You must create a new ER format configuration that uses the **Intrastat** data model as the source of business data.</span></span> <span data-ttu-id="2d992-151">この形式のコンフィギュレーションは、OpenXML (Excel ファイル) 形式の電子ドキュメントとして出力結果を生成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2d992-151">This format configuration must generate output results as electronic documents in OpenXML (Excel file) format.</span></span> <span data-ttu-id="2d992-152">詳細については、**OPENXML 形式でレポートのコンフィギュレーションを ER 作成する** のタスク ガイドを再生してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-152">For more information, play the **ER Create a configuration for reports in OPENXML format** task guide.</span></span> <span data-ttu-id="2d992-153">次の図に示すように、新しいコンフィギュレーションに **インポート/エクスポート活動** の名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="2d992-153">Name the new configuration **Import / export activities**, as shown in the following illustration.</span></span> <span data-ttu-id="2d992-154">ER 形式をデザインするときにテンプレートとして、「[ER データのインポートとエクスポートの詳細](https://go.microsoft.com/fwlink/?linkid=845208)」 Excel ファイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="2d992-154">Use the [ER data - import and export details](https://go.microsoft.com/fwlink/?linkid=845208) Excel file as a template when you design the ER format.</span></span> <span data-ttu-id="2d992-155">(形式のテンプレートをインポートする方法について、タスク ガイドを再生してください。)</span><span class="sxs-lookup"><span data-stu-id="2d992-155">(For information about how to import a format template, play the task guide.)</span></span>

<span data-ttu-id="2d992-156">[![インポート/エクスポート活動のコンフィギュレーション](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-156">[![Import / export activities configuration](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png)</span></span>

<span data-ttu-id="2d992-157">**インポート/エクスポート活動** 形式のコンフィギュレーションを変更するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="2d992-157">To modify the **Import / export activities** format configuration, follow these steps.</span></span>

1. <span data-ttu-id="2d992-158">**デザイナー** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-158">Click **Designer**.</span></span>
2. <span data-ttu-id="2d992-159">**形式** タブで、この形式の **Excel 出力ファイル** のファイル要素に名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="2d992-159">On the **Format** tab, name the file element for this format **Excel output file**.</span></span>

    <span data-ttu-id="2d992-160">[![Excel 出力ファイル要素](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-160">[![Excel output file element](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)</span></span>

3. <span data-ttu-id="2d992-161">**マッピング** タブで、この形式で実行されるたびに生成される Excel ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="2d992-161">On the **Mapping** tab, specify the name of the Excel file that will be generated whenever this format is run.</span></span> <span data-ttu-id="2d992-162">値の **インポートとエクスポートの詳細** を返して関連する式をコンフィギュレーションします (.xlsx ファイル名拡張子は自動的に追加されます)。</span><span class="sxs-lookup"><span data-stu-id="2d992-162">Configure the related expression to return the value **Import and export details** (the .xlsx file name extension will be added automatically).</span></span>

    <span data-ttu-id="2d992-163">[![形式デザイナー](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-163">[![Format designer](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)</span></span>

4. <span data-ttu-id="2d992-164">この形式の新しいデータ ソースの品目を追加します。</span><span class="sxs-lookup"><span data-stu-id="2d992-164">Add a new data source item for this format.</span></span> <span data-ttu-id="2d992-165">(この列挙は、さらにデータ バインディングのために必要です。)</span><span class="sxs-lookup"><span data-stu-id="2d992-165">(This enumeration will be required for further data binding.)</span></span>

    1. <span data-ttu-id="2d992-166">データ ソース **direction\_enum** に名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="2d992-166">Name the data source **direction\_enum**.</span></span>
    2. <span data-ttu-id="2d992-167">データ ソース タイプとして、**データ モデルの列挙** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-167">Select **Data model enumeration** as the data source type.</span></span>
    3. <span data-ttu-id="2d992-168">**方向** データ モデルの列挙を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-168">Refer to the **Direction** data model enumeration.</span></span>

    <span data-ttu-id="2d992-169">[![direction_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-169">[![direction_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)</span></span>

5. <span data-ttu-id="2d992-170">次の図に示すように、**イントラスタット** データ モデルの要素と設計された形式の要素のバインディングを完了します。</span><span class="sxs-lookup"><span data-stu-id="2d992-170">Complete the binding of elements of the **Intrastat** data model and elements of the designed format, as shown in the following illustration.</span></span>

    <span data-ttu-id="2d992-171">[![バインディングの完了](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-171">[![Completing the binding](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)</span></span>

<span data-ttu-id="2d992-172">実行後、ER 形式は Excel 形式で出力の結果を生成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-172">After it's run, the ER format generates the output result in Excel format.</span></span> <span data-ttu-id="2d992-173">出力結果にイントラスタット トランザクションの詳細を送信し、インポート活動またはエクスポート活動のいずれかを記述するトランザクションとして分離します。</span><span class="sxs-lookup"><span data-stu-id="2d992-173">It sends the details of the Intrastat transactions to the output result, and separates them as transactions that describe either import activities or export activities.</span></span> <span data-ttu-id="2d992-174">**イントラスタット** ページ (**税** &gt; **申告** &gt; **対外貿易** &gt; **イントラスタット**) のイントラスタット トランザクションのリストのための新しい ER フォーマットをテストするには、**実行** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-174">Click **Run** to test the new ER format for the list of Intrastat transactions on the **Intrastat** page (**Tax** &gt; **Declarations** &gt; **Foreign trade** &gt; **Intrastat**).</span></span>

<span data-ttu-id="2d992-175">[![イントラスタット ページ](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-175">[![Intrastat page](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png)</span></span>

<span data-ttu-id="2d992-176">次の出力の結果が生成されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-176">The following output result is generated.</span></span> <span data-ttu-id="2d992-177">書式設定で指定したとおり、ファイルは **Import and export details.xlsx** と名前が付けられます。</span><span class="sxs-lookup"><span data-stu-id="2d992-177">The file is named **Import and export details.xlsx**, as you specified in the format settings.</span></span>

<span data-ttu-id="2d992-178">[![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-178">[![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)</span></span>

## <a name="configure-the-er-destination"></a><span data-ttu-id="2d992-179">ER 送信先のコンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="2d992-179">Configure the ER destination</span></span>
<span data-ttu-id="2d992-180">特別な方法で新しい ER 形式のコンフィギュレーションの出力結果を送信するために ER フレームワークをコンフィギュレーションする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2d992-180">You must configure the ER framework to send the output result of the new ER format configuration in a special way.</span></span>

- <span data-ttu-id="2d992-181">出力結果は、選択した SharePoint Server のフォルダーに送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2d992-181">The output result must be sent to the folder of the selected SharePoint Server.</span></span>
- <span data-ttu-id="2d992-182">形式のコンフィギュレーションを実行するたびに、同じ Excel ファイルの新しいバージョンを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2d992-182">Each execution of the format configuration must create a new version of same Excel file.</span></span>

<span data-ttu-id="2d992-183">**電子申告** のページ (**組織管理** &gt; **電子申告**) で、**電子申告の送信先** の項目をクリックして、新しい送信先を追加します。</span><span class="sxs-lookup"><span data-stu-id="2d992-183">On the **Electronic reporting** page (**Organization administration** &gt; **Electronic reporting**), click the **Electronic reporting destination** item, and add a new destination.</span></span> <span data-ttu-id="2d992-184">**参照** フィールドで、以前に作成した **エクスポート/インポート活動** の形式のコンフィギュレーションを選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-184">In the **Reference** field, select the **Import / export activities** format configuration that you created earlier.</span></span> <span data-ttu-id="2d992-185">参照用の新しいファイル送信先レコードを追加するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="2d992-185">Follow these steps to add a new file destination record for the reference.</span></span>

1. <span data-ttu-id="2d992-186">**名前** フィールドに、ファイルの送信先のタイトルを入力します。</span><span class="sxs-lookup"><span data-stu-id="2d992-186">In the **Name** field, enter the title of the file destination.</span></span>
2. <span data-ttu-id="2d992-187">**ファイル名** で、Excel ファイル形式のコンポーネントの名前 **Excel 出力ファイル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-187">In the **File name** field, select the name **Excel output file** for the Excel file format component.</span></span>

<span data-ttu-id="2d992-188">新しい送信先レコードの **設定** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-188">Click the **Settings** button for the new destination record.</span></span> <span data-ttu-id="2d992-189">次に、**送信先の設定** のダイアログ ボックスで、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="2d992-189">Then, in the **Destination settings** dialog box, follow these steps.</span></span>

1. <span data-ttu-id="2d992-190">**Power BI** タブで、**有効** オプションを **はい** に設定します。</span><span class="sxs-lookup"><span data-stu-id="2d992-190">On the **Power BI** tab, set the **Enabled** option to **Yes**.</span></span>
2. <span data-ttu-id="2d992-191">**SharePoint** フィールドで、以前に作成した **共有** ドキュメント タイプを選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-191">In the **SharePoint** field, select the **Shared** document type that you created earlier.</span></span>

## <a name="schedule-execution-of-the-configured-er-format"></a><span data-ttu-id="2d992-192">コンフィギュレーションされた ER 形式の実行をスケジュールする</span><span class="sxs-lookup"><span data-stu-id="2d992-192">Schedule execution of the configured ER format</span></span>
1. <span data-ttu-id="2d992-193">**コンフィギュレーション** ページ (**組織管理** &gt; **電子申告** &gt; **コンフィギュレーション**) のコンフィギュレーション ツリーで、以前に作成した **インポート/エクスポート活動** のコンフィギュレーションを選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-193">On the **Configurations** page (**Organization administration** &gt; **Electronic reporting** &gt; **Configurations**), in the configurations tree, select the **Import / export activities** configuration that you created earlier.</span></span>
2. <span data-ttu-id="2d992-194">この形式を使用できるように、バージョン 1.1 の状態を **ドラフト** から **完了** に変更します。</span><span class="sxs-lookup"><span data-stu-id="2d992-194">Change the status of version 1.1 from **Draft** to **Complete** to make this format available for use.</span></span>

    <span data-ttu-id="2d992-195">[![構成ページ](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-195">[![Configurations page](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png)</span></span>

3. <span data-ttu-id="2d992-196">**インポート/エクスポート活動** コンフィギュレーションの完了したバージョンを選択し、**実行** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-196">Select the completed version of the **Import / export activities** configuration, and then click **Run**.</span></span> <span data-ttu-id="2d992-197">コンフィギュレーションした送信先は、Excel 形式で生成される出力結果に適用されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-197">Note that the configured destination is applied to the output result that is generated in Excel format.</span></span>
4. <span data-ttu-id="2d992-198">無人モードでこのレポートを実行するには、**バッチ処理** オプションを **はい** に設定します。</span><span class="sxs-lookup"><span data-stu-id="2d992-198">Set the **Batch processing** option to **Yes** to run this report in unattended mode.</span></span>
5. <span data-ttu-id="2d992-199">このバッチ実行の必要な再実行をスケジュールするために **再実行** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-199">Click **Recurrence** to schedule the required recurrence of this batch execution.</span></span> <span data-ttu-id="2d992-200">再実行は、更新されたデータが Power BI に転送される頻度を定義します。</span><span class="sxs-lookup"><span data-stu-id="2d992-200">The recurrence defines how often the updated data will be transferred to Power BI.</span></span>

    <span data-ttu-id="2d992-201">[![電子申告パラメーター ダイアログ ボックス](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-201">[![Electronic report parameters dialog box](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png)</span></span>

6. <span data-ttu-id="2d992-202">これをコンフィギュレーションした後、**バッチ ジョブ** のページ (**システム管理 &gt; 照会 &gt; バッチ ジョブ**) に ER レポートの実行ジョブを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="2d992-202">After it's configured, you can find the ER report execution job on the **Batch jobs** page (**System administration &gt; Inquiries &gt; Batch jobs**).</span></span>

    <span data-ttu-id="2d992-203">[![バッチ ジョブのページ](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-203">[![Batch jobs page](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png)</span></span>

7. <span data-ttu-id="2d992-204">このジョブを初めて実行すると、送信先は、選択した SharePoint のフォルダーにコンフィギュレーションされた名前を持つ新しい Excel ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-204">When this job is run for the first time, the destination creates a new Excel file that has the configured name in the selected SharePoint folder.</span></span> <span data-ttu-id="2d992-205">その後ジョブが実行されるたびに、送信先は新しいバージョンの Excel ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-205">Every subsequent time that the job is run, the destination creates a new version of this Excel file.</span></span>

    <span data-ttu-id="2d992-206">[![Excel ファイルの新しいバージョン](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-206">[![New version of the Excel file](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)</span></span>

## <a name="create-a-power-bi-dataset-by-using-the-output-result-of-the-er-format"></a><span data-ttu-id="2d992-207">ER 形式の出力結果を使用して Power BI データセットを作成</span><span class="sxs-lookup"><span data-stu-id="2d992-207">Create a Power BI dataset by using the output result of the ER format</span></span>
1. <span data-ttu-id="2d992-208">Power BI にサイン インして、既存の Power BI グループ (ワークスペース) を開くか、新しいグループを作成します。</span><span class="sxs-lookup"><span data-stu-id="2d992-208">Sign in to Power BI, and either open an existing Power BI group (workspace) or create a new group.</span></span> <span data-ttu-id="2d992-209">**データにインポートまたは接続** セクションの **ファイル** の下の **追加** をクリックするか、左ウィンドウの **データセット** の横にあるプラス記号 (**+**) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-209">Either click **Add** under **Files** in the **Import or Connect to Data** section, or click the plus sign (**+**) next to **Datasets** in the left pane.</span></span>

    <span data-ttu-id="2d992-210">[![データセットの作成](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-210">[![Creating a dataset](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png)</span></span>

2. <span data-ttu-id="2d992-211">**SharePoint – チーム サイト** オプションを選択してから、使用している SharePoint Server のパス (上記の例では、`https://ax7partner.litware.com`) を入力します。</span><span class="sxs-lookup"><span data-stu-id="2d992-211">Select the **SharePoint – Team sites** option, and then enter the path of SharePoint Server that you're using (`https://ax7partner.litware.com` in our example).</span></span>
3. <span data-ttu-id="2d992-212">**/共有ドキュメント/GER データ/PowerBI** フォルダーを参照し、新しい Power BI データセットのためのデータのソースとして作成した Excel ファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="2d992-212">Browse to the **/Shared Documents/GER data/PowerBI** folder, and select the Excel file that you created as the source of data for the new Power BI dataset.</span></span>

    <span data-ttu-id="2d992-213">[![Excel ファイルの選択](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-213">[![Selecting the Excel file](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png)</span></span>

4. <span data-ttu-id="2d992-214">**接続** をクリックし、**インポート** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-214">Click **Connect**, and then click **Import**.</span></span> <span data-ttu-id="2d992-215">新しいデータセットは、選択された Excel ファイルに基づいて作成されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-215">A new dataset is created that is based on the selected Excel file.</span></span> <span data-ttu-id="2d992-216">データセットは、新しく作成されたダッシュボードに自動的に追加できます。</span><span class="sxs-lookup"><span data-stu-id="2d992-216">The dataset can also be added automatically to the newly created dashboard.</span></span>

    <span data-ttu-id="2d992-217">[![ダッシュボードのデータセット](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-217">[![Dataset on the dashboard](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png)</span></span>

5. <span data-ttu-id="2d992-218">このデータセットの更新スケジュールをコンフィギュレーションして、定期更新を強制します。</span><span class="sxs-lookup"><span data-stu-id="2d992-218">Configure the refresh schedule for this dataset to force a periodic update.</span></span> <span data-ttu-id="2d992-219">定期更新により、SharePoint サーバ上に作成された Excel ファイルの新しいバージョンを使用した ER レポートを定期的に実行することで、新しいビジネス データが利用可能になります。</span><span class="sxs-lookup"><span data-stu-id="2d992-219">Periodic updates enable the consumption of new business data that comes via periodic execution of the ER report through new versions of the Excel file that are created on the SharePoint Server.</span></span>

## <a name="create-a-power-bi-report-by-using-the-new-dataset"></a><span data-ttu-id="2d992-220">新しいデータセットを使用して Power BI レポートを作成</span><span class="sxs-lookup"><span data-stu-id="2d992-220">Create a Power BI report by using the new dataset</span></span>
1. <span data-ttu-id="2d992-221">作成した **インポートとエクスポートの詳細** Power BI データセットをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-221">Click the **Import and export details** Power BI dataset that you created.</span></span>
2. <span data-ttu-id="2d992-222">視覚化をコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="2d992-222">Configure the visualization.</span></span> <span data-ttu-id="2d992-223">たとえば **入力済マップ** の視覚化を選択して、次のようにコンフィギュレーションします:</span><span class="sxs-lookup"><span data-stu-id="2d992-223">For example, select the **Filled map** visualization, and configure it as follows:</span></span>

    - <span data-ttu-id="2d992-224">**CountryOrigin** データセット フィールドをマップ視覚化の **場所** フィールドに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="2d992-224">Assign the **CountryOrigin** dataset field to the **Location** field of the map visualization.</span></span>
    - <span data-ttu-id="2d992-225">**金額** データセット フィールドをマップ視覚化の **彩度** フィールドに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="2d992-225">Assign the **Amount** dataset field to the **Color saturation** field of the map visualization.</span></span>
    - <span data-ttu-id="2d992-226">**活動** と **年** のデータセット フィールドに、マップ視覚化の **フィルター** フィールド コレクション を追加します。</span><span class="sxs-lookup"><span data-stu-id="2d992-226">Add the **Activity** and **Year** dataset fields to the **Filters** fields collection of the map visualization.</span></span>

3. <span data-ttu-id="2d992-227">**インポートとエクスポートの詳細レポート** として Power BI レポートを保存します。</span><span class="sxs-lookup"><span data-stu-id="2d992-227">Save the Power BI report as **Import and export details report**.</span></span>

    <span data-ttu-id="2d992-228">[![インポートとエクスポートの詳細レポート](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-228">[![Import and export details report](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png)</span></span>

    <span data-ttu-id="2d992-229">地図には、Excel ファイルに示されている国/地域 (この例ではオーストリアとスイス) が表示されていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-229">Note that the map shows the countries/regions that are mentioned in the Excel file (Austria and Switzerland in this example).</span></span> <span data-ttu-id="2d992-230">これらの国/地域は、それぞれの請求額の割合の色分けが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-230">These countries/regions are colored to show the proportion of invoiced amounts for each.</span></span>

4. <span data-ttu-id="2d992-231">イントラスタット トランザクションのリストを更新します。</span><span class="sxs-lookup"><span data-stu-id="2d992-231">Update the list of Intrastat transactions.</span></span> <span data-ttu-id="2d992-232">イタリアからの輸出トランザクションが追加されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-232">The export transaction that originated from Italy is added.</span></span>

    <span data-ttu-id="2d992-233">[![イントラスタット トランザクションのリスト](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-233">[![Intrastat transactions list](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png)</span></span>

5. <span data-ttu-id="2d992-234">ER レポートの次のスケジュールされた実行と Power BI データセットの次のスケジュールされた更新を待ちます。</span><span class="sxs-lookup"><span data-stu-id="2d992-234">Wait for the next scheduled execution of the ER report and the next scheduled update of the Power BI dataset.</span></span> <span data-ttu-id="2d992-235">次に、Power BI レポート (インポート トランザクションのみを表示するように選択) を確認します。</span><span class="sxs-lookup"><span data-stu-id="2d992-235">Then review the Power BI report (select to show import transactions only).</span></span> <span data-ttu-id="2d992-236">更新されたマップにイタリアが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2d992-236">The updated map now shows Italy.</span></span>

    <span data-ttu-id="2d992-237">[![更新されたマップ](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-237">[![Updated map](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)</span></span>

## <a name="access-power-bi-report-in-finance"></a><span data-ttu-id="2d992-238">財務で Power BI レポートへのアクセス</span><span class="sxs-lookup"><span data-stu-id="2d992-238">Access Power BI report in Finance</span></span>
<span data-ttu-id="2d992-239">統合と Power BI を設定します。</span><span class="sxs-lookup"><span data-stu-id="2d992-239">Set up the integration with Power BI.</span></span> <span data-ttu-id="2d992-240">詳細については、「[ワークスペースの Power BI 統合のコンフィギュレーション](configure-power-bi-integration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2d992-240">For more information, see [Configure Power BI integration for workspaces](configure-power-bi-integration.md).</span></span>

1. <span data-ttu-id="2d992-241">Power BI 統合 (**組織管理** &gt; **ワークスペース** &gt; **電子申告ワークスペース**) をサポートする **電子申告** ワークスペース ページで、**オプション** &gt; **レポート カタログを開く** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2d992-241">On the **Electronic reporting** workspace page that supports Power BI integration (**Organization administration** &gt; **Workspaces** &gt; **Electronic reporting workspace**), click **Options** &gt; **Open report catalog**.</span></span>
2. <span data-ttu-id="2d992-242">作成した **インポートとエクスポートの詳細** Power BI レポートを選択して、選択されたページでアクション項目としてレポートを表示します。</span><span class="sxs-lookup"><span data-stu-id="2d992-242">Select the **Import and export details** Power BI report that you created, to show that report as an action item on the selected page.</span></span>
3. <span data-ttu-id="2d992-243">アクション項目をクリックして、Power BI でデザインされたレポートを表示するページを開きます。</span><span class="sxs-lookup"><span data-stu-id="2d992-243">Click the action item to open the page that shows the report that you designed in Power BI.</span></span>

    <span data-ttu-id="2d992-244">[![インポートとエクスポートの詳細レポート](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)</span><span class="sxs-lookup"><span data-stu-id="2d992-244">[![Import and export details report](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="2d992-245">追加リソース</span><span class="sxs-lookup"><span data-stu-id="2d992-245">Additional resources</span></span>

[<span data-ttu-id="2d992-246">電子申告 (ER) の送信先</span><span class="sxs-lookup"><span data-stu-id="2d992-246">Electronic reporting (ER) destinations</span></span>](electronic-reporting-destinations.md)

[<span data-ttu-id="2d992-247">電子申告 (ER) の概要</span><span class="sxs-lookup"><span data-stu-id="2d992-247">Electronic reporting (ER) overview</span></span>](general-electronic-reporting.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]