---
title: ER アプリケーション固有のパラメータを使用するルックアップ データ ソースのコンフィギュレーション
description: このトピックでは、ER アプリケーション固有のパラメーターを使用して電子申告 (ER) 形式のルックアップ データ ソースを構成する方法について説明します。
author: NickSelin
ms.date: 04/02/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, EROperationDesigner, ERLookupDesigner, ERComponentLookupStructureEditing
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: Release 8.1.3
ms.openlocfilehash: 2849df85c37c4ed00754be91b9a9708db1bb16b7d0eb49d3a61d169037687196
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "6723192"
---
# <a name="configure-lookup-data-sources-to-use-er-application-specific-parameters"></a>ER アプリケーション固有のパラメータを使用するルックアップ データ ソースのコンフィギュレーション 

[!include[banner](../includes/banner.md)]

[電子申告 (ER)](general-electronic-reporting.md) アプリケーション固有のパラメーター機能を使用すると、データ フィルターを ER 形式に構成して、一連の抽象的なルールに基づくようにすることができます。 このルール セットは、ER 形式で使用可能な **ルックアップ** タイプのデータ ソースを使用するように構成できます。 対応する ER 形式と現在の法人データの **ルックアップ** データ ソース設定に基づいて自動的に生成されるユーザー インターフェイス (UI) を使用して、ER コンポーネント デザイナーを超えた実際のルールを指定することができます。 最終的には、この ER 形式を実行するとき、指定したルールは ER 形式の **ルックアップ** データ ソースによってアクセスされます。

> [!NOTE]
> 編集可能な ER 形式の構成されたデータ ソースを使用して、実際のルールの構成に使用するアプリケーション データを指定します。

[ER Operations デザイナー](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) を使用して、**ルックアップ** タイプのデータ ソースを ER 形式で移動します。 次を含め、データ ソースを構成して、抽象的なルールの表示方法を記述する必要があります。

   - 1 つのルールを指定するために値が指定されている特定のデータ型のパラメーター セット。
   - このルールがその他よりも最も適していると見なされる場合に 1 つのルールによって返される特定のデータ型の値の型。

構成された任意のルールによって返される値の型に応じて、次のタイプの **ルックアップ** データ ソースを構成することができます。

   - モデル列挙値が返される必要がある場合は、**データ モデル\ルックアップ** タイプを使用します。
   - アプリケーションの列挙値またはアプリケーションの [拡張データ型](../extensibility/extensible-edts.md) の値を返す必要がある場合は、**Dynamics 365 工程\ルックアップ** タイプを使用します。
   - 形式列挙値が返される必要がある場合は、**形式列挙型\ルックアップ** タイプを使用します。

次の図は、サンプルの ER 形式で形式列挙型を構成する方法を示しています。

   ![構成されたルックアップ データ ソースの基礎として形式列挙型を表示する。](./media/er-lookup-data-sources-img1.gif)

次の図は、さまざまなタイプの税を生成されたレポートとは別のセクションで報告するように構成された形式コンポーネントを示しています。

   ![さまざまなタイプの税を個別に報告する形式セクションを表示する。](./media/er-lookup-data-sources-img2.png)

次の図は、ER Operations デザイナーによって、**形式列挙型\ルックアップ** タイプのデータ ソースの追加を許可する方法を示しています。  追加したデータ ソースは、`List of taxation levels` 形式列挙型の値を返すするように構成されています。

   ![形式列挙型\ルックアップ タイプの ER データ ソースを追加する。](./media/er-lookup-data-sources-img3.gif)

次の図は、追加されたデータ ソースが、**モデル** データ ソース内の **Model.Data.Tax** レコード リストの **コード** フィールドを、すべての構成済みルールに対して指定される必要のあるパラメーターとして使用するよう構成される方法を示しています。

![形式列挙型\ルックアップ タイプの追加データ ソースのパラメータを構成する。](./media/er-lookup-data-sources-img4.gif)

追加された `Model.Data.Tax` データ ソースは、**TaxTable** アプリケーション テーブルのレコードにアクセスすることにより、すべての構成済みルールに対して税コードを指定するように構成されます。

   ![1 つの会社の形式列挙型\ルックアップ タイプのルックアップ データ ソースの確認。](./media/er-lookup-data-sources-img5.gif)

自動的に構成済みデータ ソースの構造にアラインされた UI を使用して、選択した ER 形式のルックアップ ルールを設定することができます。 現在、この UI は、各ルールについて、戻り値をパラメーターとしての税コードと同様に `List of taxation levels` 形式として指定する必要があります。

   ![構成済みデータ ソースのルールを設定する。](./media/er-lookup-data-sources-img6.gif)

次の図は、**計算済みフィールド** タイプの `Model.Data.Summary.LevelByLookup` データ ソースを、必要なパラメーターを提供する **ルックアップ** データ ソースを呼び出すように構成する方法を示しています。 実行時にこの呼び出しを処理するために、ER は定義された順序で構成されたルールの一覧を確認し、指定された条件を満たす最初のルールを探します。 この例は、指定された税コードと一致する税コードを含むルールです。 このため、最も適しているルールが検索され、検索されたルールに対して構成されている列挙値が、このデータ ソースによって返されます。

> [!NOTE]
> 該当するルールが見つからない場合に、例外がスローされます。 これらの例外を回避するために、ルール一覧の最後に追加のルールを構成して、構成されていない値または値が指定されなかったケースを処理できるようにします。 それに応じて **\*空白でない***と **\*空白***オプションを使用します。  
>
> ![データ ソースを追加して、構成済みのルックアップ データ ソースを呼び出す。](./media/er-lookup-data-sources-img7.png)

編集可能なルックアップ データ ソースに対して **会社間** オプションを **はい** に設定する場合、必要な新しい **会社** パラメーターが、このデータ ソースのパラメーター セットに追加されます。 ルックアップ データ ソースが呼び出される場合、実行時に **会社** パラメーターの値を指定する必要があります。 会社コードが実行時に指定された場合、この会社に対して構成されたルールを使用して最も適切なルールが検索され、対応する値が返されます。 次の図は、この実行方法および編集可能なデータ ソースのパラメーター セットの変更方法を示しています。

   ![会社間の形式列挙型\ルックアップ タイプのルックアップ データ ソースの確認。](./media/er-lookup-data-sources-img8.gif)

> [!NOTE]
> すべての会社を個別に選択して、編集可能な ER 形式のルックアップ データ ソースのルール セットを構成します。 ルックアップ設定が完了していない会社のコードを使用して会社間ルックアップが呼び出される場合、実行時に例外がスローされます。
>
> 会社間の **ルックアップ** データ ソースを使用して ER 形式を実行し、このデータ ソースの範囲内ですべての会社のデータにアクセスするユーザーにアクセス許可が与えられていることを確認してください。 それ以外の場合は、実行時に例外がスローされます。

バージョン 10.0.19 から、**ルックアップ** データ ソースの拡張機能が使用可能になりました。 編集可能なルックアップ データ ソースに対して **拡張** オプションを **はい** に設定すると、構成済みルックアップ データ ソースは、構成済みのルール セットを分析する追加機能を提供する構造化されたデータ ソースに変換されます。 次の図は、このトランザクションを示しています。

   ![形式列挙型\ルックアップ タイプの構造化されたルックアップ データ ソースの確認。](./media/er-lookup-data-sources-img9.gif)

- **ルックアップ** のサブ項目は、指定されたパラメーター セットに基づいて構成済みのルール セットから最も適したルールを検索する関数として設計されています。
- **IsLookupResultSet** サブ項目は、指定された列挙値が戻り値として構成されたルールが少なくとも 1 つ含まれている場合に、基本列挙型データ ソースの値を受け入れ、**True** の *ブール* 値を返す関数として設計されています。 指定された列挙値を返すよう構成されたルールがない場合、関数は **False** の *ブール* 値を返します。
- **設定** のサブ項目は、レコード リストのレコードとして構成済みのルール セットを返す関数として設計されています。 戻り値および構成済みルールのパラメーター セットは、返されるすべてのレコードで、関連するデータ型のフィールドとして表示されます。

    - 戻り値は、**ルックアップの結果** フィールドとして表示されます。
    - 構成済みのパラメーターは、パラメーターの名前を持つフィールドとして表示されます (この例では **コード** フィールド)。

**ルックアップ** データ ソースの構成方法の詳細については、[法人ごとに指定されたパラメーターを使用するよう電子申告形式を構成する](er-app-specific-parameters-configure-format.md) を参照してください。 ルックアップ ルールを設定する方法については、[法人ごとの電子申告形式のパラメーターの設定](er-app-specific-parameters-set-up.md) を参照してください。

## <a name="additional-resources"></a>追加リソース

[法人ごとに指定されたパラメーターを使用するよう電子申告形式を構成する](er-app-specific-parameters-configure-format.md)

[法人ごとの電子申告形式のパラメーターの設定](er-app-specific-parameters-set-up.md)
