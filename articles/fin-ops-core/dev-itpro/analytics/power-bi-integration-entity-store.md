---
title: エンティティ格納と Power BI の統合
description: エンティティ格納は、Microsoft Dynamics 365 Finance に含まれている運用データ ストアです。 このトピックでは、エンティティストアが Power BI 統合を有効にする方法について説明します。
author: MilindaV2
manager: AnnBe
ms.date: 06/16/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: BIMeasurementDeployManagementEntityStore
audience: IT Pro
ms.reviewer: kfend
ms.custom: 265974
ms.assetid: 434b5d9f-9877-4769-ad96-d4e8d460a7fa
ms.search.region: Global
ms.author: milindav
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: Platform update 1
ms.openlocfilehash: 605b8b410887d782abe8370abdfeacda00393ad8
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2020
ms.locfileid: "4688305"
---
# <a name="power-bi-integration-with-entity-store"></a><span data-ttu-id="103db-104">エンティティ格納と Power BI の統合</span><span class="sxs-lookup"><span data-stu-id="103db-104">Power BI integration with Entity store</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="103db-105">エンティティ格納は、Microsoft Dynamics 365 Finance に含まれている運用データ ストアです。</span><span class="sxs-lookup"><span data-stu-id="103db-105">Entity store is an operational data store that is included with Microsoft Dynamics 365 Finance.</span></span> <span data-ttu-id="103db-106">このトピックでは、エンティティストアが Power BI 統合を有効にする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="103db-106">This topic describes how Entity store enables Power BI integration.</span></span>

<span data-ttu-id="103db-107">エンティティ格納は、アプリケーションに含まれている運用データ ストアです。</span><span class="sxs-lookup"><span data-stu-id="103db-107">Entity store is an operational data store that is included with the application.</span></span> <span data-ttu-id="103db-108">エンティティ格納の機能は、Microsoft Dynamics AX プラットフォーム更新プログラム 1 (2016 年 5 月) リリースで導入されました。</span><span class="sxs-lookup"><span data-stu-id="103db-108">The Entity store feature was introduced in the Microsoft Dynamics AX platform update 1 (May 2016) release.</span></span> <span data-ttu-id="103db-109">この機能を使用すると、管理者またはパワーユーザーは、レポートおよび分析用の専用データストアで測定値を公開できます。</span><span class="sxs-lookup"><span data-stu-id="103db-109">This feature lets an administrator or power user stage aggregate measurements in a dedicated data store for reporting and analytics.</span></span> <span data-ttu-id="103db-110">(集計の測定は、エンティティを使用してモデル化されたスター スキーマです)。このデータ ストアをエンティティ格納と呼びます。</span><span class="sxs-lookup"><span data-stu-id="103db-110">(Aggregate measurements are a star schema that is modeled by using entities.) We call this data store Entity store.</span></span> <span data-ttu-id="103db-111">レポート用に最適化されたデータベースです。</span><span class="sxs-lookup"><span data-stu-id="103db-111">It’s a database that is optimized for reporting purposes.</span></span> <span data-ttu-id="103db-112">エンティティ格納では、Microsoft SQL Server に組み込まれたメモリ内の集合縦棒ストア インデックス (CCI) 機能を使用して、レポートとクエリを最適化します。</span><span class="sxs-lookup"><span data-stu-id="103db-112">Entity store uses the in-memory, clustered columnstore index (CCI) functionality that is built into Microsoft SQL Server to optimize reporting and queries.</span></span> <span data-ttu-id="103db-113">顧客は、Microsoft Power BI の DirectQuery モデルをエンティティ格納と共に使用し、大量のデータに対して大量のほぼリアルタイムの分析レポートを有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="103db-113">Customers can use Microsoft Power BI DirectQuery models together with Entity store to enable high-volume, near-real-time analytical reporting over large volumes of data.</span></span>

## <a name="power-bi-directquery-mode"></a><span data-ttu-id="103db-114">Power BI DirectQuery モード</span><span class="sxs-lookup"><span data-stu-id="103db-114">Power BI DirectQuery mode</span></span>
<span data-ttu-id="103db-115">Microsoft Dynamics AX の 2016 年 2 月のリリースでは、データ エンティティ (集計データのエンティティと、詳細または通常のデータ エンティティの両方) で公開される OData エンドポイントを使用して Power BI レポートを作成することができました。</span><span class="sxs-lookup"><span data-stu-id="103db-115">In the February 2016 release of Microsoft Dynamics AX, you could create Power BI reports by using OData endpoints that are exposed via data entities (both aggregate data entities and detailed or regular data entities).</span></span> <span data-ttu-id="103db-116">この方法は引き続き サポートされていますが、エンティティ格納でもパワー ユーザーは Power BI DirectQuery レポートを作成できます。</span><span class="sxs-lookup"><span data-stu-id="103db-116">Although this approach is still supported, Entity store also lets power users create Power BI DirectQuery reports.</span></span>

<span data-ttu-id="103db-117">[![DirectQuery モード](./media/entity-store-architecture-1024x587.jpg)](./media/entity-store-architecture.jpg)</span><span class="sxs-lookup"><span data-stu-id="103db-117">[![DirectQuery mode](./media/entity-store-architecture-1024x587.jpg)](./media/entity-store-architecture.jpg)</span></span>

<span data-ttu-id="103db-118">前の図に示すように、DirectQuery はエンティティ格納で直接レポートを実行するレポート モードです。</span><span class="sxs-lookup"><span data-stu-id="103db-118">As the preceding illustration shows, DirectQuery is a reporting mode that runs reports directly on Entity store.</span></span> <span data-ttu-id="103db-119">このレポート モードでは、データは Power BI のキャッシュにステージングされません。</span><span class="sxs-lookup"><span data-stu-id="103db-119">In this reporting mode, data isn't staged in Power BI caches.</span></span> <span data-ttu-id="103db-120">このモードでは、2 つの直接的な利点があります。</span><span class="sxs-lookup"><span data-stu-id="103db-120">This mode provides two immediate benefits:</span></span>

- <span data-ttu-id="103db-121">大量のデータに対して Power BI レポートを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="103db-121">You can create Power BI reports over large data volumes.</span></span>
- <span data-ttu-id="103db-122">レポートは、Power BI を使って更新する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="103db-122">Reports don't have to be updated by using Power BI.</span></span> <span data-ttu-id="103db-123">エンティティ格納が更新されると、レポートに最新のデータが反映されます。</span><span class="sxs-lookup"><span data-stu-id="103db-123">When Entity store is updated, reports reflect the latest data.</span></span>

<span data-ttu-id="103db-124">さらに、Power BI サービスにデータがキャッシュされないため、データが環境から離れることはありません。</span><span class="sxs-lookup"><span data-stu-id="103db-124">Additionally, data doesn't leave your environment, because no data is cached in the Power BI service.</span></span>

## <a name="stage-aggregate-measurements-in-entity-store"></a><span data-ttu-id="103db-125">エンティティ格納における集計測定のステージング</span><span class="sxs-lookup"><span data-stu-id="103db-125">Stage aggregate measurements in Entity store</span></span>
<span data-ttu-id="103db-126">集計測定は分析シナリオのためにモデル化されたスター スキーマです。</span><span class="sxs-lookup"><span data-stu-id="103db-126">Aggregate measurements are a star schema that is modeled for analytical scenarios.</span></span> <span data-ttu-id="103db-127">2016 年 2 月のリリースでは、リアルタイムなメモリ内集計の測定が有効になりました。</span><span class="sxs-lookup"><span data-stu-id="103db-127">In the February 2016 release, we enabled real-time, in-memory aggregate measurements.</span></span> <span data-ttu-id="103db-128">リアルタイムの集計測定を使用することにより、データのリアルタイム操作に対応する埋め込みチャートおよび主要業績評価指標 (KPI) を有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="103db-128">By using real-time aggregate measurements, you can enable embedded charts and key performance indicators (KPIs) that react to real-time operations on data.</span></span> <span data-ttu-id="103db-129">詳細については、 [Analysis Services キューブから集計モデルへの移行](../migration-upgrade/in-memory-real-time-aggregate-models.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="103db-129">For information, see [Transition from Analysis Services cubes to aggregate models](../migration-upgrade/in-memory-real-time-aggregate-models.md).</span></span> <span data-ttu-id="103db-130">リアルタイム集計測定は、インメモリの非クラスター化縦棒ストア インデックス (NCCI) の技術を活用します。</span><span class="sxs-lookup"><span data-stu-id="103db-130">Real-time aggregate measurements take advantage of the in-memory, non-clustered columnstore index (NCCI) technology.</span></span> <span data-ttu-id="103db-131">リアルタイムの集計の測定で作成されたビジュアルおよび集計計算に数秒以内のトランザクションが反映されます。</span><span class="sxs-lookup"><span data-stu-id="103db-131">Visuals and aggregate calculations that are built over real-time aggregate measurements reflect transactions within seconds.</span></span> <span data-ttu-id="103db-132">プラットフォーム更新プログラム 1 (2016 年 5 月) のリリースでは、エンティティ格納でステージングできる集計測定を有効にしました。</span><span class="sxs-lookup"><span data-stu-id="103db-132">In the platform update 1 (May 2016) release, we enabled aggregate measurements that can be staged in Entity store.</span></span> <span data-ttu-id="103db-133">エンティティ ストアで実施された集計測定は、Power BI を使用して大量のデータを調べる必要がある、ほぼリアルタイムの分析シナリオで使用できます。</span><span class="sxs-lookup"><span data-stu-id="103db-133">Aggregate measurements that are staged in Entity store can be used for near-real-time analytical scenarios where large volumes of data must be explored by using Power BI.</span></span> <span data-ttu-id="103db-134">開発者として、 [集計データのモデリング](model-aggregate-data.md) でリアルタイム分析の集計測定をモデル化する方法について確認することができます。</span><span class="sxs-lookup"><span data-stu-id="103db-134">As a developer, you learned how to model an aggregate measurement for real-time analytics in [Model aggregate data](model-aggregate-data.md).</span></span> <span data-ttu-id="103db-135">プラットフォーム更新プログラム 1 (2016 年 5 月) のリリースでは、エンティティ格納でステージングできる集計測定をモデル化する機能も追加しました。</span><span class="sxs-lookup"><span data-stu-id="103db-135">In the platform update 1 (May 2016) release, we also added the capability to model aggregate measurements that can be staged in Entity store.</span></span> <span data-ttu-id="103db-136">Microsoft Visual Studio で、**StagedEntityStore** を集計の測定の用途プロパティとして指定します。</span><span class="sxs-lookup"><span data-stu-id="103db-136">In Microsoft Visual Studio, you can specify **StagedEntityStore** as the usage property of an aggregate measurement.</span></span> <span data-ttu-id="103db-137">この新しいプロパティは、2016 年 5 月で追加されました。</span><span class="sxs-lookup"><span data-stu-id="103db-137">This new property was added in May 2016.</span></span> <span data-ttu-id="103db-138">以前は、**InMemoryRealTime** は用途プロパティとして使用できました。</span><span class="sxs-lookup"><span data-stu-id="103db-138">Previously, **InMemoryRealTime** was available as the usage property.</span></span>

![Visual Studio にある新しい StagedEntityStore の使用プロパティ](media/new-usage-property-in-VS.png)

<span data-ttu-id="103db-140">ただし、ステージングできるように集計測定をモデル化するのはなぜかと疑問に思われるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="103db-140">However, you might wonder why you would model an aggregate measurement so that it can be staged?</span></span> <span data-ttu-id="103db-141">メモリ内リアルタイム集計測定を常に使用しないのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="103db-141">Why wouldn’t you use in-memory real-time aggregate measurements all the time?</span></span> <span data-ttu-id="103db-142">**StagedEntityStore** パターンを使用する理由はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="103db-142">There are several reasons for using the **StagedEntityStore** pattern:</span></span>

- <span data-ttu-id="103db-143">調査して分析する必要がある、大量のデータが存在する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="103db-143">There might be large amounts of data that must be explored and analyzed.</span></span>
- <span data-ttu-id="103db-144">コード アップグレード プロセスの一部として、Microsoft Dynamics AX 2012 R3 から移行した解析プロジェクト (つまり、キューブ) がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="103db-144">You might have Analysis projects (that is, cubes) that you migrated from Microsoft Dynamics AX 2012 R3 as part of the code upgrade process.</span></span> <span data-ttu-id="103db-145">スキーマには複雑なビューと結合が存在するため、クエリ応答時間は埋め込まれたビジュアルには受け入れられない場合があります。</span><span class="sxs-lookup"><span data-stu-id="103db-145">Because of the complex views and joins that are present in the schema, query response times might not be acceptable for embedded visuals.</span></span> <span data-ttu-id="103db-146">ただし、NCCI テクノロジーを直ちに活用するためにビジュアルをリファクタリングする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="103db-146">However, you might not want to refactor the visuals to take advantage of NCCI technology immediately.</span></span>
- <span data-ttu-id="103db-147">運用データベースのスキーマとは異なり、エンティティ ストアのスキーマは特にレポートのためにモデル化されています。</span><span class="sxs-lookup"><span data-stu-id="103db-147">Unlike the operational database schema, the schema in Entity store is modeled specifically for reporting.</span></span> <span data-ttu-id="103db-148">したがって、エンティティ ストアのスキーマから新しいレポートを作成する方がはるかに簡単です。</span><span class="sxs-lookup"><span data-stu-id="103db-148">Therefore, it's much easier to build new reports from the schema in Entity store.</span></span>
- <span data-ttu-id="103db-149">自分のシナリオが、操作の数秒以内での分析データの更新を必要としない場合があります。</span><span class="sxs-lookup"><span data-stu-id="103db-149">Your scenario might not require that analytical data be updated within seconds of an operation.</span></span> <span data-ttu-id="103db-150">データ検索を有効にするために構築されているほとんどの Power BI レポートは、このカテゴリに分類されます。</span><span class="sxs-lookup"><span data-stu-id="103db-150">Most Power BI reports that are built to enable data exploration fall into this category.</span></span> <span data-ttu-id="103db-151">約 10 分でデータをリフレッシュすることがシナリオで許容される場合は、段階的なパターンを使用する場合があります。</span><span class="sxs-lookup"><span data-stu-id="103db-151">If data freshness of approximately 10 minutes is acceptable for your scenario, you might want to use the staged pattern.</span></span>

<span data-ttu-id="103db-152">上記の理由のいずれかによってユーザーの状況がカバーされる場合、エンティティ店舗で集計測定を実行し、Power BI 統合に対して使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="103db-152">If one of the preceding reasons covers your situation, you should stage your aggregate measurement in Entity store and it use for Power BI integration.</span></span>

## <a name="update-entity-store"></a><span data-ttu-id="103db-153">エンティティ店舗の更新</span><span class="sxs-lookup"><span data-stu-id="103db-153">Update Entity store</span></span>
<span data-ttu-id="103db-154">エンティティ格納が自動化され、システムにより管理されます。</span><span class="sxs-lookup"><span data-stu-id="103db-154">Entity store refresh is automated and managed by the system.</span></span> <span data-ttu-id="103db-155">クライアントで、**エンティティ格納** ページは **システム管理** &gt; **設定** &gt; **エンティティ格納** で表示できます。</span><span class="sxs-lookup"><span data-stu-id="103db-155">In the client, you can find the **Entity Store** page at **Systems administration** &gt; **Setup** &gt; **Entity Store**.</span></span> <span data-ttu-id="103db-156">詳細については、[エンティティ格納の自動化更新](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/analytics/automated-entity-store-refresh)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="103db-156">For more information, see [Automated Entity store refresh](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/analytics/automated-entity-store-refresh).</span></span>

### <a name="connecting-to-the-entity-store-database"></a><span data-ttu-id="103db-157">エンティティ格納データベースに接続する</span><span class="sxs-lookup"><span data-stu-id="103db-157">Connecting to the Entity store database</span></span>
<span data-ttu-id="103db-158">トラブルシューティングや診断の場合、関連するサンドボックス環境から直接エンティティ格納データベースに接続することができます。</span><span class="sxs-lookup"><span data-stu-id="103db-158">For troubleshooting and diagnostics, you can connect to the Entity store database directly from a related sandbox environment.</span></span>  <span data-ttu-id="103db-159">接続するには</span><span class="sxs-lookup"><span data-stu-id="103db-159">To connect:</span></span>

1. <span data-ttu-id="103db-160">サンドボックスにアクセスするには、リモート デスクトップを使用します。</span><span class="sxs-lookup"><span data-stu-id="103db-160">Use Remote Desktop to access the sandbox.</span></span>  <span data-ttu-id="103db-161">RDP ファイルは、IP アドレスをセーフ リストに登録後、**環境の詳細** ページからダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="103db-161">The RDP file can be downloaded from the **Environment Details** page after you have included your IP address in a safe list.</span></span>
2. <span data-ttu-id="103db-162">SQL Server Management Studio を開き、**環境の詳細** ページで指定したサーバーに接続します。</span><span class="sxs-lookup"><span data-stu-id="103db-162">Open SQL Server Management Studio, and connect to the server specified on the **Environment Details** page.</span></span>  
    * <span data-ttu-id="103db-163">**データベース アカウント** というセクションを見つけます。</span><span class="sxs-lookup"><span data-stu-id="103db-163">Find the section titled **Database Accounts**.</span></span>  <span data-ttu-id="103db-164">名前 **axdwadmin** を持つユーザーのエントリを探します。</span><span class="sxs-lookup"><span data-stu-id="103db-164">Locate the entry for the user with the name **axdwadmin**.</span></span>  
    * <span data-ttu-id="103db-165">サーバー名は、**SQL サーバー\データベース名** フィールドの最初の部分です。</span><span class="sxs-lookup"><span data-stu-id="103db-165">The server name is the first portion of the **SQL Server\Database Name** field.</span></span>  <span data-ttu-id="103db-166">これは、**SQLServerName.database.windows.net** の形式で使用する必要があります。ここで、SQLServerName は LCS からの値です。</span><span class="sxs-lookup"><span data-stu-id="103db-166">This should be used in the format of **SQLServerName.database.windows.net** where SQLServerName is the value from LCS.</span></span>
    * <span data-ttu-id="103db-167">認証の種類は、Windows 認証から SQL Server 認証に変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="103db-167">The authentication type should be changed from Windows Authentication to SQL Server Authentication.</span></span>
    * <span data-ttu-id="103db-168">ログインは、axdwadmin となり、パスワードは LCS からの値となります。</span><span class="sxs-lookup"><span data-stu-id="103db-168">The login will be axdwadmin and the password will be the value from LCS.</span></span>
3. <span data-ttu-id="103db-169">**オプション** ボタンを使用するか **接続のプロパティ** タブを参照して、**データベースに接続** プロパティを既定値から、LCS からの **データベース名** 値に変更します。</span><span class="sxs-lookup"><span data-stu-id="103db-169">Using the **Options** button or by browsing to the **Connection Properties** tab, change the **Connect to database** property from the default value to your **Database Name** value from LCS.</span></span>
4. <span data-ttu-id="103db-170">**接続** をクリックしてデータベースにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="103db-170">Click **Connect** to access the database.</span></span>
