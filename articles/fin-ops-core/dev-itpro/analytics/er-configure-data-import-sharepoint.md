---
title: SharePoint からのデータ インポートをコンフィギュレーションする
description: このトピックでは、Microsoft SharePoint からデータをインポートする方法について説明します。
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: c11123c0d53fcf4ba67e83fe64d2d6e692d5b6f1
ms.sourcegitcommit: fbc106af09bdadb860677f590464fb93223cbf65
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/06/2019
ms.locfileid: "2771355"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="011ba-103">SharePoint からのデータ インポートをコンフィギュレーションする</span><span class="sxs-lookup"><span data-stu-id="011ba-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="011ba-104">電子申告 (ER) フレームワークを使用して受信ファイルからデータをインポートするには、インポート処理をサポートする ER 形式をコンフィギュレーションし、データ ソースとしてその形式を使用する**宛先**タイプのモデル マッピングを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="011ba-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="011ba-105">データをインポートするには、インポートするファイルに移動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="011ba-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="011ba-106">受信ファイルは、ユーザーにより手動で選択できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="011ba-107">Microsoft SharePoint からのデータのインポートをサポートするための新しい ER 機能を使用すると、このプロセスを無人プロセスとしてコンフィギュレーションできます。</span><span class="sxs-lookup"><span data-stu-id="011ba-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="011ba-108">ER コンフィギュレーションを使用して、Microsoft SharePoint フォルダーに格納されているファイルからデータのインポートを実行できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="011ba-109">このトピックでは、SharePoint からインポートを完了する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="011ba-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="011ba-110">例では、業務データとして仕入先トランザクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="011ba-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="011ba-111">必要条件</span><span class="sxs-lookup"><span data-stu-id="011ba-111">Prerequisites</span></span>
<span data-ttu-id="011ba-112">このトピックの例を完了するには、次のアクセスが必要です:</span><span class="sxs-lookup"><span data-stu-id="011ba-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="011ba-113">次のロールのいずれかにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="011ba-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="011ba-114">電子申告開発者</span><span class="sxs-lookup"><span data-stu-id="011ba-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="011ba-115">電子申告機能コンサルタント</span><span class="sxs-lookup"><span data-stu-id="011ba-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="011ba-116">システム管理者</span><span class="sxs-lookup"><span data-stu-id="011ba-116">System administrator</span></span>

- <span data-ttu-id="011ba-117">アプリケーションで使用するようにコンフィギュレーションされた、Microsoft SharePoint Server のインスタンスへアクセスします。</span><span class="sxs-lookup"><span data-stu-id="011ba-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="011ba-118">1099 支払の ER 形式およびモデル コンフィギュレーション。</span><span class="sxs-lookup"><span data-stu-id="011ba-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="011ba-119">必須な ER コンフィギュレーションの作成</span><span class="sxs-lookup"><span data-stu-id="011ba-119">Create required ER configurations</span></span>
<span data-ttu-id="011ba-120">**7.5.4.3 IT サービス/ソリューション コンポーネントの取得/開発 (10677)** 業務プロセスの一部である **Microsoft Excel ファイルからの ER インポート データ**タスク ガイドを再生します。</span><span class="sxs-lookup"><span data-stu-id="011ba-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="011ba-121">これらのタスク ガイドでは、デザインのプロセスおよび Microsoft Excel ファイルから仕入先トランザクションを対話型でインポートする ER コンフィギュレーションの使用について説明します。</span><span class="sxs-lookup"><span data-stu-id="011ba-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="011ba-122">詳細については、[Excel 形式で受信ドキュメントを解析する](parse-incoming-documents-excel.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="011ba-122">For more information, see [Parse incoming documents in Excel format](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="011ba-123">タスク ガイドが完了したら、次の設定を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="011ba-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="011ba-124">ER コンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="011ba-124">ER configurations</span></span>

- <span data-ttu-id="011ba-125">ER モデル構成、**1099 支払モデル**</span><span class="sxs-lookup"><span data-stu-id="011ba-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="011ba-126">ER 形式コンフィギュレーション、**Excel から仕入先のトランザクションをインポートするための形式**</span><span class="sxs-lookup"><span data-stu-id="011ba-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![SharePoint からデータをインポートするための ER コンフィギュレーション](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="011ba-128">データのインポートに対する受信ファイルのサンプル</span><span class="sxs-lookup"><span data-stu-id="011ba-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="011ba-129">Excel ファイル **1099import-data.xlsx** と、インポートする必要がある仕入先トランザクション。</span><span class="sxs-lookup"><span data-stu-id="011ba-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![SharePoint からインポートするためのサンプル Microsoft Excel ファイル](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="011ba-131">仕入先トランザクションをインポートするための形式が既定のモデル マッピングとして選択されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="011ba-132">したがって、**1099 支払モデル**のモデル マッピングを実行し、そのモデル マッピングが**宛先**タイプの場合、モデル マッピングは外部ファイルからデータをインポートするこの形式を実行します。</span><span class="sxs-lookup"><span data-stu-id="011ba-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="011ba-133">続いてそのデータを使用して、アプリケーション テーブルを更新します。</span><span class="sxs-lookup"><span data-stu-id="011ba-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="011ba-134">ファイル ストレージの SharePoint へのアクセスをコンフィギュレーションする</span><span class="sxs-lookup"><span data-stu-id="011ba-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="011ba-135">電子レポート ファイルを SharePoint の場所に保管するには、現在の会社によって使用される SharePoint Server のインスタンスへのアクセスをコンフィギュレーションする必要があります。</span><span class="sxs-lookup"><span data-stu-id="011ba-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="011ba-136">この例では、会社は USMF です。</span><span class="sxs-lookup"><span data-stu-id="011ba-136">In this example, the company is USMF.</span></span> <span data-ttu-id="011ba-137">手順については、[SharePoint ストレージのコンフィギュレーション](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="011ba-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="011ba-138">[SharePoint ストレージのコンフィギュレーション](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage) で手順を完了します。</span><span class="sxs-lookup"><span data-stu-id="011ba-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="011ba-139">コンフィギュレーションされた SharePoint サイトを開きます。</span><span class="sxs-lookup"><span data-stu-id="011ba-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="011ba-140">受信した電子申告ファイルを保存できる次のフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="011ba-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="011ba-141">ファイルのインポート ソース (メイン) (次のスクリーン ショットに示された例)</span><span class="sxs-lookup"><span data-stu-id="011ba-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="011ba-142">ファイルのインポート ソース (代替)</span><span class="sxs-lookup"><span data-stu-id="011ba-142">Files import source (alternative)</span></span>

    ![ファイルのインポート ソース (メイン)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="011ba-144">(オプション) インポート後にファイルを保存できる次のフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="011ba-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="011ba-145">ファイル アーカイブ フォルダー - このフォルダーは正常にインポートしたファイル用です。</span><span class="sxs-lookup"><span data-stu-id="011ba-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="011ba-146">ファイル警告フォルダー - このフォルダーは警告付きでインポートしたファイル用です。</span><span class="sxs-lookup"><span data-stu-id="011ba-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="011ba-147">ファイル エラー フォルダー - このフォルダーはインポートに失敗したファイル用です。</span><span class="sxs-lookup"><span data-stu-id="011ba-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="011ba-148">**組織管理 > ドキュメント管理 > ドキュメント タイプ**へ移動します。</span><span class="sxs-lookup"><span data-stu-id="011ba-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="011ba-149">先ほど作成した SharePoint フォルダーにアクセスするために使用される次のドキュメント タイプを作成します。</span><span class="sxs-lookup"><span data-stu-id="011ba-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="011ba-150">手順については、[ドキュメント タイプのコンフィギュレーション](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="011ba-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="011ba-151">文書種類</span><span class="sxs-lookup"><span data-stu-id="011ba-151">Document type</span></span>       | <span data-ttu-id="011ba-152">グループ化</span><span class="sxs-lookup"><span data-stu-id="011ba-152">Group</span></span>              | <span data-ttu-id="011ba-153">保管場所</span><span class="sxs-lookup"><span data-stu-id="011ba-153">Location</span></span>      | <span data-ttu-id="011ba-154">SharePoint フォルダー</span><span class="sxs-lookup"><span data-stu-id="011ba-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="011ba-155">SP メイン</span><span class="sxs-lookup"><span data-stu-id="011ba-155">SP Main</span></span>             |<span data-ttu-id="011ba-156">ファイル</span><span class="sxs-lookup"><span data-stu-id="011ba-156">File</span></span>                |<span data-ttu-id="011ba-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="011ba-157">SharePoint</span></span>     |<span data-ttu-id="011ba-158">ファイルのインポート ソース (メイン)</span><span class="sxs-lookup"><span data-stu-id="011ba-158">Files import source (main)</span></span>|
|<span data-ttu-id="011ba-159">SP 代替</span><span class="sxs-lookup"><span data-stu-id="011ba-159">SP Alternative</span></span>             |<span data-ttu-id="011ba-160">ファイル</span><span class="sxs-lookup"><span data-stu-id="011ba-160">File</span></span>                |<span data-ttu-id="011ba-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="011ba-161">SharePoint</span></span>     |<span data-ttu-id="011ba-162">ファイルのインポート ソース (代替)</span><span class="sxs-lookup"><span data-stu-id="011ba-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="011ba-163">SP アーカイブ</span><span class="sxs-lookup"><span data-stu-id="011ba-163">SP Archive</span></span>             |<span data-ttu-id="011ba-164">ファイル</span><span class="sxs-lookup"><span data-stu-id="011ba-164">File</span></span>                |<span data-ttu-id="011ba-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="011ba-165">SharePoint</span></span>     |<span data-ttu-id="011ba-166">ファイル アーカイブ フォルダー</span><span class="sxs-lookup"><span data-stu-id="011ba-166">Files archive folder</span></span>|
|<span data-ttu-id="011ba-167">SP 警告</span><span class="sxs-lookup"><span data-stu-id="011ba-167">SP Warning</span></span>             |<span data-ttu-id="011ba-168">ファイル</span><span class="sxs-lookup"><span data-stu-id="011ba-168">File</span></span>                |<span data-ttu-id="011ba-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="011ba-169">SharePoint</span></span>     |<span data-ttu-id="011ba-170">ファイル警告フォルダー</span><span class="sxs-lookup"><span data-stu-id="011ba-170">Files warning folder</span></span>|
|<span data-ttu-id="011ba-171">SP エラー</span><span class="sxs-lookup"><span data-stu-id="011ba-171">SP Error</span></span>             |<span data-ttu-id="011ba-172">ファイル</span><span class="sxs-lookup"><span data-stu-id="011ba-172">File</span></span>                |<span data-ttu-id="011ba-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="011ba-173">SharePoint</span></span>     |<span data-ttu-id="011ba-174">ファイル エラー フォルダー</span><span class="sxs-lookup"><span data-stu-id="011ba-174">Files error folder</span></span>|

![SharePoint 設定 – 新しいドキュメント タイプ](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="011ba-176">ER 形式の ER ソースをコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="011ba-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="011ba-177">**組織管理** \> **電子申告** \> **電子申告ソース**の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="011ba-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="011ba-178">**電子申告ソース**ページで、コンフィギュレーション済の ER 形式を使用してデータ インポートのソース ファイルをコンフィギュレーションします。</span><span class="sxs-lookup"><span data-stu-id="011ba-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="011ba-179">.Xlsx 拡張子のファイルのみがインポートされるように、ファイル名マスクを定義します。</span><span class="sxs-lookup"><span data-stu-id="011ba-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="011ba-180">ファイル名マスクはオプションであり、定義された場合にのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="011ba-181">ER 形式ごとにマスクを 1 つだけ定義できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="011ba-182">多数のインポート用ファイルが存在し、インポート順序は重要ではない場合は、**ファイルをインポート前に並べ替える**を**並べ替えない**に変更します。</span><span class="sxs-lookup"><span data-stu-id="011ba-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="011ba-183">以前に作成したすべての SharePoint フォルダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="011ba-184">[![ER ファイル ソースの設定](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="011ba-185">ER *ソース*は、アプリケーションの会社ごとに個別に定義されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="011ba-186">対照的に、ER *コンフィギュレーション*は会社間で共有されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="011ba-187">ER 形式の ER ソース設定を削除すると、接続されているすべてのファイルの状態 (以下を参照) も確認によって削除されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="011ba-188">ER 形式のファイルの状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="011ba-189">**電子申告ソース**ページで、**ソースのファイル状態**を選択して現在の ER 形式のコンフィギュレーション済ファイル ソースの内容を確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="011ba-190">**ファイル**セクションで、ファイルの一覧を確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="011ba-191">このリストは、次のものを表します。</span><span class="sxs-lookup"><span data-stu-id="011ba-191">This list presents the following:</span></span>

    - <span data-ttu-id="011ba-192">該当するソース ファイルは、ファイル名マスク (ファイル名マスクが定義されている場合) に基づいており 、データのインポートの準備が整っています。</span><span class="sxs-lookup"><span data-stu-id="011ba-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="011ba-193">これらのファイルについては、**インポート フォーマットのソース ログ**セクションは空白になります。</span><span class="sxs-lookup"><span data-stu-id="011ba-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="011ba-194">以前にインポートされたファイル。</span><span class="sxs-lookup"><span data-stu-id="011ba-194">Previously imported files.</span></span> <span data-ttu-id="011ba-195">これらの各ファイルについては、**インポート フォーマットのソース ログ**セクションで、このファイルのインポートの履歴を確認できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="011ba-196">**組織管理** \> **電子申告** \> **ソースのファイルの状態**の順に選択することにより、**ソースのファイルの状態**ページを開くこともできます。</span><span class="sxs-lookup"><span data-stu-id="011ba-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="011ba-197">この場合、ページではすべての ER 形式のファイル ソースに関する情報、つまりファイル ソースが現在サインインしている会社でコンフィギュレーションされたという情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="011ba-198">SharePoint フォルダーにある Excel ファイルからのデータをインポートする</span><span class="sxs-lookup"><span data-stu-id="011ba-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="011ba-199">SharePoint では、仕入先トランザクションを含む Microsoft Excel ファイル **1099import data.xlsx** を、以前に作成した**ファイルのインポート ソース (メイン)** SharePoint フォルダーにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="011ba-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="011ba-200">[![SharePoint コンテンツ – インポート用 Microsoft Excel ファイル](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="011ba-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="011ba-201">**ソースのファイルの状態**ページで、**更新**を選択してページを更新します。</span><span class="sxs-lookup"><span data-stu-id="011ba-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="011ba-202">このページに表示される SharePoint にアップロードされた Excel ファイルの状態が**準備完了**となることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="011ba-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="011ba-203">次のステータスは、現在サポートされています。</span><span class="sxs-lookup"><span data-stu-id="011ba-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="011ba-204">**準備完了** – SharePoint フォルダーで新しいファイルごとに自動的に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="011ba-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="011ba-205">このステータスは、ファイルがインポートの準備ができていることを意味します。</span><span class="sxs-lookup"><span data-stu-id="011ba-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="011ba-206">**インポート中** – 他のプロセス (それらの多くが同時に実行されている場合) による使用を防ぐためにインポート プロセスによってファイルがロックされるときに、ER レポートによって自動的に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="011ba-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="011ba-207">**インポート済** – ファイルのインポートが正常に完了するときに、ER レポートによって自動的に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="011ba-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="011ba-208">このステータスは、インポートされたファイルがコンフィギュレーション済ファイル ソース (SharePoint フォルダー) から削除されたことを意味します。</span><span class="sxs-lookup"><span data-stu-id="011ba-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="011ba-209">**失敗** – ファイルのインポートがエラーまたは例外で完了するときに、ER レポートによって自動的に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="011ba-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="011ba-210">**保留中** – このページ上のユーザーによって手動で割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="011ba-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="011ba-211">このステータスは、ファイルが現在インポートされないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="011ba-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="011ba-212">このステータスは、いくつかのファイルのインポートを延期するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="011ba-213">[![選択したソースの ER ファイル状態のページ](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="011ba-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="011ba-214">データを SharePoint ファイルからインポート</span><span class="sxs-lookup"><span data-stu-id="011ba-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="011ba-215">ER コンフィギュレーション ツリーを開き、**1099 支払モデル**を選択し、ER モデル コンポーネントの一覧を展開します。</span><span class="sxs-lookup"><span data-stu-id="011ba-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="011ba-216">選択した ER モデル構成のモデルのマッピングの一覧を開くためのモデル マッピングの名前を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="011ba-217">[![選択したソースの ER ファイル状態のページ](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="011ba-218">**実行**を選択し、選択したモデル マッピングを実行します。</span><span class="sxs-lookup"><span data-stu-id="011ba-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="011ba-219">ER 形式のファイル ソースをコンフィギュレーションしたため、必要に応じて**ファイル ソース**オプションの設定を変更できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="011ba-220">このオプションの設定を維持すると、コンフィギュレーション済ソース (この例では SharePoint フォルダー) から .xslx ファイルがインポートされます。</span><span class="sxs-lookup"><span data-stu-id="011ba-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="011ba-221">この例では、1 つだけファイルをインポートしています。</span><span class="sxs-lookup"><span data-stu-id="011ba-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="011ba-222">ただし、複数のファイルがある場合、SharePoint フォルダーに追加された順序でインポートするよう選択されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="011ba-223">ER 形式の各実行で、単一の選択されたファイルをインポートします。</span><span class="sxs-lookup"><span data-stu-id="011ba-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="011ba-224">[![ER モデル マッピングの実行](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="011ba-225">モデル マッピングはバッチ モードで無人で実行できます。</span><span class="sxs-lookup"><span data-stu-id="011ba-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="011ba-226">この場合、バッチがこの ER 形式を実行するたびに、単一のファイルがコンフィギュレーションされたファイル ソースからインポートされます。</span><span class="sxs-lookup"><span data-stu-id="011ba-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="011ba-227">ファイルが SharePoint フォルダーから正常にインポートされると、そのフォルダーから削除され、正常にインポートされたファイルのフォルダー、または警告付きでインポートされたファイルのフォルダーに移動されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="011ba-228">それ以外の場合は、失敗したファイルのフォルダーに移動されるか、失敗したファイルのフォルダーが設定されていない場合にはこのフォルダー内に保持されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="011ba-229">**V-00001** などの伝票 ID を入力し、**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="011ba-230">[![ER モデル マッピングの実行](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="011ba-231">**ソースのファイルの状態**ページで、**更新**を選択してページを更新します。</span><span class="sxs-lookup"><span data-stu-id="011ba-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="011ba-232">[![選択したソースの ER ファイル状態のページ](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="011ba-233">**ファイル**セクションで、ファイルの一覧を確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="011ba-234">**インポート フォーマットのソース ログ**セクションでは、Excel ファイルのインポートの履歴を提供します。</span><span class="sxs-lookup"><span data-stu-id="011ba-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="011ba-235">このファイルが正常にインポートされなかったため、SharePoint フォルダーで**削除**としてマークされます。</span><span class="sxs-lookup"><span data-stu-id="011ba-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="011ba-236">**ファイルのインポート ソース (メイン)** SharePoint フォルダーを確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="011ba-237">正常にインポートされた Excel ファイルは、このフォルダーから削除されました。</span><span class="sxs-lookup"><span data-stu-id="011ba-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="011ba-238">**買掛金勘定** \> **定期処理のタスク** \> **税金 1099** \> **1099s の仕入先決済**の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="011ba-239">**開始日**および**終了日**フィールドに、適切な値を入力します。</span><span class="sxs-lookup"><span data-stu-id="011ba-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="011ba-240">**手動 1099 トランザクション**を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="011ba-241">伝票 **V-00001** として SharePoint 上の Excel ファイルからインポートされた仕入先トランザクションが、ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="011ba-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="011ba-242">[![1099 仕入先トランザクション ページ](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="011ba-243">インポート用 Excel ファイルの準備</span><span class="sxs-lookup"><span data-stu-id="011ba-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="011ba-244">以前に使用した Excel ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="011ba-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="011ba-245">行 3 列 1で、アプリケーションに存在しない仕入先コードを追加します。</span><span class="sxs-lookup"><span data-stu-id="011ba-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="011ba-246">行に追加の false 仕入先情報を追加します。</span><span class="sxs-lookup"><span data-stu-id="011ba-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="011ba-247">[![SharePoint からインポートするためのサンプル Microsoft Excel ファイル](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="011ba-248">仕入先トランザクションを含む更新済 Excel ファイルを**ファイルのインポート ソース (メイン)** SharePoint フォルダーにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="011ba-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="011ba-249">ER コンフィギュレーション ツリーを開き、**1099 支払モデル**を選択し、ER モデル コンポーネントの一覧を展開します。</span><span class="sxs-lookup"><span data-stu-id="011ba-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="011ba-250">データのインポート処理中に不適切な仕入先コードがエラーと見なされるよう、モデル マッピングを更新するモデル マッピングの名前を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="011ba-251">**デザイナー** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="011ba-251">Select **Designer**.</span></span>
6. <span data-ttu-id="011ba-252">**検証**タブで、アプリケーションでインポートされた仕入先勘定が存在するかどうかを評価するようコンフィギュレーションされた、検証ルールの検証後のアクションを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="011ba-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="011ba-253">**後検証アクション**フィールドの値を**実行停止**に更新し、変更内容を保存し、ページを閉じます。</span><span class="sxs-lookup"><span data-stu-id="011ba-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="011ba-254">[![ER モデル マッピング デザイナーのページ](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="011ba-255">変更内容を保存し、ER モデル マッピング デザイナーを閉じます。</span><span class="sxs-lookup"><span data-stu-id="011ba-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="011ba-256">**実行**を選択し、変更した ER モデル マッピングを実行します。</span><span class="sxs-lookup"><span data-stu-id="011ba-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="011ba-257">**V-00002** などの伝票 ID を入力し、**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="011ba-258">情報ログには、正しくない仕入先勘定が含まれたファイルが SharePoint フォルダーにあり、インポートできないという通知が含まれることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="011ba-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="011ba-259">[![ER モデル マッピングの実行](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="011ba-260">**ソースのファイルの状態**ページで**更新**を選択し、次に**ファイル**セクションでファイルの一覧を確認します。</span><span class="sxs-lookup"><span data-stu-id="011ba-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="011ba-261">[![選択したソースの ER ファイル状態のページ](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="011ba-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="011ba-262">**インポート形式のソース ログ**セクションでは、インポート プロセスが失敗したこと、およびファイルがまだ SharePoint フォルダーの中にあることを示します (**削除済**チェック ボックスが選択されていません)。</span><span class="sxs-lookup"><span data-stu-id="011ba-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="011ba-263">適切な仕入先コードを追加して SharePoint 上でこのファイルを修正してから、ファイルのインポート ソース (メイン) の SharePoint フォルダーに移動すると、ファイルを再度インポートできます。</span><span class="sxs-lookup"><span data-stu-id="011ba-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="011ba-264">**買掛金勘定** \> **定期処理のタスク** \> **税金 1099** \> **1099 の仕入先決済**の順に選択し、**開始日**および**終了日**フィールドで適切な値を入力し、**手動 1099 トランザクション**を選択します。</span><span class="sxs-lookup"><span data-stu-id="011ba-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="011ba-265">伝票 V-00001 のトランザクションのみが使用可能です。</span><span class="sxs-lookup"><span data-stu-id="011ba-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="011ba-266">Excel ファイルで最後にインポートされたトランザクションのエラーが見つかった場合でも、伝票 V-00002 のトランザクションは存在しません。</span><span class="sxs-lookup"><span data-stu-id="011ba-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
