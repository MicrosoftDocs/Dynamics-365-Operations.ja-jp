---
title: 画像が埋め込まれた Office 形式でのレポートの生成
description: このトピックでは、電子申告 (ER) コンフィギュレーションを設計して、Excel と Word で埋め込み画像を含む電子ドキュメントを生成する方法を示します。
author: NickSelin
ms.date: 06/13/2017
ms.topic: business-process
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 6ec9f3013c1e365a3ca1a4c6cabe71a22e3e8b730eac38155ef023fe68107524
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "6735529"
---
# <a name="generate-reports-in-office-format-that-have-embedded-images"></a>画像が埋め込まれた Office 形式でのレポートの生成

[!include [banner](../../includes/banner.md)]

次のステップでは、「システム管理者」または「電子申告開発者」ロールが付与されたユーザーが、電子申告（ER）の構成を設計し、埋め込み画像を含む MS Office 形式（Excel および Word）で電子ドキュメントを生成する方法を説明します。

この例では、サンプル会社 「Litware, Inc.」 用に作成した ER の構成を使用します。  これらのステップを完了するには、まず、「ER 画像を埋め込んだ MS Office 形式のレポートを作成する（パート 2: 構成を確認する）」タスク ガイドに記載された手順を完了する必要があります。 これらのステップは会社 「USMF」 で実行可能です。


## <a name="run-format-with-initial-model-mapping"></a>初期モデル マッピングを使用して形式を実行する
1. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
2. クイック フィルターを使用して、値が「USMF OPER」である [銀行口座] フィールドをフィルター処理します。
3. アクション ペインで、[設定] をクリックします。
4. [小切手] をクリックします。
5. [印刷テスト] をクリックします。
    * テスト目的で形式を実行します。  
6. [譲渡性小切手フォーマット] フィールドで、[はい] を選択します。
7. [OK] をクリックします。
    * 作成した出荷を確認します。 会社のロゴは権限者の署名やレポートにも表示されます。 署名画像は、選択した銀行口座に関連付けられた小切手のレイアウト レコードのデータ型 「コンテナー」 のフィールドから取得されます。  
8. [コピー] セクションを展開します。
9. [編集] をクリックします。
10. [透かし] フィールドで、[無効として透かしを印刷] を入力します。
    * 透かしレイアウトの設定を変更して、Excel 図形要素の生成ドキュメントに透かしのテキストを表示します。  
11. [印刷テスト] をクリックします。
12. [OK] をクリックします。
    * 作成した出荷を確認します。 選択オプションに従って、作成済みのレポートに透かしが表示されます。  
13. ページを閉じます。
14. [アクション] ウィンドウで [支払の管理] をクリックします。
15. [小切手] をクリックします。
16. [フィルターの表示] をクリックします。
17. 次のフィルターを適用します。"次の値のいずれか" フィルター演算子を使用して、[小切手番号] フィールドで "381","385","389" のフィルター値を入力。
18. リストで、すべての行をマークします。
19. [小切手のコピーの印刷] をクリックします。
    * 形式を実行して、選択した小切手を再印刷します。  
    * 作成した出荷を確認します。 選択した小切手が再印刷されました。 会社のロゴとラベルは、事前に印刷されたフォームに表示されているので印刷されません。  

## <a name="modify-the-mapping-of-the-imported-data-model"></a>インポート済データ モデルのマッピングを変更する
1. ページを閉じます。
2. ページを閉じます。
3. [組織管理] > [電子申告] > [コンフィギュレーション] に移動します。
4. ツリーで、「小切手のモデル」を選択します。
5. [デザイナー] をクリックします。
6. [モデルからデータ ソースへのマップ] をクリックします。
7. [デザイナー] をクリックします。
    * 選択した銀行口座に関連付けられている小切手のレイアウト レコードに添付されたファイルから署名の画像を取得するよう、データ モデルの署名項目のバインディングを変更します。  
8. [詳細の表示] をオフにします。
9. ツリーで、「レイアウト」を展開します。
10. ツリーで、「レイアウト\署名」を展開します。
11. ツリーで、「レイアウト\署名\image = chequesaccount.'<Relations'.BankChequeLayout.Signature1Bmp」を選択します。
12. ツリーで、「chequesaccount」を展開します。
13. ツリーで、「chequesaccount\<Relations」を展開します。
14. ツリーで、「chequesaccount\<Relations\BankChequeLayout」を展開します。
15. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations」を展開します。
16. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations\<Documents」を展開します。
17. ツリーで、「chequesaccount\<Relations\BankChequeLayout\<Relations\<Documents\getFileContentAsContainer()」を選択します。
18. [バインド] をクリックします。
19. [保存] をクリックします。
20. ページを閉じます。
21. ページを閉じます。
22. ページを閉じます。
23. ページを閉じます。

## <a name="run-format-using-the-adjusted-model-mapping"></a>調整済モデル マッピングを使用して形式を実行する
1. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
2. クイック フィルターを使用して、レコードを見つけます。 たとえば、「USMF OPER」という値を含む [銀行口座] フィールドをフィルターします。
3. アクション ペインで、[設定] をクリックします。
4. [小切手] をクリックします。
5. [印刷テスト] をクリックします。
6. [OK] をクリックします。
    * 作成した出荷を確認します。 ドキュメント管理添付ファイルの画像は、権限者の署名として表示されます。  

## <a name="use-ms-word-document-as-a-template-in-the-imported-format"></a>インポートされた形式で MS Word ドキュメントをテンプレートとして使用する
1. ページを閉じます。
2. ページを閉じます。
3. [組織管理] > [電子申告] > [コンフィギュレーション] に移動します。
4. ツリーで、「小切手のモデル」を展開します。
5. ツリーで、「小切手のモデル\小切手の印刷形式」を選択します。
6. [デザイナー] をクリックします。
7. [添付ファイル] クリックします。
8. [削除] をクリックします。
9. [はい] をクリックします。
10. [新規] をクリックします。
11. [ファイル] をクリックします。
    * [参照] をクリックし、事前にダウンロードした 「小切手のテンプレート Word.docx」 ファイルを選択します。  
12. ページを閉じます。
13. [テンプレート] フィールドで、値を入力または選択します。
14. [保存] をクリックします。
15. ページを閉じます。
16. [編集] をクリックします。
17. [ドラフトの実行] フィールドで、[はい] を選択します。
18. ページを閉じます。
19. [現金および銀行管理] > [銀行口座] > [銀行口座] の順に移動します。
20. クイック フィルターを使用して、値が「USMF OPER」である [銀行口座] フィールドをフィルター処理します。
21. [小切手] をクリックします。
22. [印刷テスト] をクリックします。
23. [OK] をクリックします。
    * 作成した出荷を確認します。 出力は、会社のロゴ、権限者の署名、選択した透かしのテキストを表示する埋め込み画像付きの Word ドキュメントとして生成されています。  



[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]