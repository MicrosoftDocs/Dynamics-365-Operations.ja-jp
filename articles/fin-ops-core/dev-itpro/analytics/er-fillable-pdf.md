---
title: PDF テンプレートに入力する ER コンフィギュレーションのデザイン
description: このトピックでは、PDF テンプレートに入力する電子レポート (ER) 形式をデザインする方法について説明します。
author: NickSelin
manager: AnnBe
ms.date: 04/19/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.1
ms.openlocfilehash: de31469e79addfb82b3b57e647ff82e4d254881a
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2020
ms.locfileid: "4688128"
---
# <a name="design-er-configurations-to-fill-in-pdf-templates"></a>PDF テンプレートに入力する ER コンフィギュレーションのデザイン

[!include[banner](../includes/banner.md)]

このトピックの手順は、**システム管理者** ロールまたは **電子レポート開発者** ロールのユーザーが、レポート テンプレートとしての PDF ドキュメントを使いレポートを PDF として生成する電子レポート (ER) 形式をどのようにコンフィギュレーションできるかを示す例です。 これらの手順は、Dynamics 365 Finance または Regulatory Configuration Services (RCS) のどの会社でも実行できます。

## <a name="prerequisites"></a>必要条件

開始する前に、このトピックの手順を実行するために使用するサービスに応じて、次のいずれかのタイプのアクセス権を持っている必要があります。

- 次のいずれかのロールに対応する財務にアクセスします。

    - 電子申告開発者
    - 電子申告機能コンサルタント
    - システム管理者

- 次のいずれかのロールに対応する RCS にアクセスします。

    - 電子申告開発者
    - 電子申告機能コンサルタント
    - システム管理者

また、[コンフィギュレーション プロバイダーを作成しアクティブとマーク](tasks/er-configuration-provider-mark-it-active-2016-11.md) の手順を完成する必要があります。

最後に、[CustomerSource](https://go.microsoft.com/fwlink/?linkid=874111) から次のファイルをダウンロードする必要があります。

| コンテンツの説明                       | ファイル名                                     |
|-------------------------------------------|-----------------------------------------------|
| レポートの最初のページをテンプレート | [IntrastatReportTemplate1.pdf](https://mbs.microsoft.com/Files/public/CS)                  |
| レポートの他のページをテンプレート    | [IntrastatReportTemplate2.pdf](https://mbs.microsoft.com/Files/public/CS/AX/IntrastatReportTemplate2.pdf)                  |
| ER フォーマットのサンプル - PDF                          | [イントラスタット レポート (PDF). バージョン .1.1.xml](https://mbs.microsoft.com/Files/public/CS/AX/IntrastatreportPDFversion11.xml)        |
| ER フォーマットのサンプル - Excel                          | [イントラスタット (Excel からインポート). バージョン .1.1.xml](https://mbs.microsoft.com/Files/public/CS/AX/IntrastatimportfromExcelversion11.xml) |
| サンプル データセット                            | [イントラスタット サンプル データ .xlsx](https://mbs.microsoft.com/Files/public/CS/AX/Intrastatsampledata.xlsx)                    |

## <a name="design-the-format-configuration"></a>形式のコンフィギュレーションをデザイン

### <a name="get-access-to-the-list-of-configurations-provided-by-microsoft"></a>Microsoft 提供の設定リストにアクセスする

1. **組織管理  \> ワークスペース \> 電子申告** の順に移動します。
2. **Litware, Inc.** 事業者が使用可能で、有効としてマークされていることを確認します。
3. **Microsoft** プロバイダーのタイルで、**リポジトリ** を選択します。

    > [!NOTE]
    > **LCS** タイプのレポジトリが既に存在する場合、この手順の残りのステップを省略します。

4. **追加** を選択します。
5. ドロップダウン ダイアログ ボックスの **コンフィギュレーション レポジトリ タイプ** フィールド グループで、**LCS** オプションを選択します。
6. **レポジトリを作成** を選択します。
7. **OK** を選択します。

### <a name="get-the-model-configurations-provided-by-microsoft"></a>Microsoft 提供のモデル コンフィギュレーションを取得

1. **コンフィギュレーション リポジトリ** ページの左側で、**フィルターを表示** ボタン (じょうごシンボル) を選択します。
2. **タイプ** フィールドにある **LCS** の値フィルターを追加し、**で始まる** オペレーターを使用します。
3. **適用** を選択します。
4. **開く** を選択します。
5. ツリーで、**イントラスタット モデル** を選択します。
6. **バージョン** FastTab で、バージョン **1** を選択します。

    > [!NOTE]
    > **バージョン** FastTab で **インポート** ボタンが使用できない場合、この手順の残りのステップを省略します。

7. **インポート** を選択します。
8. **はい** を選択し、**イントラスタット モデル** モデル コンフィギュレーションの選択されたバージョンのインポートを確認します。

### <a name="create-a-new-format-configuration"></a>新しいコンフィギュレーションの書式設定の作成

1. **電子レポート** ワークスペースで、**レポート コンフィギュレーション** タイルを選択します。
2. ツリーで、**イントラスタット モデル** を選択します。
3. **コンフィギュレーションの作成** を選択します。

    > [!NOTE]
    > **コンフィギュレーションの作成** ボタンが使用できない場合、**電子レポート** ワークスペースから開くことができる **電子レポート パラメーター** ページのデザイン モードを有効にする必要があります。

4. ドロップダウン ダイアログ ボックスにある **新しい** フィールド グループで、**データ モデル イントラスタットに基づくフォーマット** オプションを選択します。
5. **名前** フィールドで、**イントラスタット レポート (PDF)** を入力します。
6. **説明** フィールドで、**PDF フォーマットのイントラスタット レポート** を入力します。

    > [!NOTE]
    > 有効なコンフィギュレーション プロバイダーは自動的に入力されます。 このプロバイダーはこのコンフィギュレーションを管理できます。 たとえ他のプロバイダーがこのコンフィギュレーションを使用できても、管理することはできません。

7. オプション: **フォーマット タイプ** フィールドで、電子ドキュメントの特定形式を選択できます。 デザイン時に **PDF** を選択する場合、ER オペレーション デザイナーは形式に生成されたドキュメントのみに適用される形式要素のみを提供します (**PDF\File**、**PDF\PDF 合併**、など)。 このフィールドを空白のままにすると、最初の形式要素が追加されるときに、ER オペレーション デザイナーのデザイン時に電子ドキュメントの形式が指定されます。 たとえば、**Excel\File** を最初の形式要素として追加した場合、ER オペレーション デザイナーは Excel 形式で生成されたドキュメントのみに適用される形式要素だけを提供します (**Excel\Cell**、**Excel\Range**、など)。 形式。
8. **コンフィギュレーションの作成** を選択します。

新しい ER 形式のコンフィギュレーションが作成されます。 このコンフィギュレーションの下書きバージョンを使用して、PDF 形式の電子ドキュメントを生成するように設計された ER 形式のコンポーネントを保存できます。

### <a name="design-the-format-of-an-electronic-document"></a>電子ドキュメントの形式のデザイン

次に、作成した ER 形式のコンフィギュレーションで、PDF 形式の **イントラスタット コントロール** レポートを生成する ER 形式をデザインします。 このレポートの最初のページには、レポートの概要および報告された対外貿易トランザクションの詳細を表示する必要があります。 他のページでは、報告された対外貿易トランザクションの詳細のみを表示する必要があります。 生成されるレポート ページのレイアウトが異なるため、PDF 形式の 2 つの異なるテンプレートが ER 形式で使用されます。

どの PDF ビューアーでも、ダウンロードした PDF テンプレートを開きます。 各テンプレートには、入力の必要がある複数のフィールドが含まれていることに注意してください。 各テンプレートでは、対外貿易トランザクションの詳細が 42 行として表示され、それぞれに 9 つのフィールドがあります。 行番号は各フィールドの名前の末尾に表示されます (例えば、**日付 1**… **日付 42** および **商品 1**… **商品 42**)。

次の図は、レポートの最初のページの PDF テンプレートを示しています。

![テンプレート 1](media/rcs-ger-filloutpdf-template1.png)

次の図は、レポートの他のページの PDF テンプレートを示しています。

![テンプレート 2](media/rcs-ger-filloutpdf-template2.png)

1. **構成** ページで、**デザイナー** を選択します。
2. **ルートの追加** を選択します。
3. ドロップダウン ダイアログ ボックスのツリーで、**PDF \> PDF 合併** を選択します。

    形式のルート要素として **PDF 合併** 要素を選択するとき、実行時に生成されるすべての PDF ドキュメントが単一の最終 PDF ドキュメントにマージされます。 デザインした ER 形式を使用してすべての必要なドキュメントを生成する PDF テンプレートが 1 つだけの場合、**PDF ファイル** をルート要素として選択できます。

4. **名前** フィールドに、**アウトプット** と入力します。
5. **言語の基本設定** フィールドで、**ユーザーの基本設定** を選択します。 レポートは、実行したユーザーの優先言語で生成されます。
6. **カルチャの基本設定** フィールドで、**ユーザーの基本設定** を選択します。 レポートのページに表示される値と日付は、レポートを実行するユーザーの優先ロケールに基づいて書式設定されます。
7. **OK** を選択します。
8. アクション ウィンドウの **インポート** タブで、**PDF からインポート** を選択します。

    入力可能な PDF ドキュメントが、この ER 形式のテンプレートとしてインポートされるとき、すべての必要な ER 形式の要素 (**PDF ファイル**、**フィールド グループ** および **フィールド** 要素) が、インポートされる PDF ドキュメントの構造に基づいて、自動的にデザインされた形式に作成されます。

9. **参照** を選択します。 前提条件として事前にダウンロードした **IntrastatReportTemplate1.pdf** ファイルに移動して選択します。
10. **OK** を選択します。

    選択したファイルが読み込まれ、**PDF からインポート** ダイアログ ボックスの **テンプレート** フィールドが入力されます。

11. **グループ フィールド** オプションを **はい** に設定します。 選択した PDF ドキュメントが任意のフィールドグループを含む場合は、作成された ER 形式の要素をグループ化するために使用されます。 この目的のために、**フィールド グループ** 形式の要素が作成されます。

    このオプションを **いいえ** に設定する場合、必要な ER 形式の要素が、作成される **PDF ファイル** 形式の要素の下に入れ子になった要素の単純なリストとして作成されます。

12. **OK** を選択します。

    ![PDF ダイアログ ボックスからインポート](media/rcs-ger-filloutpdf-importtemplate.png)

13. ツリーで、**アウトプット** を展開します。

    実行時に生成されるレポートの最初のページの作成を管理するために、**PDF ファイル** コンポーネントは自動的に作成されていることに注意してください。

14. ツリーで **アウトプット \> PDF ファイル** を展開します。

    書式設定要素の構造化された一覧が、先にインポートした入力可能な PDF ドキュメントの構造に基づいて、この ER 形式で自動的に作成されていることを確認してください。

15. ツリーで、**アウトプット \> PDF ファイル** を選択します。
16. **名前** フィールドに、**ページ 1** と入力します。

    この形式要素は、**イントラスタット制御** レポートの最初のページを生成するために使用されます。 このページには、レポートの概要および対外貿易トランザクションの詳細が表示されます。

    **言語の詳細設定** フィールドを空白のままにする場合、親の **PDF 合併** 要素の **言語の詳細設定** 設定は、この形式要素を使用して生成されるレポートの言語を決定します。 別の値を選択して、親要素の設定を上書きすることができます。

    **カルチャの詳細設定** フィールドを空白のままにする場合、親の **PDF 合併** 要素の **カルチャの詳細設定** 設定は、この形式要素を使用して生成されるレポートのロケールを決定します。 ロケールによって、レポートのページで値と日付の形式が決まります。 別の値を選択して、親要素の設定を上書きすることができます。

17. アクションウィンドウで、**インポート** タブを選択します。**PDF から更新** ボタンは、選択した形式要素の **PDF ファイル** に使用可能になります。

    このボタンを使用して、更新された PDF テンプレートを編集した形式にインポートできます。 更新された PDF テンプレートをインポートすると、それに応じて形式要素の一覧が変更されます。

    - 更新された PDF テンプレートの新しいフィールドについては、編集された ER 形式で新しい形式の要素が作成されます。
    - 更新された PDF テンプレートに、編集された ER 形式の既存の形式要素に対応するフィールドが含まれなくなった場合、それらの書式要素が ER 形式から削除されます。

18. **形式** タブで、**添付ファイル** を選択します。

    読み込んだ PDF ドキュメントが編集した ER 形式で関連付けられていることを確認します。

    ![PDF ファイルのプレビュー](media/rcs-ger-filloutpdf-attachedtemplate.png)

19. この形式を引き続きデザインするには、2 番目の PDF テンプレートをインポートし、必要なバインドをデータ ソースに追加します。
20. **保存** を選択します。
21. ページを閉じます。
22. **削除** を選択します。
23. **はい** を選択します。

新しい **PDF 合併**、**PDF ファイル**、**フィールド グループ** および **フィールド** 形式の要素を使用して PDF 形式のドキュメントを生成する方法については、サンプル ER 形式をインポートおよび分析します。

### <a name="import-the-format-configuration"></a>書式設定のコンフィギュレーションのインポート

次に、以前にダウンロードしたサンプル ER 形式をインポートし、PDF 形式の **イントラスタット コントロール** レポートを生成します。 レポートの最初のページには、レポートの概要および報告された対外貿易トランザクションの詳細を表示する必要があります。 他のページでは、報告された対外貿易トランザクションの詳細のみを表示する必要があります。

1. **コンフィギュレーション** ページで、**交換 \> XML ファイルからロード** を選択します。
2. **参照** を選択します。 前提条件として事前にダウンロードした **インストタット レポート (PDF). バージョン .1.1.xml** ファイルに移動して選択します。
3. **OK** を選択します。

## <a name="analyze-the-format-configuration"></a>書式設定のコンフィギュレーションの分析

### <a name="format-layout"></a>形式レイアウト

1. **コンフィギュレーション** ページのツリーで、**イントラスタット モデル \> イントラスタット レポート (PDF)** を選択します。
2. **デザイナー** をクリックします。
3. **詳細を表示** を選択します。
4. ツリーで、**アウトプット: PDF 合併** を展開します。

    この ER 形式には、それぞれ異なる PDF 形式を使用する 2 つの **PDF ファイル** の要素が含まれていることに注意してください。 1 つのテンプレートを使用してレポートの最初のページを PDF 形式で生成し、もう 1 つのテンプレートを使用して他のページを生成します。

5. ツリーで、**出力: PDF 合併 \> ページ 1: PDF ファイル (IntrastatReportTemplate1)** を展開します。
6. ツリーで、**出力: PDF 合併 \> ページ N: PDF ファイル (IntrastatReportTemplate2)** を展開します。

    2 つの PDF テンプレートの内容が異なるため、2 つの **PDF ファイル** 要素の入れ子になった形式要素の構造も異なります。

### <a name="format-mapping"></a>形式マッピング

1. **フォーマット デザイナー** ページで、**マッピング** タブを選択します。
2. ツリーで、**ページング \> ページ** を展開します。

    ![モデル ツリーが展開される数式デザイナーのページ](media/rcs-ger-filloutpdf-reviewformat.png)

    次の詳細に留意してください。

    - **PDF ファイル** タイプの **アウトプット \> ページ 1** の形式要素は、どのデータ ソースにもバインドされず、この形式要素の **有効** 式は空になります。 したがって、実行時に **IntrastatReportTemplate1** の PDF テンプレートは、個々の PDF ドキュメントが生成されたときに 1 回だけ入力されます。
    - **PDF ファイル** タイプの **アウトプット \> ページ N** の形式要素は、**レコード リスト** タイプの **ページング. ページ N** データ ソースにバインドされ、この形式要素の **有効** 式は空です。 したがって、実行時に **IntrastatReportTemplate2** の PDF テンプレートは、個々の PDF ドキュメントが生成されたときにバインド レコードから各レコードを入力します。
    - **ページ1: PDF ファイル** と **ページ N: PDF ファイル** 形式の要素が **出力: PDF 合併** 形式の要素の子であるため、入力されたすべての PDF ドキュメントは 1 つの最終 PDF ドキュメントに統合されます。
    - **ページング. ページ 1** と **ページング. ページ N** のデータ ソースは、**ページング. ページ** のデータ ソースからレコードのフィルタとして構成されます。 このデータ ソースは、外部取引トランザクションのセット全体をバッチに分割するようにコンフィギュレーションされています。 バッチごとに、最大 42 レコードが含まれています。 トランザクションをバッチに分割するには、次の ER 式を使用します。

        SPLITLIST(Totals.CommodityRecord,42)

    - **ページング. ページ** のデータソースには、バッチに含まれている各レコードの詳細を返す **ページング. ページ. 列挙型** 要素が含まれています。 この詳細には、現在のバッチにおけるレコード シーケンスが含まれています (**ページング. ページ. 列挙型. 番号** フィールド)。 **ページング. ページ. 列挙型. 番号** フィールドは、**PDF フィールド** の形式要素にある **名前** 式で使用され、バッチのトランザクション番号に基づいて動的にフィールド名を生成します。 生成されたフィールド名は、使用される PDF テンプレートに正しい PDF フィールドを入力するために使用されます。
    - **PDF グループ** タイプの **アウトプット \> ページ N \> 詳細 2** の形式要素は、**レコード リスト** タイプの **ページング. ページ N. 列挙型** データ ソース (または **\@. 列挙型** であり **相対パス** ビュー モードが使用されている場合) にバインドされます。 したがって、実行時に PDF グループの入れ子になった要素が、バインドされたレコード リストのレコードごとに入力されます。 このようにして、個々の PDF ラインは、**ページング. ページ N. 列挙型** リストの各 N 番目の 42 のレコードに対して以下のフィールドが入力されている場合、実質的には生成されます: 日付 N、方向 N、商品 N など。したがって、この点において **フィールド グループ** 形式要素の動作は **XML \> シーケンス** および **テキスト \> シーケンス** の形式要素の動作に似ています。

3. ツリーで、**アウトプット \> ページ N \> 詳細 2** を展開します。
4. ツリーで、**アウトプット \> ページ N \> 詳細 2 \> PageFooter** を選択します。

    この形式要素の **名前** 属性は、**PageFooter** として定義されていることに注意してください。 また、書式要素の **名前** の式が空であることに注意してください。

5. ツリーで、**アウトプット \> ページ N \> 詳細 2 \> 訂正 1** を選択します。

    この形式要素の **名前** 属性は、**訂正 1** として定義されていることに注意してください。 また、書式要素の **名前** 式は、**ページング .FldName(「訂正」、\@. 番号)** で定義されていることに注意してください。

![マッピングが選択されている形式デザイナー](media/rcs-ger-filloutpdf-reviewformat2.png)

**フィールド** の形式要素は、親の **PDF ファイル** 形式要素のテンプレートとして定義される入力可能な PDF ドキュメントの個々のフィールドに入力するために使用されます。 **PDF ファイル** 形式要素またはネストした要素のバインディングは、ネストした要素がある場合、対応する PDF フィールドに入力された値が指定されます。 個々の形式要素によって入力される PDF フィールドを指定するには、**フィールド** 形式要素のさまざまなプロパティを使用できます。

- **形式** タブでの形式要素の **名前** 属性
- **マッピング** タブでの形式要素の **名前** 式

**フィールド** 形式要素に対して両方のプロパティが省略可能であるため、次の規則を適用して目的の PDF フィールドを指定します。

- **名前** 属性が空白の場合、**名前** 式が実行時に空の文字列を返すと、実行時に例外がスローされ、PDF ドキュメントに入力するために使用されている PDF テンプレートで PDF フィールドが見つからないことをユーザーに通知します。
- **名前** 属性が定義され、**名前** 式が空白の場合、形式要素の **名前** 属性と同じ名前の PDF フィールドが入力されます。
- **名前** 属性が定義され、**名前** 式がコンフィギュレーションされている場合、形式要素の **名前** 式によって返される値と同じ名前の PDF フィールドが入力されます。

> [!NOTE]
> PDF チェック ボックスは、次の方法で選択したとおりに入力できます。
>
> - 対応する **フィールド** 形式要素が、**True** 値を持つ **ブール値** データ タイプのデータ ソース フィールドに連結されている場合
> - 対応する **フィールド** 形式要素に、**1**、**True**、または **はい** のテキスト値を持つデータ ソース フィールドに連結され入れ子になった **文字列** 形式要素が含まれる場合

## <a name="run-the-format-configuration"></a>形式のコンフィギュレーションを実行

### <a name="import-the-format-configuration"></a>書式設定のコンフィギュレーションのインポート

次に、**イントラスタット (Excel からインポート)** サンプル ER 形式を読み込みます。 この形式は、ユーザーが選択した Microsoft Excel ブックを解析するために作成され、対外貿易トランザクションをシミュレートします。

1. **コンフィギュレーション** ページで、**交換 \> XML ファイルからロード** を選択します。
2. **参照** を選択します。 前提条件として事前にダウンロードした **イントラスタット (Excel からインポート). バージョン .1.1.xml** ファイルに移動して選択します。
3. **OK** を選択します。
4. ツリーで、**イントラスタット モデル \> イントラスタット (Excel からインポート)** を選択します。
5. **編集** を選択します。
6. **モデル マッピングの既定値** オプションを **はい** に設定します。

    > [!NOTE]
    > 事前に、**イントラスタット モデル** コンフィギュレーションに対して **モデル マッピングの規定値** オプションを **はい** に設定した場合、または **イントラスタット モデル** コンフィギュレーションの下に入れ子になった別のコンフィギュレーションの場合、オプションを **いいえ** に設定します。

    **モデル マッピングの規定値** が **はい** に設定されている場合、インポートされた **イントラスタット (Excel からインポート)** ER 形式は、**イントラスタット レポート (PDF)** 形式コンフィギュレーションの規定値のデータ ソースとして割り当てられます。 その後、**イントラスタット レポート (PDF)** 形式のコンフィギュレーションが実行されると、**イントラスタット (Excel からインポート)** ER 形式によって解析された Excel ブックの内容により、外部取引トランザクションがシミュレーションされます。 次の図は、Excel ブックの例を示します。

    ![サンプル データが含まれる Excel ブック](media/rcs-ger-filloutpdf-excelworkbook.png)

### <a name="run-the-format-configuration"></a>形式のコンフィギュレーションを実行

1. **コンフィギュレーション** ページのツリーで、**イントラスタット モデル \> イントラスタット レポート (PDF)** を選択します。
2. **実行** を選択します。
3. **参照** を選択します。 前提条件として事前にダウンロードした **イントラスタット サンプル データ .xlsx** ファイルに移動して選択します。
4. **OK** を選択します。
5. **レポートの方向** フィールドで、**両方** を選択して、インポートした Excel ブックのすべてのトランザクションを、生成される PDF レポートに入力します。
6. **OK** を選択します。
7. 生成された PDF ドキュメントを確認します。

次の図で、生成されるレポートの最初のページの例を示します。

![生成されたレポートの最初のページ](media/rcs-ger-filloutpdf-generatedreport.png)

次の図で、生成されるレポートの別のページの例を示します。

![生成されたレポートの別のページ](media/rcs-ger-filloutpdf-generatedreport2.png)

## <a name="additional-resources"></a>追加リソース

- [OPENXML 形式でレポートを生成する ER コンフィギュレーションを設計する (2016 年 11 月)](tasks/er-design-reports-openxml-2016-11.md)
- [Word 形式でレポートを生成するための ER コンフィギュレーションのデザイン](tasks/er-design-configuration-word-2016-11.md)
