---
title: アクション依存の ER 送信先を構成する
description: この記事では、送信ドキュメントを生成するように構成された電子申告 (ER) 形式に対して、アクション依存の送信先を構成する方法について説明します。
author: kfend
ms.date: 12/05/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: 2020-12-01
ms.dyn365.ops.version: 10.0.17
ms.custom: 97423
ms.assetid: f3055a27-717a-4c94-a912-f269a1288be6
ms.search.form: ERSolutionTable, ERFormatDestinationTable
ms.openlocfilehash: 80a432a431891c02e4bf5c71cfe2bd9642c41c75
ms.sourcegitcommit: e9000d0716f7fa45175b03477c533a9df2bfe96d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/13/2022
ms.locfileid: "9843800"
---
# <a name="configure-action-dependent-er-destinations"></a>アクション依存の ER 送信先を構成する

[!include [banner](../includes/banner.md)]

送信ドキュメントの生成に使用する [電子申告 (ER)](general-electronic-reporting.md) 形式 の [構成](general-electronic-reporting.md#Configuration) の各出力コンポーネント (フォルダーまたはファイル) に対して、[送信先](electronic-reporting-destinations.md) を構成できます。 このタイプの ER 形式を実行し、適切なアクセス権を持つユーザーは、実行時に構成した送信先設定を変更することもできます。

Microsoft Dynamics 365 Finance **バージョン 10.0.17以降** では、その ER 形式を実行することによりユーザーが実行するアクション コードを [プロビジョニング](er-apis-app10-0-17.md) することで、ER 形式を実行できます。 たとえば、**売掛金勘定モジュール** では、印刷管理の設定で、自由書式の請求書などの特定のビジネス ドキュメントを生成する ER 形式を選択できます。 **表示** を選択して請求書をプレビューするか、**印刷** を選択してプリンタに送信できます。 実行時に実行中の ER 形式に対してユーザー アクションが渡される場合、ユーザー アクションごとに異なる ER 送信先を構成できます。 この記事では、このタイプの ER 形式に対して ER の送信先を構成する方法について説明します。

## <a name="make-action-dependent-er-destinations-available"></a>アクション依存の ER 送信先を使用可能にする

現在の Finance インスタンスでアクション依存の ER 送信先を構成し、[新しい](er-apis-app10-0-17.md) ER API を有効にするには、[機能管理](../../fin-ops/get-started/feature-management/feature-management-overview.md#the-feature-management-workspace) ワークスペースを開き、**異なる PM アクションに対して使用する特定の ER 送信先を構成する** 機能を有効にします。 実行時に 特定 のレポートに対して構成された ER 送信先を使用するには、**ユーザー アクション固有の ER 送信先に基づく PM レポートのルート出力 (ウェーブ 1)** 機能を有効にします。

## <a name="configure-action-dependent-er-destinations"></a>アクション依存の ER 送信先を構成する

**異なる PM アクションに対して使用する特定の ER 送信先を構成する** 機能を有効にすると、**電子申告の送信先** ページの **ファイルの送信先** クイックタブで、アクション依存の ER 送信先を構成できます。 各コンポーネントに対して、レコードを追加し、特定の ER 送信先を有効にできます。 各レコードに対して、ER 送信先を適用するドキュメント タイプを指定する必要があります。 **ドキュメント タイプ** フィールドで、次のいずれかの値を選択します:

- 実行時にユーザー アクション コードが指定されていない場合は、**電子** を選択して、構成した送信先を適用します。
- 実行時にユーザー アクション コードが指定されていない場合は、**印刷管理** を選択して、構成した送信先を適用します。
- **任意** を選択して、実行時にユーザー アクションが指定されているかどうかに関係なく、常に構成した送信先を適用します。

**印刷管理** ドキュメント タイプ を選択した場合は、構成した ER 送信先を適用するユーザー アクションを指定する必要があります。 **印刷管理アクション** フィールドで、次のいずれかの値を選択します:

- **表示** ユーザー アクションが実行時に指定されている場合は、**表示** を選択して、構成した送信先を適用します。
- **印刷** ユーザー アクションが実行時に指定されている場合は、**印刷** を選択して、構成した送信先を適用します。
- **送信** ユーザー アクションが実行時に指定されている場合は、**送信** を選択して、構成した送信先を適用します。

> [!NOTE]
> 1 つの送信先レコードに対して複数のアクションを選択できます。

**任意** のドキュメント タイプを選択した場合、**自動検出** が **印刷管理アクション** フィールドでユーザー アクションとして自動的に選択され、次の動作が発生します:

- 実行時にユーザー アクション コードが指定されていない場合は、構成済みのすべての ER 送信先が適用されます。
- 実行時にユーザー アクション コードが指定された場合、特定のアクションに対してあらかじめ定義されている ER 送信先が、**有効になっているかどうかに関係なく** 適用されます:

    - **表示** アクションを実行時に指定すると、**画面** ER 送信先が適用されます。
    - **送信** アクションを実行時に指定すると、**メール** ER 送信先が適用されます。
    - **印刷** アクションを実行時に指定すると、**プリンター** ER 送信先が適用されます。

たとえば、**自由書式の請求書 (Excel)** ER 形式を使用して、転記時に [自由書式の請求書](../../../finance/accounts-receivable/create-free-text-invoice-new.md) を印刷できます。 生成されたドキュメントを転送するには、この ER 形式用に ER 送信先を構成する必要があります。 たとえば、生成されたドキュメントで次の処理を実行するには、これらの ER 送信先を構成する必要があります:

- ER 形式が実行されているが、アクション コードが指定されていない場合 (例えば、ドキュメントが電子的に送信される場合など) は、ドキュメントをアーカイブします。
- ユーザーが **表示** アクションを実行すると、Web ブラウザーでドキュメントをプレビューします。
- ユーザーが **印刷** アクションを実行すると、ドキュメントをアーカイブして印刷します。
- ユーザーが **送信** アクションを実行すると、ドキュメントをアーカイブし、電子メールで送信電子メール メッセージの添付ファイルとして送信します。

次の図は、各レコードが個別のユーザー アクションに構成されている場合に、この ER 送信先を個別の送信先レコードのセットとして構成を行う方法を示しています:

![1 つのユーザー アクションに対してすべての送信先レコードが構成されている場合に、ER 形式のアクション依存の送信先設定を持つ電子申告の送信先ページ。](./media/er-destination-action-dependent-01.png)

次の図は、各レコードが個別の送信先に構成されている場合に、ER 送信先を個別の送信先レコードのセットとして代わりに同じ構成を行う方法を示しています:

![1 つの送信先に対してすべての送信先レコードが構成されている場合に、ER 形式のアクション依存の送信先設定を持つ電子申告の送信先ページ。](./media/er-destination-action-dependent-01a.png)

> [!NOTE]
> 実行している ER 形式のアクション コードが指定されている一方で、そのアクション コードに送信先が構成されていない場合は、[既定](electronic-reporting-destinations.md#default-behavior) の送信先の動作が適用されます。

## <a name="change-action-dependent-er-destinations-at-runtime"></a>アクション依存の ER 送信先を実行時に変更する

ER 形式を実行するときに、構成済の送信先設定を実行時に変更するための適切な [アクセス許可](electronic-reporting-destinations.md#security-considerations) を持つユーザが、ユーザー アクションをプロビジョニングした場合は、構成した送信先設定を変更するためのオプションを示すダイアログ ボックスが表示されます。 このダイアログ ボックスはオプションであり、その外観は、ER フレームワークが ER 形式を実行するために呼び出しがどのように実装されたかによって異なります。 このダイアログ ボックスが表示される場合、指定したユーザー アクションに従って、ボックス内の ER 送信先が有効になります。

次の図では、この記事で前述したように、**プリンター** アクションがプロビジョニングされ、ER 送信先がこの形式に対して構成されている場合に、自由書式の請求書が [転記](../../../finance/accounts-receivable/create-free-text-invoice-new.md) され、**自由書式の請求書 (Excel)** ER 形式が実行されて、このドキュメントが生成されるときに表示される **電子申告形式の送信先** ダイアログ ボックスの例を示しています。

![実行中の ER 形式に対して初期構成された ER 送信先を変更するオプションを表示するダイアログ ボックス。](./media/er-destination-action-dependent-02.gif)

> [!NOTE]
> 実行中の ER 形式の複数のコンポーネントに ER 送信先を構成した場合、ER 形式の構成済コンポーネントごとにオプションが個別に提供されます。

選択したドキュメントのレポート テンプレートに複数の ER 形式が適用できる場合は、すべての適用可能な ER レポート テンプレートのすべての ER 出力先がダイアログ ボックスに表示され、実行時に手動調整に使用できます。

選択したドキュメントに [SQL Server Reporting Services (SSRS)](SSRS-report.md) レポート テンプレートを適用できない場合、印刷管理先の標準の選択は動的に非表示になります。

財務バージョン **10.0.31** では、次の業務ドキュメントについて、実行時に、割り当てられている ER の行先を手動で変更できます。

- 顧客勘定明細書
- 利子計算書
- 督促状
- 顧客支払通知
- 仕入先支払通知

実行時に ER の出荷先を変更する機能を有効にするには、[機能管理](../../fin-ops/get-started/feature-management/feature-management-overview.md#the-feature-management-workspace) ワークスペースのランタイム機能で **出荷先の調整を許可** を有効にします。

> [!IMPORTANT]
> **顧客支払通知** レポートと **仕入先支払通知** レポートでは、**ForcePrintJobSettings** フライト化が有効になっている場合にのみ、ER の出荷先を手動で変更することができます。

[![実行時の ER 行先の調整](./media/ERdestinaiotnChangeUI.jpg)](./media/ERdestinaiotnChangeUI.jpg)

> [!NOTE]
> **印刷管理先の使用** オプションが **はい** に設定されている場合は、特定の ER レポートに対して構成されている既定の ER 出力先が使用されます。 ダイアログ ボックスで行われたすべての手動の変更は無視されます。 **印刷管理 先を使用** オプションを **いいえ** に設定すると、レポートを実行する直前にダイアログ ボックスで定義されている ER の出力先に対してドキュメントが処理されます。

次のビジネス ドキュメントは、実行時にアクションを明示的に選択した場合には使用されません。

- 顧客勘定明細書
- 利子計算書
- 督促状
- 顧客支払通知
- 仕入先支払通知

次のロジックを使用して、前のレポートの処理時に使用されるアクションを決定します。

- **ForcePrintJobSettings** フライト化が有効になっている場合:

    - **印刷管理先を使用** オプションが **はい** に設定されている場合は、**印刷** アクションが使用されます。
    - **印刷管理先を使用** オプションが **いいえ** に設定されている場合は、**表示** アクションが使用されます。

- **ForcePrintJobSettings** フライト化が有効になっていない場合:

    - **印刷管理先の使用** オプションが **はい** に設定されている場合、**印刷** アクションは **顧客支払通知** レポートや **仕入先支払通知** レポートに使用 されます。
    - **印刷管理出力先を使用** オプションが **いいえ** に設定されている場合は、構成されている ER の設定に関係なく、常に **顧客支払通知** レポートおよび **仕入先支払通知** レポートに既定の SSRS レポート テンプレートが使用されます。
    - **印刷** アクション は、常に **顧客勘定明細書**、**利子計算書**、および **催促状** の各レポートに使用されます。

前のロジックでは、アクションの **印刷** または **表示** を使用して、アクションに依存する ER レポートの出力先を構成できます。 実行時に、特定のアクションに対して構成されている ER 行先だけがダイアログ ボックスでフィルター処理されます。

## <a name="verify-the-provided-user-action"></a>指定されたユーザー アクションの検証

特定のユーザー アクションを実行するときに、実行中の ER 形式に提供されるユーザー アクション (該当する場合) を検証できます。 この検証は、アクション依存の ER 送信先を構成する必要があるが、どのユーザー アクション コードが提供されているかが不明な場合に重要です。 たとえば、自由形式の請求書の転記を開始し、**自由形式請求書の転記** ダイアログ ボックスで **請求書の印刷** オプションを **はい** に設定した場合、**印刷管理先の使用** オプションを **はい** または **いいえ** に設定できます。

次の手順に従って、指定されたユーザー アクション コードを検証します。

1. **組織管理** \> **電子申告** \> **構成** の順に移動します。
2. **構成** ページ、アクション ウィンドウ、**構成** タブ、**詳細設定** グループで、**ユーザー パラメーター** を選択します。
3. **ユーザー パラメーター** ダイアログ ボックスで、[デバッグ モードの実行](er-trace-reports-compare-baseline.md#configure-er-parameters-to-use-the-baseline-feature) オプションを **はい** に **設定** します。
4. ER 形式を実行してユーザー アクションを実行します。 ER ユーザー パラメーターは、会社固有およびユーザ固有であることに注意してください。
5. **組織管理** \> **電子申告** \> **構成デバッグ ログ** の順に移動します。
6. **構成デバッグ ログ** ページで、ER の実行ログをフィルター処理して、ER 形式の実行のログを検索します。
7. ER 形式の実行にアクションが指定されている場合は、指定されたユーザー アクション コードを示すレコードを含む必要があるログのエントリを確認します。

    ![ER 形式のフィルター処理された実行に対して指定されたユーザー アクション コードに関する情報を含む電子申告実行ログ ページ。](./media/er-destination-action-dependent-03.png)

## <a name="additional-resources"></a>追加リソース

[電子申告 (ER) の概要](general-electronic-reporting.md)

[電子申告 (ER) の送信先](electronic-reporting-destinations.md)

[Application update 10.0.17 での電子申告フレームワーク API の変更](er-apis-app10-0-17.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
