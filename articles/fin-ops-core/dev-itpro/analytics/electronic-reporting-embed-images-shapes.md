---
title: ER を使用して生成されるドキュメントへの画像や図形の埋め込み
description: このトピックでは、電子申告ツールを使用して、画像や図形が埋め込まれたビジネス ドキュメントを生成する方法について説明します。
author: kfend
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Developer
ms.reviewer: kfend
ms.custom: 27621
ms.assetid: ''
ms.search.region: Global
ms.author: mrolecki
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: July 2017 update
ms.openlocfilehash: 0f31ea4dda8f886e32e66ac4299bf7e70c300453
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/31/2021
ms.locfileid: "5751304"
---
# <a name="embed-images-and-shapes-in-documents-that-you-generate-by-using-er"></a>ER を使用して生成されるドキュメントへの画像や図形の埋め込み

[!include [banner](../includes/banner.md)]

電子申告 (ER) ツールを使用すると、必要な電子ドキュメントを生成するために実行することができるレポートを設計することができます。 Microsoft Excel また Microsoft Word ドキュメントを使用してレポートのレイアウトを指定することができます。 ER Operations デザイナーを使用すると、レポートのテンプレートとして Excel または Wordドキュメントを添付できます。 添付されたテンプレートの名前付き要素は、ER レポートの書式要素に関連付けられます。 レポートの要素の書式設定は、データ ソースにバインドされます。 これらの要素は、実行時に生成されるドキュメントに入力されるデータを指定します。

この新しい機能は、Microsoft Office 形式の文書を作成する点で既存の ER 機能を超えています。 詳細については、次のタスク ガイドを実行してください。 これらのタスク ガイドは 7.5.4.3 IT サービス/ソリューション コンポーネントの取得/開発 (10677) 業務プロセスの下で見つけることができます。

- ER は、OPENXML 形式でレポートを生成するコンフィギュレーションを設計する
- ER は、Microsoft WORD 形式でレポートを生成するコンフィギュレーションを設計

## <a name="embed-an-image-in-an-excel-document"></a>Excel ドキュメントに画像を埋め込む
最初に、Excel ドキュメントの画像に対するプレースホルダーを追加する必要があります。 Excel ブックを開き、後で追加する画像のプレース ホルダーとして、画像を追加します。 ER ツールを使用して、新しい ER フォーマット構成を追加して、設計中のレポートを組み込みます。 Excel ブックをレポートの形式のテンプレートとして添付し、ブックの内容を ER 形式にインポートします。 形式の定義が自動的に作成されます。 追加したイメージのプレースホルダーは、**セル** 要素として ER 形式の定義に含まれます。

> [!NOTE]
> 形式の定義をインポートせずに手動で指定できます。 変更を保存するとき、形式が検証されます。

次に、ER 形式の **セル** 要素を、実行時にバイナリ形式で画像のデータを提供する形式のデータ ソースからフィールドにバインドします。 ER データ モデルがフォーマットのデータ ソースとして使用されるとき、このフィールドのデータ型を **CONTAINER** にする必要があります。 現在、**コンテナー** データ型が存在する ER データ モデル フィールドは、バイナリ形式で画像を返すデータ ソースのいくつかの種類をバインドできます。 ドキュメント管理フレームワークを使用して、データ テーブル内のフィールド、およびデータ テーブルのレコードにアタッチされたファイルにアクセスすることができます。

> [!IMPORTANT]
> - Excel テンプレートを使用して作成するドキュメントのイメージ プレースホルダーを入力する場合、ER 形式に Excel テンプレートの名前付き写真要素を参照する **セル** 要素が含まれている必要があります。 それ以外の場合、レポートの出力にイメージのプレースホルダーが表示されません。 **CELL** 要素の拘束がデータを実行時に返さない場合、生成されたドキュメントでは、テンプレートからイメージのプレース ホルダーが表示されます。 作成するドキュメントのイメージを非表示にするには、**CELL** 要素を定義し、**Enabling** 式が **FALSE** の値を返すように指定します。
> - Excel テンプレートでは、すべての要素で固有の名前を使用します。 これらの要素には、画像やセルが含まれます。 要素名を複製する場合、生成されるレポートの内容が曖昧になり、紛らわしくなります。

## <a name="embed-a-shape-in-an-excel-document"></a>Excel ドキュメントに図形を埋め込む
最初に、Excel ドキュメントの図形に対するプレースホルダーを追加する必要があります。 Excel ブックを開いて、図形のプレース ホルダーとして **図形**、**テキスト ボックス**、または **WordArt** を選択します。 ER ツールを使用して、新しい ER フォーマット構成を追加して、設計中のレポートを組み込みます。 Excel ブックをレポートの形式のテンプレートとして添付し、ブックの内容を ER 形式にインポートします。 形式の定義が自動的に作成されます。 追加したシェイプ プレースホルダは、名前付き Excel シェイプ要素を参照する **CELL** 要素として ER フォーマット定義に含まれます。

> [!NOTE]
> 形式の定義をインポートせずに手動で指定できます。 変更を保存するとき、形式が検証されます。

次に、ER 形式で **セル** 要素を、実行時にデータを提供する形式のデータ ソースからフィールドにバインドします。 このデータはテキスト文字列に変換できます。 ER 形式の **セル** 要素がテキストをサポートする Excel テンプレート内の Shape 要素を参照するとき、実行時にこのバインディングによって提供されたテキストは、生成されるドキュメント内のシェイプに表示されます。

> [!IMPORTANT]
> - 図形のプレースホルダを含む Excel テンプレートを使用して新しいドキュメントを生成する場合、ER 形式には、Excel 図形要素を参照する **セル** 要素が含まれている必要があります。 それ以外の場合、レポートの出力にシェイプのプレースホルダーが表示されません。 指定された Excel シェイプ要素を参照する **CELL** 要素のバインディングが実行時にデータを返さない場合、生成されるドキュメントには、Excel テンプレートからシェイプ プレース ホルダのテキストが表示されます。 作成するドキュメントのシェイプを非表示にするには、名前付き Excel シェイプ要素を参照する **CELL** 要素を定義し、**Enabling** 式が **FALSE** の値を返すように指定します。
> - Excel テンプレートでは、すべての要素で固有の名前を使用します。 これらの要素には、図形やセルが含まれます。 要素名を複製する場合、生成されるレポートの内容が曖昧になり、紛らわしくなります。

## <a name="embed-an-image-in-a-word-document"></a>Word ドキュメントに画像を埋め込む
> [!IMPORTANT]
> Excel テンプレートを使用する ER 形式を再利用して、画像が埋め込まれた文書を作成することができます。 ER 形式で、Excel で名前付きの図の要素を参照する **セル** 要素に名前が指定されており、実行時に画像を返すデータ ソースにバインドされていることを確認します。

最初に、Word ドキュメントのレイアウトをコンフィギュレーションする必要があります。 **写真コンテンツ** コントロールを使用して、埋め込みイメージのプレースホルダーを作成します。 このコントロールにアクセスするには、まず Word Ribbon の **開発者** タブを表示する必要があります。

次に、ER 形式から Excel テンプレートを削除し、Word テンプレート ドキュメントを添付します。 テンプレートへの参照を更新し、変更を保存します。 現在の ER 形式の構造は、**Report** という新しいカスタム XML パーツとして Word テンプレートに保存されます。

次に、ローカル コンピューターに現在の ER 形式の Word テンプレートを保存します。 テンプレートを開いて、**XML マッピング** ウィンドウを開きます。 **レポート** という名前のカスタム XML 部分を検索し、次にバイナリ形式で画像を返すデータ ソースにバインドされている ER レポート内の **セル** 要素をポイントします。 この XML 部分の項目に、選択した **画像コンテンツ** コントロールをマップして、変更を保存します。

[![画像を埋め込む](./media/embed-images-shapes-01.png)](./media/embed-images-shapes-01.png)

最後に、ER フォーマットから Word テンプレートを削除し、マップされたカスタム XML 部分を含む Word 文書を添付します。 テンプレートへのフォーマット参照を更新し、この ER フォーマットに加えた変更を保存します。

## <a name="more-information"></a>詳細情報
この機能の詳細を理解するには、一連のタスク ガイド **画像を埋め込んだ MS Office 形式の ER Make レポート** を再生します。 これらのタスク ガイドは、Excel ツールと Word ドキュメントで ER ツールを使用して生成された支払小切手に、会社ロゴの画像と権限を与えられたユーザーの署名を埋め込む方法を示しています。

次のテーブルに、**ER 埋め込み画像付きで MS Office 形式のレポートを作成する** タスク ガイドを完了するために必要なファイルを示します。 ファイルをローカル コンピューターに[ダウンロード](https://go.microsoft.com/fwlink/?linkid=851448) し、保存します。

| 説明                                          | ファイル名                   |
|------------------------------------------------------|-----------------------------|
| ER データ モデル構成                          | cheques.xml 用のモデル       |
| ER フォーマット構成                              | format.xml を印刷する小切手 |
| 会社のロゴ画像                                   | 会社の logo.png            |
| 署名の画像                                      | Signature image.png         |
| 代替署名画像                          | Signature image 2.png       |
| 小切手印刷用の Microsoft Word テンプレート  | 小切手テンプレート Word.docx   |
| 小切手印刷用の Microsoft Excel テンプレート | 小切手 template.xlsx        |

次の図は、Excel テンプレートから生成された支払い小切手のテスト印刷の例です。

[![支払チェック テスト印刷](./media/embed-images-shapes-02.png)](./media/embed-images-shapes-02.png)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]