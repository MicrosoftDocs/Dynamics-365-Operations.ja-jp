---
title: Azure Data Lake へのエクスポートの構成
description: このトピックでは、Azure Data Lake へのエクスポートの構成に関する情報を説明します。
author: MilindaV2
ms.date: 06/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Developer, IT Pro
ms.reviewer: kfend
ms.custom: 96283
ms.assetid: ''
ms.search.region: Global
ms.author: milindav
ms.search.validFrom: 2020-03-03
ms.dyn365.ops.version: Platform Update 33
ms.openlocfilehash: 52f87f4effc28ae45e0d829df961fc993229284b
ms.sourcegitcommit: 3673eeca1ada0f3e4ec277176515a946706f8a41
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/24/2021
ms.locfileid: "6304381"
---
# <a name="configure-export-to-azure-data-lake"></a><span data-ttu-id="d672f-103">Azure Data Lake へのエクスポートのコンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="d672f-103">Configure export to Azure Data Lake</span></span>

[!include [banner](../includes/banner.md)]

> [!NOTE]
> <span data-ttu-id="d672f-104">**Data Lake へのエクスポート** 機能は、米国、カナダ、英国、ヨーロッパ、南アジア、東アジア、オーストラリア、および日本の地域でパブリック プレビューで表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-104">The **Export to Data Lake** feature is in public preview in the United States, Canada, United Kingdom, Europe, South East Asia, East Asia, Australia, and Japan regions.</span></span> <span data-ttu-id="d672f-105">Finance and Operations 環境がそれらの地域にある場合は、Microsoft Dynamics Lifecycle Services (LCS) を使用して、環境でこの機能を有効にできます。</span><span class="sxs-lookup"><span data-stu-id="d672f-105">If your Finance and Operations environment is in any of those regions, you can enable this feature in your environment by using Microsoft Dynamics Lifecycle Services (LCS).</span></span>
>
> <span data-ttu-id="d672f-106">数か月後に、Microsoft は需要に基づいて、追加の地域でこの機能を有効にします。</span><span class="sxs-lookup"><span data-stu-id="d672f-106">In the coming months, Microsoft will enable this feature in additional regions, based on the demand.</span></span> <span data-ttu-id="d672f-107">環境がプレビューが有効になっている地域にない場合は、[アンケートを完了し、お知らせください](https://aka.ms/FnODataLakePreviewSurvey)。</span><span class="sxs-lookup"><span data-stu-id="d672f-107">If your environment isn't in a region where the preview is enabled, [complete the survey and let us know](https://aka.ms/FnODataLakePreviewSurvey).</span></span> <span data-ttu-id="d672f-108">[プレビュー Yammer グループ](https://www.yammer.com/dynamicsaxfeedbackprograms/#/threads/inGroup?type=in_group&feedId=32768909312&view=all) に参加できます。</span><span class="sxs-lookup"><span data-stu-id="d672f-108">You can also join a [preview Yammer group](https://www.yammer.com/dynamicsaxfeedbackprograms/#/threads/inGroup?type=in_group&feedId=32768909312&view=all).</span></span> <span data-ttu-id="d672f-109">Yammer グループを使用して、機能を理解するのに役立つ質問をお伝えすることができます。</span><span class="sxs-lookup"><span data-stu-id="d672f-109">You can use the Yammer group to stay in contact and ask questions that will help you understand the feature.</span></span> 
>
> <span data-ttu-id="d672f-110">**Data Lake へのエクスポート** 機能は、Tier 1 (開発者) 環境では使用できません。</span><span class="sxs-lookup"><span data-stu-id="d672f-110">The **Export to Data Lake** feature isn't available in Tier-1 (developer) environments.</span></span> <span data-ttu-id="d672f-111">この機能を有効化するには、クラウド ベースの Tier 2 またはそれ以上の環境が必要です。</span><span class="sxs-lookup"><span data-stu-id="d672f-111">You must have a cloud-based Tier-2 or higher sandbox environment to enable this feature.</span></span> 
> 
> <span data-ttu-id="d672f-112">Tier 1 (開発者) 環境では、[GitHub ツール](https://github.com/microsoft/Dynamics-365-FastTrack-Implementation-Assets/blob/master/Analytics/AzureDataFactoryARMTemplates/SQLToADLSFullExport/ReadmeV2.md) を使用して機能の実装のプロトタイプを作成または計画できます。</span><span class="sxs-lookup"><span data-stu-id="d672f-112">In your Tier-1 (developer) environment, you can prototype or plan the feature implementation by using [GitHub tools](https://github.com/microsoft/Dynamics-365-FastTrack-Implementation-Assets/blob/master/Analytics/AzureDataFactoryARMTemplates/SQLToADLSFullExport/ReadmeV2.md).</span></span> <span data-ttu-id="d672f-113">このツールを使用すると、機能によってエクスポートされたのと同じ形式で、階層 1 またはサンドボックス環境のデータをストレージ アカウントにエクスポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="d672f-113">The tools let you export data from your Tier-1 or sandbox environment into a storage account in the same format that is exported by the feature.</span></span> 
> 
> <span data-ttu-id="d672f-114">**プレビュー中は、運用環境ではこの機能がサポートされていません。**</span><span class="sxs-lookup"><span data-stu-id="d672f-114">**Use of this feature in production environments isn't supported while it's in preview.**</span></span> <span data-ttu-id="d672f-115">運用環境では、この機能を有効にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d672f-115">You can't enable this feature in production environments.</span></span> <span data-ttu-id="d672f-116">サンドボックス (階層 2 以降) 環境でのみプレビューできます。</span><span class="sxs-lookup"><span data-stu-id="d672f-116">You can preview it only in your sandbox (Tier-2 or above) environments.</span></span>


## <a name="create-service-principal-for-microsoft-dynamics-erp-microservices"></a><a name="createServicePrincipal"></a> <span data-ttu-id="d672f-117">Microsoft Dynamics ERP Microservices のサービス プリンシパルの作成</span><span class="sxs-lookup"><span data-stu-id="d672f-117">Create Service Principal for Microsoft Dynamics ERP Microservices</span></span>

<span data-ttu-id="d672f-118">**Azure Data Lake へのエクスポート** 機能は、Finance and Operations アプリ データを Azure Data Lake へエクスポートしデータを最新の状態に維持するマイクロサービスを使用して構築されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-118">The **Export to Azure Data Lake** feature is built using a microservice that exports Finance and Operations app data to Azure Data Lake and keeps the data fresh.</span></span> <span data-ttu-id="d672f-119">マイクロサービスは、Azure サービス プリンシパル、**Microsoft Dynamics ERP Microservices** を使用して、Azure リソースに安全に接続します。</span><span class="sxs-lookup"><span data-stu-id="d672f-119">Microservice uses the Azure service principal, **Microsoft Dynamics ERP Microservices**, to securely connect to your Azure resources.</span></span> <span data-ttu-id="d672f-120">Data Lake にエクスポートする機能を構成する前に、**Microsoft Dynamics ERP Microservices** サービス プリンシパルを Azure Active Directory (Azure AD) に追加します。</span><span class="sxs-lookup"><span data-stu-id="d672f-120">Before you configure the Export to Data Lake feature, add the  **Microsoft Dynamics ERP Microservices** service principal to your Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="d672f-121">この手順により Azure AD を有効にしてマイクロサービスを認証できます。</span><span class="sxs-lookup"><span data-stu-id="d672f-121">This step enables Azure AD to authenticate the microservice.</span></span> 

> [!NOTE]
> <span data-ttu-id="d672f-122">これらの手順を実行するには、**Azure Active Directory テナント管理者** の権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="d672f-122">You will need **Azure Active Directory tenant administrator** rights to perform these steps.</span></span>

<span data-ttu-id="d672f-123">サービス プリンシパルを追加するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="d672f-123">To add the service principal, complete the following steps.</span></span>
1. <span data-ttu-id="d672f-124">Azure portal を起動し、Azure Active Directory にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="d672f-124">Launch the Azure portal and go to the Azure Active Directory.</span></span>
2. <span data-ttu-id="d672f-125">左のメニューで、**管理** > **エンタープライズ アプリケーション** を選択し、以下のアプリケーションを検索します。</span><span class="sxs-lookup"><span data-stu-id="d672f-125">On the left menu, select **Manage** > **Enterprise Applications**, and search for the following applications.</span></span>

| <span data-ttu-id="d672f-126">**申請書**</span><span class="sxs-lookup"><span data-stu-id="d672f-126">**Application**</span></span>                          | <span data-ttu-id="d672f-127">**アプリ ID**</span><span class="sxs-lookup"><span data-stu-id="d672f-127">**App ID**</span></span>                           |
|------------------------------------------|--------------------------------------|
| <span data-ttu-id="d672f-128">Microsoft Dynamics ERP マイクロサービス</span><span class="sxs-lookup"><span data-stu-id="d672f-128">Microsoft Dynamics ERP Microservices</span></span>     | <span data-ttu-id="d672f-129">0cdb527f-a8d1-4bf8-9436-b352c68682b2</span><span class="sxs-lookup"><span data-stu-id="d672f-129">0cdb527f-a8d1-4bf8-9436-b352c68682b2</span></span> |

<span data-ttu-id="d672f-130">上記のアプリケーションが見つからない場合は、次の手順を完了してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-130">If you are unable to find the above applications, complete following steps.</span></span>

3. <span data-ttu-id="d672f-131">ローカル コンピューターで、**スタート** メニューを開き、**PowerShell** を検索します。</span><span class="sxs-lookup"><span data-stu-id="d672f-131">On your local machine, open the **Start** menu, and search for **PowerShell**.</span></span>
4. <span data-ttu-id="d672f-132">**Windows PowerShell** を右クリックし、**管理者として実行** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-132">Right-click **Windows PowerShell**, and then select **Run as administrator**.</span></span>
5. <span data-ttu-id="d672f-133">以下のコマンドを実行して **AzureAD** モジュールをインストールします。</span><span class="sxs-lookup"><span data-stu-id="d672f-133">Run the following command to install **AzureAD** module:</span></span>
     >   <span data-ttu-id="d672f-134">*Install-Module -Name AzureAD*</span><span class="sxs-lookup"><span data-stu-id="d672f-134">*Install-Module -Name AzureAD*</span></span>
  - <span data-ttu-id="d672f-135">NuGet プロバイダーを続行する必要がある場合は、**Y** を選択してインストールします。</span><span class="sxs-lookup"><span data-stu-id="d672f-135">If NuGet provider is required to continue, select **Y** to install it.</span></span>
  - <span data-ttu-id="d672f-136">**信頼できないリポジトリ** のメッセージが表示された場合は、**Y** を選択して続行します。</span><span class="sxs-lookup"><span data-stu-id="d672f-136">If an **Untrusted repository** message appears, select **Y** to continue.</span></span>

6. <span data-ttu-id="d672f-137">Azure Active Directory へのアクセス許可を付与するには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="d672f-137">Run the following commands to add the application to the Azure Active Directory.</span></span>

    > <span data-ttu-id="d672f-138">Connect-AzureAD</span><span class="sxs-lookup"><span data-stu-id="d672f-138">Connect-AzureAD</span></span>
    
    > <span data-ttu-id="d672f-139">New-AzureADServicePrincipal – AppId 0cdb527f-a8d1-4bf8-9436-b352c68682b2 '</span><span class="sxs-lookup"><span data-stu-id="d672f-139">New-AzureADServicePrincipal –AppId '0cdb527f-a8d1-4bf8-9436-b352c68682b2'</span></span>

7. <span data-ttu-id="d672f-140">メッセージが表示されたら、管理者で Azure Active Directory にログインします。</span><span class="sxs-lookup"><span data-stu-id="d672f-140">Sign in as the Azure Active Directory administrator when prompted.</span></span>

## <a name="configure-azure-resources"></a><a name="ConfigureAzureResources"></a><span data-ttu-id="d672f-141">Azure リソースの構成</span><span class="sxs-lookup"><span data-stu-id="d672f-141">Configure Azure Resources</span></span> 

<span data-ttu-id="d672f-142">Data Lake へのエクスポートを構成するには、ご利用の Azure サブスクリプションにストレージ アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="d672f-142">To configure the export to Data Lake, create a storage account in your own Azure subscription.</span></span> <span data-ttu-id="d672f-143">このストレージ アカウントはデータの格納に使用されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-143">This storage account is used to store data.</span></span> <span data-ttu-id="d672f-144">続いて、ストレージ アカウントのルートへのアクセスを許可する Azure AD のアプリケーション ID を作成します。</span><span class="sxs-lookup"><span data-stu-id="d672f-144">Next, create an Azure AD application ID that grants access to the root of your storage account.</span></span> <span data-ttu-id="d672f-145">Finance or Operations アプリは、 Azure AD アプリケーションを使用してストレージへのアクセスや、フォルダ構造の作成や、データの書き込みを行います。</span><span class="sxs-lookup"><span data-stu-id="d672f-145">Your Finance or Operations app will use the Azure AD application to gain access to storage, create the folder structure, and write data.</span></span> <span data-ttu-id="d672f-146">サブスクリプションにキー コンテナーを作成し、ストレージ アカウントの名前、アプリケーション ID、アプリケーションのシークレットを保存します。</span><span class="sxs-lookup"><span data-stu-id="d672f-146">Create a key vault in your subscription and store the name of the storage account, application ID, and the application secrets.</span></span> <span data-ttu-id="d672f-147">Azure ポータルでリソースを作成するアクセス許可がない場合は、組織内でこのアクセス許可を持つユーザーの支援が必要となります。</span><span class="sxs-lookup"><span data-stu-id="d672f-147">If you don't have permission to create resources in Azure portal, you will need assistance from someone in your organization with the required permissions.</span></span>

<span data-ttu-id="d672f-148">Azure portal で行われる手順は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="d672f-148">The steps, which take place in the Azure portal, are as follows:</span></span>
> [!NOTE]
> <span data-ttu-id="d672f-149">Azure portal で作業する場合は、後続の手順に対して複数の値を保存するように指示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-149">When you are working in the Azure portal, you will be instructed to save several values for subsequent steps.</span></span> <span data-ttu-id="d672f-150">また、これらの値の一部は、Lifecycle Services (LCS) を使用して Finance and Operations アプリに提供されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-150">You will also provide some of these values to your Finance and Operations apps by using Lifecycle Services (LCS).</span></span> <span data-ttu-id="d672f-151">これを行うには、LCS への管理者アクセス権が必要です。</span><span class="sxs-lookup"><span data-stu-id="d672f-151">You will need Administrator access to LCS in order to do this.</span></span>
1. [<span data-ttu-id="d672f-152">Azure Active Directory でアプリケーションを作成する</span><span class="sxs-lookup"><span data-stu-id="d672f-152">Create an application in Azure Active Directory</span></span>](#createapplication)
2. [<span data-ttu-id="d672f-153">サブスクリプションに Data Lake ストレージ (Gen2 アカウント) を作成します</span><span class="sxs-lookup"><span data-stu-id="d672f-153">Create a Data Lake Storage (Gen2 account) in your subscription</span></span>](#createsubscription)
3. [<span data-ttu-id="d672f-154">アプリケーションにアクセス制御ロールを付与する</span><span class="sxs-lookup"><span data-stu-id="d672f-154">Grant access control roles to applications</span></span>](#grantaccess)
4. [<span data-ttu-id="d672f-155">キー コンテナーの作成</span><span class="sxs-lookup"><span data-stu-id="d672f-155">Create a key vault</span></span>](#createkeyvault)
5. [<span data-ttu-id="d672f-156">キー コンテナーにシークレットを追加する</span><span class="sxs-lookup"><span data-stu-id="d672f-156">Add secrets to the key vault</span></span>](#addsecrets)
6. [<span data-ttu-id="d672f-157">キー コンテナーのシークレットを読み取るためにアプリケーションを許可する</span><span class="sxs-lookup"><span data-stu-id="d672f-157">Authorize the application to read secrets in the key vault</span></span>](#authorize)
7. [<span data-ttu-id="d672f-158">Power Platform 統合</span><span class="sxs-lookup"><span data-stu-id="d672f-158">Power Platform integration</span></span>](#powerplatformintegration)
8. [<span data-ttu-id="d672f-159">LCS の Data Lake アドインへのエクスポートのインストール</span><span class="sxs-lookup"><span data-stu-id="d672f-159">Install the Export to Data Lake add-in in LCS</span></span>](#installaddin)


## <a name="create-an-application-in-azure-active-directory"></a><a name="createapplication"></a><span data-ttu-id="d672f-160">Azure Active Directory でアプリケーションを作成する</span><span class="sxs-lookup"><span data-stu-id="d672f-160">Create an application in Azure Active Directory</span></span>

1. <span data-ttu-id="d672f-161">Azure ポータルで、**Azure Active Directory** を選択し、**アプリケーション登録** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-161">In the Azure portal, select **Azure Active Directory**, and then select **App registrations**.</span></span>
2. <span data-ttu-id="d672f-162">**新しいアプリケーションの登録** を選択し、以下の情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-162">Select **New registration**, and enter the following information:</span></span> 

    -  <span data-ttu-id="d672f-163">**名前:** アプリの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-163">**Name:** Enter a name for the app.</span></span>
    -   <span data-ttu-id="d672f-164">**対応しているアカウントのタイプ** : 適切なオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-164">**Supported Account types**: Choose the appropriate option.</span></span>

3. <span data-ttu-id="d672f-165">アプリケーションの作成後は、これを選択し、<a name="appid"></a> アプリケーション (クライアント) IDをページの先頭に保存します。</span><span class="sxs-lookup"><span data-stu-id="d672f-165">After the application is created, select it, and then copy and save the <a name="appid"></a>Application (client) ID at the top of the page.</span></span> <span data-ttu-id="d672f-166">これは後で必要になります。</span><span class="sxs-lookup"><span data-stu-id="d672f-166">You will need this later.</span></span>
4. <span data-ttu-id="d672f-167">左のナビゲーション ウィンドウで、**API のアクセス許可** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-167">On the left navigation pane, select **API permissions**.</span></span>
5. <span data-ttu-id="d672f-168">**アクセス許可の追加** を選択し、**API アクセス許可の要求** ダイアログ ボックスで、**Azure キー コンテナー** を選択し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-168">Select **Add a permission**, and in the **Request API permissions** dialog box, select **Azure Key vault**.</span></span>
6. <span data-ttu-id="d672f-169">**委任されたアクセス許可** を選択し 、**user_impersonation** を選択します。続いて **アクセス許可の追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-169">Select **Delegated permissions**, select **user_impersonation**, and then select **Add permissions**.</span></span>
7. <span data-ttu-id="d672f-170">左のナビゲーションウィンドウで、**証明書とシークレット** を選択し、 **新たなクライアント シークレット** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-170">On the left navigation pane, select **Certificates & secrets**, and then select **New client secret**.</span></span> 
8. <span data-ttu-id="d672f-171">**説明** フィールドに名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-171">In the **Description** field, enter a name.</span></span>
9. <span data-ttu-id="d672f-172">**有効期限** フィールドで、オプションを選択し、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-172">In the **Expires** field, select an option, and then select **Add**.</span></span> <span data-ttu-id="d672f-173">システムがシークレットを生成し、グリッドの下に表示します。</span><span class="sxs-lookup"><span data-stu-id="d672f-173">The system will generate a secret and display it under the grid.</span></span> 
10. <span data-ttu-id="d672f-174">シークレット **値** をクリップボードにコピーします。</span><span class="sxs-lookup"><span data-stu-id="d672f-174">Copy the secret **Value** to the clipboard.</span></span> <span data-ttu-id="d672f-175">これは後でキー コンテナーを設定する際に、<a name="secret"></a> 値を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-175">This is the  <a name="secret"></a>value you will need to provide when you set up the key vault later.</span></span>

## <a name="create-a-data-lake-storage-gen2-account-in-your-subscription"></a><a name="createsubscription"></a><span data-ttu-id="d672f-176">サブスクリプションに Data Lake ストレージ（Gen2）を作成します</span><span class="sxs-lookup"><span data-stu-id="d672f-176">Create a Data Lake Storage (Gen2) account in your subscription</span></span>

<span data-ttu-id="d672f-177">Data Lake ストレージ アカウントは、Finance and Operations アプリのデータを格納する目的で使用されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-177">The Data Lake Storage account will be used to store data from your Finance and Operations apps.</span></span> <span data-ttu-id="d672f-178">ストレージ アカウントを手動で作成するには、Azure サブスクリプションへの管理者権限を持つユーザーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-178">To manually create a storage account, you must have administrative rights to your organization's Azure subscription.</span></span> <span data-ttu-id="d672f-179">ストレージ アカウントを作成するには、次の手順を完了してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-179">To create a storage account, complete the following steps.</span></span>

1. <span data-ttu-id="d672f-180">Azure portalで、**新しいリソースの作成** を選択し、**ストレージアカウント (blob、ファイル、テーブル、キュー)** を検索して選択し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-180">In the Azure portal, select **Create new resource**, and then search for and select **Storage account – blob, file, table, queue**.</span></span>
2. <span data-ttu-id="d672f-181">**ストレージ アカウントを作成** ダイアログ ボックスで、次のパラメーター フィールドの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="d672f-181">In the **Create storage account** dialog box, provide values for the following parameter fields:</span></span>

    - <span data-ttu-id="d672f-182">**場所:** 環境があるデータ センターを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-182">**Location:** Select the data center where your environment is located.</span></span> <span data-ttu-id="d672f-183">選択したデータ センターが異なる Azure リージョンにある場合は、データ移動コストが発生する場合があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-183">If the data center that you select is in a different Azure region, you may incur additional data movement costs.</span></span> <span data-ttu-id="d672f-184">Microsoft Power BI やデータ ウェアハウスが別の地域にある場合は、地域間でのストレージ移動にはレプリケーションを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="d672f-184">If your Microsoft Power BI or your data warehouse is in a different region, you can use replication to move storage between regions.</span></span>
    - <span data-ttu-id="d672f-185">**パフォーマンス**: **標準** を選択することを推奨します。</span><span class="sxs-lookup"><span data-stu-id="d672f-185">**Performance**: We recommend you select **Standard**.</span></span>
    - <span data-ttu-id="d672f-186">**アカウントの種類**: 必ず **Storage V2** を選択してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-186">**Account kind**: You must select **StorageV2**.</span></span> <span data-ttu-id="d672f-187">**詳細オプション** ダイアログ ボックスに、**Data Lake ストレージ Gen2** オプションが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-187">In the **Advanced options** dialog box, you will see the option, **Data Lake storage Gen2**.</span></span>

3. <span data-ttu-id="d672f-188">**詳細タブ** で、 **Data Lake storage Gen2** \> **階層の名前空間** を選択し、**有効化** を選択し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-188">On the **Advanced tab**, select **Data Lake storage Gen2** \> **Hierarchical namespaces**, and then select **Enabled**.</span></span> <span data-ttu-id="d672f-189">このオプションを無効にすると、Power BI データフローや AI Builder などのサービスを使用して Finance and Operations アプリが書き込んだデータを使用できなくなる場合があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-189">If you disable this option, you may not be able to consume data that is written by Finance and Operations apps with services such as Power BI data flows and AI builder.</span></span>
4. <span data-ttu-id="d672f-190">**確認して作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-190">Select **Review and create**.</span></span> <span data-ttu-id="d672f-191">デプロイの完了後は、新たなリソースが Azure ポータルに表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-191">When the deployment is complete, the new resource will be shown in the Azure portal.</span></span>
5. <span data-ttu-id="d672f-192">Azure portal で、作成したストレージ アカウントを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-192">In the Azure portal, select the storage account you created.</span></span> <span data-ttu-id="d672f-193">ストレージ<a name="storageaccount"></a>アカウント名をコピーして保存し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-193">Copy and save the <a name="storageaccount"></a>storage account name.</span></span>  

## <a name="grant-access-control-roles-to-applications"></a><a name="grantaccess"></a><span data-ttu-id="d672f-194">アプリケーションにアクセス制御ロールを付与する</span><span class="sxs-lookup"><span data-stu-id="d672f-194">Grant access control roles to applications</span></span> 

<span data-ttu-id="d672f-195">アプリケーションにストレージ アカウントの読み取り、書き込みのアクセス許可を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-195">You need to grant your application permissions to read and write to the storage account.</span></span> <span data-ttu-id="d672f-196">これらのアクセス許可は、Azure AD のロールを使用して付与されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-196">These permissions are granted by using Roles in Azure AD.</span></span>

1. <span data-ttu-id="d672f-197">**Azure ポータルl** で、作成済のストレージ アカウントを開きます。</span><span class="sxs-lookup"><span data-stu-id="d672f-197">In **Azure portal**, open the storage account that you created earlier.</span></span>
2. <span data-ttu-id="d672f-198">左側のナビゲーション ウィンドウで、**アクセス制御 (IAM)** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-198">Select **Access Control (IAM)** in the left navigation.</span></span> 
3. <span data-ttu-id="d672f-199">**アクセス制御** ページで、**ロールの割り当て** タブを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-199">On the **Access control** page, select the **Role assignments** tab.</span></span>
4. <span data-ttu-id="d672f-200">ページの上部の **追加** を選択し、**ロール割り当ての追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-200">Select **Add** at the top of the page, and then select **Add role assignment**.</span></span>
5. <span data-ttu-id="d672f-201">**ロール割り当ての追加** ダイアログ ボックスで、**ロール** フィールドを選択し、**ストレージ BLOB データの共同作成者** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-201">In the **Add role assignment** dialog box, select the **Role** field, and then select **Storage blob data contributor**.</span></span>
6. <span data-ttu-id="d672f-202">**選択** フィールドで、前述の手順で登録したアプリケーションを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-202">In the **Select** field, select the application that you registered earlier.</span></span>

> [!NOTE]
> <span data-ttu-id="d672f-203">フィールド対する変更、**Azure AD ユーザー、グループ、サービス プリンシパル** への **アクセス権の割り当て** は行わないでください。</span><span class="sxs-lookup"><span data-stu-id="d672f-203">Don't make any changes to the fields, **Assign access to** and **Azure AD user, group, or service principal**.</span></span>

7. <span data-ttu-id="d672f-204">**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-204">Select **Save**.</span></span>
8. <span data-ttu-id="d672f-205">手順 4 ~ 7 を繰り返して、次に示すように **ストレージ BLOB データの読み取り** ロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="d672f-205">Repeat steps 4-7 to add the **Storage blob data reader** role, as shown.</span></span>
9. <span data-ttu-id="d672f-206">先ほど作成した[アプリケーション](#appid) のストレージ アカウント ロール の割り当てを検証します。</span><span class="sxs-lookup"><span data-stu-id="d672f-206">Validate the storage account role assignment for [the application](#appid) you created earlier.</span></span> 

     |   <span data-ttu-id="d672f-207">申請書</span><span class="sxs-lookup"><span data-stu-id="d672f-207">Application</span></span>     |     <span data-ttu-id="d672f-208">役割</span><span class="sxs-lookup"><span data-stu-id="d672f-208">Role</span></span>     |
     |----------------------------------|-----------------------------|
     | <span data-ttu-id="d672f-209">既に作成した[アプリケーション](#appid)</span><span class="sxs-lookup"><span data-stu-id="d672f-209">[The application](#appid) you created earlier</span></span> | <span data-ttu-id="d672f-210">ストレージ BLOB データの共同作成者</span><span class="sxs-lookup"><span data-stu-id="d672f-210">Storage blob data contributor</span></span> |
     | <span data-ttu-id="d672f-211">既に作成した[アプリケーション](#appid)</span><span class="sxs-lookup"><span data-stu-id="d672f-211">[The application](#appid) you created earlier</span></span> | <span data-ttu-id="d672f-212">ストレージ BLOB データの読み取り権限を持つユーザー</span><span class="sxs-lookup"><span data-stu-id="d672f-212">Storage blob data reader</span></span>     |

## <a name="create-a-key-vault"></a><a name="createkeyvault"></a> <span data-ttu-id="d672f-213">キー コンテナーの作成</span><span class="sxs-lookup"><span data-stu-id="d672f-213">Create a key vault</span></span>

<span data-ttu-id="d672f-214">キーボルトは、ストレージ アカウント名などの詳細情報を Finance and Operations アプリに共有する安全な手段です 。</span><span class="sxs-lookup"><span data-stu-id="d672f-214">A key vault is a secure way to share details such as storage account name to your Finance and Operations apps.</span></span> <span data-ttu-id="d672f-215">キー コンテナーとシークレットを作成するには、次の手順を完了してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-215">Complete the following steps to create a key vault and a secret.</span></span>

1. <span data-ttu-id="d672f-216">Azure portalで、**新しいリソースの作成** を選択し、**キー コンテナー** を検索して選択し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-216">In the Azure portal, select **Create a new resource** and then search for and select, **Key Vault**.</span></span>
2. <span data-ttu-id="d672f-217">**キー コンテナーの作成** ダイアログ ボックスの **場所** フィールドで、環境があるデータ センターを選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-217">In the **Create key vault** dialog box, in the **Location** field, select the datacenter where your environment is located.</span></span>
3. <span data-ttu-id="d672f-218">キー コンテナーの作成後は、一覧から選択し、左側のナビゲーション ウィンドウで **概要** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-218">After the key vault is created, select it from the list, and on the left navigation pane, select **Overview**.</span></span> 
4. <span data-ttu-id="d672f-219"><a name="dnsname"></a>**DNS名** フィールドに値を保存します。</span><span class="sxs-lookup"><span data-stu-id="d672f-219">Save the value in the <a name="dnsname"></a>**DNS name** field.</span></span> <span data-ttu-id="d672f-220">後に、この値を使用します。</span><span class="sxs-lookup"><span data-stu-id="d672f-220">You will need this value later.</span></span>

## <a name="add-secrets-to-the-key-vault"></a><a name="addsecrets"></a><span data-ttu-id="d672f-221">キー コンテナーにシークレットを追加する</span><span class="sxs-lookup"><span data-stu-id="d672f-221">Add secrets to the key vault</span></span>

<span data-ttu-id="d672f-222">キーコンテナーに3つのシークレットを作成し、前述の手順で保存した値を追加します。</span><span class="sxs-lookup"><span data-stu-id="d672f-222">You are going to create three secrets in the Key vault and then add the values saved from previous steps.</span></span> <span data-ttu-id="d672f-223">それぞれのシークレットに対して、前述の手順で保存したシークレット名を入力し、値を入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-223">For each of the secrets, you will need to provide a secret name and provide the value you saved from earlier steps.</span></span>

| <a name="suggest"></a><span data-ttu-id="d672f-224">**推奨されるシークレット名**</span><span class="sxs-lookup"><span data-stu-id="d672f-224">**Suggested secret name**</span></span> | <span data-ttu-id="d672f-225">**前述の手順で保存したシークレット値**</span><span class="sxs-lookup"><span data-stu-id="d672f-225">**Secret value that you saved earlier**</span></span>  | <span data-ttu-id="d672f-226">**シークレット値の例**</span><span class="sxs-lookup"><span data-stu-id="d672f-226">**Example secret value**</span></span> |
|---------------------------|------------------------------------------------------------------|-------------|
| <span data-ttu-id="d672f-227">アプリ ID</span><span class="sxs-lookup"><span data-stu-id="d672f-227">app-id</span></span>                    | <span data-ttu-id="d672f-228">[作成済みの](#appid)アプリケーション オブジェクトの ID。</span><span class="sxs-lookup"><span data-stu-id="d672f-228">The ID of the application [created earlier](#appid).</span></span>             |<span data-ttu-id="d672f-229">8936e905-197b-xxx-xxxx-xxxxxxxxx</span><span class="sxs-lookup"><span data-stu-id="d672f-229">8936e905-197b-xxx-xxxx-xxxxxxxxx</span></span>|
| <span data-ttu-id="d672f-230">アプリのシークレット</span><span class="sxs-lookup"><span data-stu-id="d672f-230">app-secret</span></span>                | <span data-ttu-id="d672f-231">前述の手順で入力した[クライアント シークレット](#secret)です。</span><span class="sxs-lookup"><span data-stu-id="d672f-231">The [client secret](#secret) specified earlier.</span></span>                  |<span data-ttu-id="d672f-232">NaeIxxxxxxx---xxxx7eixxx ~ 1g-</span><span class="sxs-lookup"><span data-stu-id="d672f-232">NaeIxxxxxxx---xxxx7eixxx~1g-</span></span>|
| <span data-ttu-id="d672f-233">storage-account-name</span><span class="sxs-lookup"><span data-stu-id="d672f-233">storage-account-name</span></span>      | <span data-ttu-id="d672f-234">上記手順で作成した[ストレージアカウントの名前](#storageaccount)です。</span><span class="sxs-lookup"><span data-stu-id="d672f-234">The name of the [storage account](#storageaccount) created earlier.</span></span> |<span data-ttu-id="d672f-235">contosod365datalake</span><span class="sxs-lookup"><span data-stu-id="d672f-235">contosod365datalake</span></span>|

<span data-ttu-id="d672f-236">それぞれのシークレットごとに 1 回ずつ、以下の手順を 3 回実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-236">You will need to complete the following steps three times, once for each secret.</span></span>

1. <span data-ttu-id="d672f-237">Azure portalで、上記手順で作成したキー コンテナーに移動し、左側のナビゲーション ウィンドウで **シークレット** を選択し ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-237">In the Azure portal, go to the key vault you created earlier and on the left navigation pane, select **Secrets**.</span></span>
2. <span data-ttu-id="d672f-238">**生成/インポート** を選択し、**シークレットの作成** ダイアログ ボックスの、 **アップロード オプション** フィールドで **手動** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-238">Select **Generate/Import**, and in the **Create a secret** dialog box, in the **Upload options** field, select **Manual**.</span></span>
3. <span data-ttu-id="d672f-239">シークレットの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-239">Enter a name for the secret.</span></span> <span data-ttu-id="d672f-240">このセクション冒頭の「推奨される名前」の表を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-240">See the table in the introduction of this section for suggested names.</span></span>
4. <span data-ttu-id="d672f-241">**値** フィールドに、対応するシークレットの値をコピーして貼り付け ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-241">Copy and paste the corresponding secret value in the **Value** field.</span></span>
6. <span data-ttu-id="d672f-242">**有効** を選択し、**作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-242">Select **Enabled**, and then select **Create**.</span></span> 

<span data-ttu-id="d672f-243">シークレットの一覧に作成されたシークレットが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-243">You will notice the secret created in the list of secrets.</span></span>

## <a name="authorize-the-application-to-read-secrets-in-the-key-vault"></a><a name="authorize"></a><span data-ttu-id="d672f-244">キー コンテナーのシークレットを読み取るためにアプリケーションを許可する</span><span class="sxs-lookup"><span data-stu-id="d672f-244">Authorize the application to read secrets in the key vault</span></span>

1. <span data-ttu-id="d672f-245">**Azure ポータルl** で、作成済のキー コンテナーを開きます。</span><span class="sxs-lookup"><span data-stu-id="d672f-245">In **Azure portal**, open the key vault that you created earlier.</span></span>  
2. <span data-ttu-id="d672f-246">**アクセスポリシーの追加** ダイアログ ボックスで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-246">In the **Add access policy** dialog box, select **Add**.</span></span>
3. <span data-ttu-id="d672f-247">左のナビゲート ウィンドウ、**アクセス ポリシー > 新規ポリシーの追加** を選択して、新規ポリシーを作成します。</span><span class="sxs-lookup"><span data-stu-id="d672f-247">On the left navigation pane, select **Access policies > Add Access Policy** to create a new policy.</span></span> 
4. <span data-ttu-id="d672f-248">**アクセス ポリシーの追加** ダイアログ ボックスの **プリンシパルの選択** フィールドで、**Microsoft Dynamics ERP マイクロサービス** を検索して選択し、**選択** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d672f-248">In the **Add access policy** dialog box, in the **Select principal** field, locate and select the application, **Microsoft Dynamics ERP Microservices**, and then click **Select**.</span></span> 

> [!NOTE]
> <span data-ttu-id="d672f-249">**Microsoft Dynamics ERP Microservices** が見つからない場合は、このドキュメントの[サービス プリンシパルの作成](#createServicePrincipal) セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-249">If you can't find **Microsoft Dynamics ERP Microservices**, see the [Create Service Principal](#createServicePrincipal) section in this document.</span></span>

5. <span data-ttu-id="d672f-250">**シークレットのアクセス許可** フィールドで、**取得** と **リスト** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-250">In the **Secret permissions** fields, select **Get** and **List**.</span></span>  
6. <span data-ttu-id="d672f-251">**アクセスポリシー** ダイアログ ボックスで、**追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-251">In the **Access policy** dialog, select **Add**.</span></span>

<span data-ttu-id="d672f-252">以下のように、キー コンテナーへのアクセス権を持つアプリケーションが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-252">You should see application with access to your key vault as shown below.</span></span>

| <span data-ttu-id="d672f-253">申請書</span><span class="sxs-lookup"><span data-stu-id="d672f-253">Application</span></span>                                                    | <span data-ttu-id="d672f-254">シークレットのアクセス許可</span><span class="sxs-lookup"><span data-stu-id="d672f-254">Secret permissions</span></span> |
|----------------------------------------------------------------|--------------------|
| <span data-ttu-id="d672f-255">Microsoft Dynamics ERP マイクロサービス</span><span class="sxs-lookup"><span data-stu-id="d672f-255">Microsoft Dynamics ERP Microservices</span></span>                           | <span data-ttu-id="d672f-256">取得、リスト表示</span><span class="sxs-lookup"><span data-stu-id="d672f-256">Get, List</span></span>          |

7.  <span data-ttu-id="d672f-257">**保存** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-257">Select **Save**.</span></span>

## <a name="power-platform-integration"></a><a name="powerplatformintegration"></a><span data-ttu-id="d672f-258">Power Platform 統合</span><span class="sxs-lookup"><span data-stu-id="d672f-258">Power Platform integration</span></span> 
<span data-ttu-id="d672f-259">この環境に初めてアドインをインストールする場合、この環境に対して **Power Platform 統合** を有効にする必要があるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="d672f-259">If this is the first time you are installing add-ins in this environment, you may need to enable the **Power Platform integration**  for this environment.</span></span> <span data-ttu-id="d672f-260">Finance and Operations アプリケーション環境で Power Platform 統合を設定するには 2 つのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="d672f-260">There are two options to set up Power Platform integration in Finance and Operations app environments.</span></span>

### <a name="option-1-set-up-power-platform-integration-using-lcs"></a><span data-ttu-id="d672f-261">オプション 1: LCS を使用して Power Platform 統合の設定</span><span class="sxs-lookup"><span data-stu-id="d672f-261">Option 1: Set up Power Platform integration using LCS</span></span>

<span data-ttu-id="d672f-262">LCS から Power Platform 統合を設定するには、[アドインの概要](../power-platform/add-ins-overview.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-262">To set up Power Platform integration from LCS, see [Add-ins overview](../power-platform/add-ins-overview.md).</span></span>


### <a name="option-2-set-up-power-platform-integration-using-the-dual-write-wizard"></a><span data-ttu-id="d672f-263">オプション 2: 二重書き込みウィザードを使用して Power Platform 統合の設定</span><span class="sxs-lookup"><span data-stu-id="d672f-263">Option 2: Set up Power Platform integration using the Dual-write wizard</span></span>

<span data-ttu-id="d672f-264">**Power Platform 統合** を設定するもう 1 つの方法は、データベースで Power Platform 環境を作成し、二重書き込みの設定を使用します。</span><span class="sxs-lookup"><span data-stu-id="d672f-264">Another way to set up **Power Platform integration** is to create a Power Platform environment with a database and then use the Dual-write setup.</span></span> <span data-ttu-id="d672f-265">次の手順を実行して、Power Platform 環境を作成し、統合を完了します。</span><span class="sxs-lookup"><span data-stu-id="d672f-265">Complete the following steps to create the Power Platform environment and complete the integration.</span></span> 

1. <span data-ttu-id="d672f-266">[データベースを使用して環境を作成します](/power-platform/admin/create-environment#create-an-environment-with-a-database.md)。</span><span class="sxs-lookup"><span data-stu-id="d672f-266">[Create an environment with database](/power-platform/admin/create-environment#create-an-environment-with-a-database.md).</span></span>
2. <span data-ttu-id="d672f-267">[要件と前提条件を完了します](dual-write/requirements-and-prerequisites.md)。</span><span class="sxs-lookup"><span data-stu-id="d672f-267">[Complete the requirement and prerequisite](dual-write/requirements-and-prerequisites.md).</span></span>  
3. <span data-ttu-id="d672f-268">[二重書き込みウィザードを使用して環境をリンクする](dual-write/link-your-environment.md) を使用します。</span><span class="sxs-lookup"><span data-stu-id="d672f-268">Use the [dual-write wizard to link your environment](dual-write/link-your-environment.md).</span></span>
4. <span data-ttu-id="d672f-269">Power Platform 統合が設定され、LCS 環境ページに追加されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="d672f-269">Validate that the Power Platform integration is set up and added in the LCS environment page.</span></span>  

> [!NOTE]
> <span data-ttu-id="d672f-270">このアプローチを使用する場合は、Finance and Operations 環境と同じリージョンにある Power Platform 環境を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-270">If you use this approach, you must select a Power Platform environment that is in the same region as your Finance and Operations environment.</span></span> <span data-ttu-id="d672f-271">別の地域の Power Platform 環境を選択した場合、アドインのインストールが失敗する場合があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-271">If you select a Power Platform environment that is in a different region, installation of the add-in might fail.</span></span>

## <a name="install-the-export-to-data-lake-add-in-in-lcs"></a><a name="installaddin"></a><span data-ttu-id="d672f-272">LCS の Data Lake アドインへにエクスポート機能をインストールする</span><span class="sxs-lookup"><span data-stu-id="d672f-272">Install the Export to Data Lake add-in in LCS</span></span> 

<span data-ttu-id="d672f-273">Finance and Operations アプリから Data Lake にデータをエクスポートするには、LCS の **Data Lake エクスポートする** アドインをインストールする必要があり ます。</span><span class="sxs-lookup"><span data-stu-id="d672f-273">Before you can export data to your Data lake from your Finance and Operations apps, you must install the **Export to Data Lake** add-in in LCS.</span></span> <span data-ttu-id="d672f-274">このタスクを完了するには、使用する環境の LCS 環境管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-274">To complete this task, you must be an environment administrator in LCS for the environment that you want to use.</span></span>

<span data-ttu-id="d672f-275">これを開始する前に、次の情報を確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-275">You need the following information before you start.</span></span> <span data-ttu-id="d672f-276">作業の開始前に、情報を手元に保管しておいてください。</span><span class="sxs-lookup"><span data-stu-id="d672f-276">Keep the information handy before you begin.</span></span>

| <span data-ttu-id="d672f-277">**Data lake アドインへのエクスポートに必要な情報**</span><span class="sxs-lookup"><span data-stu-id="d672f-277">**Information you need for Export to Data lake add-in**</span></span>   | <span data-ttu-id="d672f-278">**どこにあるか**</span><span class="sxs-lookup"><span data-stu-id="d672f-278">**Where can you find it**</span></span>| <span data-ttu-id="d672f-279">**例**</span><span class="sxs-lookup"><span data-stu-id="d672f-279">**Example**</span></span>|
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| <span data-ttu-id="d672f-280">ご利用の Azure AD テナント ID</span><span class="sxs-lookup"><span data-stu-id="d672f-280">Your environment Azure AD Tenant ID</span></span>                            | <span data-ttu-id="d672f-281">Azure AD テナント ID は Azure ポータルで確認できます。</span><span class="sxs-lookup"><span data-stu-id="d672f-281">Your Azure AD tenant ID in the Azure portal.</span></span> <span data-ttu-id="d672f-282">**Azure ポータル** にログインし、**Azure Active Directory**  サービスを開きます。</span><span class="sxs-lookup"><span data-stu-id="d672f-282">Sign in to the **Azure portal** and open the **Azure Active Directory** service.</span></span> <span data-ttu-id="d672f-283">**プロパティ** ページを開き、**ディレクトリ ID** フィールドの値をコピーします。</span><span class="sxs-lookup"><span data-stu-id="d672f-283">Open the **Properties** page and copy the value in the **Directory ID** field.</span></span> |<span data-ttu-id="d672f-284">72f988bf-0000-0000-00000-2d7cd011db47</span><span class="sxs-lookup"><span data-stu-id="d672f-284">72f988bf-0000-0000-00000-2d7cd011db47</span></span>|
| <span data-ttu-id="d672f-285">キー コンテナーの DNS 名</span><span class="sxs-lookup"><span data-stu-id="d672f-285">DNS name of your key vault</span></span>                                | <span data-ttu-id="d672f-286">この名前は、あらかじめ保存しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-286">This name should have been previously saved.</span></span> <span data-ttu-id="d672f-287">キー コンテナーの [DNS 名](#dnsname) を入力します</span><span class="sxs-lookup"><span data-stu-id="d672f-287">Enter the [DNS name](#dnsname) of your key vault</span></span>                                                                                                               | https://contosod365datafeedpoc.vault.azure.net/|
| <span data-ttu-id="d672f-288">ストレージ アカウントの名前を含むシークレット</span><span class="sxs-lookup"><span data-stu-id="d672f-288">The secret that contains the name of your storage account</span></span> |  <span data-ttu-id="d672f-289">提示された名前を使用した場合は、**storage-account-name** を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-289">If you used the suggested name, enter **storage-account-name**.</span></span> <span data-ttu-id="d672f-290">これを使用していない場合は、定義した[シークレット名](#suggest)を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-290">If not, enter the [secret name](#suggest) you defined.</span></span>                                                                                                                                                                                                                         |<span data-ttu-id="d672f-291">storage-account-name</span><span class="sxs-lookup"><span data-stu-id="d672f-291">storage-account-name</span></span>|
| <span data-ttu-id="d672f-292">アプリケーション ID を含むシークレット</span><span class="sxs-lookup"><span data-stu-id="d672f-292">Secret that contains the Application ID</span></span>                   |  <span data-ttu-id="d672f-293">定時された名前を使用した場合は、**app id** を入力してください。これを使用していない場合は、定義した[シークレット名](#suggest)を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-293">If you used the suggested name, enter **app-id**. If not, enter the [secret name](#suggest) you defined.</span></span>                                                                                       |<span data-ttu-id="d672f-294">アプリ ID</span><span class="sxs-lookup"><span data-stu-id="d672f-294">app-id</span></span>|
| <span data-ttu-id="d672f-295">アプリケーションのシークレットを含むシークレット</span><span class="sxs-lookup"><span data-stu-id="d672f-295">Secret that contains the Application secret</span></span>               |  <span data-ttu-id="d672f-296">提示された名前を使用した場合は、**app-secret** を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-296">If you used the suggested name, enter **app-secret**.</span></span> <span data-ttu-id="d672f-297">これを使用していない場合は、定義した[シークレット名](#suggest)を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-297">If not, enter the [secret name](#suggest) you defined.</span></span>                                                                                             |<span data-ttu-id="d672f-298">アプリのシークレット</span><span class="sxs-lookup"><span data-stu-id="d672f-298">app-secret</span></span>|

1.  <span data-ttu-id="d672f-299">[LCS](https://lcs.dynamics.com) にログインし、ご利用の環境に移動します。</span><span class="sxs-lookup"><span data-stu-id="d672f-299">Sign in to [LCS](https://lcs.dynamics.com) and navigate to your environment.</span></span>
2.  <span data-ttu-id="d672f-300">**環境** ページで、**環境アドイン** タブを選択します。**Data lakeの エクスポート** が一覧に表示される場合は、Data Lake アドインが既にインストールされているため、この手順の残りの部分は省略することができます。</span><span class="sxs-lookup"><span data-stu-id="d672f-300">On the **Environment** page, select the **Environment add-ins** tab. If **Export Data Lake** appears in the list, the Data Lake add-in is already installed, and you can skip the rest of this procedure.</span></span> <span data-ttu-id="d672f-301">これに該当しない場合は、残りの手順を実行してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-301">Otherwise, complete the remaining steps.</span></span>
3.  <span data-ttu-id="d672f-302">**インストールするアドイン** を選択し、ダイアログ ボックスで、**Data lake にエクスポート** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-302">Select **Install a new add-in**, and in the dialog box, select **Export to Data lake**.</span></span> <span data-ttu-id="d672f-303">**Data lake にエクスポート** が表示されない場合は、この機能がご利用の環境で使用できない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-303">If **Export to data lake** isn't listed, the feature might not be available for your environment at this time.</span></span>
4.  <span data-ttu-id="d672f-304">**設定のアドイン** ダイアログ ボックスで、必要な情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="d672f-304">In the **Setup add-in** dialog box, enter the required information.</span></span> <span data-ttu-id="d672f-305">質問に答えるには、既にストレージ アカウントが作成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="d672f-305">To answer the questions, you must already have a storage account.</span></span> <span data-ttu-id="d672f-306">ストレージ アカウントをまだ持っていない場合は、作成するか、管理者にアカウントの作成代行を依頼してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-306">If you don't already have a storage account, create one, or ask your admin to create one on your behalf.</span></span>
5.  <span data-ttu-id="d672f-307">チェック ボックスをオンにしてサービス条件を承認し、**インストール** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d672f-307">Accept the terms of the offer by selecting the check box, and then select **Install**.</span></span>

<span data-ttu-id="d672f-308">システムが、ご利用の環境に Data Lake をインストールし構成します。</span><span class="sxs-lookup"><span data-stu-id="d672f-308">The system installs and configures the data lake for the environment.</span></span> <span data-ttu-id="d672f-309">インストールと構成が完了すると、 **環境** のページに **Azure Data Lake** の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d672f-309">After installation and configuration are complete, you should see **Azure Data Lake** listed on the **Environment** page.</span></span>

## <a name="troubleshooting"></a><a name="troubleshooting"></a> <span data-ttu-id="d672f-310">トラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="d672f-310">Troubleshooting</span></span>

### <a name="error-unabletoinitializelakeduetousererror"></a><span data-ttu-id="d672f-311">エラー UnableToInitializeLakeDueToUserError</span><span class="sxs-lookup"><span data-stu-id="d672f-311">Error UnableToInitializeLakeDueToUserError</span></span>

<span data-ttu-id="d672f-312">エラー **UnableToInitializeLakeDueToUserError** は、**Data Lake にエクスポート** サービスがストレージ アカウントに接続できないか、[アプリケーション](#appid) にストレージ アカウントへの必要なアクセス権がないことを示します。</span><span class="sxs-lookup"><span data-stu-id="d672f-312">The error, **UnableToInitializeLakeDueToUserError** indicates that the **Export to Data Lake** service can't connect to a storage account or [the application](#appid) doesn't have the required access to the storage account.</span></span> <span data-ttu-id="d672f-313">この問題を解決するには、次のを試してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-313">To resolve this issue, try the following:</span></span>

- <span data-ttu-id="d672f-314">キー コンテナーに保存されているシークレット値が有効で正しいことを検証します。</span><span class="sxs-lookup"><span data-stu-id="d672f-314">Validate that the secret values stored in the key vault are valid and correct.</span></span> <span data-ttu-id="d672f-315">詳細については、[キー コンテナーにシークレットを追加する](#addsecrets) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-315">For more information, see [add secrets to the key vault](#addsecrets).</span></span>   
- <span data-ttu-id="d672f-316">ストレージ アカウントへのアクセスが必要な Azure Active Directory (Azure AD) アプリを確認します。</span><span class="sxs-lookup"><span data-stu-id="d672f-316">Validate that the Azure Active Directory (Azure AD) app you have requires access to the storage account.</span></span> <span data-ttu-id="d672f-317">詳細については、[アプリケーションへのアクセス制御ロールを付与](#grantaccess) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d672f-317">For more information, see [Grant access control roles to applications](#grantaccess).</span></span>


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
