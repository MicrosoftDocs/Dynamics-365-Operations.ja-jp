---
title: データ統合戦略の選択
description: このトピックは、設計者と開発者が統合シナリオを実装する際に意思決定を適切に行えるようにすることを目的としています。
author: Sunil-Garg
ms.date: 11/23/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Developer
ms.reviewer: sericks
ms.search.region: Global
ms.author: sunilg
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d8097b8d3601b182059022b22d9459d0064fd12e
ms.sourcegitcommit: a202bf67c3c2c054e2a47cb7b3145cb7c0ee635e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/25/2021
ms.locfileid: "5941182"
---
# <a name="choose-a-data-integration-strategy"></a>データ統合戦略の選択

[!include [banner](../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

このトピックは、設計者と開発者が統合シナリオを実装する際に意思決定を適切に行えるようにすることを目的としています。

このトピックでは、統合パターン、統合シナリオ、統合ソリューション、およびベストプラクティスについて説明します。 ただし、すべての統合パターンを使用または設定する方法に関する技術詳細は含まれません。 また、サンプル統合コードも含まれていません。

> [!NOTE]
> パターンを選択にあたってガイダンスを示し、シナリオについて説明する際には、データのボリューム番号について言及されます。 これらの番号は、パターンを測定するためだけに使用する必要があり、ハードシステムの限界を意味するものではありません。 絶対数は、実稼働環境ではさまざまな要因によって変わってきます。コンフィギュレーションはこのシナリオにおけるただ1つの側面に過ぎません。 

次のテーブルに、使用可能な統合パターンを示します。

| パターン                       | ドキュメント |
|-------------------------------|---------------|
| Power Platform 統合    | [Finance and Operations アプリと Microsoft Power Platform の統合](../power-platform/overview.md) |
| 二重書き込み                    | [二重書き込みの概要](dual-write/dual-write-home-page.md) |
| クラシック データの統合      | [クラシック データ統合の概要](data-integration-cds.md) |
| OData                         | [データ プロトコル (OData) を開く](odata.md) |
| バッチ データ API                | [定期統合](recurring-integrations.md)<br>[データ管理パッケージ REST API](data-management-api.md) |
| カスタム サービス                | [カスタム サービスの開発](custom-services.md) |
| 外部 Web サービスの消費 | [外部 Web サービスの消費](consume-external-web-service.md) |
| Excel 統合             | [Office 統合の概要](../office-integration/office-integration.md) |

> [!NOTE]
> オンプレミス配置の場合、唯一サポートされる API は [データ管理パッケージ REST API](data-management-api.md) です。 これは、7.2、platform update 12 ビルド 7.0.4709.41184 で現在利用可能です。

## <a name="power-platform-integration"></a>Power Platform の統合
Finance and Operations は、Dataverse の仮想データ ソースであり、Dataverse および Microsoft Power Platform からの完全な作成、読み取り、更新、削除 (CRUD) 操作を可能にし ます。 定義上、仮想エンティティのデータは、Dataverse には存在しません。 代わりに、Finance and Operations には引き続き存在します。 Dataverse から Finance and Operations エンティティに対して CRUD 操作を有効にするには 、エンティティを Dataverse の仮想エンティティとして使用できるようにする必要があります。 これにより、Finance and Operations アプリに存在するデータに対して、Dataverse と Microsoft Power Platform から CRUD 処理を実行できるようになります。 詳細については、[Microsoft Power Platform 統合](../power-platform/overview.md)を参照してください。

## <a name="dual-write-vs-classic-data-integration-patterns-vs-virtual-entities"></a>二重書き込み対クラシック データ統合のパターン対仮想エンティティ

二重書き込みにより、Dynamics 365 と Finance and Operations アプリケーションのモデル駆動型アプリケーション間で、同期、双方向、ほぼリアルタイムのエクスペリエンスが可能です。 データ同期は、ほとんどまたはまったく介入を伴うことなく行われ、エンティティに対する作成、更新、および削除アクションによってトリガーされます。 二重書き込みは、Dynamics 365 アプリケーションにまたがる対話型業務シナリオに適しています。

クラシック データ統合により、Customer Engagement アプリと Finance and Operations アプリの間で非同期および単一方向のデータ同期エクスペリエンスが可能です。 IT管理者主導のエクスペリエンスであり、データ同期ジョブを特定の頻度で実行するようにスケジュールする必要があります。 クラシック データの統合は、Dynamics 365アプリケーション間で大量のデータの入出力を伴う業務シナリオに適しています。

| パターン                       | タイミング                        | バッチ | テクノロジ | Finance and Operations アプリ | Dynamics 365 モデル駆動型アプリ |
|-------------------------------|-------------------------------|-------|---|------|------------|
| 二重書き込み             | 同期<br>双方向   | 無    | OData | Finance<br>サプライ チェーン<br>Commerce<br>サービス業<br>CoreHR | Sales<br>マーケティング<br>顧客サービス<br>Field Service<br>Project Service Automation<br>人材 | 
| クラシック データの統合 | 非同期、単一方向 | 有   | DIXF | Finance<br>サプライ チェーン<br>Commerce<br>サービス業<br>CoreHR | Sales<br>マーケティング<br>顧客サービス<br>Field Service<br>Project Service Automation<br>人材 |

仮想エンティティは、データを Dataverse に物理的にコピーすることなく、Finance and Operations で Microsoft Power Platform を使用するメカニズムを提供します。 このガイダンスは、要件に二重書き込みまたはデータ統合、または仮想エンティティが必要かどうかを判断するために使用する必要があります。 仮想エンティティと二重書き込み/データ統合は、必要に応じて併用できる補完的なテクノロジです。

## <a name="synchronous-vs-asynchronous-integration-patterns"></a>同期および非同期の統合パターン

処理は、同期または非同期にすることができます。 多くの場合、使用すべき処理タイプは、選択した統合パターンによって決まります。

*同期* パターンは、ブロック要求と応答パターンであり、呼び出し先が実行を終了して応答を返すまで呼び出し元がブロックされます。 *非同期* パターンは非ブロック パターンで、呼び出し元が要求を送信して応答を待たずに続行します。

次のテーブルに、使用可能な受信統合パターンを示します。

| パターン        | タイミング       | バッチ |
|----------------|--------------|-------|
| OData          | 同期  | 無    |
| バッチ データ API | 非同期 | 有   |

同期と非同期パターンを比較する前に、すべての REST および SOAP 統合アプリケーション プログラミング インターフェイス (API) を同期または非同期で呼び出すことができるので注意が必要です。

次の例は、このポイントを示しています。 オープン データ プロトコル (OData) が統合のために使用される場合、呼び出し元がブロックされるとは限りません。 通話の仕方によっては、呼び出し元がブロックされない場合があります。

| パターン        | 同期式のプログラミング パラダイム    | 非同期式のプログラミング パラダイム |
|----------------|-------------------------------------|-----------------------------------|
| OData          | DbResourceContextSaveChanges         | DbResourceContextSaveChangesAsync |
| カスタム サービス | httpRequestGetResponse               | httpRequestBeginGetResponse |
| SOAP           | UserSessionServiceGetUserSessionInfo | UserSessionServiceGetUserSessionInfoAsync |
| バッチ データ API | ImportFromPackage                   | [BeginInvoke](/dotnet/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously) |

これらの API が呼び出されると、すぐにビジネス ロジックが実行されるため、OData とカスタム サービスの両方は同期統合パターンです。 次にいくつか例を挙げます。

- OData を使用して製品レコードを挿入すると、レコードはすぐに OData 呼び出しの一部として挿入されます。
- 手持ちの在庫を検索するためにカスタム サービスを使用すると、ビジネス ロジックが JSON/SOAP 呼び出しの一部としてすぐに実行され、在庫総額がすぐに返されます。

これらの API が呼び出されると、バッチ モードでデータがインポートまたはエクスポートされるため、バッチ データ API は非同期統合パターンと見なされます。 たとえば、ImportFromPackage API への呼び出しは、同期することができます。 ただし、API は、特定のデータ パッケージのみをインポートするバッチ ジョブをスケジュールします。 スケジューリング ジョブはすぐに戻され、後でバッチ ジョブで処理されます。 したがって、バッチ データ API は非同期として分類されます。

バッチ データ API は大量のデータのインポートとエクスポートを処理するために設計されています。 大量である条件を正確に定義することは困難です。 回答は、エンティティによって、およびインポートまたはエクスポート中に実行されるビジネス ロジックの量によって異なります。 ただし、経験則を次に示します: 容量が数十万レコード以上の場合は、統合のバッチ データ API を使用する必要があります。

一般に、統合パターンを選択しようとしている場合、次の質問を検討することをお勧めします。

- 統合をリアルタイムで行う必要がある業務要件がありますか。
- ピーク時のデータ量の要件は何ですか ?
- 頻度はどのくらいですか ?

### <a name="error-handling"></a>エラー処理 

同期パターンを使用するときは、呼び出し元に成功または失敗の応答が返されます。 たとえば、OData 呼び出しが販売注文を挿入するために使用される場合、販売注文明細行に存在しない製品への無効な参照があると、呼び出し元が受信する応答には、エラー メッセージが含まれます。 呼び出し元は、応答内のエラーを処理します。

非同期パターンを使用するときは、呼び出し元には、スケジューリング呼び出しが成功したかどうかを示す応答がすぐ表示されます。 呼び出し元は、応答内のエラーを処理します。 スケジューリングが完了したら、データのインポートまたはエクスポートのステータスは、呼び出し元にプッシュされません。 呼び出し元は、対応するインポートまたはエクスポート処理の結果をポーリングし、それに応じてエラーを処理する必要があります。

## <a name="typical-scenarios-and-patterns-that-use-dual-write"></a>二重書き込みを使用する一般的なシナリオとパターン 

二重書き込みを使用する一般的なシナリオを次に示します。

### <a name="enable-customer-service-representative-to-facilitate-change-of-address-for-finance-and-operations-customers"></a>顧客サービス担当者が Finance and Operations の顧客の住所変更を容易にできるようにする

顧客が移転し、請求先住所と送付先住所の情報を変更したいとします。 この顧客は、顧客サポート担当者に連絡して、住所の変更を依頼します。 顧客サポート担当者が電話を受け、顧客の請求先住所と送付先住所を変更します。

| 意思決定                    | 情報              |
|-----------------------------|--------------------------|
| リアルタイムな日付が必要ですか。 | 有                      |
| ピーク データ量            |                          |
| 頻度                   | アドホック                   |

#### <a name="recommended-solution"></a>推奨される解決策
このほぼリアルタイムのデータ同期のシナリオでは、二重書き込みで実装するのが最適です。

- 顧客情報は、Finance and Operations アプリから取得されます。
- 顧客が顧客サポートに電話し、請求先住所と送付先住所の情報を変更するよう依頼します。
- 顧客サポート担当者は、Dynamics 365 Customer Service の顧客レコードを取得します。
- 顧客サポート担当者は、請求先住所と送付先住所を更新してデータを保存します。
- 新しい請求先住所と送付先住所は、リアルタイムで Finance and Operations アプリに同期されます。

### <a name="sales-representatives-can-change-customer-credit-limits-without-logging-into-a-finance-and-operations-app"></a>販売担当者は、Finance and Operations アプリにログインすることなく、顧客の与信限度額を変更できます

顧客には $2,000 の与信限度額があり、$5,000 に引き上げたいと考えています。 この顧客は、顧客サポートに電話し、増加を依頼します。 チケットが、販売部門に割り当てられます。 販売責任者は、依頼を検討し、顧客の支払履歴を確認し、顧客が与信限度額の増加の資格があると判断します。 販売責任者は依頼を承認し、チケットに応答します。 顧客は与信限度額 $5,000 の承認を通知する電子メールを受け取ります。

| 意思決定                    | 情報              |
|-----------------------------|--------------------------|
| リアルタイムな日付が必要ですか。 | 有                      |
| ピーク データ量            |                          |
| 頻度                   | アドホック                   |


#### <a name="recommended-solution"></a>推奨される解決策

このシナリオでは、二重書き込みで実装するのが最適です。

- 顧客は顧客サポートに電話し、与信限度額を $2,000 から $5,000 に引き上げたいと考えています。
- 顧客サポート担当者が Dynamics 365 Customer Service でチケットを作成します。
- このチケットが、販売部門に割り当てられます。
- 販売部門の販売担当者が依頼を確認して、承認します。
- この結果、Dynamics 365 Sales で顧客の与信限度額が $5,000 に引き上げられました。 
- Finance and Operations アプリの与信限度額が $5,000 に更新されます。
- 販売担当者は、チケットに応答して解決します。 
- 顧客は、与信限度額の引き上げに関する電子メールを受け取ります。

## <a name="typical-scenarios-and-patterns-that-use-odata-integrations"></a>OData 統合を使用する一般的なシナリオとパターン

OData 統合を使用する典型的なシナリオを次に示します。

> [!NOTE]
> Power BI レポートの OData の使用はお勧めしません。 このような状況ではエンティティ格納を使用することをお勧めします。

### <a name="create-and-update-product-information"></a>製品情報の作成および更新

あるメーカーでは、その製品をオンプレミスでホストされているサード パーティ製アプリケーションを使用して、定義および構成します。 このメーカーは、生産情報をオンプレミス アプリケーションから Finance and Operations に移行する必要があります。 製品が定義されるとき、またはオンプレミス アプリケーションで変更されるとき、ユーザーは、同じ変更をリアルタイムに確認できます。

| 意思決定                    | 情報              |
|-----------------------------|--------------------------|
| リアルタイムな日付が必要ですか。 | はい                      |
| ピーク データ量            | 時間当たり 1,000 レコード\* |
| 頻度                   | アドホック                   |

\* 場合によっては、新しいまたは変更された生産コンフィギュレーションが短時間に多く発生します。

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、OData サービス エンドポイントを使用して、Finance and Operations で製品情報を作成および更新することによって最適に実装されます。

Finance and Operations の場合:

- 統合に必要なすべてのエンティティを決定します。
- OData サービス エンドポイントが同じエンティティのセットに対して使用可能であることを確認します。

サード パーティ製アプリケーション:

- 製品情報がサード パーティ製アプリケーションで作成または変更されるときは、同じ変更を加えるために Finance and Operations に対して OData 呼び出しが行われます。

### <a name="read-the-status-of-customer-orders"></a>客注文のステータスを読み取る

会社は、顧客が注文の状況を確認できる自己ホストの顧客ポータルを持っています。 注文ステータス情報は、アプリケーションで管理されます。

| 意思決定                    | 情報            |
|-----------------------------|------------------------|
| リアルタイムな日付が必要ですか。 | はい                    |
| ピーク データ量            | 時間当たり 5,000 レコード |
| 頻度                   | アドホック                 |

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、OData サービス エンドポイントを使用して、注文ステータス情報を読み取ることによって最適に実装されます。

Finance and Operations の場合:

- 注文のステータス情報を読むために必要なエンティティを決定します。
- OData サービス エンドポイントがエンティティに対して使用可能であることを確認します。

顧客のポータル サイトで、次の操作を行います。

- 顧客は注文のステータスをチェックするとき、対応する注文を読み取ってそのステータスを取得するために、Finance and Operations にリアルタイムの OData 呼び出しを行います。

### <a name="approve-boms"></a>BOM の承認

会社は、オンプレミスでホストされている製品ライフサイクル管理 (PLM) システムを使用しています。 PLM システムには、承認のためにアプリケーションに完成した部品表 (BOM) 情報を送信するワークフローがあります。

| 意思決定                    | 情報            |
|-----------------------------|------------------------|
| リアルタイムな日付が必要ですか。 | 有                    |
| ピーク データ量            | 時間当たり 1,000 レコード |
| 頻度                   | アドホック                 |

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、OData アクションを使用して実装できます。

Finance and Operations の場合:

- 統合に必要なエンティティを決定する
- OData サービス エンドポイントがエンティティに対して使用可能であることを確認します。
- エンティティで、必要なビジネス ロジックを実行するアクションを作成します。

PLM ソリューション:

- PLM システムで、BOM を承認する OData アクションを呼び出します。

> [!NOTE]
> このタイプの OData アクションは **BOMBillOfMaterialsHeaderEntity::approve** で見つけることができます。

## <a name="typical-scenarios-and-patterns-that-use-a-custom-service"></a>カスタム サービスを使用する一般的なシナリオとパターン

カスタム サービスを使用する典型的なシナリオを次に示します。

### <a name="look-up-on-hand-inventory"></a>手持在庫の検索

エネルギー会社にはヒーターのインストール ジョブをスケジュールするフィールド作業者がいます。 この会社はバック オフィスとサード パーティのサービスとしてのソフトウェア (SaaS) のためにアプリケーションを使用して予定をスケジューリングします。 現場作業員が予定をスケジュールするときは、ジョブに使用できるインストール パーツがあることを確認するために、引当可能在庫数を検索する必要があります。

| 意思決定                    | 情報            |
|-----------------------------|------------------------|
| リアルタイムな日付が必要ですか。 | 有                    |
| ピーク データ量            | 時間当たり 1,000 レコード |
| 頻度                   | アドホック                 |

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、カスタム サービスを使用して実装できます。

Finance and Operations の場合:

- 特定のアイテムの現物手持在庫を計算するカスタム サービスを作成します。

スケジューリング アプリケーション:

- 選択した品目の在庫情報を取得するために、SOAP または REST を通じてカスタム サービス エンドポイントへのリアルタイムな呼び出しを行います。

> [!NOTE]
> このタイプのカスタム サービスの例は、Retail Real Time Services が実装された **RetailTransactionServiceInventory::inventoryLookup** で見つけることができます。

また、inventorySiteOnHand エンティティを使用して同じ結果を得ることができます。 場合によっては、複数のメソッドを使用して同じデータとビジネス ロジックを公開でき、すべてのメソッドが同じように有効になり効果を持ちます。 この場合、特定のシナリオを最適に機能して、開発者が最も使いやすいメソッドを選択します。

## <a name="typical-scenarios-and-patterns-that-use-batch-data-integrations"></a>バッチ データ統合を使用する一般的なシナリオとパターン

バッチ データ API を使用する典型的なシナリオを次に示します。

### <a name="import-large-volumes-of-sales-orders"></a>大量の販売注文のインポート

会社は、オンプレミスを実行するフロント エンド システムから大量の販売注文を受信します。 これらの注文は、定期的に処理、管理するためにアプリケーションに送信する必要があります。

| 意思決定                    | 情報                 |
|-----------------------------|-----------------------------|
| リアルタイムな日付が必要ですか。 | 無                          |
| ピーク データ量            | 時間当たり 200,000 レコード    |
| 頻度                   | 5 分間隔で 1 回 |

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、バッチ データ API を使用すると最もよく実装されます。

Finance and Operations の場合:

- 統合に必要なすべてのエンティティを決定します。
- エンティティに対してデータ管理が有効であることを確認します。

オンプレミスシステム:

- REST バッチ データ API を使用して、ファイルをインポートします。

### <a name="export-large-volumes-of-purchase-orders"></a>大量の発注書をエクスポート

会社は、Finance and Operations で大量の発注書を生成し、オンプレミス在庫管理システムを使用して製品を入庫します。 発注書は、Finance and Operations からオンプレミス インベントリ システムに移動する必要があります。

| 意思決定                    | 情報               |
|-----------------------------|---------------------------|
| リアルタイムな日付が必要ですか。 | 無                        |
| ピーク データ量            | 時間当たり 300,000 レコード  |
| 頻度                   | 1 時間あたり 1 回         |

#### <a name="recommended-solution"></a>推奨される解決策

このシナリオは、バッチ データ API を使用すると最もよく実装されます。

Finance and Operations の場合:

- 統合に必要なすべてのエンティティを決定します。
- エンティティに対してデータ管理が有効であることを確認します。
- 差分プッシュする必要がある場合は、エンティティの変更履歴を有効にできるかを確認します。

オンプレミス在庫システム:

- REST バッチ データ API を使用して、Finance and Operations からファイルをエクスポートし、在庫システムにインポートします。

## <a name="typical-scenarios-and-patterns-that-call-external-web-services"></a>外部の Web サービスを呼び出す一般的なシナリオとパターン

通常、アプリケーションはオンプレミスまたは別の SaaS プロバイダーによってホストされている外部 Web サービスを呼び出します。 この場合、アプリケーションは統合クライアントとして機能します。 統合クライアントを作成するときは、他のアプリケーションの統合クライアントを作成するときと同じベスト プラクティスおよびガイドラインのセットに従ってください。 単純な例として、 [外部 Web サービスの使用](consume-external-web-service.md) を参照してください。

> [!IMPORTANT]
> セキュリティ要件のため、運用およびサンドボックス環境では、トランスポート層セキュリティ (TLS) 1.2 以降を使用するセキュリティ保護された通信のみがサポートされます。 つまり、アプリケーションが呼び出すターゲットの Web サービス エンドポイントは、TLS 1.2 以降をサポートする必要があります。 ターゲット サービス エンドポイントがこの要件を満たしていない場合、呼び出しは失敗します。 例外エラー メッセージは、次のメッセージのようになります。
>
> *「転送接続からデータを読み取ることができません: 既存の接続がリモート ホストによって強制的に切断されました。」*
>
> TLS 1.2 またはそれ以降のバージョンを使用することが原因で対象サービスを変更できない場合は、次の図に示すように、ブローカー サービスを導入して 2 ホップ コールを行うことでこの問題を回避できます。
>
> ![TLS の要件](./media/integration-tls.png)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]