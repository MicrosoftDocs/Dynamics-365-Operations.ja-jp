---
title: 二重書き込み FAQ
description: このトピックでは、二重書き込みについてよく寄せられる質問に回答します。
author: robinarh
manager: AnnBe
ms.date: 07/21/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.custom: 21311
ms.assetid: ''
ms.search.region: Global
ms.author: rhaertle
ms.search.validFrom: 2020-07-21
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d3acfac5d953e773ed82a4894fcf956361d0b41b
ms.sourcegitcommit: 48cbc5b0dbbc8aaddd19ee36fb04834540c4781a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/03/2021
ms.locfileid: "5107822"
---
# <a name="dual-write-faq"></a><span data-ttu-id="caa2a-103">二重書き込み FAQ</span><span class="sxs-lookup"><span data-stu-id="caa2a-103">Dual-write FAQ</span></span>

[!include [banner](../../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

<span data-ttu-id="caa2a-104">このトピックでは、二重書き込みに関してよく寄せられる質問を取り上げ、必要な情報をすぐ得られるように簡単な回答を示します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-104">This topic lists frequently asked questions about dual-write and provides brief answers to help you quickly get the information that you require.</span></span>

## <a name="dual-write-setup"></a><span data-ttu-id="caa2a-105">二重書き込みの設定</span><span class="sxs-lookup"><span data-stu-id="caa2a-105">Dual-write setup</span></span>

### <a name="do-you-plan-to-enable-dual-write-to-use-dataverse-as-a-hub-between-multiple-finance-and-operations-environments-if-dataverse-is-used-as-a-hub-data-can-be-synced-between-two-or-more-finance-and-operations-environments"></a><span data-ttu-id="caa2a-106">Dataverse を、複数の Finance and Operations 環境間でハブとして使用できるように二重書き込みを有効にする予定はありますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-106">Do you plan to enable dual-write to use Dataverse as a hub between multiple Finance and Operations environments?</span></span> <span data-ttu-id="caa2a-107">Dataverse をハブとして使用すれば、2 つ以上の Finance and Operations 環境間でデータを同期することができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-107">If Dataverse is used as a hub, data can be synced between two or more Finance and Operations environments.</span></span>

<span data-ttu-id="caa2a-108">行の扱いに関する現在のプランでは、二重書き込みを単一の Finance and Operations 環境および単一の Dataverse 環境との間の 1 対 1 (1:1) のマッピングに制限しています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-108">The current plan of row is to restrict dual-write to a one-to-one (1:1) mapping between a single Finance and Operations environment and a single Dataverse environment.</span></span>

### <a name="can-i-control-the-sequencing-of-maps-in-dual-write-as-i-can-in-data-integrator"></a><span data-ttu-id="caa2a-109">データ インテグレーターのように、二重書き込みでマッピングの順序をコントロールすることはできますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-109">Can I control the sequencing of maps in dual-write, as I can in Data integrator?</span></span>

<span data-ttu-id="caa2a-110">二重書き込みはトランザクション ベースです。</span><span class="sxs-lookup"><span data-stu-id="caa2a-110">Dual-write is transaction-based.</span></span> <span data-ttu-id="caa2a-111">たとえば、Finance and Operations アプリの変更より、Dataverse で複数のマップの同期が実行される場合、既定では、それらの変更はデータベースで更新される順序で行われます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-111">For example, if a change in a Finance and Operations app triggers synchronization of multiple maps with Dataverse, by default, those changes will be sequenced in the order in which they are updated in the database.</span></span> <span data-ttu-id="caa2a-112">このパターンは、最初の同期のコンテキストでは、より有意義なものです。</span><span class="sxs-lookup"><span data-stu-id="caa2a-112">This pattern makes more sense in the context of initial synchronization.</span></span> <span data-ttu-id="caa2a-113">システムによって、関連するテーブル マップが指定された順序で提供されますが、環境に適したものにするよう、一覧の順序を変更することができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-113">The system provides related table maps in a specified order, and you can reorder the list so that it best suits your environment.</span></span>

### <a name="do-application-users-require-any-special-permissions-to-enable-or-configure-dual-write"></a><span data-ttu-id="caa2a-114">アプリケーション ユーザーは、二重書き込みを有効にしたり構成したりするために特別なアクセス許可を必要としていますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-114">Do application users require any special permissions to enable or configure dual-write?</span></span>

<span data-ttu-id="caa2a-115">Finance and Operations 環境に対して 2 つ の Azure Active Directory (Azure AD) アプリケーションが設定され、Dataverse 環境で 2 つのアプリケーション ユーザーが設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-115">You must have two Azure Active Directory (Azure AD) applications set up for the Finance and Operations environment and two application users set up in the Dataverse environment.</span></span> <span data-ttu-id="caa2a-116">これらのアプリケーション ユーザーには、適切なアプリケーション ID を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-116">These application users should contain the appropriate application IDs.</span></span> <span data-ttu-id="caa2a-117">正常に接続されるようにするため、アプリケーションに、セキュリティ ロールを使用して関連するテーブル アクセス許可を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-117">For the connection to work properly, you must give the applications the relevant table permissions by using a security role.</span></span> <span data-ttu-id="caa2a-118">詳細については、[要件を確認してアクセスを許可する](requirements-and-prerequisites.md#verify-requirements-and-grant-access) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-118">For more information, see [Verify requirements and grant access](requirements-and-prerequisites.md#verify-requirements-and-grant-access).</span></span>

### <a name="do-end-users-require-any-special-permissions-to-enable-or-configure-dual-write"></a><span data-ttu-id="caa2a-119">エンド ユーザーは、二重書き込みを有効にしたり構成したりするために特別なアクセス許可を必要としていますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-119">Do end users require any special permissions to enable or configure dual-write?</span></span>

<span data-ttu-id="caa2a-120">二重書き込みマッピングの構成を行っているエンド ユーザーは、Dataverse および Finance and Operations の両方の環境でシステム管理者セキュリティ ロールが割り当てられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-120">End users who are configuring dual-write mappings should have System Administrator security roles assigned in both Dataverse and Finance and Operations environments.</span></span>

<span data-ttu-id="caa2a-121">すべてのユーザーおよび環境が単一テナントに属し、ユーザーが必要なセキュリティおよびライセンスの割り当てを所有している限り、複数のユーザーが二重書き込みマッピングにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-121">Dual-write mappings can be accessed by multiple users, as long as all the users and environments belong to a single tenant, and the user has the required security and licenses assignment.</span></span>

### <a name="i-have-multiple-legal-entities-some-of-my-maps-are-legal-tablespecific-or-valid-for-only-some-of-the-legal-entities-what-is-the-best-way-to-address-this-requirement-can-i-apply-a-filter-such-as-company--usmf-to-address-it"></a><span data-ttu-id="caa2a-122">複数の法人を担当しています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-122">I have multiple legal entities.</span></span> <span data-ttu-id="caa2a-123">扱っているマップの中には、リーガル テーブルに特化しているもの、または一部の法人に対してのみ有効というものがあります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-123">Some of my maps are legal table–specific or valid for only some of the legal entities.</span></span> <span data-ttu-id="caa2a-124">この要件に対応する最善の方法は何でしょうか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-124">What is the best way to address this requirement?</span></span> <span data-ttu-id="caa2a-125">Company = USMF などのフィルタを適用して対応することはできますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-125">Can I apply a filter such as Company = USMF to address it?</span></span>

<span data-ttu-id="caa2a-126">Dataverse 環境がリンクされているなら、リーガル テーブル マッピングを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-126">Legal table mapping can be done when the Dataverse environment is linked.</span></span> <span data-ttu-id="caa2a-127">特定の法人にテーブル マップをマップすることはできません。</span><span class="sxs-lookup"><span data-stu-id="caa2a-127">You can't map table maps to a specific legal entity.</span></span>

### <a name="if-dual-write-solutions-are-installed-in-dataverse-can-i-uninstall-them"></a><span data-ttu-id="caa2a-128">Dataverse に二重書き込みソリューションがインストールされている場合、アンインストールすることはできますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-128">If dual-write solutions are installed in Dataverse, can I uninstall them?</span></span>

<span data-ttu-id="caa2a-129">二重書き込みソリューションは、アンインストール可能なマネージド ソリューションです。</span><span class="sxs-lookup"><span data-stu-id="caa2a-129">Dual-write solutions are managed solutions that can be uninstalled.</span></span> <span data-ttu-id="caa2a-130">ただし、マネージド ソリューションをアンインストールすると、ソリューション内のすべてのコンポーネントが削除されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-130">However, when a managed solution is uninstalled, all components in the solution are deleted.</span></span> <span data-ttu-id="caa2a-131">コンポーネントに格納されているデータも削除されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-131">Any data that is stored in the components is also deleted.</span></span> <span data-ttu-id="caa2a-132">詳細については、[管理ソリューションの保守](https://docs.microsoft.com/powerapps/developer/common-data-service/maintain-managed-solutions) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-132">For more information, see [Maintain managed solutions](https://docs.microsoft.com/powerapps/developer/common-data-service/maintain-managed-solutions).</span></span>

### <a name="i-have-data-in-both-a-customer-engagement-app-and-a-finance-and-operations-app-and-i-bootstrap-my-existing-data-in-the-customer-engagement-app-if-my-data-isnt-currently-aligned-can-i-specify-a-master-source-for-the-initialization-run-so-that-all-differences-are-applied-to-the-target"></a><span data-ttu-id="caa2a-133">Customer Engagement アプリと Finance and Operations アプリの両方にデータを保持しており、Customer Engagement アプリで既存のデータをブートストラップしています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-133">I have data in both a customer engagement app and a Finance and Operations app, and I bootstrap my existing data in the customer engagement app.</span></span> <span data-ttu-id="caa2a-134">現在データが配置されていない場合は、初期化実行でマスタ ソースを指定して、すべての差異がターゲットに適用されるようにすることができますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-134">If my data isn't currently aligned, can I specify a master source for the initialization run, so that all differences are applied to the target?</span></span>

<span data-ttu-id="caa2a-135">ブートストラップが完了したら、差異を適用してマスタを選択するように、初期同期の設定を構成することができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-135">After the bootstrapping is done, you can configure the initial synchronization to apply differences and select a master.</span></span> <span data-ttu-id="caa2a-136">ブートストラップの詳細については、[社内データを含むブートストラップに関するよく寄せられる質問](bootstrap-company-data.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-136">For more information about bootstrapping, see [Bootstrap with company data FAQ](bootstrap-company-data.md).</span></span> <span data-ttu-id="caa2a-137">初期同期の詳細については、[テーブル マップの二重書き込みの有効化](enable-entity-map.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-137">For more information about the initial synchronization, see [Enable table maps for dual-write](enable-entity-map.md).</span></span>

## <a name="dual-write-administration-and-management"></a><span data-ttu-id="caa2a-138">二重書き込みの管理</span><span class="sxs-lookup"><span data-stu-id="caa2a-138">Dual-write administration and management</span></span>

### <a name="what-is-the-purpose-of-the-integration-key-and-is-it-mandatory"></a><span data-ttu-id="caa2a-139">統合キーの目的は何ですか。これは必須ですか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-139">What is the purpose of the integration key, and is it mandatory?</span></span>

<span data-ttu-id="caa2a-140">統合キーは、行を一意に識別するナチュラル キーです。</span><span class="sxs-lookup"><span data-stu-id="caa2a-140">The integration key is the natural key that uniquely identifies rows.</span></span> <span data-ttu-id="caa2a-141">統合キーは、Dataverse テーブルに対してのみ必要です。</span><span class="sxs-lookup"><span data-stu-id="caa2a-141">Integration keys are required only for Dataverse tables.</span></span> <span data-ttu-id="caa2a-142">二重書き込みで統合キーを手動作成できます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-142">You can manually create an integration key in dual-write.</span></span> <span data-ttu-id="caa2a-143">テーブルに対して代替キーが既に提供されている場合は、テーブルの代替キーから自動的に統合キーを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-143">An integration key can also be automatically created from the table's alternate keys, if an alternate key is already provided for the table.</span></span> <span data-ttu-id="caa2a-144">統合キーは、代替キーと同じ目的で使用されます。これにより、データを外部システムと統合するための効率的かつ正確な方法が提供されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-144">Integration keys are used for the same purpose as alternate keys: they provide an efficient and accurate way to integrate data with external systems.</span></span> <span data-ttu-id="caa2a-145">統合キーは、Dataverse の行を一意に識別するグローバル一意識別子 (GUID) が外部システムに格納されていない場合に必須です。</span><span class="sxs-lookup"><span data-stu-id="caa2a-145">Integration keys are essential in cases where an external system doesn't store the globally unique identifiers (GUIDs) that uniquely identify rows in Dataverse.</span></span>

<span data-ttu-id="caa2a-146">二重書き込みでは、統合キーを使用して、固有の組み合わせを表す 1 つ以上のテーブル列の値を使用して、行を一意に識別します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-146">Dual-write uses integration keys to uniquely identify rows, by using one or more table column values that represent a unique combination.</span></span> <span data-ttu-id="caa2a-147">たとえば、統合キーを使用して勘定行を識別するには、勘定番号列を使用できます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-147">For example, to identify an account row by using an integration key, you can use the account number column.</span></span> <span data-ttu-id="caa2a-148">別の方法として、勘定番号列を、変更すべきではない値を持つ他の列と共に使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-148">Alternatively, you can use the account number column together with other columns that have values that should not change.</span></span> <span data-ttu-id="caa2a-149">詳細については、[Power Apps ポータルを使用した代替キーの定義](https://docs.microsoft.com/powerapps/maker/common-data-service/define-alternate-keys-portal) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-149">For more information, see [Define alternate keys using Power Apps portal](https://docs.microsoft.com/powerapps/maker/common-data-service/define-alternate-keys-portal).</span></span>

<span data-ttu-id="caa2a-150">キーが Finance and Operations 環境と Dataverse 環境との間で一致していることは重要です。</span><span class="sxs-lookup"><span data-stu-id="caa2a-150">It's important that keys be matched between the Finance and Operations environment and the Dataverse environment.</span></span> <span data-ttu-id="caa2a-151">そうでない場合、初期同期フェーズで問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-151">Otherwise, issues might occur during the initial synchronization phase.</span></span>

### <a name="how-do-i-move-table-maps-between-environments-is-version-control-supported-for-table-maps"></a><span data-ttu-id="caa2a-152">環境間でテーブル マップを移動するにはどうすればよいですか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-152">How do I move table maps between environments?</span></span> <span data-ttu-id="caa2a-153">テーブル マップではバージョン管理がサポートされていますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-153">Is version control supported for table maps?</span></span>

<span data-ttu-id="caa2a-154">マップをエクスポートして、別の環境にインポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-154">You can export maps and then import them into a different environment.</span></span> <span data-ttu-id="caa2a-155">Azure DevOps を使用してプロセスを自動化することができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-155">You can automate the process by using Azure DevOps.</span></span> <span data-ttu-id="caa2a-156">マッピングはソリューションに対応しているコンポーネントなので、二重書き込みマッピングに対してバージョン管理を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-156">You can have version control on your dual-write mappings, because the mappings are solution-aware components.</span></span> <span data-ttu-id="caa2a-157">詳細については、[テーブル マップを更新し、ソリューションとして他の環境にエクスポートする](app-lifecycle-management.md#update-table-maps) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-157">For more information, see [Update table maps and export them to other environments as a solution](app-lifecycle-management.md#update-table-maps).</span></span>

### <a name="where-can-i-find-examples-and-patterns-for-filtering-dual-write-maps"></a><span data-ttu-id="caa2a-158">二重書き込みマップをフィルタリングするための例とパターンはどこにありますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-158">Where can I find examples and patterns for filtering dual-write maps?</span></span>

<span data-ttu-id="caa2a-159">基本的なフィルタ処理の例については、[データのフィルター処理](customizing-mappings.md#filter-your-data) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-159">For basic filtering examples, see [Filter your data](customizing-mappings.md#filter-your-data).</span></span>

<span data-ttu-id="caa2a-160">Dataverse での詳細な例については、[結果のフィルター](https://docs.microsoft.com/powerapps/developer/common-data-service/webapi/query-data-web-api#filter-results) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-160">For more advanced examples for Dataverse, see [Filter results](https://docs.microsoft.com/powerapps/developer/common-data-service/webapi/query-data-web-api#filter-results).</span></span> <span data-ttu-id="caa2a-161">二重書き込みソースフィルターでは、ネストしたルックアップはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="caa2a-161">Nested lookup isn't supported in dual-write source filters.</span></span> <span data-ttu-id="caa2a-162">テーブル列に対して直接、[標準のフィルタ演算子](https://docs.microsoft.com/powerapps/developer/common-data-service/webapi/query-data-web-api#standard-filter-operators)のみがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-162">Only [standard filter operators](https://docs.microsoft.com/powerapps/developer/common-data-service/webapi/query-data-web-api#standard-filter-operators) directly against table columns are supported.</span></span>

<span data-ttu-id="caa2a-163">Finance and Operations のフィルターの詳細については、[クエリ範囲での式の使用](https://docs.microsoft.com/dynamicsax-2012/developer/using-expressions-in-query-ranges)、および[高度なフィルター処理とクエリ構文](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/get-started/advanced-filtering-query-options) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-163">For more advanced Finance and Operations filters, see [Using Expressions in Query Ranges](https://docs.microsoft.com/dynamicsax-2012/developer/using-expressions-in-query-ranges) and [Advanced filtering and query syntax](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/get-started/advanced-filtering-query-options).</span></span>

### <a name="dual-write-live-synchronization-introduces-tight-coupling-across-applications-what-happens-if-one-side-fails-will-the-other-side-fail-too"></a><span data-ttu-id="caa2a-164">二重書き込みライブ同期では、アプリケーション間に緊密な結合が導入されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-164">Dual-write live synchronization introduces tight coupling across applications.</span></span> <span data-ttu-id="caa2a-165">1 つの側に障害が発生した場合はどうなりますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-165">What happens if one side fails?</span></span> <span data-ttu-id="caa2a-166">他方の側でも障害が発生するでしょうか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-166">Will the other side fail too?</span></span>

<span data-ttu-id="caa2a-167">統合がライブ同期モードの場合、いずれかのアプリケーションで同期が失敗すると、他のアプリケーションも失敗し、ユーザーにエラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-167">When the integration is in live sync mode, if the sync fails on one of the apps, then the other app will fail as well and users will receive an error.</span></span> <span data-ttu-id="caa2a-168">統合が一時停止すると、変更がステージングされます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-168">When the integration is paused, changes are staged.</span></span> <span data-ttu-id="caa2a-169">その後、ターゲット システムが起動して実行されるときに、これらが書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-169">They are then written when the target system is up and running.</span></span> <span data-ttu-id="caa2a-170">統合を自動的に一時停止する方法の詳細については、[警告の通知](errors-and-alerts.md#alert-notifications) を参照してください</span><span class="sxs-lookup"><span data-stu-id="caa2a-170">For more information about how to automatically pause integrations, see [Alert notifications](errors-and-alerts.md#alert-notifications)</span></span>

### <a name="when-live-synchronization-is-paused-and-then-resumed-does-it-follow-the-sequence-of-changes-for-example-if-the-name-column-in-the-finance-and-operations-app-is-changed-from-namea-to-nameb-to-namec-is-customer-engagement-data-changed-from-namea-to-nameb-to-namec-or-is-it-changed-directly-from-namea-to-namec"></a><span data-ttu-id="caa2a-171">ライブ同期が一時停止後に再開された場合、変更の順序に従いますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-171">When live synchronization is paused and then resumed, does it follow the sequence of changes?</span></span> <span data-ttu-id="caa2a-172">たとえば、Finance and Operations アプリの名前列が NameA から NameB、次いで NameC に変更された場合、Customer Engagement のデータは NameA から NameB、次いで NameC に変更されますか? それとも、NameA から NameC に直接変更されますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-172">For example, if the Name column in the Finance and Operations app is changed from NameA to NameB to NameC, is customer engagement data changed from NameA to NameB to NameC, or is it changed directly from NameA to NameC?</span></span>

<span data-ttu-id="caa2a-173">統合は、変更の順序を完全に反映します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-173">The integration follows the complete sequence of changes.</span></span> <span data-ttu-id="caa2a-174">この例では、Customer Engagement アプリのデータは、**NameA** から **NameB** に、次いで、**NameC** に変更されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-174">In the example, the customer engagement app data is changed from **NameA** to **NameB** to **NameC**.</span></span>

### <a name="how-do-i-handle-a-finance-and-operations-database-transfer-from-prod-to-stage-what-is-the-effect-on-dual-write-after-the-transfer-the-systems-are-no-longer-in-sync-is-the-synchronization-done-automatically"></a><span data-ttu-id="caa2a-175">PROD から STAGE への Finance and Operations データベースの転送をどのように処理したらよいですか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-175">How do I handle a Finance and Operations database transfer from PROD to STAGE?</span></span> <span data-ttu-id="caa2a-176">二重書き込みはどんな影響がありますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-176">What is the effect on dual-write?</span></span> <span data-ttu-id="caa2a-177">転送後、システムの同期は解除されますが、同期は自動的に行われますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-177">After the transfer, the systems are no longer in sync. Is the synchronization done automatically?</span></span>

<span data-ttu-id="caa2a-178">リンクされた各環境ペア (Finance and Operations アプリ環境と Dataverse 環境) は、単一の単位として処理され、それに応じて更新される必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-178">Each linked environment-pair (Finance and Operations apps environment and Dataverse environment) should be treated as a single unit and refreshed accordingly.</span></span> <span data-ttu-id="caa2a-179">たとえば、実稼働環境からサンドボックスを更新する場合、Finance and Operations アプリのサンドボックス環境と Dataverse のサンドボックス環境の両方を、それに対応する実稼働環境から更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-179">For example, if you are refreshing a sandbox from production, then both Finance and Operations app sandbox environment and the Dataverse sandbox environment should be refreshed from their production counterparts.</span></span> <span data-ttu-id="caa2a-180">二重書き込みがターゲット環境で既に使用されている場合は、それらの環境のリンクを解除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-180">If dual-write is already used in target environments, those environments need to be unlinked.</span></span> <span data-ttu-id="caa2a-181">ターゲット環境でデータを更新した後、次のテーブルをクリーンアップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-181">After the data refresh on target environments, these tables should be cleaned up:</span></span>

+ <span data-ttu-id="caa2a-182">Finance and Operations アプリ テーブル: **DualWriteProjectConfiguration**、**DualWriteProjectFieldConfiguration**、および **BusinessEventsDefinition**。</span><span class="sxs-lookup"><span data-stu-id="caa2a-182">Finance and Operations apps tables: **DualWriteProjectConfiguration**, **DualWriteProjectFieldConfiguration**, and **BusinessEventsDefinition**.</span></span> 
+ <span data-ttu-id="caa2a-183">Dataverse テーブル: **DualwriteRuntimeConfiguration**。</span><span class="sxs-lookup"><span data-stu-id="caa2a-183">Dataverse tables: **DualwriteRuntimeConfiguration**.</span></span> 

<span data-ttu-id="caa2a-184">環境を再びリンクし、手動でマップを再有効化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-184">The environments need to be relinked and maps reactivated manually.</span></span>

### <a name="i-need-real-time-integration-and-i-want-to-move-some-tables-or-scenarios-from-data-integrator-to-dual-write-how-do-i-migrate-and-what-are-the-implications-of-changing-my-integration-pattern"></a><span data-ttu-id="caa2a-185">リアルタイム統合が必要なので、一部のテーブルまたはシナリオをデータ インテグレーターから二重書き込みに移動したいと考えています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-185">I need real-time integration, and I want to move some tables or scenarios from Data integrator to dual-write.</span></span> <span data-ttu-id="caa2a-186">移行の方法と、統合パターンを変更した場合の影響について教えてください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-186">How do I migrate, and what are the implications of changing my integration pattern?</span></span>

<span data-ttu-id="caa2a-187">Prospect to Cash を二重書き込みに移行する方法の詳細については、[データ インテグレーターから二重書き込みへのデータの移行](https://www.yammer.com/dynamicsaxfeedbackprograms/#/files/433337729024) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-187">For information about how to migrate Prospect to cash to dual-write, see [Migrating data from Data Integrator to Dual Write](https://www.yammer.com/dynamicsaxfeedbackprograms/#/files/433337729024).</span></span> <span data-ttu-id="caa2a-188">一般に、移行中に変更される可能性があるものを 3 つ挙げておきます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-188">In general, three things might change during migration:</span></span>

+ <span data-ttu-id="caa2a-189">データ インテグレーターから二重書き込みへのマップの手動移行</span><span class="sxs-lookup"><span data-stu-id="caa2a-189">Manual migration of the maps from Data integrator to dual-write</span></span>
+ <span data-ttu-id="caa2a-190">高度なクエリ機能がないため、テーブルを変更</span><span class="sxs-lookup"><span data-stu-id="caa2a-190">Table changes, because of the absence of advanced query capabilities</span></span>
+ <span data-ttu-id="caa2a-191">会社のストライピングなどの新しい概念に適合するためのデータ移行</span><span class="sxs-lookup"><span data-stu-id="caa2a-191">Data migration, because of adaptation to new concepts such as company striping</span></span>

### <a name="on-finance-and-operations-data-tables-can-i-develop-unbounded-columns-that-flow-to-dataverse-by-using-dual-write"></a><span data-ttu-id="caa2a-192">Finance and Operations データ テーブルでは、二重書き込みを使用して Dataverse にフローするバインドされない列を開発することはできますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-192">On Finance and Operations data tables, can I develop unbounded columns that flow to Dataverse by using dual-write?</span></span>

<span data-ttu-id="caa2a-193">はい。</span><span class="sxs-lookup"><span data-stu-id="caa2a-193">Yes.</span></span> <span data-ttu-id="caa2a-194">[計算列と仮想列](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/data-entities/data-entity-computed-columns-virtual-columns)の両方を使用できます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-194">You can use both [computed columns and virtual columns](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/data-entities/data-entity-computed-columns-virtual-columns).</span></span> <span data-ttu-id="caa2a-195">ただし、読み取りと書き込みに必要な追加のX++ ロジックを使用して、パフォーマンスのオーバーヘッドを監視する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-195">However, you should monitor the performance overhead from the additional X++ logic that is required for reads and writes.</span></span> <span data-ttu-id="caa2a-196">同じトランザクション内でのラウンド トリップは許可されません。</span><span class="sxs-lookup"><span data-stu-id="caa2a-196">Round-tripping within the same transaction isn't allowed.</span></span> <span data-ttu-id="caa2a-197">したがって、X++ を使用して追加の値を変換または計算するために仮想列を使用することは避け、それが同じトランザクション内の Dataverse に戻ることを予期してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-197">Therefore, you should avoid using virtual columns to transform or calculate additional values through X++ and expect that to go back to Dataverse within the same transaction.</span></span>

### <a name="when-i-use-the-dataverse-offline-app-what-happens-if-i-cant-sync-the-data-after-reconnection-does-this-situation-cause-an-inconsistent-state-between-the-dataverse-environment-and-the-finance-and-operations-environment"></a><span data-ttu-id="caa2a-198">Dataverse オフライン アプリを使用して、再接続後にデータを同期できない場合はどうなりますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-198">When I use the Dataverse offline app, what happens if I can't sync the data after reconnection?</span></span> <span data-ttu-id="caa2a-199">この状況により、Dataverse 環境と Finance and Operations 環境との間で状態が矛盾することになりますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-199">Does this situation cause an inconsistent state between the Dataverse environment and the Finance and Operations environment?</span></span>

<span data-ttu-id="caa2a-200">[電話用 Dynamics 365 アプリ](https://docs.microsoft.com/dynamics365/mobile-app/install-dynamics-365-for-phones-and-tablets)、または [Field Service Mobile アプリ](https://docs.microsoft.com/dynamics365/field-service/field-service-mobile-overview) をオフライン モードで使用すると、Dataverse データをオフラインで操作できます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-200">You can interact with Dataverse data offline when using the [Dynamics 365 for phones app](https://docs.microsoft.com/dynamics365/mobile-app/install-dynamics-365-for-phones-and-tablets) or the [Field Service Mobile app](https://docs.microsoft.com/dynamics365/field-service/field-service-mobile-overview) in offline mode.</span></span> <span data-ttu-id="caa2a-201">両方のアプリで、データはオフラインで保存され、お客様の裁量で、サーバーとの同期を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-201">In both apps, data is stored offline and can be synced with the server at your discretion.</span></span> <span data-ttu-id="caa2a-202">オフライン データとサーバーの同期中にエラーが発生し、他の環境が失敗しているために更新ができない場合、データ同期は失敗し、Dataverse は更新されません。</span><span class="sxs-lookup"><span data-stu-id="caa2a-202">If there are errors when the offline data is synced with the server, and updates can't be done because the other environment is failing, data sync will fail, and Dataverse will not be updated.</span></span> <span data-ttu-id="caa2a-203">統合が一時停止したときに、同期を再度実行して、サーバーに更新データを保存することができます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-203">When the integration is paused, you can re-run the sync and save your updates on the server.</span></span> <span data-ttu-id="caa2a-204">これらの変更はステージングされ、マッピングが再度実行されるときに Finance and Operations 環境に同期されます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-204">These changes will be staged and then synced with the Finance and Operations environment when the mapping is up and running again.</span></span> <span data-ttu-id="caa2a-205">詳細については、[Power Apps Mobile でモデル駆動型アプリおよびキャンバス アプリを実行する](https://docs.microsoft.com/powerapps/mobile/run-powerapps-on-mobile)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-205">For more information, see [Run model-driven apps and canvas apps on Power Apps mobile](https://docs.microsoft.com/powerapps/mobile/run-powerapps-on-mobile).</span></span>

## <a name="mapping-concepts-between-apps"></a><span data-ttu-id="caa2a-206">アプリ間の概念のマッピング</span><span class="sxs-lookup"><span data-stu-id="caa2a-206">Mapping concepts between apps</span></span>

### <a name="how-are-number-sequences-handled-for-example-the-customer-account-number-is-automatically-generated-in-finance-and-operations-apps-but-its-added-manually-in-customer-engagement-apps"></a><span data-ttu-id="caa2a-207">番号順序はどのように処理されますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-207">How are number sequences handled?</span></span> <span data-ttu-id="caa2a-208">たとえば、顧客アカウント番号は Finance and Operations アプリで自動的に生成されますが、Customer Engagement アプリでは手動で追加されています。</span><span class="sxs-lookup"><span data-stu-id="caa2a-208">For example, the customer account number is automatically generated in Finance and Operations apps, but it's added manually in customer engagement apps.</span></span>

<span data-ttu-id="caa2a-209">Finance and Operations アプリと Customer Engagement アプリの番号順序は関連付けられていません。</span><span class="sxs-lookup"><span data-stu-id="caa2a-209">Number sequences for Finance and Operations apps and customer engagement apps aren't connected.</span></span> <span data-ttu-id="caa2a-210">複数のマスター テーブルが含まれるシナリオでは、別々の番号順序の形式を設計するか、各アプリケーションの範囲を定める必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-210">In a scenario that involves a multi-mastered table, you must either plan for separate number sequence formats or create a range for each app.</span></span> <span data-ttu-id="caa2a-211">次にいくつか例を挙げます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-211">Here are some examples:</span></span>

+ <span data-ttu-id="caa2a-212">Finance and Operationsアプリでは、**F0001、F0002、F0003** を使用します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-212">In the Finance and Operations app, use **F0001, F0002, F0003**.</span></span> <span data-ttu-id="caa2a-213">Customer Engagement アプリでは、**C0001、C0002、C0003** を使用します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-213">In the customer engagement app, use **C0001, C0002, C0003**.</span></span>
+ <span data-ttu-id="caa2a-214">Finance and Operations アプリでは、**US0001 から US4999 まで** を使用します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-214">In the Finance and Operations app, use **US0001 to US4999**.</span></span> <span data-ttu-id="caa2a-215">Customer Engagement アプリでは、**US5000 から US9999 まで** を使用します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-215">In the customer engagement app, use **US5000 to US9999**.</span></span>

<span data-ttu-id="caa2a-216">テーブルが単一のシステムで作成された場合は、ソース アプリに対してのみ番号順序を設定します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-216">If a table is created in only one system, set up the number sequence in the source app only.</span></span> <span data-ttu-id="caa2a-217">詳細については、[自動付番列](https://docs.microsoft.com/powerapps/maker/common-data-service/autonumber-columns)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-217">For more information, see [Autonumber columns](https://docs.microsoft.com/powerapps/maker/common-data-service/autonumber-columns).</span></span>

### <a name="can-i-map-a-company-specific-table-in-a-customer-engagement-app-with-a-global-table-in-a-finance-and-operations-app-or-a-global-table-in-a-customer-engagement-app-with-a-company-specific-table-in-a-finance-and-operations-app"></a><span data-ttu-id="caa2a-218">Customer Engagement アプリの会社固有のテーブルを Finance and Operations アプリのグローバル テーブルに、または Customer Engagement アプリのグローバル テーブルを Finance and Operations アプリの会社固有のテーブルにマップすることはできますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-218">Can I map a company-specific table in a customer engagement app with a global table in a Finance and Operations app, or a global table in a customer engagement app with a company-specific table in a Finance and Operations app?</span></span>

<span data-ttu-id="caa2a-219">二重書き込みでは、会社間のテーブル、または会社固有のテーブルのみ、両側からのマッピングがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="caa2a-219">Dual-write supports mappings only between cross-company tables or company-specific tables from both sides.</span></span>

### <a name="how-do-i-make-a-company-specific-table-in-dataverse"></a><span data-ttu-id="caa2a-220">どのように Dataverse の会社固有のテーブルを作成しますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-220">How do I make a company-specific table in Dataverse?</span></span>

<span data-ttu-id="caa2a-221">Dataverse の会社固有のカスタム テーブルを作成するには、カスタム テーブルと標準の会社テーブルとの間に多対一 (N:1) の関係を追加します。</span><span class="sxs-lookup"><span data-stu-id="caa2a-221">You can make Dataverse custom tables company-specific by adding a many-to-one (N:1) relationship between your custom tables and the out-of-box company table.</span></span> <span data-ttu-id="caa2a-222">また、テーブル キーの一部として会社の外部キーを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-222">You should also include the company foreign key as part of the table key.</span></span> <span data-ttu-id="caa2a-223">詳細については、[Dataverse の企業概念](company-data.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-223">For more information, see [Company concept in Dataverse](company-data.md).</span></span>

<span data-ttu-id="caa2a-224">テーブル マップの二重書き込みを有効にするには、Dataverse で代替キーを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-224">To enable table maps for dual-write, you must define an alternate key in Dataverse.</span></span> <span data-ttu-id="caa2a-225">Dataverse の代替キーの値は、Finance and Operations アプリで定義されているキーと一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="caa2a-225">The value of the alternative key in Dataverse must match the key that is defined in the Finance and Operations app.</span></span> <span data-ttu-id="caa2a-226">詳細については、[テーブルをリンクするための基準](enable-entity-map.md#criteria-for-linking) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-226">For more information, see [Criteria for linking tables](enable-entity-map.md#criteria-for-linking).</span></span>

### <a name="is-there-a-document-about-best-practices-for-table-usage-should-i-use-customers-v2-customers-v3-or-customer-details-what-is-the-difference-between-these-tables-and-what-is-the-use-case-for-each"></a><span data-ttu-id="caa2a-227">テーブルの使用方法に関するベスト プラクティスについてのドキュメントがありますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-227">Is there a document about best practices for table usage?</span></span> <span data-ttu-id="caa2a-228">顧客 V2、顧客 V3、または顧客の詳細を使用する必要がありますか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-228">Should I use Customers V2, Customers V3, or Customer Details?</span></span> <span data-ttu-id="caa2a-229">これらのテーブルの違いは何ですか、またそれぞれのユース ケースはどのようなものですか?</span><span class="sxs-lookup"><span data-stu-id="caa2a-229">What is the difference between these tables, and what is the use case for each?</span></span>

<span data-ttu-id="caa2a-230">可能であれば、顧客や仕入先の統合などの一般的なシナリオをカバーしている[標準のシナリオ](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/data-entities/dual-write/customer-mapping)を使用してください。</span><span class="sxs-lookup"><span data-stu-id="caa2a-230">You should use the [out-of-box scenarios](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/data-entities/dual-write/customer-mapping) if you can, because they cover common scenarios such as customer/vendor integration.</span></span>
