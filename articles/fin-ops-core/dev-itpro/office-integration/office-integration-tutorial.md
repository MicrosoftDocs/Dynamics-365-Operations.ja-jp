---
title: Office 統合のチュートリアル
description: このチュートリアルでは、Excel、Word、ドキュメント管理および電子メールが関係する Office 統合エクスペリエンスを使用して構築します。
author: jasongre
ms.date: 05/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Developer
ms.reviewer: sericks
ms.custom: 10884
ms.assetid: 65fb607a-58e4-4800-81b5-6058acb003cb
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d7ac7dec71d4c20c40c42716c6bb12562ad425d9c6bbbc1bb9e093a8bb2d220d
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "6742290"
---
# <a name="office-integration-tutorial"></a>Office 統合のチュートリアル

[!include [applies to](../includes/applies-to-commerce-finance-hr-scm.md)]

[!include [banner](../includes/banner.md)]

このチュートリアルでは、Excel、Word、ドキュメント管理および電子メールが関係する Office 統合エクスペリエンスを使用して構築します。 

## <a name="overview"></a>概要

このチュートリアルでは、Microsoft Excel、Microsoft Word、Finance and Operations アプリのドキュメント管理機能、および電子メールが関係する Microsoft Office 統合エクスペリエンスを使用して構築します。 Excel と Word がデータ エンティティをシステムへのエントリ ポイントとして使用する方法、Excel がユーザー エクスペリエンスの中核になれる方法、Excel と Word を一時的な簡易レポートとして使用できる方法を確認します。 ドキュメント管理機能と電子メール機能を使用してファイルを格納および共有する方法も表示されます。

## <a name="key-concepts"></a>重要な概念
-   **エンティティと OData** - Microsoft Dynamics Excel データ コネクタ アプリ (Excel App) を使用して、作成、読み取り、更新、および削除を行います。 コネクタは、デフォルト状態の「public」(**DataEntity.Public**=**Yes**) のまま残されているエンティティに対して作成された OData サービスを使用します。
-   **Office 用アプリ** - Excel アプリケーションは、Office 用アプリ フレームワーク (Office Web API とも呼ばれます) を使用して作成されます。 Excel アプリは Web ベースのため、クライアントと技術を共有し、オンプレミス Excel インスタンスおよび Microsoft Excel Online (Microsoft 365) の両方の中で実行されます。 アプリは、作業ウィンドウの Excel の内部で実行されます。
-   **Microsoft Office 2016** – Excel アプリと Word アプリは、Office 2016 で導入された Apps for Office フレームワークの進歩を利用します。 したがって、Excel および Word の各アプリケーションを実行するには Office 2016 が必要です。
-   **認証** - Excel と Word アプリは、Excel と Word 内のブラウザー ウィンドウで実行されます。 コンフィギュレーションに使用されるブラウザーに関する詳細については、[Office アドインで使用されるブラウザー](/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins)を参照してください。ユーザーが Microsoft Edge の InPrivate 閲覧セッションや Google Chrome などの異なるブラウザーでクライアントを実行している場合でも指定されたブラウザーが使用されます。 認証は OAuth によって促進され、ユーザーはアプリ内でアカウントを選択してサインインすることができます。 ブラウザーは最初にユーザーを自動的にサインインさせようとするため、正しいユーザーとしてサインインしていない場合や、サインインに問題がある場合は、サインアウト リンクを使用して、強制的にアプリからログアウトする必要がある場合があります。 サインアウト後、再度アプリにサインインしてください。
-   **Excel アプリ** - Excel アプリは、更新を促進し、データ操作を公開することに加えて、ソースとフィールド情報、ルックアップ、フィルタリング、エラーメッセージ、エンティティデータソースからフィールド、テーブル列、またはラベルを追加または削除するためのデザイン エクスペリエンスも提供します。

## <a name="setup"></a>段取り
### <a name="load-the-fleet-data-set"></a>フリート データセットの読み込み

チュートリアル中に、Fleet Management モデルのフォーム、エンティティ、およびデータを主に使用します。 そのため、Fleet データ セットを最初にロードする必要があります。

1.  **フリート管理** &gt; **設定** &gt; **フリート** **設定** に移動します。
2.  **作成** を選択します。

## <a name="static-export-to-excel-experiences"></a>Excel への静的エクスポート エクスペリエンス
### <a name="static-export-to-excel"></a>Excel への静的エクスポート

Excel への静的エクスポートは、ページのグリッドにデータを取得するための簡単なメカニズムを提供します。 Excel へのエクスポートを開始するための標準的なメカニズムは、**Microsoft Office** で **開く** メニューです。 Excel への静的エクスポートも、グリッドのショートカット メニューから使用できます。

1.  **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
2.  **Microsoft Office** で **開く** &gt; **Excel にエクスポート** &gt; **顧客** の順に選択します。
3.  生成されたブックをダウンロードして開きます。 ブックの列がグリッドの列と一致することに注意してください。
4.  [すべて選択] チェック マークの下の行の左端をクリックして、最初の 2 行を選択 ("マーク") します。
5.  ショートカット メニューを表示するためにグリッド ヘッダーを右クリックします。 **すべての行をエクスポート** および **マークした行をエクスポート** の両方がコマンドとして使用できることに注意してください。
6.  **マークした行をエクスポート** を選択します。 ブック内の列はグリッド内の列と一致しており、エクスポートされる行はマークされた行と一致することに注意してください。

### <a name="modify-the-static-export-to-excel-experience"></a>静的な Excel へのエクスポート エクスペリエンスの変更

グリッドに Excel メカニズムへの静的エクスポートを非表示にするか、**Microsoft Office** メニューの **開く** に表示されるラベルを変更することができます。

1.  Visual Studio を起動します。 管理者として実行していることを確認します。
2.  **表示** &gt; **アプリケーション エクスプローラー** の順に選択します (または Ctrl + E、Ctrl + E を押します)。
3.  **AOT** &gt; **ユーザー インターフェイス** &gt; **フォーム** &gt; **FMCustomer** に移動します。
4.  **FMCustomer** を右クリックし、**新しいプロジェクトに追加** をクリックします。
5.  ソリューション エクスプローラーで、**FMCustomer** フォームをダブルクリックしてデザイナー ビューを開きます。
6.  **FMCustomerDesignTab(Tab)TabPageGrid(TabPage)MainGrid(Grid)** を選択します。
7.  **プロパティ** ウィンドウで、**エクスポート ラベル** プロパティを検索します。
8.  **エクスポート ラベル** プロパティを **フリート顧客** に設定します。
9.  フォームを保存します。 既存のフォームを上書きするか、新しいフォームとしてそれを保存するかを尋ねられたら、**上書き** をクリックします。
10. ソリューションをビルドします (Ctrl + Shift + B キーを押します)。
11. ブラウザーで、**フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
12. **Microsoft Office で開く** を選択します。 **顧客** オプションが **フリート顧客** に変更されることに注意してください。

## <a name="generated-open-in-excel-experiences"></a>生成された Excel で開くエクスペリエンス
### <a name="generated-open-in-excel"></a>生成された Excel で開く

生成された Excel で開くオプションは、フォームとして同じルート データ ソースを持つデータ エンティティをシステムが検出するときに、自動的にフォームに追加されます。 生成されたワークブックには、そのエンティティからのデータがロードされる単一のテーブルデータ ソースが含まれます。 Excel で開くエクスペリエンスは、**Microsoft Office** で **開く** メニューにリストされます。 (エンティティがフォームと同じルート データ ソースを持っている場合は、**Microsoft Office で開く** メニューの **Excel で開く** セクションでオプションとして追加されます。 このオプションは「生成済み」オプションと呼ばれます。

1.  **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
2.  **Microsoft Office** で **開く** &gt; **Excel で開く** &gt; **フリート管理の顧客 (フィルター処理なし)** の順に選択します。
3.  生成されたブックをダウンロードして開きます。 このブックには、**フリート管理顧客** エンティティへのバインドである Excel データ コネクタ アプリと、ブックを生成したサーバーへのポインタが含まれます。
4.  **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みを行えるようになります。 顧客データは、サーバー上の OData サービスから読み取られ、テーブルに追加されます。
5.  ブラウザー上の **顧客** ページで、**編集** をクリックして (または F2 キーを押して)、いずれかの顧客の電子メール アドレスを変更します。
6.  Excel アプリで、**更新** をクリックします。 Excel に新しい電子メール アドレスが表示されることに注意してください。
7.  Excel で、いずれかの顧客の電子メール アドレスを変更します。
8.  Excel アプリで、**公開** をクリックします。
9.  ブラウザーで、ページの右上にある **更新** をクリックします (または Shift キーを押しながら F5 キーを押します)。 新しい電子メール アドレスが **顧客** ページに表示されることに注意してください。
10. Excel で、Excel アプリの右下隅にある **設定** (歯車) ボタンをクリックします。 表示されるダイアログ ボックスを使用すると、現在のブック内の設定を調整することができます。 **サーバー URL** の値が、ブラウザーで示されている URL の開始と一致していることに注意してください。 データ更新およびデータ公開操作が一覧表示されることに注意してください。
11. **キャンセル** を選択して **設定** ダイアログ ボックスを閉じます。
12. Excel アプリの右下隅にある **メッセージ センター** (旗) ボタンを選択します。 表示されるメッセージ センター ダイアログ ボックスには、Excel アプリケーションで発生している内容に関する情報が表示されます。

### <a name="add-and-remove-table-columns-from-an-existing-table-data-source-in-the-excel-app"></a>Excel アプリケーションで既存のテーブル データ ソースからテーブルの列の追加と削除

Excel アプリケーションには、ユーザーがエンティティ データ ソースおよびラベルへのバインディングを追加および編集できるデザイン エクスペリエンスがあります。 既存のバインドからフィールドを追加および削除するには、、次の手順で説明している編集エクスペリエンスを使用します。

1. 既存のテーブル データ ソースを持つブックを取得します。
   1.  **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
   2.  **Microsoft Office で開く** &gt; **Excel で開く** &gt; **フリート管理の顧客 (フィルター処理なし)** の順に選択します。
   3.  生成されたブックをダウンロードして開きます。 このブックには、Excel データ コネクタ アプリ、フリート管理顧客エンティティへのバインド、およびブックを生成したサーバーへのポインターが含まれています。
   4.  **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みを行えるようになります。 顧客データは、サーバー上の OData サービスから読み取られ、テーブルに追加されます。

2. 編集のためのデータ ソースを開く:
   1.  Excel では、Excel アプリで **デザイン** をクリックします。 テーブルおよびフィールド データ ソースの一覧が表示されます。
   2.  既存のテーブル データ ソースの横の **編集** ボタン (鉛筆) を選択します。 データ ソースの詳細が表示されます。

3. フィールドを削除します。 **選択済** リストで、フィールドをダブルクリックします。 または、フィールドをクリックし、その後 **削除** をクリックします。 複数のフィールドを選択するには、Ctrl キーを押しながら各フィールドをクリックします。 すべてのフィールドを選択するには、Ctrl+A キーを押します。
4. フィールドを追加します。 **使用可能** リストで、フィールドをダブルクリックします。 または、フィールドをクリックし、その後 **追加** をクリックします。 複数のフィールドを選択するには、Ctrl キーを押しながら各フィールドをクリックします。 すべてのフィールドを選択するには、Ctrl+A キーを押します。
5. フィールドの順序を変更します。 **選択済** リストで、フィールドをクリックしてから **上** または **下** をクリックします。
6. フィールド ラベルの変更。 <strong>選択済</strong>リストで、フィールドをクリックしてから、リストの下にある<strong>列ラベル</strong> フィールドをクリックします。 アクティブ言語に翻訳される静的文字列またはラベル識別子のいずれかにラベルを変更することができます (たとえば、<strong>@SYS129977</strong>)。
7. データ ソース フィールドに行った変更を適用します。
   1.  **更新** を選択してデータ ソース リストに戻ります。
   2.  **更新** を選択し、新しいフィールドにデータが入力されていることを確認します。

### <a name="change-an-automatically-generated-open-in-excel-experience"></a>自動的に生成された Excel で開くエクスペリエンスを変更する

エンティティ向けに作成される自動生成された [Excel で開く] エクスペリエンスには、1 つのテーブル バインディングがあります。 そのテーブル バインディングに追加されるフィールドのリストは、テーブル バインディングにフィールドが含まれている場合は、**AutoReport** フィールド グループによって定義されます。 それ以外の場合、エンティティのキーおよび必須フィールドが自動的に追加されます。 **AutoReport** グループのフィールドの順序は、テーブル バインディングのフィールドの順序を決定します。

1.  Visual Studio を起動します。 管理者として実行していることを確認します。
2.  **表示** &gt; **アプリケーション エクスプローラー** の順に選択します (または Ctrl + E、Ctrl + E を押します)。
3.  **AOT** &gt; **データ モデル** &gt; **データ エンティティ** &gt; **FMCustomerEntity** に移動します。
4.  **FMCustomerEntity** を右クリックし、**プロジェクトに追加** をクリックします。
5.  **FMCustomerEntity**&gt;**フィールド グループ**&gt;**AutoReport** を展開します。
6.  **性** フィールドをクリックして上に移動 (Alt+Up 矢印キーを押す) することにより、**名** と **性** フィールドを取り消します。
7.  エンティティを保存します。 既存のエンティティを上書きするか、新しいエンティティとしてそれを保存するかを尋ねられたら、**上書き** をクリックします。
8.  ソリューションをビルドします (Ctrl + Shift + B キーを押します)。
9.  ブラウザーで、**フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
10. **Microsoft Office** で **開く** &gt; **Excel で開く** &gt; **フリート管理の顧客** の順に選択します。
11. 生成されたブックを開きます。
12. **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みを行えるようになります。 **姓** 列は **名** 列の前に表示されることに注意してください。

### <a name="open-in-excel-online"></a>Excel Online で開く

Excel アプリケーションは、Office フレームワークの新しいアプリケーションを使用して構築されます。 このフレームワークは、アプリケーションが Office アプリケーションと通信できる JavaScript ベースの Web アプリケーション プログラミング インターフェイス (API) を提供します。 この新しいフレームワークの最大の利点は、アプリがオンプレミスの Excel インスタンス (Win32)、Excel Online (Microsoft 365)、および Apple iPad 上の Excel で実行できることです。 将来的に他の Excel アプリでも実行できるようになります。

1.  **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
2.  **Microsoft Office** で **開く** &gt; **Excel で開く** &gt; **フリート管理の顧客** の順に選択します。
3.  **SharePoint** を選択します。
4.  目的の Microsoft SharePoint フォルダーを参照します。
5.  **保存** を選択します。 既定の動作では、保存後にファイルを開きます。 ブックが Excel Online で開くことに注意してください。 Excel Online では、更新や公開などの Excel アプリの機能、およびデザイン体験が、オンプレミスの Excel インスタンスと同様に機能する必要があります。

## <a name="template-open-in-excel-experiences"></a>Excel で開いたテンプレートのエクスペリエンス
### <a name="template-open-in-excel"></a>Excel で開いたテンプレート

テンプレート オプションは、生成された [Excel で開く] のオプションと似ています。 フォーム内のルート データ ソースと同じ最初のデータ ソースを持つテンプレートがシステムによって検出されると、フォームに自動的に追加されます。 ワークブック テンプレートは、複数のデータ ソースを持つことができます。 また、バインドされていないコンテンツを持つこともできます。 Excel で開くエクスペリエンスは、**Microsoft Office** で **開く** メニューにリストされます。 **Excel ブック デザイナー** ページには、エンティティの生成された [Excel で開く] エクスペリエンスで取得する簡単な方法があります。 また、Excel アプリおよびサーバーへのポインターを含む空白のブックを取得するメカニズムも提供します。

1.  **共通** &gt; **共通** &gt; **Office 統合** &gt; **Excel ブック デザイナー** に移動します。
2.  **FleetCustomer** エンティティを選択します。
3.  選択したフィールドのリストに利用可能なフィールドのリストのすべてのフィールドを追加します。
4.  **ブックの作成** を選択します。
5.  生成されたブックを開きます。 このブックには、**フリート管理顧客** エンティティへのバインドである Excel データ コネクタ アプリと、ブックを生成したサーバーへのポインタが含まれます。
6.  **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みを行えるようになります。 顧客データは、サーバー上の OData サービスから読み取られ、テーブルに追加されます。
7.  テーブル上に空白行を挿入し、タイトルとして **フリート顧客** と入力します。
8.  ワークシート **FleetCustomers** の名前を変更します。
9.  テーブルの一部のフィールドを再配置します。 **デザイン** を選択し、デザイン エクスペリエンスを開きます。
10. **FleetCustomer** データ ソースの横に、データ ソースを編集および削除するためのボタンがあります。 フィールド リストを表示するには、**編集** を選択します。
11. フィールドを選択し、必要に応じてに移動します。 最初の 3 つのフィールドの順序を **FirstName**、**LastName**、**DriverLicense** に設定します。
12. **更新プログラム** を選択します。 フィールドの順序は変わることに注意してください。
13. **完了** を選択します。
14. **設定** (ギア) ボタンを選択します。
15. バインドされたデータがワークブックに含まれないように **バインディング データのクリア** を選択します。
16. **OK** を選択します。
17. ブックを **FleetCustomersBasic.xlsx** という名前で保存します。
18. ブラウザーで、**共通** &gt; **共通** &gt; **Office 統合** &gt; **ドキュメント テンプレート** と移動します。
19. **新規** を選択します。
20. 保存したファイルを参照します。
21. **OK** を選択します。 テンプレートは、テンプレート テーブルの行として追加されます。
22. **FleetCustomersBasic** 行で、**現在のレコード フィルターの適用** チェック ボックスをオフにすると、テンプレートが開かれた後にフィルター処理されていない顧客の一覧が読み込まれます。
23. **テンプレートの表示名** 値を **基本フリートカスタマー** に変更します。
24. **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
25. **Microsoft Office** **で開く** を選択します。 **フリート顧客ベーシック** は、**Excel で開く** セクションのオプションになっていることに注意してください。 そのオプションを選択します。
26. 生成されたブックを開きます。
27. **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みを行えるようになります。 顧客データは、サーバー上の OData サービスから読み取られ、作成したテーブルのバインドに追加されます。

### <a name="register-a-template-as-a-system-defined-template"></a>システム定義のテンプレートとしてテンプレートを登録します。

システム定義のテンプレートとして登録されているテンプレートは、配置時に読み込まれます。 この動作は、他のモデル コンポーネントと一緒にテンプレートをパッケージ化する独立系ソフトウェア ベンダー (ISV) やパートナーにとって役立ちます。

1.  モデルが **フリート管理** に設定されている以前に作成したプロジェクトを開いて Visual Studio を起動するか、または新しいプロジェクトを作成します。
2.  プロジェクトを右クリックし、**追加** &gt; **新しい項目** をクリックします。
3.  **リソース** 品目タイプを選択します。
4.  名前を **FleetCustomersBasicTemplate** に設定します。
5.  FleetCustomersBasic.xlsx ファイルが閉じられていることを確認します。
6.  **追加** を選択します。
7.  **FleetCustomersBasic.xlsx** ファイルを選択します。 リソースがプロジェクトに追加されることに注意してください。
8.  **表示** &gt; **アプリケーション エクスプローラー** の順に選択します (または Ctrl + E、Ctrl + E を押します)。
9.  **AOT** &gt; **クラス** &gt; **コード** &gt; **FMTemplateRegistrations** に移動します。
10. **FMTemplateRegistrations** を右クリックし、**プロジェクトに追加** をクリックします。
11. **FMTemplateRegistrations** を開きます。 FMTemplateRegistrations.xpp コード ファイルが表示されます。
12. 既存の行の 1 つをコピーし、テンプレート名、リソース名、説明、表示名、および **現在のレコード フィルターの適用** と **Office で開くメニューに表示** の値を指定して変更します。 表示名は、[Excel で開く] オプションとして表示されるテキストです。 ユーザーがその項目の上にポインタを置くと説明が表示されます。 表示名と説明には、ラベルまたは静的な文字列を使用できます。 コードは次の例のようになります。


     ```xpp
     this.addTemplate(
         OfficeAppApplicationType::Excel, 
         resourceStr(FleetCustomersBasicTemplate), 
         resourceStr(FleetCustomersBasicTemplate), 
         "Template for fleet customers", "Fleet customers basic", NoYes::No, NoYes::Yes);
     ```

13. コードを保存します。 既存のコードを上書きするか、新しいファイルとしてそれを保存するかを尋ねられたら、**上書き** をクリックします。
14. ソリューションをビルドします (Ctrl + Shift + B キーを押します)。
15. 変更が正常に完了したことを確認します。 ブラウザーで、**共通** &gt; **共通** &gt; **Office 統合** &gt; **ドキュメント テンプレート** と移動します。
16. **システム テンプレートの再読み込み** を選択します。
17. **はい** を選択して、システム テンプレートの再読み込みを確定します。
18. 新しいシステム定義テンプレートが読み込まれたこと、そのテンプレート名が **FleetCustomersBasicTemplate** であることを確認します。

### <a name="journal-entry-in-excel-experience-powered-by-a-template"></a>テンプレートによる Excel での仕訳入力エクスペリエンス

1.  **総勘定元帳** &gt; **仕訳入力** &gt; **一般仕訳帳** の順に移動します。
2.  会社 **USMF** にいることを確認します。
3.  **新規** をクリックし、新しい仕訳帳を作成します。
4.  名前を **GenJrn** に設定します。
5.  **Excel で明細行を開く** を選択します。
6.  生成されたブックを開いて、必要に応じて編集を有効にします。 ヘッダー フィールドにデータが設定されていることに注意してください。
7.  新しい行を入力し、**MainAccount** フィールドを **110110** に設定します。 説明、通貨、および借方金額を入力します。 これらの関係はこのエンティティに定義されているため、ルックアップは会社と通貨のフィールドに指定されていることに注意してください。
8.  **公開** を選択します。 明細行が現在の日付と 0 (ゼロ) の借方金額がで更新されることに注意してください。
9.  ブラウザーで **明細行** をクリックします。 Excel で入力した明細行が表示されることに注意してください。

## <a name="lookups-in-excel-experiences"></a>Excel でのルックアップ エクスペリエンス
### <a name="lookups-in-the-excel-app"></a>Excel アプリでのルックアップ

データ入力を容易にするため、Excel App はルックアップとデータ支援を提供します。 日付フィールドは日付の選択の提供、列挙 (列挙) フィールドは列挙リストの提供、リレーションシップはリレーションシップ ルックアップの提供をします。

1.  **フリート管理** &gt; **レンタル** &gt; **レンタル** に移動します。
2.  **Microsoft Office** **で開く** &gt; **Excel で開く** &gt; **フリート管理のレンタル** の順に選択します。
3.  生成されたブックを開きます。
4.  **編集の有効化** を選択すると、Excel データ コネクタ アプリがデータの読み込みと読み取りを行えるようになります。
5.  **運転免許証** 値を選択します。 リレーションシップ ルックアップが Excel アプリで表示され、顧客の一覧を表示することに注意してください。 リレーションシップ ルックアップは最初の世代であるため、現在フィルター処理または並べ替えはサポートされていません。
6.  ルックアップで別の顧客を選択し、**運転免許証** の値が変化することに注意してください。 このフィールドはキーの一部なので、元の **運転免許証** 値をクリックしてリセットします。 **運転免許証**、**名**、および **姓** のフィールドはマルチパート キーを形成しますが、Excel アプリはマルチパート キーのすべての部分をすぐに変更しないことに注意してください。
7.  **開始日** の値を選択します。 日付の選択が Excel アプリで表示されることに注意してください。
8.  別の日付を選択すると、**開始日** の値が変更されます。
9.  **デザイン** を選択し、FleetRental データ ソースを編集するには、**ステータス** フィールドをテーブル バインディングの列として追加します。
10. **状態** 列の追加が完了したら、**状態** 値をクリックします。 列挙リストが Excel アプリで表示されることに注意してください。
11. フォーカスが **状態** 列にあるとき、レンタルのリストを上下に動かして、現在の値を反映するために列挙型リストがどれだけ早く変更されるか確認します。 ユーザーが使用可能なすべての値をすばやく表示できるように、列挙リスト全体が表示されます。
12. 別の **状態** 値を選択すると、クリック 1 回で列挙値を変更する方法を確認できます。

### <a name="create-a-relationship-lookup"></a>リレーションシップ ルックアップを作成する

エンティティ間にリレーションシップが存在するときは、リレーションシップ ルックアップが表示されます。

1.  モデルが **フリート管理** に設定されている以前に作成したプロジェクトを開いて Visual Studio を起動するか、または新しいプロジェクトを作成します。
2.  **表示** &gt; **アプリケーション エクスプローラー** の順に選択します (または Ctrl + E、Ctrl + E を押します)。
3.  **AOT** &gt; **データ モデル** &gt; **テーブル** &gt; **FMCustGroup** に移動します。
4.  右クリックしてから、**デザイナーを開く** をクリックします。
5.  デザイナーで、**FMCustGroup** を右クリックしてから、**アドイン** &gt; **データ エンティティの作成** とクリックします。 コンポーネントはプロジェクトに追加されます。
6.  **FMCustGroupEntity** のデザイナー ビューを開きます。
7.  **FMCustGroupEntity** のプロパティ シートで、**パブリック コレクション名** を **FleetCustomerGroups** に、**パブリック エンティティ名** を **FleetCustomerGroup** に設定します。
8.  **AutoLookup** フィールド グループに **CustGroup** と **説明** フィールドを追加します。
9.  **FMCustomerEntity** がまだプロジェクトに入っていない場合、それを追加します。
10. **FMCustomerEntity** のデザイナー ビューを開きます。
11. **関係** を右クリックし、**新規** &gt; **関係** をクリックします。
12. 新しいリレーションで、**名前** を **CustomerGroup** に、**基数** を **ZeroMore** に、**RelatedDataEntity** を **FMCustGroupEntity** に、**RelatedDataEntityCardinality** を **ZeroOne** に、**RelationshipType** を **関連** に、**ロール** を **CustomerGroupSource** に、および **RelatedDataEntityRole** を **CustomerGroupTarget** に設定します。
13. ソリューションをビルドします (Ctrl + Shift + B キーを押します)。
14. 変更が正常に完了したことを確認します。 ブラウザーで、**フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
15. **Microsoft Office** で **開く** &gt; **Excel で開く** &gt; **フリート管理の顧客** の順に選択します。
16. 生成されたブックを開きます。
17. **顧客グループ** の値を選択します。
18. 顧客の **顧客グループ** 値を変更します。
19. 変更を公開します。
20. 値を元に戻し、その変更を公開します。

### <a name="create-a-custom-lookup"></a>カスタム ルックアップの作成

列挙型またはリレーションシップが十分でないとき、データ オプションを表示するカスタム ルックアップを作成することができます。 主な使用例は、外部サービスからデータを取得し、リアルタイムで提示する必要がある場合です。

1.  モデルが **フリート管理** に設定されている以前に作成したプロジェクトを開いて Visual Studio を起動するか、または新しいプロジェクトを作成します。
2.  **FMCustomerEntity** のデザイナー ビューを開きます。
3.  **メソッド** を右クリックし、 **新規メソッド** をクリックします。
4.  次の例から **lookup\_Country** コードを追加します。

    ```xpp
      public class FMCustomerEntity extends common
    {
        [SysODataAction("FMCustomerEntityCountryCustomLookup", false), //Name in $metadata
        SysODataCollection("_fields", Types::String), //Types in context
        SysODataFieldLookup(fieldStr(FMCustomerEntity, Country))] //Name of field
        public static str lookup_Country(Array _fields)
        {
            OfficeAppCustomLookupListResult result = new OfficeAppCustomLookupListResult();

            result.items().value(1, "US");
            result.items().value(2, "AU");
            result.items().value(3, "FR");
            result.items().value(4, "GR");
            result.items().value(5, "NZ");

            return result.serialize();
        }
      }
    ```

5.  コードを保存します。 既存のコードを上書きするか、新しいファイルとして保存するかを尋ねられたら、**上書き** をクリックします。
6.  ソリューションをビルドします (Ctrl + Shift + B キーを押します)。
7.  変更が正常に完了したことを確認します。 ブラウザーで、**フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
8.  **Microsoft Office** で **開く** &gt; **Excel で開く** &gt; **フリート管理の顧客** の順に選択します。
9.  生成されたブックを開きます。
10. **国** の値を選択します。
11. 顧客の **国** 値を変更します。
12. 変更を公開します。
13. 値を元に戻し、その変更を公開します。

## <a name="export-to-word-experiences"></a>Word エクスペリエンスへエキスポート
### <a name="export-to-word"></a>Word にエクスポート

Word エクスペリエンスへのエクスポートは、簡易レポートに使用することができます。 あらかじめ構築されたテンプレートによって強化されています。 Word へのエクスポート エクスペリエンスは、**Microsoft Office** で **開く** メニューにリストされます。 フリート管理の顧客に対して作成された体験例を見てみましょう。

1.  **フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
2.  **Microsoft Office** で **開く** &gt; **Word にエクスポート** &gt; **顧客情報フリート管理の顧客 (フィルター処理なし)** の順に選択します。
3.  生成されたドキュメントをダウンロードして開きます。 ドキュメントには、現在選択されているレコードのデータが含まれています。

### <a name="create-a-word-template"></a>Word テンプレートを作成する

Microsoft Dynamics App for Office は、Word で実行でき、ドキュメントの生成のために使用できるテンプレートの作成を可能にします。

1.  空白の文書の作成
    1.  **共通** &gt; **コメント** &gt; **Excel ブック デザイナー** に移動します。 
    2.  **空白のドキュメントの作成** を選択します。
    3.  生成されたドキュメントをダウンロードして開きます。

2.  アプリにログインします:
    1.  **サインイン** を選択します。 Azure Active Directory サインイン画面には、資格情報の一覧が表示される必要があります。 エラーが発生した場合、(サインアウト リンクを使用して) 強制的にサインアウトし、再度サインインします。
    2.  適切なアカウントを選択するか、**別のアカウントを使用** をクリックします。
    3.  環境の資格情報を入力し、次に **サイン イン** をクリックします。

3.  次の手順のいずれかを実行します。
    -   フィールド データ ソースの追加:
        1.  アプリで **デザイン** をクリックします。
        2.  **フィールドの追加** を選択します。
        3.  **FleetCustomer** を選択します。
        4.  **次へ** を選択してフィールド選択ページに進みます。
        5.  ドキュメントで、ドキュメントの上部にタイトルまたはいくつかの空白行を追加します。
        6.  アプリの **利用可** の一覧で、**FirstName** フィールドを選択します。
        7.  **ラベルの追加** を選択し、「名」ラベルを参照するコンテンツ コントロールを追加します。
        8.  ドキュメントで、ドキュメントをクリックしてフォーカスを配置し、もう一度クリックしてラベルの終わりにフォーカスを配置してから、カーソルがコンテンツ コントロールの外に行く (コントロール ボックスが表示されなくなる) まで右矢印キーを押します。
        9.  スペース + ハイフン + スペース (「 - 」) またはスペース + コロン + スペース (「 : 」) などの区切り記号を追加します。
        10. アプリで **値の追加** をクリックして、**FirstName** フィールドを参照するコンテンツ コントロールを追加します。
        11. **LastName** フィールドのラベルおよび値に対してプロセスを繰り返します。
        12. 必要に応じてフィールドを追加し続けます。
    -   テーブル データ ソースの追加:
        1.  アプリで **デザイン** をクリックします。
        2.  **テーブルの追加** を選択します。
        3.  **FleetCustomer** を選択します。
        4.  **次へ** を選択してフィールド選択ページに進みます。
        5.  ドキュメントで、ドキュメントの上部にタイトルまたはいくつかの空白行を追加します。
        6.  アプリの **使用可能なフィールド** の一覧で、**FirstName**、**LastName**、および **City** フィールドを追加します。
        7.  **完了** を選択します。

6.  Word で、テンプレート ドキュメントを保存します。

### <a name="create-a-word-template-and-use-it-for-document-generation"></a>Word テンプレートを作成し、ドキュメントの生成に使用する

Word テンプレートを作成した後は、アップロードし、Word エクスペリエンスにエクスポートを作成することができます。

1.  次のテンプレートのアップロード: 
    1.  **共通** &gt; **共通** &gt; **Office 統合** &gt; **ドキュメント テンプレート** に移動します。 または、ページを検索します。
    2.  **新規** を選択します。
    3.  **参照** を選択します。
    4.  ダイアログ ボックスで、前に作成したテンプレートを選択してから **開く** をクリックします。 ルート データ エンティティはテンプレートから取得され、ダイアログ ボックスの下部付近に表示されることに注意してください。
    5.  **OK** を選択します。
    6.  テンプレートが追加されたことを確認するためにテンプレートの一覧を下にスクロールします。
    7.  オプション: テンプレートがユーザーの現在のレコードにフィルター処理されない場合、**現在のレコード フィルターの適用** チェック ボックスをオフにします。
    8.  オプション: テンプレートがユーザーの現在の会社にフィルター処理されない場合、**会社フィルターの適用** チェック ボックスをオフにします。

2.  ドキュメントの生成にはアップロード済みのテンプレートを使用します。
    1.  テンプレートのルート データ エンティティと同じルート データ ソースを共有するページに移動します。 **FleetCustomer** (**FMCustomerEntity**) で、そのページは **フリート管理** &gt; **顧客** &gt; **顧客** です。
    2.  **Microsoft Office で開く** &gt; **Word にエクスポート** の順に開き、テンプレートを選択します。
    3.  生成されたドキュメントをダウンロードして開きます。

## <a name="document-management-and-sharepoint-experiences"></a>ドキュメントの管理と SharePoint の経験
### <a name="add-a-sharepoint-document-type"></a>SharePoint ドキュメント タイプを追加します。

ドキュメント管理サブシステムは、レコードにファイルを添付するために使用できます。 ほとんどの非実行可能ファイルの種類が添付ファイルとしてサポートされています。 ドキュメント プレビューは、Office ドキュメントのファイルおよび PDF に提供されます。 管理者は、添付ファイルが保存される場所を示すためにドキュメント タイプを作成します。 管理者が SharePoint を保管場所として使用するとき、ファイルを配置する特定のフォルダーを提供する必要があります。 その SharePoint フォルダーのセキュリティは、個別の管理責任です。

1.  **組織管理** &gt; **ドキュメント管理** &gt; **ドキュメント管理パラメーター** に移動します。
2.  **SharePoint** を選択します。
3.  **既定の SharePoint サーバー** フィールドが **contosoax7.sharepoint.com** などのテナントの既定値に設定されていることを確認します。
4.  **SharePoint 接続のテスト** を選択します。 正常に接続することに注意します。
5.  **保存** を選択します。
6.  **組織管理** &gt; **ドキュメント管理** &gt; **ドキュメント タイプ** へ移動します。
7.  **新規** を選択します。
8.  **Type** を **SharePointDoc** に設定します。
9.  **Name** を **SharePointDoc** に設定します。
10. **場所** を **SharePoint** に設定します。
11. **SharePoint アドレス** フィールドの横にある **編集** (鉛筆) ボタンを選択します。
12. ダイアログ ボックスの左側で、サイトを選択します。 contosoax7 テナントについては、**ContosoAX チーム サイト** を選択します。
13. ダイアログ ボックスの右側で、フォルダーを選択します。 contosoax7 テナントについては、**ContosoAX チーム サイト** &gt; **ドキュメント** &gt; **OfficeIntegration** &gt; **添付ファイル** を選択します。
14. **OK** を選択します。
15. **保存** を選択します。
16. **SharePoint アドレス** フィールドの横にある **参照** (地球) ボタンを選択します。 選択したフォルダーを表示する新しいブラウザー タブが表示されることに注意してください。
17. Windows エクスプローラーを使用して、ドキュメント フォルダーに Word ドキュメントを作成し、ドキュメントにいくつかの単語を入力します。
18. ブラウザーで、**フリート管理** &gt; **顧客** &gt; **顧客** に移動します。
19. 最初の顧客にフォーカスを配置し、ページの右上隅にある **添付** (クリップ) ボタンをクリックします。
20. **新規** &gt; **SharePointDoc** を選択します。
21. **参照** を選択し、作成した Word ドキュメントを選択します。
22. Word ドキュメントのプレビューを表示するには、**プレビュー** FastTab を展開します。
23. Word ドキュメントのファイル場所を表示するには、**添付ファイル** FastTab を展開します。
24. ブラウザーで、以前に開かれたタブを使用し、SharePoint フォルダーを表示して、ファイルが適切に配置されていることを再確認します。

## <a name="email-experiences"></a>電子メールの経験
### <a name="send-mail-via-a-local-mail-client"></a>ローカル メール クライアント経由で電子メールを送信

SysEmail フレームワークで有効になっている電子メール ワークフローでは、添付ファイルを含む電子メール メッセージ (.eml files) を生成できます。 これらのメッセージは Microsoft Outlook または他の電子メール クライアント経由で送信することができます。

1.  **売掛金勘定** &gt; **顧客** &gt; **すべての顧客** の順に移動します。
2.  **US-008 Sparrow Retail** を選択します。
3.  **回収** &gt; **顧客残高** &gt; **コレクション** の順に選択し、**コレクション** ページを開きます。
4.  **連絡** &gt; **電子メール** &gt; **連絡先に対する明細書** の順に選択します。
5.  ダイアログ ボックスで既定値を承諾する場合は、**OK** を選択します。
6.  メール オプションの使用を促すメッセージが表示された場合は、**再度確認しない** チェックボックス (このオプションはユーザー オプション ページから変更できます) をオフにし、**Outlook などの電子メール アプリケーションを使用** を選択し、**OK** をクリックします。
7.  ラップトップ上でブラウザーを実行している場合は、生成される電子メール (.eml) ファイルを開きます。 VM 上でブラウザーを実行している場合は、ファイルをラップトップにコピーし、そのラップトップでファイルを開きます。
8.  **宛先** フィールドの電子メール アドレスと生成されたブック添付ファイルに注意します。

### <a name="send-mail-via-smtp"></a>SMTP 経由でメールを送信

SysEmail フレームワークを介して有効になっている電子メール ワークフローは、簡単な電子メール ダイアログ ボックスで作成し、Simple Mail Transfer Protocol (SMTP) 経由で送信することもできます。

1.  **システム管理** &gt; **設定** &gt; **電子メール** &gt; **電子メール パラメータ** の順に移動します。
2.  **SMTP** を選択します。
3.  **送信メール サーバー** を要求された SMTP サーバーに設定します。
    -   [Microsoft 365 製品](https://support.office.com/article/Outlook-settings-for-POP-and-IMAP-access-for-Office-365-for-business-or-Microsoft-Exchange-accounts-7fc677eb-2491-4cbc-8153-8e7113525f6c) (\*.onmicrosoft.com アカウントを含む) 用: smtp.office365.com (**設定** &gt; **メール** &gt; **POP および IMAP** で outlook.office.com を通してこの設定を検索します。)
    -   Outlook/Hotmail 用: smtp-mail.outlook.com

4.  ユーザー名とパスワードを適切な電子メール アカウントとパスワードに設定します。
5.  **SSLRequired** を有効のままにして、**SMTP ポート番号** は **587** に設定したままにします。
6.  **保存** を選択します。
7.  ブラウザーで、**売掛金勘定** &gt; **顧客** &gt; **すべての顧客** に移動します。
8.  **US-008 Sparrow Retail** を選択します。
9.  **回収** &gt; **顧客残高** &gt; **コレクション** の順に選択し、**コレクション** ページを開きます。
10. **連絡** &gt; **電子メール** &gt; **連絡先に対する明細書** の順に選択します。
11. ダイアログ ボックスで既定値を承諾する場合は、**OK** を選択します。
12. メール オプションを使用するように求められたら、**Microsoft Dynamics 365 for Finance and Operations 電子メール クライアントの使用** を選択し、**OK** をクリックします。
13. テスト メッセージを受信するには、宛先アドレスをメール アドレスに変更します。
14. メッセージの件名および本文を入力します。
15. **送信** を選択します。 メッセージは 1 〜 5 分で配信する必要があります。 メッセージが **電子メール パラメーター** ページに設定されている電子メール アカウントから送信されることに注意してください。 そのメール アカウントに **メールの送信** ダイアログ ボックスで使用されている送信元アドレスの「送信者」(または「このメールボックスからメールを送信」) のアクセス許可が与えられている場合、そのアドレスからのメッセージが表示されます。
    -   [送信者] 権限は、Microsoft 365 管理センター (portal.office.com/Admin) にて、**ユーザー** &gt; **有効なユーザー** &gt; **ユーザー** &gt; **メールボックスのアクセス許可を編集** &gt; **このメールボックスから電子メールを送信する** で構成することができます。 詳細については、[Microsoft 365 で別のユーザーのメールボックスからの電子メールの送信を有効にする](https://support.office.com/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E) を参照してください。
    -   ユーザーが電子メール メッセージを送信する前に、**電子メール パラメーター** ページで設定されている電子メール アカウントにクライアントの各ユーザー電子メール アカウントの 「送信者」権限を与える必要があります。 詳細については、[Microsoft 365 を使用して電子メールを送信するためのマルチ機能デバイスまたはアプリケーションの設定方法](/Exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365) を参照してください。

16. ユーザーの介入なしにサーバーから直接送信される電子メールは、バッチ処理を介して送信され、**電子メール ディストリビューター バッチ** プロセスを開始する必要があります。 プロセスを開始するには、これらの手順に従います。
    1.  **システム管理** &gt; **定期処理のタスク** &gt; **電子メールの処理** &gt; **バッチ** の順に移動します。
    2.  **バッチ処理** をオンにします。



## <a name="additional-resources"></a>追加リソース

- [Office 統合の概要](office-integration.md)
- [Office 統合のトラブルシューティング](office-integration-troubleshooting.md)





[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
