---
title: Excel でのエンティティ データの表示および更新
description: このトピックでは、Microsoft Excel でエンティティ データを開き、Excel 用の Microsoft Dynamics Excel アドインを使用してそのデータを表示、更新、また編集する方法を説明します。
author: jasongre
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: a39dbdcae29df5e838673dc1fe77ae7e76ebfc86
ms.sourcegitcommit: 34b478f175348d99df4f2f0c2f6c0c21b6b2660a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2021
ms.locfileid: "5908344"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="80f2c-103">Excel でのエンティティ データの表示および更新</span><span class="sxs-lookup"><span data-stu-id="80f2c-103">View and update entity data with Excel</span></span> 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]


<span data-ttu-id="80f2c-104">このトピックでは、Microsoft Excel でエンティティ データを開き、Excel 用の Microsoft Dynamics Excel アドインを使用してそのデータを表示、更新、また編集する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="80f2c-105">エンティティ データを開くには、Excel か Finance and Operations アプリのいずれからでも開始できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="80f2c-106">Excel でエンティティ データを開くことにより、Excel アドインを使用して迅速かつ簡単にデータを表示し編集することができます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="80f2c-107">このアドインには Microsoft Excel 2016 以降が必要です。</span><span class="sxs-lookup"><span data-stu-id="80f2c-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="80f2c-108">Microsoft Azure Active Directory (Azure AD) テナントが Active Directory フェデレーション サービス (AD FS) を使用するようにコンフィギュレーションされている場合は、Excel のアドインに正しくサインインできるように、2016 年 5 月の Office の更新が適用されていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="80f2c-109">Excel アドインを使用する方法に関する詳細は、[ヘッダーと明細行のパターンの Excel テンプレートを作成する](https://youtu.be/RTicLb-6dbI) のショート ビデオをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="80f2c-110">Finance and Operations アプリから開始して Excel でエンティティ データを開く</span><span class="sxs-lookup"><span data-stu-id="80f2c-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="80f2c-111">Finance and Operations アプリのページで、**Microsoft Office で開く** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="80f2c-112">そのページのルート データ ソース (テーブル) がエンティティのルート データ ソースと同じである場合は、既定の **Excel で開く** オプションがそのページに生成されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="80f2c-113">**Excel で開く** オプションは **すべての仕入先** や **すべての顧客** などの頻繁に使用するページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="80f2c-114">**Excel で開く** オプションを選択し、生成されるブックを開きます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="80f2c-115">このブックには、エンティティのバインディング情報、環境へのポインター、また Excel アドインへのポインターがあります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="80f2c-116">Excel で **編集機能を有効にする** を選択し、Excel アドインが実行されるようにします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="80f2c-117">Excel のウィンドウ右側のウィンドウで Excel アドインが実行されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="80f2c-118">初めて Excel アドインを実行する場合は、**このアドインを信頼します** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="80f2c-119">サインインするようにとのメッセージが表示されたら、**サインイン** を選択し、Finance and Operations アプリへのサインインに使用するのと同じ資格情報を用いてサインインします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="80f2c-120">可能な場合、Excel アドインはブラウザーからのサインイン コンテキストを使用し、自動的にサインインします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="80f2c-121">(オペレーティング システムに基づいて使用されるブラウザの詳細については、[Office アドインで使用されるブラウザー](/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) を参照してください。サインインが正常に行われるか確認するには、Excel アドインの右上隅にあるユーザー名を確認します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="80f2c-122">Excel アドインが、選択したエンティティのデータを自動的に読み取ります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="80f2c-123">Excel アドインが読み込むまでブックにデータはないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="80f2c-124">Excel から開始して Excel でエンティティ データを開く</span><span class="sxs-lookup"><span data-stu-id="80f2c-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="80f2c-125">Excel の **挿入** タブの **アドイン** グループで、**ストア** を選択して Office ストアを開きます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="80f2c-126">Office ストアで、**Dynamics** で検索し、**Microsoft Dynamics Office アドイン** (Excel アドイン) の隣の **追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="80f2c-127">初めて Excel アドインを実行する場合は、**このアドインを信頼します** を選択して Excel アドインの実行を有効化します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="80f2c-128">Excel のウィンドウ右側のウィンドウで Excel アドインが実行されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="80f2c-129">**サーバー情報の追加** を選択して **オプション** ウィンドウを開きます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="80f2c-130">お使いのブラウザーで、ターゲットの Finance and Operations アプリ インスタンスから URL をコピーし、それを **サーバー URL** フィールドに貼り付けてから、ホスト名以降をすべて消去します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="80f2c-131">結果の URL はホスト名のみである必要があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="80f2c-132">たとえば、URLが `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage` の場合、`https://xxx.dynamics.com` を除くすべてを削除します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="80f2c-133">**OK** を選択してから **はい** を選択し、変更を確認します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="80f2c-134">Excel アドインが再開しメタデータを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="80f2c-135">**デザイン** ボタンが使用できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="80f2c-135">The **Design** button is now available.</span></span> <span data-ttu-id="80f2c-136">Excel アドインに **アプレットの読み込み** ボタンがある場合は、正しいユーザーとしてサインインしていない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="80f2c-137">詳細については、このトピックの「トラブルシューティング」セクションにある「[アプレットの読み込みボタンが表示される](../office-integration/use-excel-add-in.md#troubleshooting)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](../office-integration/use-excel-add-in.md#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="80f2c-138">**デザイン** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-138">Select **Design**.</span></span> <span data-ttu-id="80f2c-139">Excel アドインがエンティティ メタデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="80f2c-140">**テーブルの追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-140">Select **Add table**.</span></span> <span data-ttu-id="80f2c-141">エンティティの一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-141">A list of entities appears.</span></span> <span data-ttu-id="80f2c-142">エンティティは「名前 - ラベル」形式で一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="80f2c-143">一覧にある **顧客 - 顧客** などのエンティティを選択し、**次へ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="80f2c-144">フィールドを **使用可能なフィールド** リストから **選択されたフィールド** リストに追加するには、そのフィールドを選択してから **追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="80f2c-145">また、**利用可能なフィールド** リストをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="80f2c-146">**選択されたフィールド** リストへフィールドの追加が完了したら、カーソルがブックの正しい場所 (たとえば、セル A1) にあることを確認し、**完了** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="80f2c-147">その後 **完了** を選択してデザイナーを終了します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="80f2c-148">**更新** を選択してデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="80f2c-149">Excel でのエンティティ データの表示および更新</span><span class="sxs-lookup"><span data-stu-id="80f2c-149">View and update entity data in Excel</span></span>
<span data-ttu-id="80f2c-150">Excel アドインがエンティティ データをブックに読み込んだら、Excel アドインで **更新** を選択することでいつでもデータを更新できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="80f2c-151">Excel でのエンティティ データの編集</span><span class="sxs-lookup"><span data-stu-id="80f2c-151">Edit entity data in Excel</span></span>
<span data-ttu-id="80f2c-152">Excel アドインで **公開** を選択することにより、必要に応じてエンティティ データを変更してから Finance and Operations に再公開することができます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="80f2c-153">レコードを編集するには、ワークシートのセルを選択し、セルの値を変更します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="80f2c-154">新しいレコードを追加するには、次のいずれかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="80f2c-155">データ ソース テーブルの任意の場所をクリックし、Excel アドインで **新規** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="80f2c-156">データ ソース テーブルの最終行の任意の場所をクリックし、カーソルがその行の最終列から出て新しい行が作成されるまで Tab キーを押します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="80f2c-157">データ ソース テーブルの真下の行の任意の場所をクリックして、セルへのデータ入力を開始します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="80f2c-158">そのセルからフォーカスを移動させると、テーブルが拡張してその新しい行を含めます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="80f2c-159">ヘッダー レコードのフィールド バインディングには、いずれかのフィールドを選択し、Excel アドインの **新規** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="80f2c-160">新しいレコードは、ワークシートですべてのキーと必須フィールドが選択されている場合、もしくはフィルタ条件を使用して既定値が入力された場合にのみ作成できることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="80f2c-161">レコードを削除するには、次のいずれかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="80f2c-162">削除するべきワークシートの行の横にある行番号を右クリックし、**削除** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="80f2c-163">削除するべきワークシートの行の任意の場所を右クリックし、**削除**&gt;**表の行** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="80f2c-164">関連するデータ ソースとしてデータ ソースが関連付けて追加される場合、行の前にヘッダーが発行されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="80f2c-165">他のデータ ソースとの間に依存関係がある場合は、既定の公開オーダーを変更する必要があるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="80f2c-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="80f2c-166">公開オーダーを変更する場合、Excel アドインで **オプション** ボタン (ギヤ記号) を選択してから、**データ コネクタ** クイック タブで **公開オーダーのコンフィギュレーション** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="80f2c-167">列の追加または削除</span><span class="sxs-lookup"><span data-stu-id="80f2c-167">Add or remove columns</span></span>
<span data-ttu-id="80f2c-168">デザイナーを使用して、ワークシートに自動的に追加された列を調整することができます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="80f2c-169">**デザイン** ボタンが Excel アドインで **フィルタ** ボタン下に表示されない場合、データ ソース デザイナーを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="80f2c-170">**オプション** ボタン (ギヤ記号) を選択してから、**デザインの有効化** チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="80f2c-171">Excel アドインで **デザイン** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="80f2c-172">すべてのデータ ソースが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="80f2c-173">データ ソースの横にある **編集** ボタン (鉛筆記号) を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="80f2c-174">必要に応じて **選択されたフィールド** リストの一覧を調整します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="80f2c-175">フィールドを **使用可能なフィールド** リストから **選択されたフィールド** リストに追加するには、そのフィールドを選択してから **追加** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="80f2c-176">また、**利用可能なフィールド** リストをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="80f2c-177">**選択されたフィールド** リストからフィールドを削除するには、そのフィールドを選択してから **削除** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="80f2c-178">または、そのフィールドをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="80f2c-179">フィールドの順序を変更するには、**選択されたフィールド** リストで対象のフィールドを選択してから **上へ** または **下へ** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="80f2c-180">データ ソースに変更を適用するには、**更新** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="80f2c-181">その後 **完了** を選択してデザイナーを終了します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="80f2c-182">フィールド (列) を追加した場合、**更新** を選択して更新されたデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="80f2c-183">バッチ サイズの発行の変更</span><span class="sxs-lookup"><span data-stu-id="80f2c-183">Change the publish batch size</span></span>
<span data-ttu-id="80f2c-184">ユーザーが Excel アドインを使用してデータ レコードに対する変更を公開すると、更新はバッチで送信されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="80f2c-185">既定の公開バッチ サイズは 100 行です。</span><span class="sxs-lookup"><span data-stu-id="80f2c-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="80f2c-186">バージョン 10.0.17 以降では、**Excel アドイン機能での発行バッチ サイズの構成を許可** により、発行バッチ サイズを柔軟に制御できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="80f2c-187">システム管理者は 、**Office アプリケーション パラメーター** ページの **アプリケーション パラメーター** セクションの **バッチ制限の公開** フィールドを設定することにより、"Excelで開く" ブックの発行バッチ サイズに対するシステム全体の制限を指定できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="80f2c-188">Excel アドインを使用すると、発行のバッチ サイズを個々のブックに対して変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="80f2c-189">Excel でブックを開きます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="80f2c-190">Excel アドインの右上隅にある **オプション** (ギア) ボタンを選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="80f2c-191">必要に応じて **バッチ サイズの発行** フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="80f2c-192">設定する値は、システム全体の公開バッチ制限を超える必要があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="80f2c-193">**OK** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-193">Select **OK**.</span></span>
5. <span data-ttu-id="80f2c-194">ワークブックを保存します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-194">Save the workbook.</span></span> <span data-ttu-id="80f2c-195">アドインの設定を変更した後にブックを保存しない場合、ブックを再度開くと、その変更は維持されません。</span><span class="sxs-lookup"><span data-stu-id="80f2c-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="80f2c-196">Excel ワークブック テンプレートの作成者は、テンプレートをシステムにアップロードする前に、同じ手順でテンプレートのバッチ サイズを設定できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="80f2c-197">環境データのコピー</span><span class="sxs-lookup"><span data-stu-id="80f2c-197">Copy environment data</span></span>

<span data-ttu-id="80f2c-198">1 つの環境からブックに読み込めるデータは、別の環境にもコピーできます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="80f2c-199">ただし、ブック内のデータ キャッシュは引き続き既存のデータとして扱われるために、接続 URL だけを変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="80f2c-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="80f2c-200">代わりに、環境データのコピー機能を使用して、新しいデータとして新しい環境にデータを発行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="80f2c-201">**オプション** ボタン (ギヤ記号) を選択してから、**データ コネクタ クイック タブ** で **環境データのコピー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="80f2c-202">新しい環境にサーバー URL を入力してください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="80f2c-203">**OK** を選択してから、**はい** を選択しアクションを確認します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="80f2c-204">Excel アドインが再開し、新しい環境に接続します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="80f2c-205">ブック内の既存データは、新しいデータとして扱われます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="80f2c-206">Excel アドインの再起動後に、ブックが環境コピー モードになっているとメッセージ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="80f2c-207">新しいデータとして新しい環境にデータをコピーするには、**発行** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="80f2c-208">環境コピー操作をキャンセルし、新しい環境で既存のデータを確認するには、**更新** を選択します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="80f2c-209">トラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="80f2c-209">Troubleshooting</span></span>
<span data-ttu-id="80f2c-210">生じる問題のいくつかは簡単なステップで解決できます。</span><span class="sxs-lookup"><span data-stu-id="80f2c-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="80f2c-211">**アプレットのロードボタンが表示されます** – サインイン後に Excel アドインに **アプレットの読み込み** ボタンがある場合は、正しいユーザーとしてサインインしていない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="80f2c-212">この問題を解決するために、Excel アドインの右上隅に正しいユーザー名が表示されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="80f2c-213">正しくないユーザー名が表示されている場合は、それを選択し、サインアウトしてから再度サインインします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="80f2c-214">**禁止されたメッセージを受信する** - Excel アドインのメタデータの読み込み中に「禁止された」メッセージを受信する場合、Excel アドインにサインインしているアカウントには、対象のサービス、インスタンス、またはデータベースを使用するためのアクセス許可がありません。</span><span class="sxs-lookup"><span data-stu-id="80f2c-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="80f2c-215">この問題を解決するために、Excel アドインの右上隅に正しいユーザー名が表示されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="80f2c-216">正しくないユーザー名が表示されている場合は、それを選択し、サインアウトしてから再度サインインします。</span><span class="sxs-lookup"><span data-stu-id="80f2c-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="80f2c-217">**Excel 上に空白の Web ページが表示される** – サインイン プロセス中に空白の Web ページが開く場合、そのアカウントには AD FS が必要ですが、Excel のアドインを実行している Excel のバージョンがサインイン ダイアログ ボックスを読み込めるほど新しくありません。</span><span class="sxs-lookup"><span data-stu-id="80f2c-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="80f2c-218">この問題を解決するには、使用している Excel のバージョンを更新します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="80f2c-219">繰延チャンネルの企業にいる場合に Excel のバージョンを更新するには、[繰延チャンネルから現在のチャンネルに移動する](/deployoffice/overview-update-channels) ために [Office 配置ツール](/deployoffice/overview-office-deployment-tool) を使用します。</span><span class="sxs-lookup"><span data-stu-id="80f2c-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](/deployoffice/overview-office-deployment-tool) to [move from the deferred channel to the current channel](/deployoffice/overview-update-channels).</span></span>
- <span data-ttu-id="80f2c-220">**データの変更を公開する際にタイム アウトが返されます** - データ変更をエンティティに公開しようとしている間にタイム アウト メッセージを受信する場合は、影響を受けるワークブックのバッチ サイズを減らすことを検討してください。</span><span class="sxs-lookup"><span data-stu-id="80f2c-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="80f2c-221">レコードの変更で大量のロジックをトリガするエンティティは、タイム アウトを防ぐため、より小さいバッチで更新を送信する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="80f2c-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
