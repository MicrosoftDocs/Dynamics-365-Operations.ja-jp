---
title: Office 統合のトラブルシューティング (タスク ガイド)
description: このトピックでは、Microsoft Office 統合の機能に関する質問、ヒント、およびトラブルシューティング情報への回答を示します。 説明されている質問と問題は、ユーザー、管理、および開発のシナリオにわたっています。
author: ChrisGarty
manager: AnnBe
ms.date: 04/28/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: OfficeAppParameters, SysEmailParameters
audience: Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 72263
ms.assetid: 89588fed-b47f-4f01-9328-325518f016d6
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 62729dc2768d4e0b0130e734a71656088b36cc2f
ms.sourcegitcommit: ce79fb570e299a26a644e29da7ceb5a57a1374e6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/28/2020
ms.locfileid: "3295093"
---
# <a name="troubleshoot-the-office-integration"></a><span data-ttu-id="3631e-104">Office 統合のトラブルシューティング (タスク ガイド)</span><span class="sxs-lookup"><span data-stu-id="3631e-104">Troubleshoot the Office integration</span></span>

[!include [banner](../includes/banner.md)]


<span data-ttu-id="3631e-105">このトピックでは、Microsoft Office 統合の機能に関する質問、ヒント、およびトラブルシューティング情報への回答を示します。</span><span class="sxs-lookup"><span data-stu-id="3631e-105">This topic provides answers to questions, tips, and troubleshooting information about the capabilities of the Microsoft Office integration.</span></span> <span data-ttu-id="3631e-106">説明されている質問と問題は、ユーザー、管理、および開発のシナリオにわたっています。</span><span class="sxs-lookup"><span data-stu-id="3631e-106">The questions and issues that are discussed range across user, administration, and development scenarios.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="3631e-107">よく寄せられる質問</span><span class="sxs-lookup"><span data-stu-id="3631e-107">Frequently asked questions</span></span>

### <a name="what-platforms-do-the-office-add-ins-support"></a><span data-ttu-id="3631e-108">Office アドインはどのようなプットフォームをサポートしますか ?</span><span class="sxs-lookup"><span data-stu-id="3631e-108">What platforms do the Office Add-ins support?</span></span>

<span data-ttu-id="3631e-109">Microsoft Excel アドインと Microsoft Word アドインは、Office Web/JavaScript アドイン フレームワークを使用して構築されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-109">The Microsoft Excel Add-in and Microsoft Word Add-in are built by using the Office Web/JavaScript Add-in framework.</span></span> <span data-ttu-id="3631e-110">このフレームワークは最初は Microsoft Office 2013 用にリリースされましたが、Microsoft Office 2016 では重要な更新が行われました。</span><span class="sxs-lookup"><span data-stu-id="3631e-110">This framework was originally released for Microsoft Office 2013 but received significant updates in Microsoft Office 2016.</span></span> <span data-ttu-id="3631e-111">詳細については、[Office アドイン ホストおよびプラットフォームの可用性](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-111">For more information, see [Office Add-in host and platform availability](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability).</span></span> <span data-ttu-id="3631e-112">Excel アドインには ExcelAPI 1.2 が必要です。</span><span class="sxs-lookup"><span data-stu-id="3631e-112">The Excel Add-in requires ExcelAPI 1.2.</span></span> <span data-ttu-id="3631e-113">したがって、Excel アドインをサポートするプラットフォームを判断するには、[[Office アドイン ホストおよびプラットフォームの可用性](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability)] マトリックスを使用します。</span><span class="sxs-lookup"><span data-stu-id="3631e-113">Therefore, use the [Office Add-in host and platform availability](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability) matrix to determine which platforms support the Excel Add-in.</span></span> <span data-ttu-id="3631e-114">多くのユーザーにとって、語句「Excel 2016 と最新の更新」で十分です。</span><span class="sxs-lookup"><span data-stu-id="3631e-114">For many users, the phrase "Excel 2016 with the latest updates" is sufficient.</span></span>

### <a name="are-the-office-add-ins-safe"></a><span data-ttu-id="3631e-115">Office アドインは安全ですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-115">Are the Office Add-ins safe?</span></span>

<span data-ttu-id="3631e-116">マルウェア、完全な接続、およびコンプライアンス リスクがあるうちは、完全に安全なものはありません。</span><span class="sxs-lookup"><span data-stu-id="3631e-116">In an age of malware, full connectivity, and compliance risks, nothing is completely secure.</span></span> <span data-ttu-id="3631e-117">ただし、他の Web サイトと同様、Web アドインは基本的に、制限のあるアプリケーション プログラミング インターフェイス (API) 経由で Office クライアント製品と対話する Web アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="3631e-117">However, the web add-ins, like other websites, are basically a web application that interacts with the Office client products via a limited application programming interface (API).</span></span> <span data-ttu-id="3631e-118">詳細については、 [Office アドイン プラットフォームの概要](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-118">For more details, see [Office Add-ins platform overview](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)</span></span>

### <a name="does-the-excel-add-in-support-office-for-mac"></a><span data-ttu-id="3631e-119">Excel アドインは Mac のために Office をサポートしますか。</span><span class="sxs-lookup"><span data-stu-id="3631e-119">Does the Excel Add-in support Office for Mac?</span></span>

<span data-ttu-id="3631e-120">No.</span><span class="sxs-lookup"><span data-stu-id="3631e-120">No.</span></span> <span data-ttu-id="3631e-121">Apple Mac および iOS のサポートは、現在開発中です。</span><span class="sxs-lookup"><span data-stu-id="3631e-121">Support for Apple Mac and iOS is currently under development.</span></span> <span data-ttu-id="3631e-122">Office JavaScript (JS) API は、特に認証に関しては、Apple Safari と Internet Explorer で動作が異なります。</span><span class="sxs-lookup"><span data-stu-id="3631e-122">The Office JavaScript (JS) APIs work differently in Apple Safari and Internet Explorer, especially in respect to authentication.</span></span> <span data-ttu-id="3631e-123">Office JS API のプラットフォーム サポートの詳細については、[Office アドイン ホストおよびプラットフォームの可用性](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-123">For details about platform support for the Office JS APIs, see [Office Add-in host and platform availability](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-in-availability).</span></span>

### <a name="what-version-of-office-is-required-for-the-excel-add-in-to-support-ad-fs"></a><span data-ttu-id="3631e-124">Excel アドインが AD FS をサポートするために必要な Office のバージョンとは</span><span class="sxs-lookup"><span data-stu-id="3631e-124">What version of Office is required for the Excel Add-in to support AD FS?</span></span>

<span data-ttu-id="3631e-125">詳細については、このトピックで後述する「問題のトラブルシューティング」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-125">For more information, see the "Troubleshooting issue" section later in this topic.</span></span>

### <a name="how-can-i-force-an-update-of-office"></a><span data-ttu-id="3631e-126">どのように Office の更新を強制できますか。</span><span class="sxs-lookup"><span data-stu-id="3631e-126">How can I force an update of Office?</span></span>

<span data-ttu-id="3631e-127">Office ビルドが更新されない場合、遅延したトラックにある場合があります ([Microsoft 365 アプリ更新チャネルの概要](https://technet.microsoft.com/library/mt455210.aspx))。</span><span class="sxs-lookup"><span data-stu-id="3631e-127">If your Office build isn't updated, you might be on the deferred track ([Overview of update channels for Microsoft 365 Apps](https://technet.microsoft.com/library/mt455210.aspx)).</span></span> <span data-ttu-id="3631e-128">この場合、[Office 配置ツールを使用して現在のチャネルに移動する](https://technet.microsoft.com/library/jj219422.aspx?f=255&MSPPError=-2147217396) を使用するか、最新の更新プログラムがあることを保証するために [Office Insider プログラム](https://products.office.com/office-insider) にサインアップできます。</span><span class="sxs-lookup"><span data-stu-id="3631e-128">In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/office-insider) to help guarantee that you have the latest updates.</span></span> <span data-ttu-id="3631e-129">最も簡単な方法は、Office 配置ツールを使用して現在のチャネルに切り替えることです。</span><span class="sxs-lookup"><span data-stu-id="3631e-129">The easiest method is to use the Office Deployment Tool to switch to the Current channel.</span></span> <span data-ttu-id="3631e-130">この場合、最新の更新プログラムはすぐにインストールされます。</span><span class="sxs-lookup"><span data-stu-id="3631e-130">In this case, the latest updates will be installed immediately.</span></span>

### <a name="why-cant-you-tell-me-what-version-of-office-or-excel-a-particular-issue-is-fixed-in"></a><span data-ttu-id="3631e-131">どのバージョンの Office または Excel で特定の問題が修正されたか知ることができないのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-131">Why can't you tell me what version of Office or Excel a particular issue is fixed in?</span></span>

<span data-ttu-id="3631e-132">Office には、多くのリリースがあります。</span><span class="sxs-lookup"><span data-stu-id="3631e-132">Office has many releases.</span></span> <span data-ttu-id="3631e-133">これらのリリースは、さまざまな時刻にアップデートを受け取り、対応しないさまざまなバージョン番号を持ちます。</span><span class="sxs-lookup"><span data-stu-id="3631e-133">These releases receive updates at different times and have different version numbers that don't correspond.</span></span> <span data-ttu-id="3631e-134">頻繁に使用されるいくつかのバージョンの Office および更新メソッドは、Click to Run (C2R) Current channel、C2R Deferred、C2R First Update Deferred、Office Insider Fast、Office Insider Slow、MSI/MSO (DVD からインストール) です。</span><span class="sxs-lookup"><span data-stu-id="3631e-134">Some frequently used Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD).</span></span> <span data-ttu-id="3631e-135">Office のバージョンの詳細については、[Microsoft 365 アプリの更新に関するリリース情報](https://technet.microsoft.com/office/mt465751?f=255&MSPPError=-2147217396) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-135">For more information about Office versions, see the [Release information for updates to Microsoft 365 Apps](https://technet.microsoft.com/office/mt465751?f=255&MSPPError=-2147217396) page.</span></span>

### <a name="why-am-i-having-trouble-signing-into-the-excel-add-in"></a><span data-ttu-id="3631e-136">Excel アドインへのサインインに問題が生じるのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-136">Why am I having trouble signing into the Excel Add-in?</span></span>

<span data-ttu-id="3631e-137">Excel アドインは、Internet Explorer ウィンドウ内で動作します。</span><span class="sxs-lookup"><span data-stu-id="3631e-137">The Excel Add-in runs inside an Internet Explorer window.</span></span> <span data-ttu-id="3631e-138">既定では、Excel アドインは Internet Explorer から保存されている資格情報を取得し、保存されている資格情報がない場合には Internet Explorer が現在の Microsoft Windows の資格情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="3631e-138">By default, the Excel Add-in picks up stored credentials from Internet Explorer, and Internet Explorer provides the current Microsoft Windows credentials if there are no stored credentials.</span></span> <span data-ttu-id="3631e-139">適切な資格情報を使用してサインインしていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3631e-139">Make sure that you're using the correct credentials to sign in.</span></span> <span data-ttu-id="3631e-140">Excel アドインで、明示的にサインアウトしてから、適切な資格情報が使用されていることを保証するためにサインインします。</span><span class="sxs-lookup"><span data-stu-id="3631e-140">In the Excel Add-in, explicitly sign out, and then sign in to help guarantee that the correct credentials are used.</span></span>

### <a name="the-excel-add-in-seems-to-be-slow-when-it-publishes-records-how-can-i-learn-more-about-what-is-occurring"></a><span data-ttu-id="3631e-141">レコードを発行するとき、Excel アドインが遅くなったように見えます。</span><span class="sxs-lookup"><span data-stu-id="3631e-141">The Excel Add-in seems to be slow when it publishes records.</span></span> <span data-ttu-id="3631e-142">何が起こっているかについてもっと知るにはどうすればいいですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-142">How can I learn more about what is occurring?</span></span>

<span data-ttu-id="3631e-143">Excel アドインが実行する作業のほとんどは、サーバーで発生させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-143">Most of the work that the Excel Add-in does should occur on the server.</span></span> <span data-ttu-id="3631e-144">時間が費やされている場所を知るには、[[Fiddler (無償ダウンロード)](https://www.telerik.com/fiddler)] を使用して Excel アドインが期待通りに機能することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-144">To learn where the time is being spent, you can use [Fiddler (a free download)](https://www.telerik.com/fiddler) to make sure that the Excel Add-in works as you expect.</span></span>

<span data-ttu-id="3631e-145">Excel アドインは、公開されているレコードを要求として送信します。</span><span class="sxs-lookup"><span data-stu-id="3631e-145">The Excel Add-in sends the published records as a request.</span></span> <span data-ttu-id="3631e-146">これらのレコードが処理されると、サーバーから応答が送信されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-146">When those records are processed, the response is sent back from the server.</span></span> <span data-ttu-id="3631e-147">次に、Excel アドインは公開するレコードの次のセットを含む別のメッセージを作成し、その要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="3631e-147">The Excel Add-in then creates another message that contains the next set of records to publish, and sends that request.</span></span> <span data-ttu-id="3631e-148">Excel アドインでは、サーバーからの以前の応答から、サーバーへの次の要求の間での処理時間に 5 から 10 秒を要します。</span><span class="sxs-lookup"><span data-stu-id="3631e-148">Five to ten seconds of processing time in the Excel Add-in should be required between the previous response from the server and the next request to the server.</span></span>

<span data-ttu-id="3631e-149">Excel アドインとサーバー/サービスの処理時間の関係を確認するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="3631e-149">To check processing time in the Excel Add-in versus the server/service, follow these steps.</span></span>

1. <span data-ttu-id="3631e-150">[Fiddler](https://www.telerik.com/fiddler) を起動します。</span><span class="sxs-lookup"><span data-stu-id="3631e-150">Start [Fiddler](https://www.telerik.com/fiddler).</span></span> 
2. <span data-ttu-id="3631e-151">プロセスをテストするいくつかのレコードを公開します。</span><span class="sxs-lookup"><span data-stu-id="3631e-151">Publish a few records to test the process.</span></span>
3. <span data-ttu-id="3631e-152">Fiddler でその要求と応答を表示できることを確認します ([HTTPS トラフィックが復号化されていることを確認します](https://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS))。</span><span class="sxs-lookup"><span data-stu-id="3631e-152">Make sure that you can view that request and response in Fiddler ([make sure that HTTPS traffic is being decrypted](https://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS)).</span></span>
4. <span data-ttu-id="3631e-153">多数のレコードを公開します。</span><span class="sxs-lookup"><span data-stu-id="3631e-153">Publish a larger number of records.</span></span> 
5. <span data-ttu-id="3631e-154">Fiddler では、要求から応答までに必要な時間と、応答から次の要求までに必要な時間を監視します。</span><span class="sxs-lookup"><span data-stu-id="3631e-154">In Fiddler, watch the time that is required from a request to its response, and from a response to the next request.</span></span>

    - <span data-ttu-id="3631e-155">要求から応答までの時間が長い場合、ボトルネックはサーバー/サービスです。</span><span class="sxs-lookup"><span data-stu-id="3631e-155">If the time from a request to its response is large, the bottleneck is the server/service.</span></span>
    - <span data-ttu-id="3631e-156">次の要求への応答時間が大きい場合は、ボトルネックは Excel アドイン (つまり、クライアント) です。</span><span class="sxs-lookup"><span data-stu-id="3631e-156">If the time from a response to the next request is large, the bottleneck is the Excel Add-in (that is, the client).</span></span>

### <a name="why-is-the-export-to-excel-functionality-limited-to-10000-records-prior-to-platform-update-22"></a><span data-ttu-id="3631e-157">Excel にエクスポート機能が 10,000 レコードに制限されているのはなぜですか (プラットフォーム更新 22 より前)?</span><span class="sxs-lookup"><span data-stu-id="3631e-157">Why is the Export to Excel functionality limited to 10,000 records (prior to Platform update 22)?</span></span>

<span data-ttu-id="3631e-158">プラットフォーム更新 22 より前では、Excel にエクスポート機能が 10,000 レコードに制限されています。</span><span class="sxs-lookup"><span data-stu-id="3631e-158">Prior to Platform update 22, the Export to Excel functionality is limited to 10,000 records.</span></span> <span data-ttu-id="3631e-159">エクスポート処理では、フォーマットされた値、計算された値、および一時テーブルのデータなど、取得できないフィールドとデータを次のレコードに提供するために、データのエクスポート元のフォームが使用されるため、この制限があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-159">This limitation is in place because the export process uses the form from which data is being exported to provide the following records with fields and data that can't be obtained otherwise: formatted values, calculated values, and temporary table data.</span></span> <span data-ttu-id="3631e-160">エクスポート時にフォームが使用されるため、特定のコンピューターのすべてのユーザーが共有するクライアント プロセス内で処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="3631e-160">Because the form is used during the export, it occurs inside the client process that is shared by all the users on a given computer.</span></span> <span data-ttu-id="3631e-161">エクスポート中に、他のユーザーはクライアントとの対話をブロックされます。</span><span class="sxs-lookup"><span data-stu-id="3631e-161">During the export, those other users are blocked from interacting with the client.</span></span>

<span data-ttu-id="3631e-162">プラットフォーム更新 22 以降では、Excel にエクスポートに進捗状況ダイアログ ボックスがあり、他のユーザーをブロックしているプロセスがなくなったため、大規模なデータセットをエクスポートできます。</span><span class="sxs-lookup"><span data-stu-id="3631e-162">With Platform update 22 and later, Export to Excel has a progress dialog box and is no longer a blocking process for other users, so larger datasets can be exported.</span></span> <span data-ttu-id="3631e-163">Excel 経由でのデータのエクスポートは、Excel アドインまたはデータ管理フレームワークを使用する場合よりも遅くなりますが、グリッドに表示されるデータが正確に返されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-163">Exporting data via Export to Excel will be slower than using the Excel Add-in or the Data Management framework, but it will return exactly the data shown in the grid.</span></span> <span data-ttu-id="3631e-164">これは、フィルター処理されたデータセットの場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="3631e-164">This is useful for filtered datasets.</span></span> <span data-ttu-id="3631e-165">ユーザーには、任意の時点で停止することができるダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-165">The user is presented with a dialog box that allows them to stop at any point.</span></span> <span data-ttu-id="3631e-166">エクスポートには時間がかかることがあるため、自動ダウンロード オプションを有効にした Chrome または Edge ブラウザーを使用して行うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3631e-166">Because the export can take some time, it is recommended that the export is done with the Chrome or Edge browsers, with the automatic download option enabled.</span></span> <span data-ttu-id="3631e-167">自動ダウンロード オプションを使用すれば、15 分の時間制限内にダウンロード リンクが使用されるように、ブラウザーはエクスポートが完了するとすぐにファイルをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="3631e-167">The automatic download option will ensure that the browser downloads the file as soon as the export is complete to ensure that the download link is used within the 15-minute time limit.</span></span>

<span data-ttu-id="3631e-168">Excel にエクスポートの理想的な代替は、[Excel で開く] と Excel アドインを使用することです。</span><span class="sxs-lookup"><span data-stu-id="3631e-168">The ideal alternative to Export to Excel is to use Open in Excel and the Excel Add-in.</span></span> <span data-ttu-id="3631e-169">Excel アドインは、OData サービスを使用してデータを取得し、エンティティが提供するセキュリティを活用します。</span><span class="sxs-lookup"><span data-stu-id="3631e-169">The Excel Add-in retrieves data by using the OData service, and takes advantage of the security that the entities provide.</span></span> <span data-ttu-id="3631e-170">データ管理フレームワーク (DMF) およびデータ インポート/エクスポート フレームワーク (DIXF) のインポートおよびエクスポート機能も使用できます。</span><span class="sxs-lookup"><span data-stu-id="3631e-170">The import and export capabilities in the Data management framework (DMF) and Data import/export framework (DIXF) can also be used.</span></span> <span data-ttu-id="3631e-171">ただし、DMF/DIXF は、多くの場合管理者に限定されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-171">However, DMF/DIXF is often limited to administrators.</span></span>

<span data-ttu-id="3631e-172">ユーザーが Excel アドイン経由でデータにアクセスすることに懸念がある場合、レコードを更新できないようにする必要があるため、次の点を考慮します。</span><span class="sxs-lookup"><span data-stu-id="3631e-172">If you have concerns about giving users access to the data via the Excel Add-in, because they should not be able to update records, consider the following points:</span></span>

- <span data-ttu-id="3631e-173">エンティティには、フォームにあるすべての検証とロジックが必要です。</span><span class="sxs-lookup"><span data-stu-id="3631e-173">The entities should have all the validation and logic that the forms have.</span></span> <span data-ttu-id="3631e-174">所有していない場合は、バグです。</span><span class="sxs-lookup"><span data-stu-id="3631e-174">If they don't, it's a bug.</span></span> 
- <span data-ttu-id="3631e-175">エンティティが保護される方法は、フォームが保護される方法と似ています。</span><span class="sxs-lookup"><span data-stu-id="3631e-175">The way that entities are secured resembles the way that forms are secured.</span></span> <span data-ttu-id="3631e-176">したがって、ユーザーがそのデータを公開するフォームを使用してデータを更新または書き込みする権限を持っていない場合、ユーザーはそのデータを公開するエンティティを使用してデータを更新または書き込みする権限を持つべきではありません。</span><span class="sxs-lookup"><span data-stu-id="3631e-176">Therefore, if a user should not have permission to update or write data by using a form that exposes that data, the user should not have permission to update or write data by using an entity that exposes that data.</span></span> 

### <a name="why-is-the-publish-button-in-the-excel-add-in-unavailable"></a><span data-ttu-id="3631e-177">Excel アドインで公開ボタンが利用できないのはなぜですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-177">Why is the Publish button in the Excel Add-in unavailable?</span></span> 

<span data-ttu-id="3631e-178">エンティティにデータを公開するには、すべてのキーおよび必須フィールドが存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-178">All key and mandatory fields must be present to publish data back to the entity.</span></span> <span data-ttu-id="3631e-179">バインドにフィールドを追加するようにデザインを編集してみてください。</span><span class="sxs-lookup"><span data-stu-id="3631e-179">Try to edit the design to add more fields to the binding.</span></span> 

### <a name="why-are-the-excel-add-in-the-word-add-in-and-the-open-in-excel-options-only-available-when-the-internet-is-available"></a><span data-ttu-id="3631e-180">Excel アドイン、Word アドイン、および Excel で開くオプションは、インターネットが利用可能な場合にのみ利用できます。</span><span class="sxs-lookup"><span data-stu-id="3631e-180">Why are the Excel Add-in, the Word Add-in, and the Open in Excel options only available when the Internet is available?</span></span>

<span data-ttu-id="3631e-181">オンプレミスを含むすべての環境で、Excel と Word のアドインとライブラリは複数のインターネット地点からロードされます。したがってインターネットが使用可能な場合にのみ実行します。</span><span class="sxs-lookup"><span data-stu-id="3631e-181">For all environments, including on-premises, the Excel and Word Add-ins, and the libraries they use, are loaded from multiple Internet locations and therefore will only run when the Internet is available.</span></span> <span data-ttu-id="3631e-182">オンプレミス環境では、インターネットが利用できない場合、コンテンツ配信ネットワーク (CDN) にアクセスできず Excel アドインが実行されないため、Excel で開くオプションは非表示になります。</span><span class="sxs-lookup"><span data-stu-id="3631e-182">For on-premises environments, when the Internet is not available, the Open in Excel options are hidden because the Excel Add-in will not run without access to the Content Delivery Network (CDN) that houses the Excel Add-in.</span></span> 

### <a name="can-the-excel-add-in-and-word-add-in-be-made-available-to-users-using-centralized-deployment"></a><span data-ttu-id="3631e-183">一元化配置を使用して、Excel アドインと Word アドインをユーザーが利用できるようにできますか。</span><span class="sxs-lookup"><span data-stu-id="3631e-183">Can the Excel Add-in and Word Add-in be made available to users using Centralized Deployment?</span></span>

<span data-ttu-id="3631e-184">はい、一元化配置はサポートされています。</span><span class="sxs-lookup"><span data-stu-id="3631e-184">Yes, Centralized Deployment is supported.</span></span> <span data-ttu-id="3631e-185">詳細については、「[一元化配置](https://docs.microsoft.com/office/dev/add-ins/publish/centralized-deployment)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-185">For more information, see [Centralized Deployment](https://docs.microsoft.com/office/dev/add-ins/publish/centralized-deployment).</span></span> 

<span data-ttu-id="3631e-186">一元化配置を使用するには、**Office アプリのパラメーター** ページの **アプリのパラメーター** タブで **アプリ ID**、**ストア**、**ストア タイプ** を変更します:</span><span class="sxs-lookup"><span data-stu-id="3631e-186">To use Centralized Deployment, on the **App parameters** tab on the **Office App Parameters** page change the **App ID**, **Store**, and **Store Type**:</span></span>

- <span data-ttu-id="3631e-187">**アプリ ID**: 61bcc63f-b860-4280-8280-3e4fb5ea7726</span><span class="sxs-lookup"><span data-stu-id="3631e-187">**App ID**: 61bcc63f-b860-4280-8280-3e4fb5ea7726</span></span>
- <span data-ttu-id="3631e-188">**ストア**: EXCatalog</span><span class="sxs-lookup"><span data-stu-id="3631e-188">**Store**: EXCatalog</span></span>
- <span data-ttu-id="3631e-189">**ストア タイプ**: 一元化配置</span><span class="sxs-lookup"><span data-stu-id="3631e-189">**Store Type**: Centralized Deployment</span></span>

<span data-ttu-id="3631e-190">Office ストアへの戻しが必要な場合、標準値は次のとおりです:</span><span class="sxs-lookup"><span data-stu-id="3631e-190">In case a change back to Office Store is needed, the standard values are:</span></span>
- <span data-ttu-id="3631e-191">**アプリ ID**: WA104379629</span><span class="sxs-lookup"><span data-stu-id="3631e-191">**App ID**: WA104379629</span></span>
- <span data-ttu-id="3631e-192">**ストア**: en-US</span><span class="sxs-lookup"><span data-stu-id="3631e-192">**Store**: en-US</span></span>
- <span data-ttu-id="3631e-193">**ストア タイプ**: Office ストア</span><span class="sxs-lookup"><span data-stu-id="3631e-193">**Store Type**: Office Store</span></span>

> [!NOTE]
>- <span data-ttu-id="3631e-194">**名前**、**バージョン**、および **メモ** は情報を提供する値ですが、Excel アドインを実行するために必要ではありません。</span><span class="sxs-lookup"><span data-stu-id="3631e-194">**Name**, **Version**, and **Notes** are values that provide information but they are not needed to run the Excel Add-in.</span></span>
>- <span data-ttu-id="3631e-195">これらの値は、ドキュメント テンプレートのフォームから実行されるときに Word アドインに対しても使用されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-195">These same values are also used for the Word Add-in when it is run from the Document Templates form.</span></span>

<span data-ttu-id="3631e-196">一部のユーザーに一元化配置で問題が発生した場合は、次のいずれかの問題が考えられます:</span><span class="sxs-lookup"><span data-stu-id="3631e-196">If you encounter issues with Centralized Deployment for some users, it could be one of these problems:</span></span>
-   <span data-ttu-id="3631e-197">グループの 1 人以上のユーザーが、他よりも制限が厳しいメンバー</span><span class="sxs-lookup"><span data-stu-id="3631e-197">One or more users are members in a group that is more restrictive than others</span></span>
-   <span data-ttu-id="3631e-198">参照されたユーザーが別の Microsoft 365 アカウント (個人アカウントなど) にある</span><span class="sxs-lookup"><span data-stu-id="3631e-198">The user referenced is on a different Microsoft 365 account (such as a personal account)</span></span>

### <a name="what-is-the-cell-limit-for-the-excel-add-in"></a><span data-ttu-id="3631e-199">Excel アドインのセル制限は何ですか。</span><span class="sxs-lookup"><span data-stu-id="3631e-199">What is the cell limit for the Excel Add-in?</span></span>

<span data-ttu-id="3631e-200">既定の Excel アドインのセル制限は、Excel アドインが適度に高速なマシン上で処理できる上限の約半分になります。</span><span class="sxs-lookup"><span data-stu-id="3631e-200">The default Excel Add-in cell limit is about half the limit of what the Excel Add-in can handle on a reasonably fast machine.</span></span> <span data-ttu-id="3631e-201">マシンの速度は制限です。</span><span class="sxs-lookup"><span data-stu-id="3631e-201">The speed of the machine is the limitation.</span></span> <span data-ttu-id="3631e-202">問題が発生した場合は、セル制限を小さくし、そして / または、フィルターを調整してデータ セットを小さくする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-202">If problems are encountered, then the cell limit should be reduced and/or the filter should be adjusted to reduce the data set.</span></span> <span data-ttu-id="3631e-203">一般的な回避策として、フィルターを使用してデータを一度にもっと小さく管理することができます。</span><span class="sxs-lookup"><span data-stu-id="3631e-203">A common workaround is to use a filter to manage the data in smaller pieces instead of all at once.</span></span>

### <a name="how-do-i-make-an-entity-available-in-the-excel-add-in-andor-as-an-open-in-excel-option"></a><span data-ttu-id="3631e-204">エンティティを Excel アドインまたは Excel で開くオプションとして使用できるようにするにはどうすればよいですか?</span><span class="sxs-lookup"><span data-stu-id="3631e-204">How do I make an entity available in the Excel Add-in and/or as an Open in Excel option?</span></span>

<span data-ttu-id="3631e-205">エンティティが "IsPublic = Yes" としてマークされており、固有の PublicEntityName と PublicCollectionName の値がある場合は、ODataサービス経由で使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="3631e-205">If the entity is marked as “IsPublic=Yes” and has unique PublicEntityName and PublicCollectionName values, then it will be available via the OData service.</span></span> <span data-ttu-id="3631e-206">(できればGoogle Chromeで) 環境の $metadata フィード を調べることによって、同じ PublicEntityName と PublicCollectionName の値を持つ既存のエンティティがないことを確認します: https://*SomeFullEnvironmentURL*.dynamics.com/data/$metadata</span><span class="sxs-lookup"><span data-stu-id="3631e-206">Check that there aren’t any existing entities with the same PublicEntityName and PublicCollectionName values by looking at the $metadata feed for the environment (preferably in Google Chrome): https://*SomeFullEnvironmentURL*.dynamics.com/data/$metadata</span></span>

### <a name="why-are-date-and-time-values-in-utc-in-the-excel-add-in"></a><span data-ttu-id="3631e-207">Excel アドインで日付と時刻の値がUTCに設定されるのはなぜですか？</span><span class="sxs-lookup"><span data-stu-id="3631e-207">Why are date and time values in UTC in the Excel Add-in?</span></span>

<span data-ttu-id="3631e-208">Excelアドイン、データ管理 フレームワーク、 Power BI レポートはすべて、データベース レベル で データと直接やり取りするように設計されています。</span><span class="sxs-lookup"><span data-stu-id="3631e-208">The Excel Add-In, Data Management Framework, and Power BI reporting are all designed to interact with data directly on the database level.</span></span> <span data-ttu-id="3631e-209">ユーザーのタイムゾーンに合わせて日付と時刻のデータを調整するクライアントが存在しないため、日付と時刻の値はすべて UTC となります。</span><span class="sxs-lookup"><span data-stu-id="3631e-209">Because there is no client to adjust Date and Time data to the time zone of the user, all Date and Time values are in UTC.</span></span>

## <a name="troubleshooting-issues"></a><span data-ttu-id="3631e-210">問題のトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="3631e-210">Troubleshooting issues</span></span>

### <a name="fixed-issue-during-sign-in-to-the-excel-add-in-i-receive-the-following-error-message-aadsts65001-the-user-or-administrator-has-not-consented-to-use-the-application-with-id-xyz"></a><span data-ttu-id="3631e-211">\[固定\] 問題: Excel アドインへのサインイン中に、次のエラー メッセージが表示されます: 「AADSTS65001: ユーザーまたは管理者が ID XYZ のアプリケーションを使用することに同意していません」</span><span class="sxs-lookup"><span data-stu-id="3631e-211">\[Fixed\] Issue: During sign-in to the Excel Add-in, I receive the following error message: "AADSTS65001: The user or administrator has not consented to use the application with ID XYZ"</span></span>

<span data-ttu-id="3631e-212">**問題:** Excel アドインへのサインイン中に、次のエラー メッセージが表示されます。「AADSTS65001: ユーザーまたは管理者が ID XYZ でアプリケーションを使用することに同意しませんでした」。</span><span class="sxs-lookup"><span data-stu-id="3631e-212">**Issue:** During sign in to the Excel Add-in, you receive the following error message: "AADSTS65001: The user or administrator has not consented to use the application with ID XYZ."</span></span>

<span data-ttu-id="3631e-213">**説明:** 通常、この問題は、Microsoft Azure Active Directory (Azure AD) が Excel アドインを表す Azure AD アプリケーションを検出できないために発生します。</span><span class="sxs-lookup"><span data-stu-id="3631e-213">**Explanation:** Typically, this issue occurs because Microsoft Azure Active Directory (Azure AD) can't find the Azure AD application that represents the Excel Add-in.</span></span> <span data-ttu-id="3631e-214">その問題は、「[Microsoft Power BI のコンフィギュレーション](../analytics/configure-power-bi-integration.md)」中、アプリケーション ID URI が環境 URL に設定された Azure AD アプリケーションが追加されたために発生します。</span><span class="sxs-lookup"><span data-stu-id="3631e-214">That issue occurs because, during the [configuration of Microsoft Power BI](../analytics/configure-power-bi-integration.md), an Azure AD application was added that has the App ID URI set to the environment URL.</span></span> 

<span data-ttu-id="3631e-215">**修正**: Azure AD アプリケーションのアプリケーション ID URI が環境 URL に設定されていないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="3631e-215">**Fix:** Make sure that no Azure AD apps have the App ID URI set to the environment URL.</span></span> <span data-ttu-id="3631e-216">アプリ ID URI は、`https://contosoAXPowerBI` などの固有の URI で作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-216">App ID URIs should be fabricated, unique URIs, such as `https://contosoAXPowerBI`.</span></span>

### <a name="fixed-issue-during-sign-in-to-the-excel-add-in-i-receive-the-following-error-message-aadsts50001-the-application-named-abc-was-not-found-in-the-tenant-named-xyz"></a><span data-ttu-id="3631e-217">\[固定\] 問題: Excel アドインへのサインイン中に、次のエラー メッセージが表示されます: 「AADSTS50001: ABC という名前のアプリケーションが XYZ という名前のテナントに見つかりませんでした」</span><span class="sxs-lookup"><span data-stu-id="3631e-217">\[Fixed\] Issue: During sign-in to the Excel Add-in, I receive the following error message: "AADSTS50001: The application named ABC was not found in the tenant named XYZ"</span></span>

<span data-ttu-id="3631e-218">**問題:** Excel アドインへのサインイン中に、次のエラー メッセージが表示されます。「AADSTS50001: XYZ という名前のテナントに ABC という名前のアプリケーションが見つかりませんでした」。</span><span class="sxs-lookup"><span data-stu-id="3631e-218">**Issue:** During sign-in to the Excel Add-in, you receive the following error message: "AADSTS50001: The application named ABC was not found in the tenant named XYZ."</span></span>

<span data-ttu-id="3631e-219">**説明:** この問題は、配置システムのエラーにより、環境がテナントのサービス プリンシパルのコンフィギュレーション済の一覧に追加されていない URL を取得したために発生している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-219">**Explanation:** This issue probably occurs because an error in the deployment system caused the environment to get a URL that wasn't added to the configured list of service principals for the tenant.</span></span> 

<span data-ttu-id="3631e-220">**修正:** 環境に関するサポート問題を提出し、問題を調査し、コンフィギュレーションを調整できるようにします。</span><span class="sxs-lookup"><span data-stu-id="3631e-220">**Fix:** File a support issue for your environment, so that the problem can be investigated and the configuration can be adjusted.</span></span>

### <a name="fixed-issue-after-the-excel-add-in-starts-and-updates-data-i-receive-the-following-error-message-an-error-occurred-while-writing-to-the-data-cache"></a><span data-ttu-id="3631e-221">\[固定\] 問題: Excel アドインが起動してデータを更新した後、次のエラー メッセージが表示されます: 「データ キャッシュへの書き込み中にエラーが発生しました」</span><span class="sxs-lookup"><span data-stu-id="3631e-221">\[Fixed\] Issue: After the Excel Add-in starts and updates data, I receive the following error message: "An error occurred while writing to the data cache"</span></span>

<span data-ttu-id="3631e-222">**問題:** Excel アドインを開始してデータを更新すると、次のエラー メッセージが表示されます。「データ キャッシュに書き込み中にエラーが発生しました」。</span><span class="sxs-lookup"><span data-stu-id="3631e-222">**Issue:** After the Excel Add-in starts and updates data, you receive the following error message: "An error occurred while writing to the data cache."</span></span> <span data-ttu-id="3631e-223">エラー状態の詳細は次の通りです。「引数が無効または不足している、またはフォーマットが正しくありません」</span><span class="sxs-lookup"><span data-stu-id="3631e-223">The details of the error state, "The argument is invalid or missing or has an incorrect format."</span></span> 

<span data-ttu-id="3631e-224">**説明**: クライアントを Internet Explorer で開いていて、ユーザーが **Excel で開く**オプションを選択した直後に、**開く**をクリックすると、このエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-224">**Explanation:** You receive this error message if the client is open in Internet Explorer, and the user clicks **Open** immediately after he or she selects the **Open in Excel** option.</span></span> <span data-ttu-id="3631e-225">Internet Explorer が一時的なインターネット ファイルを処理する方法は、Excel で問題を引き起こします。</span><span class="sxs-lookup"><span data-stu-id="3631e-225">The way that Internet Explorer handles temporary Internet files causes an issue in Excel.</span></span> <span data-ttu-id="3631e-226">この問題は、API 呼び出しの失敗の原因となります。</span><span class="sxs-lookup"><span data-stu-id="3631e-226">This issue, in turn, causes API calls to fail.</span></span> 

<span data-ttu-id="3631e-227">**回避策**: Internet Explorer でブックを開く際、まず**保存**をクリックし、それから**開く**をクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="3631e-227">**Workaround:** In Internet Explorer, when you open a workbook, click **Save** first, and then click **Open**.</span></span> <span data-ttu-id="3631e-228">ファイルはダウンロード フォルダーから開かれます。</span><span class="sxs-lookup"><span data-stu-id="3631e-228">The file will then be opened from your Downloads folder.</span></span> <span data-ttu-id="3631e-229">別の方法として、Edge または Google Chrome ブラウザを使用します。</span><span class="sxs-lookup"><span data-stu-id="3631e-229">Alternately, use the Edge or Google Chrome browser.</span></span> <span data-ttu-id="3631e-230">既定では、これらの両方のブラウザはファイルをダウンロード フォルダに保存します。</span><span class="sxs-lookup"><span data-stu-id="3631e-230">By default, both these browsers save files to a Downloads folder.</span></span> <span data-ttu-id="3631e-231">したがって、問題は発生しません。</span><span class="sxs-lookup"><span data-stu-id="3631e-231">Therefore, the issue doesn't occur.</span></span> 

<span data-ttu-id="3631e-232">**長期的な修正プログラム:** Office チームと協力してこの問題を理解し、Excel で解決できるようにしています。</span><span class="sxs-lookup"><span data-stu-id="3631e-232">**Long-term fix:** We are working with the Office team to understand this issue so that it can be fixed in Excel.</span></span>

### <a name="issue-when-i-send-email-by-using-smtp-the-server-response-is-5760-smtp-client-does-not-have-permissions-to-send-as-this-sender"></a><span data-ttu-id="3631e-233">問題: SMTP を使用して電子メールを送信したとき、サーバーからの応答が「5.7.60 SMTP。クライアントにはこの送信者として送信する権限がありません」となります</span><span class="sxs-lookup"><span data-stu-id="3631e-233">Issue: When I send email by using SMTP, the server response is "5.7.60 SMTP; Client does not have permissions to send as this sender"</span></span>

<span data-ttu-id="3631e-234">**問題:** SMTP (Simple Mail Transfer Protocol) を使用して電子メールを送信すると、サーバーの応答として「5.7.60 SMTP; クライアントにこの送信者として送信するアクセス許可がありません」というエラー メッセージが表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="3631e-234">**Issue:** When you send email by using Simple Mail Transfer Protocol (SMTP), you might receive an error message that states that the server response was "5.7.60 SMTP; Client does not have permissions to send as this sender."</span></span> <span data-ttu-id="3631e-235">または、「レポートの生成中に問題が発生しました。」 というエラー メッセージの状態かもしれません。</span><span class="sxs-lookup"><span data-stu-id="3631e-235">Alternatively, the error message might state, "Something went wrong while generating the report."</span></span>

<span data-ttu-id="3631e-236">**説明:** この問題は、通常、電子メール アカウントの送信者アクセス許可が正しく設定されていないために発生します。</span><span class="sxs-lookup"><span data-stu-id="3631e-236">**Explanation:** This issue is usually caused by incorrect setup of the Send As permissions for the email account.</span></span> 

<span data-ttu-id="3631e-237">**修正:** Microsoft 365 管理センター (portal.office.com/Admin) で送信者アクセス許可をコンフィギュレーションできます。</span><span class="sxs-lookup"><span data-stu-id="3631e-237">**Fix:** You can configure Send As permissions in the Microsoft 365 admin center (portal.office.com/Admin).</span></span> <span data-ttu-id="3631e-238">**ユーザー** > **有効なユーザー** > **ユーザー** > **メールボックスのアクセス許可を編集** > **このメールボックスから電子メールを送信する**の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="3631e-238">Click **Users** > **Active users** > **User** > **Edit mailbox permissions** > **Send email from this mailbox**.</span></span> <span data-ttu-id="3631e-239">詳細については、[Microsoft 365 - 管理者ヘルプで別のユーザーにメールボックスのアクセス許可を付与する](https://support.office.com/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-239">For more information, see [Give mailbox permissions to another user in Microsoft 365 - Admin Help](https://support.office.com/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E).</span></span> 

<span data-ttu-id="3631e-240">次の図は、**電子メール パラメーター** ページでの SMTP の設定を示しています。</span><span class="sxs-lookup"><span data-stu-id="3631e-240">The following illustration shows the setup of SMTP on the **Email parameters** page.</span></span> <span data-ttu-id="3631e-241">ここで、送信メール サーバー、ポート、ユーザー名、パスワード、および Secure Sockets Layer (SSL) の要件を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-241">Here, you must provide the outgoing mail server, port, user name, password, and Secure Sockets Layer (SSL) requirements.</span></span> 

<span data-ttu-id="3631e-242">[![電子メール パラメータ ページ上の SMTP 設定タブ](./media/smtp.png)](./media/smtp.png)</span><span class="sxs-lookup"><span data-stu-id="3631e-242">[![SMTP settings tab on the Email parameters page](./media/smtp.png)](./media/smtp.png)</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3631e-243">すべてのユーザーは、SMTP アカウントに Microsoft 365 の電子メール設定での送信者アクセス許可を与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-243">All users must give the SMTP account Send As permissions on their email setup in Microsoft 365.</span></span> <span data-ttu-id="3631e-244">この構成は、Microsoft Exchange または Microsoft 365 管理ポータルのメールボックスのアクセス許可で行われます。</span><span class="sxs-lookup"><span data-stu-id="3631e-244">This configuration is done in the mailbox permissions in Microsoft Exchange or in the Microsoft 365 Admin portal.</span></span> <span data-ttu-id="3631e-245">次の図は、STMP サービスアカウントが、**送信者** セクションに追加されているテスト ユーザー アカウントの設定を示しています。</span><span class="sxs-lookup"><span data-stu-id="3631e-245">The following illustration shows the setup for the Test User account, where the STMP service account is added in the **Send As** section.</span></span> 

<span data-ttu-id="3631e-246">[![Microsoft 365 で送信者アクセス許可を付与されている SMTP アカウント](./media/o365.png)](./media/o365.png)</span><span class="sxs-lookup"><span data-stu-id="3631e-246">[![SMTP account that is granted Send As permissions in Microsoft 365](./media/o365.png)](./media/o365.png)</span></span>

### <a name="fixed-issue-the-office-add-ins-dont-yet-support-ad-fs"></a><span data-ttu-id="3631e-247">\[固定\] 問題: Office アドインでは、まだ AD FS をサポートしていない</span><span class="sxs-lookup"><span data-stu-id="3631e-247">\[Fixed\] Issue: The Office Add-ins don't yet support AD FS</span></span>

<span data-ttu-id="3631e-248">**影響を受けるバージョン:** CTP8 と 2016 年 2 月のリリース</span><span class="sxs-lookup"><span data-stu-id="3631e-248">**Affected versions:** CTP8 and the February 2016 releases</span></span> 

<span data-ttu-id="3631e-249">**問題**: Active Directory フェデレーションサービス (AD FS) を使用する Azure AD テナントのユーザーが Office アドインにサインインしようとすると (つまり、ユーザーがアカウントを入力して Tab キーを押すか、フィールド内をクリックしてパスワードを入力すると)、別のブラウザウィンドウが開きます。</span><span class="sxs-lookup"><span data-stu-id="3631e-249">**Issue:** When users from an Azure AD tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Office Add-ins (in other words, when the users enter their account, and then press Tab or click in the field to enter their password), a separate browser window opens.</span></span> <span data-ttu-id="3631e-250">このブラウザ ウィンドウには通常、`https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\#id\_token=` で始まる URL があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-250">This browser window usually has a URL that starts with `https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\#id\_token=`.</span></span> <span data-ttu-id="3631e-251">ユーザーがログインできません。</span><span class="sxs-lookup"><span data-stu-id="3631e-251">The user can't sign in.</span></span> 

<span data-ttu-id="3631e-252">**説明:** Office アドイン (Excel アドインと Word アドインの両方) へのサインイン中、テナントの AD FS サイトへのリダイレクトが発生します。</span><span class="sxs-lookup"><span data-stu-id="3631e-252">**Explanation:** During sign-in to the Office add-ins (both the Excel Add-in and the Word Add-in), a redirect to the AD FS site for the tenant occurs.</span></span> <span data-ttu-id="3631e-253">ただし、そのサイトは不明なため、許可されていないアプリケーション ドメイン (AppDomain) です。</span><span class="sxs-lookup"><span data-stu-id="3631e-253">However, that site is an unknown and therefore disallowed application domain (AppDomain).</span></span> 

<span data-ttu-id="3631e-254">**長期的な修正プログラム:** 2016 年 5 月 10 日にこの問題の長期的な修正プログラムが適切に配置されました。</span><span class="sxs-lookup"><span data-stu-id="3631e-254">**Long-term fix:** The long-term fix for this issue was put in place on May 10, 2016.</span></span> <span data-ttu-id="3631e-255">Office アドインは、Office チームが追加した新しいダイアログ API を使用するようになりました。</span><span class="sxs-lookup"><span data-stu-id="3631e-255">The Office Add-ins now use a new Dialog API that the Office team added.</span></span> 

<span data-ttu-id="3631e-256">**AD FS をサポートするアドイン アップデートを利用:** すべての Office のインストールは、**ファイル** > **アカウント** > **更新** (Click-to-Run インストールの場合) または Windows Update(MSI インストールの場合) を経由して更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-256">**Taking advantage of the add-in updates that support AD FS:** All Office installations should be updated via **File** > **Account** > **Updates** (for click-to-run installations) or via Windows Update (for MSI installations).</span></span> <span data-ttu-id="3631e-257">AD FS ダイアログ API は、5 月の更新プログラムに含められました (16.0.6868.2060)。</span><span class="sxs-lookup"><span data-stu-id="3631e-257">The AD FS Dialog API was included in the May update (16.0.6868.2060).</span></span> <span data-ttu-id="3631e-258">更新プログラムの詳細については、[Microsoft 365 クライアント更新チャネルのリリース](https://technet.microsoft.com/office/mt465751?f=255&MSPPError=-2147217396) ページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-258">For information about updates, see the [Microsoft 365 client update channel releases](https://technet.microsoft.com/office/mt465751?f=255&MSPPError=-2147217396) page.</span></span> 

<span data-ttu-id="3631e-259">Office ビルドが更新されない場合、遅延したトラックにある場合があります ([Microsoft 365 アプリ更新チャネルの概要](https://technet.microsoft.com/library/mt455210.aspx))。</span><span class="sxs-lookup"><span data-stu-id="3631e-259">If your Office build isn't updated, you might be on the deferred track ([Overview of update channels for Microsoft 365 Apps](https://technet.microsoft.com/library/mt455210.aspx)).</span></span> <span data-ttu-id="3631e-260">この場合、[Office 配置ツールを使用して現在のチャネルに移動する](https://technet.microsoft.com/library/jj219422.aspx?f=255&MSPPError=-2147217396) を使用するか、最新の更新プログラムがあることを保証するために [Office Insider プログラム](https://products.office.com/office-insider) にサインアップできます。</span><span class="sxs-lookup"><span data-stu-id="3631e-260">In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/office-insider) to help guarantee that you have the latest updates.</span></span> <span data-ttu-id="3631e-261">また、[Office の最新バージョンをインストールする](https://docs.microsoft.com/office/dev/add-ins/develop/install-latest-office-version) と [管理者向け Office 2016 の展開ガイド](https://technet.microsoft.com/library/cc303401(v=office.16).aspx) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-261">Additionally, see [Install the latest version of Office](https://docs.microsoft.com/office/dev/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/library/cc303401(v=office.16).aspx).</span></span> 

<span data-ttu-id="3631e-262">Office の更新プログラムをインストールできない場合、次の回避策を実行するとユーザーのブロックを解除できます。</span><span class="sxs-lookup"><span data-stu-id="3631e-262">If Office updates can't be installed, the following workaround can unblock users.</span></span>

#### <a name="workaround-use-internet-explorer-to-sign-in-to-the-client-before-you-use-the-office-add-ins"></a><span data-ttu-id="3631e-263">回避策: Office アドインを使用する前に Internet Explorer を使用してクライアントにサインイン</span><span class="sxs-lookup"><span data-stu-id="3631e-263">Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins</span></span>

<span data-ttu-id="3631e-264">この回避策には、ユーザーの知識と追加の手順が必要です。</span><span class="sxs-lookup"><span data-stu-id="3631e-264">This workaround requires user knowledge and extra steps.</span></span> <span data-ttu-id="3631e-265">この解決策についてユーザーが教育を受けた後は、解決が容易になります。</span><span class="sxs-lookup"><span data-stu-id="3631e-265">After users have been educated about this workaround, it should be straightforward for them.</span></span> 

<span data-ttu-id="3631e-266">**ユーザー ステップ**: Excel (または Word) を開く前に、Internet Explorer を使用してクライアントにサインインする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-266">**User steps:** Before users open Excel (or Word), they should sign in to the client by using Internet Explorer.</span></span> 

<span data-ttu-id="3631e-267">**説明:** Excel または Word のアドインではサインイン コンテキストが使用され、リダイレクトは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="3631e-267">**Explanation:** The Excel or Word Add-in will use the sign-in context, and no redirect will be required.</span></span> <span data-ttu-id="3631e-268">Office アドインが Excel および Word の Internet Explorer ウィンドウ内で実行されるため、以前のサインインは Internet Explorer で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-268">The earlier sign-in must occur in Internet Explorer, because the Office Add-ins run inside an Internet Explorer window in Excel and Word.</span></span> <span data-ttu-id="3631e-269">サインインのコンテキストは、ポリシーに応じて 6〜24 時間続きます。</span><span class="sxs-lookup"><span data-stu-id="3631e-269">The sign-in context lasts 6 to 24 hours, depending on policies.</span></span> <span data-ttu-id="3631e-270">したがって、Internet Explorer を介した新しいサインインが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-270">Therefore, a new sign-in through Internet Explorer is required only occasionally.</span></span>

1.  <span data-ttu-id="3631e-271">Internet Explorer および Excelを終了します。</span><span class="sxs-lookup"><span data-stu-id="3631e-271">Exit Internet Explorer and Excel.</span></span>
2.  <span data-ttu-id="3631e-272">Internet Explorer を起動し、クライアントにサインインします。</span><span class="sxs-lookup"><span data-stu-id="3631e-272">Start Internet Explorer, and sign in to the client.</span></span>
3.  <span data-ttu-id="3631e-273">[Excel で開く] エクスペリエンスを使用して Excel アドインをテストします。</span><span class="sxs-lookup"><span data-stu-id="3631e-273">Test the Excel Add-in by using an Open in Excel experience.</span></span> <span data-ttu-id="3631e-274">(たとえば、**フリート管理** &gt; **顧客** &gt; **顧客** &gt; **Microsoft Office で開く** &gt; **Excel で開く** &gt; **フリート管理の顧客**をクリックします。)</span><span class="sxs-lookup"><span data-stu-id="3631e-274">(For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)</span></span>

### <a name="fixed-issue-the-excel-add-in-doesnt-correctly-run-or-enable-sign-in"></a><span data-ttu-id="3631e-275">\[固定\] 問題: Excel アドインが正しく実行されず、サインインが有効にならない</span><span class="sxs-lookup"><span data-stu-id="3631e-275">\[Fixed\] Issue: The Excel Add-in doesn't correctly run or enable sign-in</span></span>

<span data-ttu-id="3631e-276">**問題:** ユーザーが Excel アドインにサインインしようとすると、認証ページの代わりに空白の認証ダイアログボックスが表示されるか、エラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-276">**Issue:** When users try to sign into the Excel Add-in, a blank authentication dialog box appears, or an error message is shown instead of the authentication page.</span></span> <span data-ttu-id="3631e-277">ユーザーがログインできません。</span><span class="sxs-lookup"><span data-stu-id="3631e-277">The user can't sign in.</span></span> 

<span data-ttu-id="3631e-278">**説明**: Excel アドインは、Office Web JS アドイン プラットフォームを依存し、認証に Azure AD を使用します。</span><span class="sxs-lookup"><span data-stu-id="3631e-278">**Explanation:** The Excel Add-in relies on the Office Web JS Add-in platform and uses Azure AD for authentication.</span></span> <span data-ttu-id="3631e-279">プロキシを使用する場合、ユーザーが Excel アドインを実行してサインインするには、いくつかの URL にアクセスできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-279">If a proxy is used, several URLs must be accessible for users to run and sign in to the Excel Add-in.</span></span> <span data-ttu-id="3631e-280">また、AD FS が使用される場合は、AD FS URL が HTTPS を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-280">Additionally, if AD FS is used, the AD FS URL must use HTTPS.</span></span> 

<span data-ttu-id="3631e-281">**ソリューション:** この問題は顧客固有のネットワーク問題であるため、顧客固有の解決策が必要です。</span><span class="sxs-lookup"><span data-stu-id="3631e-281">**Solution:** Because this issue is a customer-specific network issue, it requires a customer-specific resolution.</span></span> <span data-ttu-id="3631e-282">AD FS が使用される場合は、AD FS URL が HTTPS を使用していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3631e-282">If AD FS is used, make sure that the AD FS URL uses HTTPS.</span></span> <span data-ttu-id="3631e-283">また、次のすべての URL がユーザーのコンピューターからアクセスできることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="3631e-283">Additionally, make sure that all the following URLs are accessible from the user's computer.</span></span>

<span data-ttu-id="3631e-284">読み込みのために次の URL にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="3631e-284">The following URLs are accessed for loading.</span></span>

- `https://az689774.vo.msecnd.net:443`
- `https://az689774.vo.msecnd.net`
- `https://appsforoffice.microsoft.com:443`
- `https://appsforoffice.microsoft.com`
- `https://secure.aadcdn.microsoftonline-p.com:443`
- `https://secure.aadcdn.microsoftonline-p.com`
- `https://az416426.vo.msecnd.net:443`
- `https://az416426.vo.msecnd.net`
- `https://telemetryservice.firstpartyapps.oaspapps.com:443`
- `https://telemetryservice.firstpartyapps.oaspapps.com`
- `https://nexus.officeapps.live.com:443`
- `https://nexus.officeapps.live.com`
- `https://browser.pipe.aria.microsoft.com:443`
- `https://browser.pipe.aria.microsoft.com`
- `http://schemas.microsoft.com`

<span data-ttu-id="3631e-285">認証のために次の URL にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="3631e-285">The following URLs are accessed for authentication.</span></span>

- `https://login.windows.net:443`
- `https://login.windows.net`
- `https://login.microsoftonline.com:443`
- `https://login.microsoftonline.com`

### <a name="issue-the-excel-add-in-needs-an-explicit-sign-out-after-encountering-an-aadsts50058-silent-sign-in-failed-error"></a><span data-ttu-id="3631e-286">問題: AADSTS50058 "サイレント サインインが失敗しました" エラーが発生した後に、Excelアドインで明示的にサインアウトする必要がある。</span><span class="sxs-lookup"><span data-stu-id="3631e-286">Issue: The Excel Add-in needs an explicit sign out after encountering an AADSTS50058 "silent sign in failed" error</span></span>

<span data-ttu-id="3631e-287">**問題:** ユーザーが、一定期間操作が行われなかった後にExcelアドインにログインしようとすると、AADSTS50058 "サイレント サインインが失敗しました" というエラーが発生し、強制的にサインアウトが要求されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-287">**Issue:** When users try to sign in to the Excel Add-in after some period of inactivity, the user encounters the AADSTS50058 "silent sign in failed" error and is forced to sign out before signing back in.</span></span>

<span data-ttu-id="3631e-288">**説明:** Excelアドインは認証に Azure AD を使用します。</span><span class="sxs-lookup"><span data-stu-id="3631e-288">**Explanation:** The Excel Add-in uses Azure AD for authentication.</span></span> <span data-ttu-id="3631e-289">認証が行われると、ユーザーにトークンが作成されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-289">When authentication occurs, a token is created for the user.</span></span> <span data-ttu-id="3631e-290">このトークンには有効期限があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-290">That token has an expiration period.</span></span> <span data-ttu-id="3631e-291">トークンの有効期限が切れると、AADSTS50058エラーが発生し "サイレントログインに失敗しました" という内容のが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3631e-291">After the token has expired, an AADSTS50058 error will occur indicating that "silent sign in failed".</span></span>

<span data-ttu-id="3631e-292">**解決策** : ユーザーは一度サインアウトしてから、再度サインインする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-292">**Solution:** The user needs to sign out and sign back in.</span></span> <span data-ttu-id="3631e-293">この挙動については来的には改善をする予定です。自動的にユーザーをログアウトさせることで、より迅速なログインを実現します。</span><span class="sxs-lookup"><span data-stu-id="3631e-293">We will improve this behavior in the future by automatically signing the user out to enable faster sign in.</span></span>

### <a name="issue-when-trying-to-use-a-document-template-with-open-in-excel-a-record-for-id-guid-not-found-error-displays"></a><span data-ttu-id="3631e-294">問題: ドキュメント テンプレートを Excel で開いて使用しようとすると「ID GUID のレコードが見つかりません」エラーが表示される</span><span class="sxs-lookup"><span data-stu-id="3631e-294">Issue: When trying to use a document template with Open in Excel a "Record for id GUID not found" error displays</span></span>

<span data-ttu-id="3631e-295">**問題:** ある環境から別の環境にデータベースをコピーすると「ID GUIDのレコードが見つかりません」エラーが表示される場合があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-295">**Issue:** The "Record for id GUID not found" error can display when copying a database from one environment to another.</span></span> 

<span data-ttu-id="3631e-296">**説明:** データベースのコピーは Azure Blob Storage に保存されたドキュメント テンプレート、レコードの添付ファイル、その他のファイルに対して問題があります。</span><span class="sxs-lookup"><span data-stu-id="3631e-296">**Explanation:** Copying the database is problematic for document templates, record attachments, and other files that are stored in Azure blob storage.</span></span> <span data-ttu-id="3631e-297">データベースをある環境から別の環境にコピーすると、ファイルはレコードとともにコピーされないため、アプリケーションがアクセスしようとするファイルが見つかりません。</span><span class="sxs-lookup"><span data-stu-id="3631e-297">When the database is copied from one environment to another, the files are not copied along with the records, so the files that the application tries to access are not found.</span></span> 

<span data-ttu-id="3631e-298">**解決策** : ドキュメント テンプレートの場合の解決策は、必要なテンプレートを特定してそのテンプレート ファイルのコピーをターゲット環境にロードすることです。</span><span class="sxs-lookup"><span data-stu-id="3631e-298">**Solution:** For document templates, the solution is to identify the templates that are needed and load a copy of those template files into the target environment.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3631e-299">追加リソース</span><span class="sxs-lookup"><span data-stu-id="3631e-299">Additional resources</span></span>

[<span data-ttu-id="3631e-300">Office 統合</span><span class="sxs-lookup"><span data-stu-id="3631e-300">Office integration</span></span>](office-integration.md)

[<span data-ttu-id="3631e-301">Office 統合のチュートリアル</span><span class="sxs-lookup"><span data-stu-id="3631e-301">Office integration tutorial</span></span>](office-integration-tutorial.md)

[<span data-ttu-id="3631e-302">Power BI 統合のコンフィギュレーション</span><span class="sxs-lookup"><span data-stu-id="3631e-302">Configuring Power BI integration</span></span>](../analytics/configure-power-bi-integration.md)
