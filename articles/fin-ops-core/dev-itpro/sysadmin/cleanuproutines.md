---
title: Dynamics 365 Finance と Dynamics 365 Supply Chain Management のクリーンアップ ルーチン
description: このトピックでは、Microsoft Dynamics 365 Finance および Dynamics 365 Supply Chain Management のクリーンアップ ルーチンの概要を提供します。
author: dvliegen
manager: AnnBe
ms.date: 01/04/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: dvliegen
ms.search.validFrom: 2020-10-31
ms.dyn365.ops.version: 10.0.13
ms.openlocfilehash: 7f9619d4453507e0a820a9eb8e99209ffcd2a66e
ms.sourcegitcommit: 7cfe8931dd454e811a691f5118a4ecae7ba4b478
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/04/2021
ms.locfileid: "4821176"
---
# <a name="cleanup-routines-in-dynamics-365-finance-and-dynamics-365-supply-chain-management"></a>Dynamics 365 Finance と Dynamics 365 Supply Chain Management のクリーンアップ ルーチン

[!include [banner](../includes/banner.md)]

Microsoft Dynamics 365 Finance および Dynamics 365 Supply Chain Management は、さまざまなモジュールでクリーンアップ ルーチンを使用できます。 このトピックでは、現在使用可能なルーチンの概要を示します。 この情報は、モジュール別にまとめられています。

> [!IMPORTANT]
> これらのクリーンアップ ルーチンを実行するのは、業務に関する詳細な分析が終了し、データが不要になったことを確認した後のみにしてください。
>
> 各クリーンアップ ルーチンは、運用環境で実行する前に必ずテスト環境でテストしてください。

## <a name="system-administration"></a>システム管理

| パス | 説明 |
|------|-------------|
| システム管理 \> 定期的なタスク \> 通知のクリーンアップ | <p>このクリーンアップ ルーチンは、EventInbox および EventInboxData テーブルから定期的にレコードを削除します。</p><p>**推奨:** 警告機能を使用しない場合は、バッチ ジョブからの警告をオフにします。</p> |
| システム管理 \> 定期的なタスク \> バッチ ジョブ履歴のクリーンアップ | [バッチ ジョブ履歴のクリーンアップ](batch-history-cleanup.md) の通常バージョンを使用すると、指定した日数より古いすべての履歴エントリをすばやく消去できます。 指定日数より前に作成されたエントリは、BatchJobHistory テーブルから削除され、関連するレコード (BatchHistory および BatchConstraintsHistory) のあるリンク テーブルからも削除されます。 このバージョンでは、フィルター処理を実行する必要がないため、パフォーマンスの最適化が向上しました。 |
| システム管理 \> 定期的なタスク \> バッチ ジョブ履歴のクリーンアップ (カスタム) | [カスタム バッチ ジョブ履歴のクリーンアップ](batch-history-cleanup.md) は、特定のエントリを削除する必要がある場合にのみ使用してください。 状態、ジョブの説明、会社、ユーザーなどの条件に基づいて、バッチ ジョブ履歴レコードの選択したタイプをクリーンアップできます。 他の条件は、**フィルター** ボタンを使用して追加することができます。 |
| システム管理 \> 問い合わせ \> データベース \> データベース ログ \> クリーンアップ ログ | <p>このクリーンアップ ルーチンを使用すると、必要に応じてデータベース ログを削除できます。 特定のテーブルのログを削除したり、特定のタイプのデータベース ログを削除するなど、作成された日時に基づいてログを削除したりすることができます。</p><p>**注:** 電子署名されたレコードは、ログから削除できません。</p> |

## <a name="data-management"></a>データ管理

| パス | 説明 |
|------|-------------|
| **データ管理** ワークスペースで、**ジョブ履歴のクリーンアップ** を選択します。 | <p>このクリーンアップ ルーチンは、プラットフォーム更新 29 以降で利用できます。 これを使用するには、機能管理の **実行履歴のクリーンアップ** 機能を有効にする必要があります。 データ管理で実行履歴の定期的なクリーンアップをスケジュールするには、このルーチンを使用する必要があります。 これは以前のステージング クリーンアップ ルーチン (現在は廃止され使われていない) を置き換えるものです。</p><p>次のテーブルがクリーンアップされます。</p><ul><li>すべてのステージング テーブル</li><li>DMFSTAGINGVALIDATIONLOG</li><li>DMFSTAGINGEXECUTIONERRORS</li><li>DMFSTAGINGLOGDETAIL</li><li>DMFSTAGINGLOG</li><li>DMFDEFINITIONGROUPEXECUTIONHISTORY</li><li>DMFEXECUTION</li><li>DMFDEFINITIONGROUPEXECUTION</li></ul> |
| **データ管理** ワークスペースで、**ステージング クリーンアップ** タイルを選択します。 | このクリーンアップ ルーチンは使用されなくなりました。 代わりに、ジョブ履歴のクリーンアップ ルーチンを使用します。 |

## <a name="general-ledger"></a>一般会計

| パス | 説明 |
|------|-------------|
| 一般会計 \> 定期的なタスク \> 仕分元帳のクリーンアップ | <p>このクリーンアップ ルーチンでは、転記されている一般会計、売掛金勘定仕訳帳、および買掛金勘定仕訳帳を削除できます。 転記済の仕訳元帳を削除すると、元のトランザクションに関連付けられたすべての情報が削除されます。</p><p>**注:** 仕訳元帳トランザクションを取り消す必要がない場合にのみ、この情報を削除することができます。</p> |

## <a name="sales-and-marketing"></a>販売とマーケティング

| パス | 説明 |
|------|-------------|
| 販売とマーケティング \> 定期的なタスク \> クリーンアップ \> 販売注文の削除 | このクリーンアップ ルーチンは、選択された販売注文を削除します。 |
| 販売とマーケティング \> 定期的なタスク \> クリーンアップ \> 見積書の削除 | このクリーンアップ ルーチンは、選択された見積書を削除します。 |
| 販売とマーケティング \> 定期的なタスク \> クリーンアップ \> 返品注文の削除 | このクリーンアップ ルーチンは、選択された返品注文を削除します。 |
| 販売とマーケティング \> 定期的なタスク \> クリーンアップ \> 販売更新履歴のクリーンアップ | このクリーンアップ ルーチンは、古い更新履歴トランザクションを削除します。 確認書、ピッキング リスト、梱包明細、請求書のすべての更新は、更新履歴トランザクションを生成します。 これらのトランザクションは、**更新の履歴** ページで表示できます。 |
| 販売とマーケティング \> 定期的なタスク \> クリーンアップ \> 注文イベントの削除 | このクリーンアップ ルーチンは、注文イベントをクリーンアップします。 次の手順として、**注文イベントの設定** ページを開いて、不要な注文イベントのチェックボックスをオフにします。 |

## <a name="procurement-and-sourcing"></a>調達

| パス | 説明 |
|------|-------------|
| 調達 \> 定期的なタスク \> クリーンアップ \> 購入更新履歴のクリーンアップ | このクリーンアップ ルーチンは、更新履歴トランザクションを生成した確認書、ピッキング リスト、製品受領書、請求書のすべての更新を削除します。 |
| 調達 \> 定期的なタスク \> クリーンアップ \> 見積依頼の削除 | このクリーンアップ ルーチンは、見積依頼 (RFQ) と RFQ の返信を削除します。 対応する RFQ 仕訳帳は削除されず、システム内に残ります。 |
| 調達 \> 定期的なタスク \> クリーンアップ \> ドラフトの委託販売補充注文仕訳帳のクリーンアップ | このクリーンアップ ルーチンは、ドラフトの委託販売補充注文仕訳帳をクリーンアップします。 |

## <a name="warehouse-management"></a>倉庫管理

| パス | 説明 |
|------|-------------|
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> 作業作成履歴の消去 | このクリーンアップ ルーチンは、WHSWorkCreateHistorytable テーブルから作業作成履歴レコードを削除します。 このダイアログ ボックスでは、履歴を保持する日数を指定します。 |
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> コンテナー詰め履歴の消去 | このクリーンアップ ルーチンは、WHSContainerizationHistory テーブルからコンテナー詰め履歴を削除します。 このダイアログ ボックスでは、履歴を保持する日数を指定します。 |
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> ウェーブ バッチのクリーンアップ | このクリーンアップ ルーチンは、ウェーブ処理バッチ グループに関連するバッチ ジョブ履歴レコードをクリーンアップします。 |
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> 循環棚卸計画のクリーンアップ | このクリーンアップ ルーチンは、循環棚卸計画の構成に関連するバッチ ジョブ履歴レコードをクリーンアップします。 |
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> モバイル デバイスの活動ログのクリーンアップ | このクリーンアップ ルーチンは、WHSMobileDeviceActivityLog テーブルからモバイル デバイスの活動ログ レコードを削除します。 このダイアログ ボックスでは、履歴を保持する日数を指定します。 |
| 倉庫管理 \> 定期的なタスク \> クリーンアップ \> 作業ユーザー セッション ログのクリーンアップ | このクリーンアップ ルーチンは、WHSWorkUserSessionLog テーブルから作業ユーザー セッション レコードを削除します。 このダイアログ ボックスでは、履歴を保持する時間数を指定します。 |

## <a name="inventory-management"></a>在庫管理

| パス | 説明 |
|------|-------------|
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 場所の負荷能力の計算 | WMSLocationLoad テーブルは、品目およびパレットの重量および容積を追跡します。 WMSLocationLoad テーブルのレコード数を減らすために、負荷調整の合計ジョブを実行して、パフォーマンスを向上させることができます。 |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 在庫仕訳帳のクリーンアップ | このクリーンアップ ルーチンは、転記済の在庫仕訳帳を削除します。 |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 在庫決済のクリーンアップ | <p>このクリーンアップ ルーチンは、決算済在庫トランザクションをグループ化するか、または取消済在庫決済を削除します。 決算済在庫決済または削除済在庫決済のクリーンアップを行うと、システム リソースを解放することができます。</p><p>現在の日付や会計年度に近すぎる在庫決済をグループ化または削除しないでください。決済用のトランザクション情報の一部が失われる可能性があります。</p><p>決算済在庫トランザクションがグループ化された後は、決済のトランザクション情報が失われるので、変更することができなくなります。</p><p>キャンセルされた在庫決済を削除した場合、財務トランザクションで調整することはできません。</p> |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 在庫分析コードのクリーンアップ | <p>このクリーンアップ ルーチンは、InventDim テーブルを管理します。 テーブルを管理するには、いずれのトランザクションやマスタ データからも参照されることのない、使用されていない在庫分析コードの組み合わせレコードを削除します。 レコードは、未処理であるか決済済であるかには無関係に削除されます。</p><p>トランザクションによって参照されている在庫分析コードの組み合わせレコードは削除できません。InventDim レコードを削除すると、関連するトランザクションを再オープンできなくなるためです。</p> |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 在庫分析コードの不整合のクリーンアップ | <p>このクリーンアップ ルーチンは、財務的に更新と決済が完了した在庫トランザクションの分析コードの不整合を解決します。 アップグレード プロセスの前か最中にマルチサイト機能が有効になると、不整合が発生する場合があります。</p><p>このルーチンは、マルチサイト機能が有効になる前に決済されたトランザクションをクリーンアップする場合のみ使用します。</p><p>**注:** このルーティンを定期的に使用しないでください。</p> |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 手持在庫のエントリのクリーンアップ | このクリーンアップ ルーチンは、一つ以上の追跡用分析コードに割り当てられる手持在庫の決算済および未使用のエントリを削除します。 決算済トランザクションはすべての数量および原価価値に **0** (ゼロ) の値を含み、決済済としてマークされます。 これらのトランザクションを削除すると、手持在庫に対するクエリのパフォーマンスを向上できます。 トランザクションは、追跡用分析コードに割り当てられていない手持在庫を削除しません。 |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 倉庫管理手持在庫エントリのクリーンアップ | このクリーンアップ ルーチンは、InventSum テーブルと WHSInventReserve テーブルのレコードを削除します。 これらのテーブルには、倉庫管理処理が有効になっている品目 (WHS 品目) の手持在庫情報が格納されます。 これらのレコードをクリーンアップすることにより、手持在庫計算を大幅を向上させることができます。 |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 財務分析コードによる手持在庫エントリの集約 | <p>このクリーンアップ ルーチンは、数量が 0 (ゼロ) である InventSum 行を集約するためのツールとして使用します。 このルーチンは、基本的には前述のルーチンを拡張するもので、**決済済** フィールドが **True** に設定されているレコードもクリーンアップします。</p><p>このルーチンは基本的に、在庫分析コードの組み合わせに対して、InventSum テーブル上の数量はなくなったものの、値はまだ存在するシナリオを処理するために必要です。 場合によっては、これらの値は削除されますが、現在の仕様では値が残ることがあります。</p><p>たとえば、バッチ番号を使用する場合、各バッチ番号 (および結合されたサイト、倉庫など) は、InventSum テーブルに新しいレコードを作成します。 そのバッチ番号が売れると、数量フィールドは **0** (ゼロ) に設定されます。 ほとんどの場合、**財務費用金額** フィールド、および **現物原価金額** フィールドも、**0** (ゼロ) に設定されます。 しかし、標準原価の再評価やその他のシナリオでは、フィールドに金額が表示される場合があります。 これは正しい動作であり、Finance および Supply Chain Management が財務在庫レベル (サイト レベルなど) で原価を処理する方法を反映しています。</p><p>Finance および Supply Chain Management では、在庫金額は InventSum テーブルのレコードによって決定されます。 過去の在庫金額が報告されたときには、在庫トランザクション (InventTrans テーブル) によって決定される場合もあります。 したがって、前に説明したシナリオでは、在庫金額のレポートを実行するときに、Finance および Supply Chain Management は、まず InventSum テーブルを確認し、すべてのレコードをサイト レベルで集計して、サイトごとの品目の値を報告します。</p><p>個々のレコードのデータがバッチ番号レベルで使用されることはありません。 したがって、このルーチンは、すべての InventSum レコードで、数量がなくなったレコードを検出します (つまり、**オープン数量なし** フィールドが **True** に設定されます)。 これらのレコードを保持する理由はないため、Finance および Supply Chain Management は、同じサイトで同じ品目の InventSum レコードを検索し、その値をバッチ番号レベルからサイト レベルにコピーしてから、レコードを削除します。 その後、在庫金額レポートを実行する場合でも、Finance および Supply Chain Management は同じ正しい値を検出します。 したがって、このルーチンは、場合によっては InventSum レコードの数を大幅に削減し、そのテーブルを照会するすべての機能でパフォーマンスを向上させることができます。</p> |
| 在庫管理 \> 定期的なタスク \> クリーンアップ \> 原価計算の詳細 | このクリーンアップ ルーチンは、原価計算の詳細をクリーンアップします。 |

## <a name="production-control"></a>生産管理

| パス | 説明 |
|------|-------------|
| 生産管理 \> 定期的なタスク \> クリーンアップ \> 生産仕訳帳のクリーンアップ | このクリーンアップ ルーチンは、使用されていない仕訳帳を削除します。 |
| 生産管理 \> 定期的なタスク \> クリーンアップ \> 製造オーダーのクリーンアップ | このクリーンアップ ルーチンは、終了した製造オーダーを削除します。 |
| 生産管理 \> 定期的なタスク \> クリーンアップ \> 登録データのクリーンアップ | <p>登録データを定期的にクリーンアップすることをお勧めします。 このクリーンアップ ルーチンは、処理されたデータのみを削除します。</p><p>**注:** 後に文書作成のために必要になる可能性がある登録データは削除しないように注意してください。</p> |
| 生産管理 \> 定期的なタスク \> クリーンアップ \> 計画登録をアーカイブに保存 | このクリーンアップ ルーチンは、作業登録テーブルから計画登録を削除します。 |


## <a name="master-planning"></a>マスター プラン

| パス | 説明 |
|------|-------------|
| マスター プラン \> マスター プラン \> プランの管理 \> プラン バージョンのクリーンアップ | 通常、このクリーンアップは自動的に実行されます。 ただし、自動クリーンアップは誤動作することがあり、孤立したデータがシステムに残ることがあります。 この孤立したデータによってクエリが低速になり、データベース サイズが増大します。 マスター リソース プラン (MRP) が実行されていない場合は、予防的に毎月 1 回、実行することをお勧めします。 |
