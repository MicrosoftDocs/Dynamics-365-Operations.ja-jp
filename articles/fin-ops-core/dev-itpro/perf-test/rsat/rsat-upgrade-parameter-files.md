---
title: パラメーター ファイルのアップグレード
description: このトピックでは、Regression suite automation tool (RSAT) で使用されるパラメーター ファイルをアップグレードする方法について説明します。
author: FrankDahl
ms.date: 04/12/2021
ms.topic: article
audience: Developer
ms.reviewer: rhaertle
ms.custom: ''
ms.search.region: Global
ms.author: fdahl
ms.search.validFrom: 2021-04-12
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 48f8f6a97b96872779a84cee8393cfee524b38da11379239bbca3923eb1c639b
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "6742262"
---
# <a name="upgrade-parameter-files"></a>パラメーター ファイルのアップグレード

[!include [banner](../../includes/banner.md)]

Regression suite automation tool (RSAT) で使用された Microsoft Excel ファイルのパラメーターの形式は、2.0 リリースで変更されました。 現在、形式はより直観的でテスト手順が示されています。 RSAT バージョン 2.0 以降で作成された新しいテスト ケースによって自動的に新しい形式でパラメーター ファイルが生成されます。 ただし、バージョン 2.0 より前に作成されたテストでは、古い形式を使用している場合があります。 古い形式のパラメーター ファイルを使用するテスト ケースの実行は、RSAT によって少なくとも次のメジャー リリースまで引き続きサポートされます。 RSAT によって古いパラメーター ファイルを新しい形式にアップグレードすることもできます。

パラメーター ファイルは、Excel で自由に編集できます。 場合によっては、パラメーター ファイルが完全にアップグレードできなかったり、プロセスを完了するために手作業が必要となります。 次のセクションで、アップグレード プロセスの仕組みについて説明します。

## <a name="upgrade-process"></a>アップグレード プロセス

アップグレード プロセスでは、フル アップグレードを試行します。 ただし、場合によっては、このプロセスを安全に完了できないことがあります。

フル アップグレード プロセスを完了できる場合は、古いパラメーター ファイルが新しいパラメーター ファイルに置き換えられます。 元のファイルのコピーが作成され、**\_BAK** がファイル名に追加されます。

パラメーター ファイルの一部のみを安全にアップグレードできる場合、元のファイルは変更されません。 代わりに新しいファイルが作成され、**\_PARTIAL** がファイル名に追加されます。 部分ファイルには、アップグレードされる可能性がある情報が含まれています。 部分ファイルを使用して元のファイルから欠落している部分を手動で転送し、新しいファイルを完成できます。 完了したら、元のファイルの名前をバックアップ名に変更します (たとえば、ファイル名に **\_BAK** を追加します)。 その後、ファイル名から **\_PARTIAL** を削除して新しいファイルの名前を変更します。 その結果、新しいファイルは新しいパラメーター ファイルになります。

> [!NOTE]
> 古いパラメーター ファイルは、新しいファイルの準備ができるまでそのまま使用できます。 パラメーター ファイル用の古いフォーマットが、RSAT によって少なくとも次のメジャー リリースまで引き続きサポートされます。

通常、アップグレード プロセスでは未編集のパラメーター ファイルをアップグレードできます。 また、ファイル内でセル値だけが変更されたファイルをアップグレードすることもできます。 ただし、追加のセルが追加され参照されている場合は、アップグレード プロセスを自動的に完了することはできません。 この場合、部分ファイルには **\#MISSING** の値を持つセルが含まれます。 この値は、セル参照が欠落していることを示します。 元のパラメーター ファイルの情報を新しい部分ファイルに手動で追加する必要があります。

> [!IMPORTANT]
> 今から、部分ファイルに追加するのと同様に、パラメーター ファイルの新しい **CustomParameters** シートに新しい行を追加します。

RSAT の 2.2 以降のリリースで、パラメーター ファイルには **CustomParameters** という名前のシートが含まれています。 このシートは、将来のパラメーター ファイルのアップグレードに役立ちます。 セルを追加する場合は、このシートにセルを追加します。

古いパラメーター ファイルにセルを追加してそのセルに名前を割り当てた場合、名前付きセルはその値が他のセルを参照しない限りアップグレード中に自動的に **CustomParameters** シートに移動されます。

追加したセルの部分ファイルへの移動を完了した後、**TestCaseSteps** シートの参照に **\#MISSING** という値がある場合、**CustomParameters** シートの関連するセルに一致するように参照を変更します。 原則的には、セル識別子 (たとえば、**E4**) ではなく、割り当てられた名前 (たとえば、**MyQuantity**) でセルを参照します。

> [!NOTE]
> ベスト プラクティスとして、**ComstomerParameters** シートに追加されるすべてのセルに名前を割り当てる必要があります。 その後、テスト ケース ステップから名前でセルを参照します。

アップグレード後、テスト ケースを実行して、新しいパラメーター ファイルによって予期される結果が生成されるのを確認する必要があります。 アップグレードが完全に完了した場合と、アップグレードで手作業が必要な場合の両方にこの手順を実行します。

新しいファイルの作成とテストが完了すると、バックアップと部分ファイルを削除できます。

## <a name="run-the-parameter-file-upgrade-process"></a>パラメーター ファイルのアップグレード プロセスの実行

パラメーター ファイルをアップグレードするには、これらの手順に従います。

1. RSAT を開きます。
2. アップグレードするパラメーター ファイルがあるテスト ケースを選択します。
3. **新規** メニューで、**パラメーター ファイルのアップグレード (テスト実行ファイルの自動生成)** を選択します。

    ![新規メニューのパラメーター ファイルのアップグレード (テスト実行ファイルの自動生成) コマンド。](media/new_dropdown_menu.png)

選択したケースすべてのパラメーター ファイルがアップグレードされます。

アップグレード プロセスでは、パラメーター ファイルが既に新しい形式であるテスト ケースがスキップされます。 パラメーター ファイルは、**Custom Parameters** シートを含む場合アップグレードされたと見なされます。

アップグレード プロセスが完了した場合、概要を示すメッセージ ボックスが表示されます。 この概要には、次の情報が含まれています。

+ アップグレード用にマークされた選択済みのテスト ケースの総数。
+ 正常にアップグレードされた数。 これらのアップグレード用として、新しいパラメーター ファイルおよび **\_BAK** ファイルがあります。
+ 失敗したアップグレードの数。 これらのアップグレード用として、新しい **\_PARTIAL** ファイルがあります。
+ スキップされたアップグレードの数。
+ 結果の説明。

次の図は、メッセージ ボックスの概要の例を示しています。

![メッセージ ボックスの概要。](media/upgrade_summary.png)

失敗したアップグレードについては、テスト ケース タイトルの横にある黄色の三角警告記号を選択することで、詳細情報を参照できます。 次の図は、表示されるメッセージ ボックスの例を示しています。

![失敗したアップグレードに対する警告メッセージ ボックス。](media/upgrade_triangle_error.png)

> [!IMPORTANT]
> アップグレードは、繰り返し実行できます。 この場合、新しくアップグレードされたパラメーター ファイルはスキップされます。 ただし、新しい部分ファイルによって既存の部分ファイルが上書きされます。 アップグレードを再実行する前に、すべての部分ファイルを完成し、名前を変更することをお勧めします。

[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]
