---
title: Regression Suite Automation Tool (RSAT) を使用したテスト ケースの実行
description: このトピックでは、Azure DevOps からのテスト ケースの読み込み、テストの実行、および作業内容を Azure DevOps に保存する方法について説明します。
author: FrankDahl
ms.date: 01/15/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Developer
ms.reviewer: rhaertle
ms.custom: 21631
ms.search.region: Global
ms.author: fdahl
ms.search.validFrom: 2019-08-01
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 14fedc9293ec7fd0eff6449745e3629ca7b5d591
ms.sourcegitcommit: e4992c57eea4c15ac052e9d65dddae625e3528f9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2021
ms.locfileid: "5866172"
---
# <a name="use-the-regression-suite-automation-tool-rsat"></a>Regression Suite Automation Tool (RSAT) の使用

[!include [banner](../../includes/banner.md)]

このトピックでは、Azure DevOps からのテスト ケースの読み込み、自動化ファイルの生成、テストパラメータの変更、結果の実行と調査、および Azure DevOps への作業内容の保存方法について説明します。

## <a name="load-test-cases-and-create-automation-files"></a>テスト ケースの読み込みと自動化ファイルの作成

RSAT で、**テスト計画** タブを選択し、**読み込み** を選択して、テスト ケースとテスト ケース自動化ファイルをダウンロードします。 **設定** タブで指定されたテスト計画に属する全てのテスト ケース (および対応する添付ファイル) は、ローカルの作業ディレクトリにダウンロードされます。

![テスト ケースの読み込み](media/load-test-cases.png)

テスト ケースは、共通のテスト計画に基づいてテスト スイートごとに編成されます。 これらは、Azure DevOpsプロジェクトで作成したテスト スイートです。 このツールを使用すると、一度に1つのテスト スイートを操作できます。

ツールでテスト ケースの読み込みに失敗したときは、Azure DevOpsのテスト計画が適切に作成されていること、また、目的のテスト スイートおよびテスト ケースが含まれていることを確認します。

このテスト計画を初めて使用する場合は、**パラメーター ファイル** 列が空白になります。 テスト ケース用のテスト自動化ファイルを作成する必要があります。

テスト ケースでは、正常に実行するために次の添付ファイルが必要です。

+ **記録ファイル**: Finance and Operations タスク レコーダーによって作成された記録ファイルです。 これにより、テスト ケースのステップが定義されます。 通常は **recording.xml** という名前ですが、Azure DevOps のテスト ケースのタイトルと一致するように名前を付けることもできます。 Azure DevOps のテスト ケースに添付され、テスト ケースのローカル作業ディレクトリの **添付** フォルダーにダウンロードされます。
+ **テスト自動化ファイル** は、構成可能なテスト ケース パラメーターを含む **テスト パラメーター ファイル** (Microsoft Excel ファイル) と **テスト実行ファイル** で構成されます。これらのファイルは、テスト記録の自動実行を可能にするために RSAT によって生成されます。 ファイル名には **_Base.cs**、**_Base.xml**、および **_Base.dll** などの接尾語が使用されます。

**新規** を選択すると、テスト自動化ファイルが作業ディレクトリに生成されます。 Excel テスト パラメーター ファイルが **パラメーター ファイル** の下のグリッドに表示されます。

![読み込まれたテスト ケースの一覧](media/rsat-test-cases.png)

また、パラメーター ファイルを上書きせずに、**テスト実行ファイル** だけを生成することもできます。 **新規 \> 実行ファイルの生成** を選択して、実行ファイルのみを再生成し、Excel ファイルは影響を受けないままにします。

ツールの新しいバージョンをインストールするとき、および新しいバージョンの記録ファイルを変更または読み込むときに、テスト実行ファイルを生成する必要があります。 このようにして、実行ファイルを更新するだけでなく、テスト パラメーター ファイルも保持できます。

![テスト実行ファイルのみのメニュー項目を生成する](media/generate-execution-files.png)

## <a name="modify-test-parameters"></a>テスト パラメーターの変更

ここでは、Excel ファイルを変更して、テストの実行に使用する入力および検証のパラメータを指定する方法について説明します。 変更する 1 つ以上のテスト ケースを選択し、ツール バーで **パラメーター** ボタン (Microsoft Excel 記号) を選択します。 選択したテスト ケースごとに Excel ウィンドウが開きます。 または、作業ディレクトリから直接 Excel ファイルを開くこともできます。

**一般** タブに加えて、Excel パラメーター ファイルには **MessageValidation** タブおよび **TestCaseSteps** タブが含まれています。

**TestCaseSteps** タブを選択して、テスト ケースの入力パラメーターおよび検証パラメーターを構成します。 入力パラメーターおよび検証パラメーターは、対応するテスト ケース ステップの横に配置され、テスト作成者はコンテキストと簡単なエクスペリエンスを得ることができます。 パラメーターを変更すると、テスト ケースのどのステップに影響を与えているかが明確になります。 コンテキスト内の値または式を入力できます。 カラー コーディングにより、入力パラメーターと検証ステップが区別されます。

![テスト ケース ステップ](media/test-case-steps.PNG)

テスト ケースの記録中にコピーされた再利用可能な変数も、テスト ケース ステップのコンテキストで表示されます。 変数を簡単に検索してコピーし、次のステップや式で使用できます。 詳細については、[変数をコピーしてテスト ケースに連鎖させる方法](rsat-chain-test-cases.md)を参照してください。

![テスト ケース ステップ変数](media/test-case-steps-rsat-var.png)

編集が完了したら Excel ファイルを保存します。

### <a name="run-a-test-as-a-specific-user"></a>特定のユーザーとしてテストを実行する

既定では、テストは管理者ロールを使用して実行されます。 特定のセキュリティ ロールとしてテストを実行する場合は、Excel パラメーター ファイルの **一般** タブにある **テスト ユーザー** パラメーターでユーザーの電子メール アドレスを指定します。 **テスト ユーザー** は、接続している環境の有効なユーザーである必要があります。 テストは、特定のユーザーが属しているセキュリティ ロールの下で実行されます。 この機能を機能させるには、バージョン 1.200 またはそれ以降のバージョンが必要です。

![Excel パラメーター ファイルの一般タブ](media/rsat-excel-general-tab.png)

### <a name="run-a-test-in-the-context-of-a-specific-company"></a>特定の会社のコンテキストでテストを実行する

Excel パラメーター ファイルの **一般** タブでは、法人 (会社) の名前を指定することもできます。 この会社のコンテキスト内でテストを実行します。 既定の会社を、ツールの **設定** ダイアログ ボックスで指定できます。

### <a name="pause-after-a-specific-test-step"></a>特定のテスト ステップの後で一時停止する

特定のテスト ステップ間に一時停止を挿入できます。 Excel パラメーター ファイルの **TestCaseSteps** タブに移動し、テスト ステップの一時停止列に値 (秒) を挿入します。 これにより、テスト ステップの完了後、テスト ケースの実行が一時停止されます。

![顧客 ID フィールドに対する一時停止設定](media/Pause-after-specific-step.png)

**一時停止** 列が表示されない場合、Excel パラメーター ファイルの古いバージョンを使用し、再生成する必要があります。 目的のテスト ケースを選択し、**新規 > テスト実行とパラメーター ファイルの生成** に移動します。 パラメーター ファイルに対して行った編集が上書きされる可能性があるため、既存の Excel ファイルを先にバックアップする必要があります。

### <a name="other-notable-test-case-execution-settings"></a>その他の重要なテスト ケースの実行の設定

次の設定が役立つ場合があります。 これらは、Excel パラメーター ファイルの **一般** タブで使用できます。

+ **情報ログの警告メッセージで失敗**: 既定では、エラーが発生、または検証ステップが失敗した場合、テスト ケースは失敗します。 警告メッセージに応じてテスト ケースも失敗させたい場合は、**情報ログの警告メッセージで失敗** オプションを **True** に設定します。 これは、たとえば、テスト ケースで重複する顧客レコードを追加する場合などに役立ちます。 既定の設定は **False** です。
+ **失敗時にテスト スイートの実行を中止する**: **失敗時にテスト スイートの実行を中止する** オプションを **True** に設定した場合、テスト ケースが失敗すると、テスト スイートの実行は中止されます。 残りのすべてのテスト ケースのステータスは **未実行** になります。 既定の設定は **False** です。
+ **ステップ間の一時停止**: テスト ステップ間で一時停止する秒数。 これは、すべてのテスト ステップに影響します。 既定値は **0** (ゼロ) です。

### <a name="infolog-and-message-validation"></a>情報ログおよびメッセージの検証

バージョン1.200 またはそれ以降のバージョンを使用して生成される Excel パラメーター ファイルには、 **messagevalidation** のタブが含まれています。

このタブには、**メッセージを検証** するためのメッセージを入力できます。 テスト ケースが実行を完了した後、ここで指定されたメッセージが情報ログに表示されることを検証します。 これらのメッセージが見つからない場合、テスト ケースは失敗します。

エラー メッセージを含む、予期されるメッセージを指定できます。 このセクションで指定されたメッセージは、実行中に情報ログで検出されていない限り、テスト ケースが失敗する原因になります。 **Equals** と **Contains** の 2 つの演算子を使用できます。 **Equals** を使用する場合、RSAT は情報ログ内のすべてのメッセージと文字列比較を実行し、完全なメッセージが見つからない場合は検証に失敗します。 **Contains** を使用する場合、RSAT は情報ログの少なくとも 1 つのメッセージに指定した文字列が含まれていることを検証します。

![メッセージ検証の例](media/message-validation.png)

文字列比較で大文字と小文字を区別するかどうかは、**設定** タブの **オプション** ページで構成できます。

## <a name="run"></a>実行

**実行** を選択して、選択済みのテストケースを実行します。 既存の自動化ファイルを用いるテスト ケースのみを実行できます。 ツールでは、Excel に入力されたデータを使用して、これらのテストが開かれ実行されます。

上下矢印ボタンを使用して、テスト ケースを実行する順序を変更できます。

### <a name="pause-prior-to-a-test-case-run"></a>テスト ケース実行前の一時停止

テスト ケース実行開始前に、一時停止を追加できます。 一時停止する場合は、目的のテスト ケースの Excel パラメーター ファイルの **一般** タブで、セル **一時停止 (秒)** を更新します。

### <a name="stop-a-run"></a>実行の停止

テストの実行が進行中の場合は、ツールバーの **停止** ボタンを選択して実行をキャンセルできます。 現在実行中のテスト ケースが完了した後で実行が停止します。 残りのテスト ケースは、Azure DevOps で **未実行** とマークされます。

### <a name="validate-readiness-of-test-automation-files"></a>テスト自動化ファイルの準備状況の検証

必要に応じて、テスト ケースの実行準備が整っているかどうかを検証する設定を有効にすることができます。 この設定により、レコーディングおよびテスト自動化ファイルの有効性に関連する不明なエラーが防止されます。 このオプションは、RSAT バージョン 1.210 で使用できます。 これを有効にするには、**設定** タブを選択し、**オプション** タブを選択します。

![ローカル ファイル検証ルールを有効にする設定](media/enable-local-file-validation-rules.png)

有効にすると、バックグラウンド プロセスによって、各テスト ケースの次の項目が継続的に検証されます。

+ ローカルの作業ディレクトリが存在します。
+ Excel パラメーター ファイルが存在します。
+ 実行に必要なテスト自動化ファイル (バイナリ ファイルまたは Xml ファイル) が存在します。
+ テスト自動化ファイルは、RSAT の現在のバージョンと互換性があります。 新しいバージョンの RSAT をインストールするときに、テスト自動化ファイルを再生成する必要があります。
+ Excel パラメーター ファイルに指定されたテスト ケース ID は、Azure DevOps のテスト ケース ID と一致します。

グリッドの有効な列は、検証プロセスの結果を示します。 検証が失敗した場合は、**有効** 列の **X** をクリックすると、エラーと推奨されるアクションが表示されます。

![有効な列グリッド](media/enable-local-file-validation-rules-2.png)

## <a name="investigate-results"></a>結果の調査

すべてのテスト ケースの実行が完了すると、**合格** または **不合格** が **結果** 列に設定されます。 結果をクリックすると、エラー メッセージが表示されます。

Azure DevOps で入手できる追加の調査詳細。 この情報を表示するには Azure DevOps プロジェクトページから、**テスト > 実行** に移動します。

![テスト結果](media/test-results.png)

目的のテストの実行を選択します。 その実行中に実行されたすべてのテストの結果が含まれます。

![結果の円グラフ](media/outcome-pie-chart.png)

![各テストの結果](media/pass-fail.png)

失敗したテスト結果を開いて、**ErrorMessage** セクションでエラーに関する情報を確認できます。

![エラー メッセージの情報](media/error-message.png)

すべてのエラー メッセージは、**C:\Users\$YourUserName\AppData\Roaming\regressionTool\errormsg-<TestCaseId>.txt** でローカルでも利用可能です。

### <a name="test-response-times"></a>応答時間のテスト

実行ログに加えて、テスト ケースの期間もテスト結果で確認できます。

![テスト ケースの期間](media/test-duration.png)

テスト結果に添付されている **BaseTime.xml** ファイルを開くことにより、テスト ケースの各ステップの応答時間を確認することもできます。

![応答時間ファイル](media/response-time.png)

応答時間を機能させるには、バージョン 1.200 またはそれ以降のバージョンが必要です。

## <a name="upload-to-azure-devops-to-commit-your-work"></a>Azure DevOps にアップロードして作業をコミットします。

Azure DevOps に作業をコミットするには、**アップロード** を選択します。 これにより、選択したテスト ケースの記録およびテストの自動化ファイル (Excel テスト パラメーター ファイルを含む) が、将来の使用のために Azure DevOps にアップロードされます。 テスト自動化ファイルを Azure DevOps にアップロードした後は、次に Regression Suite Automation Tool を使用するときに、テストの実行ファイルを生成したり Excel パラメーター ファイルを編集したりすることなく、別のコンピューターからでも簡単に **読み込み**、**実行** できます。

アップロード メニューには、レコーディング ファイル (タスクの記録) のみをアップロードするためのオプションも用意されています。

選択するテスト ケースがわからない場合に、(前回の読み込み以降の) すべての変更を Azure DevOps にコミットするには、アップロード メニューで **すべての変更されたオートメーション ファイルをアップロード** を選択します。

## <a name="process-compliance"></a>コンプライアンスのプロセス

RSAT には、テスト ケースの準備状況を管理する機能が用意されています。 また、テストの実行のためのサインオフ プロセスも用意されています。 これは、設定の **プロセス** タブでコンフィギュレーションできます。

![コンプライアンス ファイルのプロセス](media/rsat-process-compliance-settings.png)

### <a name="enforce-test-case-readiness"></a>テスト ケースの準備完了を適用する

Azure DevOps で **準備完了** のステータスがない限り、テスト ケースが実行されないように設定できます。 **テスト ケースの準備完了を適用する** のチェック ボックスをオンにします。 既定では、このチェック ボックスはオフになっています。

### <a name="signoffs"></a>サインオフ

テストの実行が完了すると、RSAT によって Azure DevOps にサインオフ作業項目が作成されます。 **サインオフ タスク** チェック ボックスをオンにします。 次に、サインオフする各ユーザーに対して作成する作業項目のタイプを設定します。 サインオフには、**機能**、**IT マネージャー**、または **チーム マネージャー** ロールを選択してから、適切な電子メール アドレスを指定できます。 その後、作業項目は Azure DevOps で作成され、承認のために所有者に割り当てられます。


[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]