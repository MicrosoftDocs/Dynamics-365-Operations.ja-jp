---
title: Azure Pipelines に配置可能なパッケージの作成
description: このトピックでは、Microsoft Azure DevOps でビルドの自動化を実行するときに、ソフトウェア配置可能なパッケージを作成する方法について説明します。
author: jorisdg
ms.date: 03/05/2020
ms.topic: article
audience: Developer
ms.reviewer: rhaertle
ms.custom: 26731
ms.assetid: ''
ms.search.region: Global
ms.author: jorisde
ms.search.validFrom: 2020-03-05
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 745b407be3212cc97809a72221137a1027b41f07
ms.sourcegitcommit: 2f766e5bb8574d250f19180ff2e101e895097713
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2021
ms.locfileid: "5923283"
---
# <a name="create-deployable-packages-in-azure-pipelines"></a><span data-ttu-id="1bf22-103">Azure Pipelines に配置可能なパッケージの作成</span><span class="sxs-lookup"><span data-stu-id="1bf22-103">Create deployable packages in Azure Pipelines</span></span>

<span data-ttu-id="1bf22-104">カスタマイズを環境に配置する場合は、配置可能なパッケージが Microsoft Dynamics Lifecycle Services (LCS) に必要です。</span><span class="sxs-lookup"><span data-stu-id="1bf22-104">If you want to deploy customizations to an environment, a deployable package is required in Microsoft Dynamics Lifecycle Services (LCS).</span></span> <span data-ttu-id="1bf22-105">このパッケージは、ビルド プロセスまたはリリース プロセス中に Azure Pipelines を使用して作成できます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-105">You can create this package by using Azure Pipelines during a build or release process.</span></span>

<span data-ttu-id="1bf22-106">このトピックは、[Azure Pipelines](/azure/devops/pipelines/get-started/pipelines-get-started) の実用的な知識を前提としています。</span><span class="sxs-lookup"><span data-stu-id="1bf22-106">This topic assumes a working knowledge of [Azure Pipelines](/azure/devops/pipelines/get-started/pipelines-get-started).</span></span>

> [!NOTE]
> <span data-ttu-id="1bf22-107">これらのステップをパイプラインに追加するには、[Dynamics 365 Finance and Operations ツール](https://marketplace.visualstudio.com/items?itemName=Dyn365FinOps.dynamics365-finops-tools)拡張機能が有効になっていて、Azure DevOps アカウントで Azure DevOps が有効化およびインストールされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-107">Before you can add these steps to a pipeline, the [Dynamics 365 Finance and Operations Tools](https://marketplace.visualstudio.com/items?itemName=Dyn365FinOps.dynamics365-finops-tools) extension for Azure DevOps must be enabled and installed in the Azure DevOps account.</span></span> <span data-ttu-id="1bf22-108">組織に拡張機能をインストールする方法の詳細については、[拡張機能のインストール](/azure/devops/marketplace/install-extension)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1bf22-108">For more information about how to install an extension for an organization, see [Install extensions](/azure/devops/marketplace/install-extension).</span></span>
>
> <span data-ttu-id="1bf22-109">この Azure DevOps タスクを実行するには、エージェントで X++ コンパイラ ツールを使用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-109">This Azure DevOps task requires that the X++ compiler tools be available on the agent.</span></span> <span data-ttu-id="1bf22-110">このタスクをビルド バーチャル マシン (VM) エージェントで実行するか、コンパイラ ツール NuGetパッケージを使用してください。</span><span class="sxs-lookup"><span data-stu-id="1bf22-110">Either run this task on a build virtual machine (VM) agent, or use the Compiler Tools NuGet package.</span></span> <span data-ttu-id="1bf22-111">NuGet パッケージとパイプラインへのインストール方法の詳細については、[Microsoft がホストするエージェントと Azure Pipelines を使用したビルドの自動化](hosted-build-automation.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1bf22-111">For more information about the NuGet package and how to install it in a pipeline, see [Build automation using Microsoft-hosted agents and Azure Pipelines](hosted-build-automation.md).</span></span>

## <a name="add-the-task-to-a-pipeline"></a><span data-ttu-id="1bf22-112">パイプラインへのタスクの追加</span><span class="sxs-lookup"><span data-stu-id="1bf22-112">Add the task to a pipeline</span></span>

<span data-ttu-id="1bf22-113">YML または Classic パイプラインのビルドにタスクを追加するには、**配置可能なパッケージの作成** のタスク リストを検索します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-113">To add the task to the build of your YML or Classic pipeline, search the task list for **Create Deployable Package**.</span></span> <span data-ttu-id="1bf22-114">次のテーブルに、このタスクで使用可能なオプションを示します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-114">The following table describes the options that are available for this task.</span></span>

| <span data-ttu-id="1bf22-115">入力名</span><span class="sxs-lookup"><span data-stu-id="1bf22-115">Input name</span></span> | <span data-ttu-id="1bf22-116">必須</span><span class="sxs-lookup"><span data-stu-id="1bf22-116">Mandatory</span></span> | <span data-ttu-id="1bf22-117">説明</span><span class="sxs-lookup"><span data-stu-id="1bf22-117">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1bf22-118">X++ ツール パス</span><span class="sxs-lookup"><span data-stu-id="1bf22-118">X++ Tools Path</span></span> | <span data-ttu-id="1bf22-119">有</span><span class="sxs-lookup"><span data-stu-id="1bf22-119">Yes</span></span> | <span data-ttu-id="1bf22-120">X++ ツールの場所のパス。</span><span class="sxs-lookup"><span data-stu-id="1bf22-120">The path of the location of the X++ tools.</span></span> <span data-ttu-id="1bf22-121">この場所は、ビルド VM 上の **PackagesLocalDirectory\\bin** フォルダーの場所か、コンパイラ ツール NuGet パッケージの抽出された NuGet ファイルの場所です。</span><span class="sxs-lookup"><span data-stu-id="1bf22-121">This location is either the **PackagesLocalDirectory\\bin** folder location on a build VM, or the location of the extracted NuGet file of the Compiler Tools NuGet package.</span></span> |
| <span data-ttu-id="1bf22-122">パッケージに対する X++ バイナリの場所</span><span class="sxs-lookup"><span data-stu-id="1bf22-122">Location of the X++ binaries to package</span></span> | <span data-ttu-id="1bf22-123">有</span><span class="sxs-lookup"><span data-stu-id="1bf22-123">Yes</span></span> | <span data-ttu-id="1bf22-124">配置可能パッケージに含める X++ パッケージ (モジュール) のすべてのバイナリが格納されているフォルダーのパス。</span><span class="sxs-lookup"><span data-stu-id="1bf22-124">The path that contains the folders that contain all the binaries for the X++ packages (modules) that you want to include in the deployable package.</span></span> <span data-ttu-id="1bf22-125">ビルド パイプラインでこのタスクを使用する場合、このフォルダーは通常、コンパイラの出力フォルダーと同じです。</span><span class="sxs-lookup"><span data-stu-id="1bf22-125">If this task is used in a build pipeline, this folder is typically the same as the compiler output folder.</span></span> |
| <span data-ttu-id="1bf22-126">パッケージ化するバイナリの検索パターン</span><span class="sxs-lookup"><span data-stu-id="1bf22-126">Search pattern for binaries to package</span></span> | <span data-ttu-id="1bf22-127">有</span><span class="sxs-lookup"><span data-stu-id="1bf22-127">Yes</span></span> | <span data-ttu-id="1bf22-128">**パッケージへの X++ バイナリの場所** オプションで指定されているパス内で、X++ パッケージ (モジュール) 名に一致する名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-128">Provide a name matching pattern for X++ package (module) names inside the path that is specified in the **Location of the X++ binaries to package** option.</span></span> <span data-ttu-id="1bf22-129">検索パターンの代わりに名前の一覧を指定したり、テスト パッケージが含まれていないように除外フィルターを指定したりすることもできます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-129">You can also specify a list of names instead of search patterns, or you can specify exclusion filters so that, for example, test packages aren't included.</span></span> <span data-ttu-id="1bf22-130">検索パターンは、フォルダーを検索し、X++ アセンブリ で `bin` サブフォルダーが含まれていることを検証します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-130">The search pattern looks for folders and validates that they contain a `bin` sub-folder with X++ assemblies.</span></span> <span data-ttu-id="1bf22-131">詳細については、[ファイルの一致パターン リファレンス](/azure/devops/pipelines/tasks/file-matching-patterns)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1bf22-131">For more information, see [File matching patterns reference](/azure/devops/pipelines/tasks/file-matching-patterns).</span></span>  |
| <span data-ttu-id="1bf22-132">配置可能なパッケージのファイル名とパス</span><span class="sxs-lookup"><span data-stu-id="1bf22-132">Filename and path for the deployable package</span></span> | <span data-ttu-id="1bf22-133">有</span><span class="sxs-lookup"><span data-stu-id="1bf22-133">Yes</span></span> | <span data-ttu-id="1bf22-134">配置可能なパッケージのパスとファイル名。</span><span class="sxs-lookup"><span data-stu-id="1bf22-134">The path and file name of the deployable package.</span></span> <span data-ttu-id="1bf22-135">出力ファイルは zip ファイルであり、ファイル名には通常、ファイルを識別しやすいようにするためのバージョン情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1bf22-135">The output file is a zip file, and the file name typically includes version information to make the file easy to identify.</span></span> |

## <a name="nuget-dependency"></a><span data-ttu-id="1bf22-136">NuGet の依存関係</span><span class="sxs-lookup"><span data-stu-id="1bf22-136">NuGet dependency</span></span>

<span data-ttu-id="1bf22-137">ビルド VM でこのタスクを実行すると、NuGet が既に使用可能になっており、アクションは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="1bf22-137">When this task is run on the build VM, NuGet is already available, and no action is required.</span></span> <span data-ttu-id="1bf22-138">ただし、このタスクをホストされたエージェントまたはその他のプライベート エージェントで実行する場合は、NuGet がインストールされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-138">However, when this task is run on hosted agents or other private agents, NuGet must be installed.</span></span> <span data-ttu-id="1bf22-139">この場合、Azure DevOps には、パッケージを作成するタスクを実行する前に実行できる [NuGet ツール インストーラー タスク](/azure/devops/pipelines/tasks/tool/nuget)があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-139">In this case, Azure DevOps has the [NuGet Tool Installer task](/azure/devops/pipelines/tasks/tool/nuget) that you can run before you run the task to create the package.</span></span>

> [!NOTE]
> <span data-ttu-id="1bf22-140">NuGet バージョン 3.4 以降のセマンティック バージョニングが導入されたため、バージョン 3.3.0 またはそれ以前のバージョンをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-140">Because of the introduction of semantic versioning in NuGet version 3.4 and later, you must install version 3.3.0 or earlier.</span></span>

## <a name="search-for-binaries-to-package"></a><span data-ttu-id="1bf22-141">パッケージ化するバイナリの検索</span><span class="sxs-lookup"><span data-stu-id="1bf22-141">Search for binaries to package</span></span>

<span data-ttu-id="1bf22-142">ビルド仮想マシンのレガシー パッケージングと比較して、パッケージング タスクでは、パッケージするモジュールとその場所を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1bf22-142">Compared to the legacy packaging on the build virtual machine, the packaging task has to specify which modules to package and where to find them.</span></span> <span data-ttu-id="1bf22-143">標準のパイプラインでは、コンパイル中の X ++ モジュールが Azure DevOps エージェントのバイナリ フォルダーに出力されます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-143">In a standard pipeline, X++ modules under compilation are output in the binaries folder of the Azure DevOps agent.</span></span> <span data-ttu-id="1bf22-144">既定では、パッケージング タスクは X++ バイナリのフォルダーを検索します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-144">The packaging task by default will look in this folder for any X++ binaries.</span></span> <span data-ttu-id="1bf22-145">フォルダー名を検索します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-145">The search looks for folder names.</span></span> <span data-ttu-id="1bf22-146">X++ アセンブリを含む `/bin/` サブフォルダーがある場合は、このフォルダー内でタスクが確認されます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-146">The task will check inside these folders if there is a `/bin/` subfolder with X++ assemblies.</span></span>

> [!NOTE]
> <span data-ttu-id="1bf22-147">ソース管理リポジトリに ISV モジュールなどのサード パーティ バイナリが含まれている場合、パッケージ ステップには特にそれらのバイナリが含まれています。</span><span class="sxs-lookup"><span data-stu-id="1bf22-147">If your source control repositores includes third-party binaries such as ISV modules, the packaging step has specifically includes those binaries.</span></span> <span data-ttu-id="1bf22-148">このトピックの例のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="1bf22-148">See the examples section of this topic.</span></span>

## <a name="examples-of-search-patterns"></a><span data-ttu-id="1bf22-149">検索パターンの例</span><span class="sxs-lookup"><span data-stu-id="1bf22-149">Examples of search patterns</span></span>

<span data-ttu-id="1bf22-150">次の例では、**パッケージへの X ++ バイナリの場所** プロパティが既定値の `$(Build.BinariesDirectory)` に設定されていると想定しています。これは、X ++ コンパイラがバイナリを生成する場所です。</span><span class="sxs-lookup"><span data-stu-id="1bf22-150">The following example assumes the **Location of the X++ binaries to package** property is set to its default value of `$(Build.BinariesDirectory)`, which is the location where the X++ compiler produces the binaries.</span></span>

| <span data-ttu-id="1bf22-151">検索パターン</span><span class="sxs-lookup"><span data-stu-id="1bf22-151">Search pattern</span></span> | <span data-ttu-id="1bf22-152">説明</span><span class="sxs-lookup"><span data-stu-id="1bf22-152">Description</span></span> |
| --- | --- |
| `*` | <span data-ttu-id="1bf22-153">`$(Build.BinariesDirectory)` 内のすべての X++ バイナリを検索する。</span><span class="sxs-lookup"><span data-stu-id="1bf22-153">Find all X++ binaries in `$(Build.BinariesDirectory)`.</span></span> <span data-ttu-id="1bf22-154">これが既定値です。</span><span class="sxs-lookup"><span data-stu-id="1bf22-154">This is the default value.</span></span> |
| `*`<br/>`!*Tests` | <span data-ttu-id="1bf22-155">すべての X++ バイナリを検索し、`Tests` で終了するモジュール名は除外します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-155">Find all X++ binaries, exclude any module names that end in `Tests`.</span></span> |
| `MyPackage` | <span data-ttu-id="1bf22-156">`$(Build.BinariesDirectory)` フォルダーで `MyPackage` という名前のモジュールを検索します。</span><span class="sxs-lookup"><span data-stu-id="1bf22-156">Find a module named `MyPackage` in the `$(Build.BinariesDirectory)` folder.</span></span> |
| `*`<br/>`$(Build.SourcesDirectory)\Metadata\MyBinaryPackage` | <span data-ttu-id="1bf22-157">すべての X ++ バイナリを `$(Build.BinariesDirectory)` に含め、 `MyBinaryPackage` という名前のモジュールを `Metadata` フォルダー内のソース ディレクトリ (マップされたソース管理リポジトリ フォルダー) に含めます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-157">Include all X++ binaries in `$(Build.BinariesDirectory)`, as well as a module named `MyBinaryPackage` in the sources directory (which is the mapped source control repository folder) inside the `Metadata` folder.</span></span> |
| `*`<br/>`!*Tests`<br/>`$(Build.SourcesDirectory)\Metadata\MyISV1`<br/>`$(Build.SourcesDirectory)\Metadata\MyISV2` | <span data-ttu-id="1bf22-158">すべての X++ バイナリを `$(Build.BinariesDirectory)` に含め、名前が `Tests` で終わるモジュールを除外し、`MyISV1` と `MyISV2` という名前の 2 つのモジュールを `Metadata` フォルダー内のソース ディレクトリ (マップされたソース管理リポジトリ フォルダー) に含めます。</span><span class="sxs-lookup"><span data-stu-id="1bf22-158">Include all X++ binaries in `$(Build.BinariesDirectory)`, exclude any modules where the names end in `Tests`, and include two modules named `MyISV1` and `MyISV2` in the sources directory (which is the mapped source control repository folder) inside the `Metadata` folder.</span></span> |

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]