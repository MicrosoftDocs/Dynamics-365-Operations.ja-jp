---
title: 重複割引の最適な組み合わせを決定する
description: 割引が重複している場合は、最小トランザクションの合計または最上位の割引合計の重複割引の組み合わせを決定する必要があります。 一般的な「Buy 1、get X ％off」(BOGO) 小売割引のように、購入される製品の価格に応じて割引額が異なる場合、このプロセスは組合せ最適化の問題になります。
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailParameters, RetailPeriodicDiscount,
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations, Retail
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: eebb532071e7c6bae7cfae93bfe795e79bb16c63
ms.sourcegitcommit: 0f530e5f72a40f383868957a6b5cb0e446e4c795
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/29/2019
ms.locfileid: "360696"
---
# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a><span data-ttu-id="5f156-104">重複割引の最適な組み合わせを決定する</span><span class="sxs-lookup"><span data-stu-id="5f156-104">Determine the optimal combination of overlapping discounts</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="5f156-105">割引が重複している場合は、最小トランザクションの合計または最上位の割引合計の重複割引の組み合わせを決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f156-105">When discounts overlap, you must determine the combination of overlapping discounts that will produce the lowest transaction total or the highest total discount.</span></span> <span data-ttu-id="5f156-106">一般的な「Buy 1、get X ％off」(BOGO) 小売割引のように、購入される製品の価格に応じて割引額が異なる場合、このプロセスは組合せ最適化の問題になります。</span><span class="sxs-lookup"><span data-stu-id="5f156-106">When the discount amount varies according to the price of the products that are purchased, such as in the common "Buy 1, get 1 X percent off" (BOGO) retail discount, this process becomes an issue of combinatorial optimization.</span></span>

<span data-ttu-id="5f156-107">この記事は、Microsoft Dynamics AX 2012 R3 の KB 3105973 (2015 年 11 月 2 日リリース) もしくはそれ以降、および  Microsoft Dynamics 365 for Retail に適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-107">This article applies to Microsoft Dynamics AX 2012 R3 with KB 3105973 (released November 2, 2015) or later, and to Microsoft Dynamics 365 for Retail.</span></span> <span data-ttu-id="5f156-108">適時に適用できるように重複する割引の組み合わせを決定するために、重複する割引を適用する方法を導入しました。</span><span class="sxs-lookup"><span data-stu-id="5f156-108">To determine the combination overlapping discounts to apply in a timely manner, we have introduced a method for applying overlapping discounts.</span></span> <span data-ttu-id="5f156-109">この新しいメソッドを **基準金額の値のランキング** と呼んでいます。</span><span class="sxs-lookup"><span data-stu-id="5f156-109">We call this new method **marginal value ranking**.</span></span> <span data-ttu-id="5f156-110">基準金額の値のランキングは、重複割引の可能な組み合わせを評価するために必要な時間が **小売パラメーター** ページでコンフィギュレーション可能なしきい値を超える場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-110">Marginal value ranking is used when the time that is required in order to evaluate the possible combinations of overlapping discounts exceeds a threshold that is configurable on the **Retail parameters** page.</span></span> <span data-ttu-id="5f156-111">基準金額の値のランキング メソッドでは、重複する各ディスカウントについて、共有された製品のディスカウント値を使用して値が計算されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-111">In the marginal value ranking method, a value is calculated for each overlapping discount by using the discount's value on the shared products.</span></span> <span data-ttu-id="5f156-112">重複した割引は、最も高い相対値から最も低い相対値に適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-112">The overlapped discounts are then applied from the highest relative value to the lowest relative value.</span></span> <span data-ttu-id="5f156-113">新しい方法の詳細については、この資料の後半の「基準金額の値」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5f156-113">For details about the new method, see the "Marginal value" section, later in this article.</span></span> <span data-ttu-id="5f156-114">基準金額の値のランキングは、ある商品の割引額がその取引の他の商品の影響を受けない場合は使用されません。</span><span class="sxs-lookup"><span data-stu-id="5f156-114">Marginal value ranking isn't used when the discount amounts for a product aren't affected by another product in the transaction.</span></span> <span data-ttu-id="5f156-115">たとえば、この方法は、2 つの単純割引、または単純割引および 1 つの製品数量割引には使用されません。</span><span class="sxs-lookup"><span data-stu-id="5f156-115">For example, this method isn't used for two simple discounts, or for a simple discount and a single product quantity discount.</span></span>

## <a name="discount-examples"></a><span data-ttu-id="5f156-116">割引の例</span><span class="sxs-lookup"><span data-stu-id="5f156-116">Discount examples</span></span>

<span data-ttu-id="5f156-117">共通の製品群に対して無制限の小売割引を作成することができます。</span><span class="sxs-lookup"><span data-stu-id="5f156-117">You can create an unlimited number of retail discounts on a common set of products.</span></span> <span data-ttu-id="5f156-118">ただし、制限がないため、さまざまな製品で使用する割引を計算しようとすると、パフォーマンスの問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5f156-118">However, because there is no limit, performance issues can occur when you try to calculate the discounts that should be used on the various products.</span></span> <span data-ttu-id="5f156-119">次の例は、この問題をより詳細に説明しています。</span><span class="sxs-lookup"><span data-stu-id="5f156-119">The following examples illustrate this issue in more detail.</span></span> <span data-ttu-id="5f156-120">例 1 では、2 つの製品と重複した 2 つの割引から始めます。</span><span class="sxs-lookup"><span data-stu-id="5f156-120">In example 1, we start with two products and two overlapping discounts.</span></span> <span data-ttu-id="5f156-121">次に、例 2 では、製品が追加されるにつれて問題がどのように展開するかを示します。</span><span class="sxs-lookup"><span data-stu-id="5f156-121">Then, in example 2, we show how the issue evolves as more products are added.</span></span>

### <a name="example-1-two-products-and-two-discounts"></a><span data-ttu-id="5f156-122">例 1: 2 つの製品と 2 つの割引</span><span class="sxs-lookup"><span data-stu-id="5f156-122">Example 1: Two products and two discounts</span></span>

<span data-ttu-id="5f156-123">この例では、各割引の資格を得るために 2 つの製品が必要で、割引を組み合わせることはできません。</span><span class="sxs-lookup"><span data-stu-id="5f156-123">In this example, two products are required in order to qualify for each discount, and the discounts can't be combined.</span></span> <span data-ttu-id="5f156-124">この例の割引は、**最良価格** 割引です。</span><span class="sxs-lookup"><span data-stu-id="5f156-124">The discounts in this example are **Best price** discounts.</span></span> <span data-ttu-id="5f156-125">どちらの製品も両方の割引の対象となります。</span><span class="sxs-lookup"><span data-stu-id="5f156-125">Both products qualify for both discounts.</span></span> <span data-ttu-id="5f156-126">ここに 2 つの割引があります。</span><span class="sxs-lookup"><span data-stu-id="5f156-126">Here are the two discounts.</span></span>

![重複する割引コンボ 01](./media/overlapping-discount-combo-01.jpg)

<span data-ttu-id="5f156-128">いずれの 2 つの製品についても、これらの 2 つの割引のうち、より良いものは 2 つの製品の価格によって異なります。</span><span class="sxs-lookup"><span data-stu-id="5f156-128">For any two products, the better of these two discounts depends on the prices of the two products.</span></span> <span data-ttu-id="5f156-129">両方の製品の価格が等しいかほぼ同じであれば、割引 1 がより良いといえます。</span><span class="sxs-lookup"><span data-stu-id="5f156-129">When the price of both products is equal or almost equal, discount 1 is better.</span></span> <span data-ttu-id="5f156-130">1 つの製品の価格が他の製品の価格よりも大幅に低い場合、割引 2 がより良いといえます。</span><span class="sxs-lookup"><span data-stu-id="5f156-130">When the price of one product is significantly less than the price of the other product, discount 2 is better.</span></span> <span data-ttu-id="5f156-131">これらの 2 つの割引を相互に評価するための数学的ルールは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="5f156-131">Here is the mathematical rule for evaluating these two discounts against each other.</span></span>

![重複する割引コンボ 02](./media/overlapping-discount-combo-02.jpg)

> [!NOTE]
> <span data-ttu-id="5f156-133">製品 1 の価格が製品 2 の価格の 3 分の 2 に等しい場合、2 つの割引は同等です。</span><span class="sxs-lookup"><span data-stu-id="5f156-133">When the price of product 1 is equal to two-thirds of the price of product 2, the two discounts are equal.</span></span> <span data-ttu-id="5f156-134">この例では、割引率 1 の有効割引率は数パーセント (2 つの製品の価格が離れている場合) から最大 25 パーセント (2 つの製品が同じ価格の場合) まで変化します。</span><span class="sxs-lookup"><span data-stu-id="5f156-134">In this example, the effective discount percentage for discount 1 varies from a few percent (when the prices of the two products are far apart) to a maximum of 25 percent (when the two products have the same price).</span></span> <span data-ttu-id="5f156-135">割引 2 の有効割引率は固定されています。</span><span class="sxs-lookup"><span data-stu-id="5f156-135">The effective discount percentage for discount 2 is fixed.</span></span> <span data-ttu-id="5f156-136">それは常に 20 ％ です。</span><span class="sxs-lookup"><span data-stu-id="5f156-136">It's always 20 percent.</span></span> <span data-ttu-id="5f156-137">割引 1 の有効割引率は、割引率 2 以上であるか、またはそれ未満である可能性があるので、割り引かれなければならない 2 つの製品の価格によって最適な割引が異なります。</span><span class="sxs-lookup"><span data-stu-id="5f156-137">Because the effective discount percentage for discount 1 has a range that can be more than or less than discount 2, the best discount depends on the prices of the two products that must be discounted.</span></span> <span data-ttu-id="5f156-138">この例では、2 つの製品に 2 つの割引のみが適用されるため、計算が迅速に完了します。</span><span class="sxs-lookup"><span data-stu-id="5f156-138">In this example, the calculation is completed quickly, because only two discounts are applied on only two products.</span></span> <span data-ttu-id="5f156-139">可能な組み合わせは 2 つしかありません: 割引 1 のアプリケーションまたは割引 2 のアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="5f156-139">There are only two possible combinations: one application of discount 1 or one application of discount 2.</span></span> <span data-ttu-id="5f156-140">計算する順列はありません。</span><span class="sxs-lookup"><span data-stu-id="5f156-140">There are no permutations to calculate.</span></span> <span data-ttu-id="5f156-141">各割引の価値は両方の製品を使用して計算され、最適な割引が使用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-141">The value of each discount is calculated by using both products, and the best discount is used.</span></span>

### <a name="example-2-four-products-and-two-discounts"></a><span data-ttu-id="5f156-142">例 2: 4 つの製品と 2 つの割引</span><span class="sxs-lookup"><span data-stu-id="5f156-142">Example 2: Four products and two discounts</span></span>

<span data-ttu-id="5f156-143">次に、4 つの製品と同じ 2 つの割引を使用します。</span><span class="sxs-lookup"><span data-stu-id="5f156-143">Next, we will use four products and the same two discounts.</span></span> <span data-ttu-id="5f156-144">4 つの製品は両方とも割引の対象となります。</span><span class="sxs-lookup"><span data-stu-id="5f156-144">All four products qualify for both discounts.</span></span> <span data-ttu-id="5f156-145">12 の可能な組み合わせがあります。</span><span class="sxs-lookup"><span data-stu-id="5f156-145">There are twelve possible combinations.</span></span> <span data-ttu-id="5f156-146">最後に、2 つの割引が、3 つの組み合わせの 1 つでトランザクションに適用されます: 割引 1 の 2 つのアプリケーション、割引 2 の 2 つのアプリケーション、または割引 1 の 1 つのアプリケーション、および割引 2 の 1 つのアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="5f156-146">In the end, two discounts will be applied to the transaction in one of three combinations: two applications of discount 1, two applications of discount 2, or one application of discount 1 and one application of discount 2.</span></span> <span data-ttu-id="5f156-147">可能な組合せを説明するために、異なる価格を持つ 4 つの製品の 2 つの異なるセットを検討します。</span><span class="sxs-lookup"><span data-stu-id="5f156-147">To illustrate the possible combinations, we will look at two different sets of four products that have different prices:</span></span>

- <span data-ttu-id="5f156-148">4 つの製品はすべて同じ価格、$15.00 です。</span><span class="sxs-lookup"><span data-stu-id="5f156-148">All four products have the same price, $15.00.</span></span> <span data-ttu-id="5f156-149">この場合、最高の割引組み合わせは割引 1 の 2 つのアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="5f156-149">In this case, the best discount combination is two applications of discount 1.</span></span> <span data-ttu-id="5f156-150">2 つの製品は定価であり、2 つで 50 % 割引になります。</span><span class="sxs-lookup"><span data-stu-id="5f156-150">Two products will be full price, and two will be 50 percent off.</span></span> <span data-ttu-id="5f156-151">トランザクションの合計割引額は $ 45 (15 + 15 + 7.50 + 7.50) で、割引前の合計 $ 60 から $ 15 (25％) を差し引いたものです。</span><span class="sxs-lookup"><span data-stu-id="5f156-151">The discounted total for the transaction is $45 (15 + 15 + 7.50 + 7.50), which is $15 (25 percent) off the undiscounted total of $60.</span></span> <span data-ttu-id="5f156-152">割引 2 はわずか $12 (20％) です。</span><span class="sxs-lookup"><span data-stu-id="5f156-152">Discount 2 is only $12 (20 percent).</span></span>
- <span data-ttu-id="5f156-153">2 つの製品はそれぞれ $20 であり、1 つの製品は $15、および 1 つの製品は $5 です。</span><span class="sxs-lookup"><span data-stu-id="5f156-153">Two products are $20 each, one product is $15, and one product is $5.</span></span> <span data-ttu-id="5f156-154">この場合、最良の割引組み合わせは、割引 2 の 1 つのアプリケーションおよび割引 1 の 1 つのアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="5f156-154">In this case, the best discount combination is one application of discount 2 and one application of discount 1.</span></span> <span data-ttu-id="5f156-155">次の表は、割引を示しています。</span><span class="sxs-lookup"><span data-stu-id="5f156-155">The following tables illustrates the discounts.</span></span>

<span data-ttu-id="5f156-156">表を読み取るには、行の 1 つの製品と列の 1 つの製品を使用します。</span><span class="sxs-lookup"><span data-stu-id="5f156-156">To read the tables, use one product from a row and one product from a column.</span></span> <span data-ttu-id="5f156-157">たとえば、割引 1 の表では、2 つの $20 の製品を組み合わせると、$10 の割引が得られます。</span><span class="sxs-lookup"><span data-stu-id="5f156-157">For example, in the table for discount 1, when you combine the two $20 products, you get $10 off.</span></span> <span data-ttu-id="5f156-158">たとえば、割引 2 の表では、$15 の製品と $5 の製品を組み合わせると、$4 の割引が得られます。</span><span class="sxs-lookup"><span data-stu-id="5f156-158">In the table for discount 2, when you combine the $15 product and the $5 product, you get $4 off.</span></span>

![重複する割引コンボ 03](./media/overlapping-discount-combo-03.jpg)

<span data-ttu-id="5f156-160">最初に、割引を使用して、2 つの製品から得られる最大の割引を見つけます。</span><span class="sxs-lookup"><span data-stu-id="5f156-160">First, we find the largest discount that is available from any two products by using either discount.</span></span> <span data-ttu-id="5f156-161">2 つの表は、2 つの製品のすべての組み合わせの割引金額を表示します。</span><span class="sxs-lookup"><span data-stu-id="5f156-161">The two tables show the discount amount for all combinations of the two products.</span></span> <span data-ttu-id="5f156-162">表の網掛け部分は、製品がそれ自体とペアになっている場合 (これは不可能)、または 2 つの製品を逆にペアにして同じ割引額が生じて無視できる場合のいずれかを表します。</span><span class="sxs-lookup"><span data-stu-id="5f156-162">The shaded portions of the tables represent either cases where a product is paired with itself, which we can't do, or a reverse pairing of two products that produces the same discount amount and can be ignored.</span></span> <span data-ttu-id="5f156-163">表を見ると、2 つの $20 品目の割引 1 が、すべての 4 つの製品のいずれかの割引に使用できる最大割引であることがわかります。</span><span class="sxs-lookup"><span data-stu-id="5f156-163">By looking at the tables, you can see that discount 1 for the two $20 items is the largest discount that is available for either discount on all four products.</span></span> <span data-ttu-id="5f156-164">(この割引は、最初の表の緑色で強調表示されています。) これにより、$15 の製品と $5 の製品のみが残っています。</span><span class="sxs-lookup"><span data-stu-id="5f156-164">(This discount is highlighted in green in the first table.) That leaves only the $15 product and the $5 product.</span></span> <span data-ttu-id="5f156-165">2 つの表を再度見ると、これらの 2 つの製品について、割引 1 は $2.50 の割引を、割引 2 は $4 の割引を提供することがわかります。</span><span class="sxs-lookup"><span data-stu-id="5f156-165">By looking at the two tables again, you can see that, for these two products, discount 1 gives a $2.50 discount, whereas discount 2 gives a $4 discount.</span></span> <span data-ttu-id="5f156-166">したがって、割引 2 を選択します。</span><span class="sxs-lookup"><span data-stu-id="5f156-166">Therefore, we select discount 2.</span></span> <span data-ttu-id="5f156-167">合計割引は $14 です。</span><span class="sxs-lookup"><span data-stu-id="5f156-167">The total discount is $14.</span></span> <span data-ttu-id="5f156-168">この説明をより簡単に視覚化するために、割引 1 と割引 2 の両方で可能な 2 つの製品の組み合わせの有効な割引率を示す 2 つの追加テーブルがあります。</span><span class="sxs-lookup"><span data-stu-id="5f156-168">To make this discussion easier to visualize, here are two additional tables that show the effective discount percentage for all possible two-product combinations for both discount 1 and discount 2.</span></span> <span data-ttu-id="5f156-169">これらの 2 つの割引については、2 つの製品が割引に入れられる順序は重要ではないため、組合せリストの半分のみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="5f156-169">Only half the list of combinations is included, because, for these two discounts, the order in which the two products are put into the discount doesn't matter.</span></span> <span data-ttu-id="5f156-170">最も高い有効割引率 (25％) は緑で強調表示され、最も低い有効割引率 (10％) は赤で強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-170">The highest effective discount (25 percent) is highlighted in green, and the lowest effective discount (10 percent) is highlighted in red.</span></span>

![重複する割引コンボ 04](./media/overlapping-discount-combo-04.jpg)

> [!NOTE]
> <span data-ttu-id="5f156-172">価格が変動し、2 つ以上の割引が競合する場合、割引の最良の組み合わせを保証する唯一の方法は、両方の割引を評価し、それらを比較することです。</span><span class="sxs-lookup"><span data-stu-id="5f156-172">When prices vary, and two or more discount compete, the only way to guarantee the best combination of discounts is to evaluate both discounts and compare them.</span></span>

## <a name="total-possible-combinations"></a><span data-ttu-id="5f156-173">すべての可能な組み合わせ</span><span class="sxs-lookup"><span data-stu-id="5f156-173">Total possible combinations</span></span>

<span data-ttu-id="5f156-174">このセクションでは、前のセクションの例を続けます。</span><span class="sxs-lookup"><span data-stu-id="5f156-174">This section continues the example from the previous section.</span></span> <span data-ttu-id="5f156-175">より多くの商品や割引を追加し、計算して比較する必要がある組み合わせを表示します。</span><span class="sxs-lookup"><span data-stu-id="5f156-175">We will add more products and another discount, and see how many combinations must be calculated and compared.</span></span> <span data-ttu-id="5f156-176">次の表は、製品数量が増加するにつれて可能な割引組み合わせの数を示しています。</span><span class="sxs-lookup"><span data-stu-id="5f156-176">The following table shows the number of possible discount combinations as the product quantity increases.</span></span> <span data-ttu-id="5f156-177">この表は、上記の例のように 2 つの重複する割引がある場合と、3 つの重複する割引がある場合の両方を示しています。</span><span class="sxs-lookup"><span data-stu-id="5f156-177">The table shows what happens both when there are two overlapping discounts, as in the previous example, and when there are three overlapping discounts.</span></span> <span data-ttu-id="5f156-178">すぐに評価する必要がある有効な割引の組み合わせの数は、高速コンピュータであっても、小売取引で受け入れられるように迅速に計算して比較できるものを超えています。</span><span class="sxs-lookup"><span data-stu-id="5f156-178">The number of possible discount combinations that must be evaluated soon exceeds what even a fast computer can calculate and compare quickly enough to be acceptable for retail transactions.</span></span>

![重複する割引コンボ 05](./media/overlapping-discount-combo-05.jpg)

<span data-ttu-id="5f156-180">より大きな数量またはより重複した割引が適用される場合、可能な割引組み合わせの総数はすぐに数百万になり、可能な限り最良の組み合わせを迅速に評価して選択するために必要な時間が顕著になります。</span><span class="sxs-lookup"><span data-stu-id="5f156-180">When even larger quantities or more overlapping discounts are applied, the total number of possible discount combinations quickly goes into the millions, and the time that is required in order to evaluate and select the best possible combination quickly becomes noticeable.</span></span> <span data-ttu-id="5f156-181">小売価格エンジンでは、いくつかの最適化が行われ、評価する必要がある組み合わせの総数が削減されています。</span><span class="sxs-lookup"><span data-stu-id="5f156-181">Some optimizations have been done in the retail price engine to reduce the total number of combinations that must be evaluated.</span></span> <span data-ttu-id="5f156-182">ただし、割引の重複数とトランザクションの数量には制限がないため、重複した割引がある場合は常に多数の組み合わせを評価する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f156-182">However, because the number overlapping discounts and the quantities in a transaction aren't limited, a large number of combinations will always have to be evaluated whenever there are overlapping discounts.</span></span> <span data-ttu-id="5f156-183">この問題は、基準金額の値のランキングが取り組む問題といえます。</span><span class="sxs-lookup"><span data-stu-id="5f156-183">This issue is the issue that the marginal value ranking method addresses.</span></span>

## <a name="marginal-value-method"></a><span data-ttu-id="5f156-184">基準金額の値のメソッド</span><span class="sxs-lookup"><span data-stu-id="5f156-184">Marginal value method</span></span>

<span data-ttu-id="5f156-185">評価されるべき指数関数的に増加する組み合わせの問題を解決するために、2 つ以上の割引を適用できる製品セットの各割引の共有製品あたりの価値を計算する最適化が存在します。</span><span class="sxs-lookup"><span data-stu-id="5f156-185">To resolve the issue of an exponentially increasing number of combinations that must be evaluated, an optimization exists that calculates the value per shared product of each discount on the set of products that two or more discounts can be applied to.</span></span> <span data-ttu-id="5f156-186">この値を、共有製品の割引の **基準金額の値** と呼びます。</span><span class="sxs-lookup"><span data-stu-id="5f156-186">We refer to this value as the **marginal value** of the discount for the shared products.</span></span> <span data-ttu-id="5f156-187">基準金額の値は、共有製品が各割引に含まれる場合、合計割引額における製品増加の平均といえます。</span><span class="sxs-lookup"><span data-stu-id="5f156-187">The marginal value is the average per product increase in the total discount amount when the shared products are included in each discount.</span></span> <span data-ttu-id="5f156-188">基準金額の値は、合計割引額 (DTotal) をとり、共有製品なしの割引額 (共有する DMinus\\) を差し引き、その差を共有製品数 (ProductsShared) で割ることによって計算されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-188">The marginal value is calculated by taking the total discount amount (DTotal), subtracting the discount amount without the shared products (DMinus\\ Shared), and dividing that difference by the number of shared products (ProductsShared).</span></span>

![重複する割引コンボ 06](./media/overlapping-discount-combo-06.jpg)

<span data-ttu-id="5f156-190">共有製品郡における各割引の基準金額の値が計算された後、割引は最大限の基準金額の値から最低限の基準金額の値まで、徹底して順番に共有製品に適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-190">After the marginal value of each discount on a shared set of products is calculated, the discounts are applied to the shared products in order, exhaustively, from highest marginal value to lowest marginal value.</span></span> <span data-ttu-id="5f156-191">この方法では、1 回の割引インスタンスが適用されるたびに、残りのすべての割引可能性が比較されることはありません。</span><span class="sxs-lookup"><span data-stu-id="5f156-191">For this method, all remaining discount possibilities aren't compared every time after a single instance of a discount is applied.</span></span> <span data-ttu-id="5f156-192">その代わりに、重複割引は 1 回比較され、その後順番に適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f156-192">Instead, the overlapping discounts are compared one time and then applied in order.</span></span> <span data-ttu-id="5f156-193">追加の比較は行われません。</span><span class="sxs-lookup"><span data-stu-id="5f156-193">No additional comparisons are done.</span></span> <span data-ttu-id="5f156-194">**小売パラメータ** ページの **割引** タブで、基準金額の値のメソッドに切り替えるようにしきい値を設定できます。</span><span class="sxs-lookup"><span data-stu-id="5f156-194">You can configure the threshold to switch to the marginal value method on the **Discount** tab of the **Retail parameters** page.</span></span> <span data-ttu-id="5f156-195">合計割引を計算するための許容可能な時間は、小売業によって異なります。</span><span class="sxs-lookup"><span data-stu-id="5f156-195">The acceptable time to calculate the total discount varies across retail industries.</span></span> <span data-ttu-id="5f156-196">ただし、この時間は、一般に、数 10 ミリ秒から 1 秒の範囲内に入ります。</span><span class="sxs-lookup"><span data-stu-id="5f156-196">However, this time generally falls in the range of tens of milliseconds to one second.</span></span>
