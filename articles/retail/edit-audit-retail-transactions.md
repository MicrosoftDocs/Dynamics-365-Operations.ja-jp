---
title: 小売店舗トランザクションの編集と監査
description: このトピックでは、小売店舗のトランザクションを編集および監査するための機能について説明します。
author: josaw1
manager: AnnBe
ms.date: 10/14/2019
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-09-29
ms.dyn365.ops.version: ''
ms.openlocfilehash: f53573b8afb2003f6796930f5877185e533a4715
ms.sourcegitcommit: 92322167f57b66d2accc134aaf862e6b9931ec94
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/31/2019
ms.locfileid: "2693069"
---
# <a name="edit-and-audit-retail-store-transactions"></a>小売店舗トランザクションの編集と監査

[!include [banner](includes/banner.md)]

[!include [banner](includes/preview-banner.md)]

Dynamics 365 Retail のお客様は、サード パーティの販売時点管理 (POS) アプリケーションの他に、ファースト パーティのアプリケーションも使用します。 ファースト パーティの POS アプリケーションを使用すると、小売店舗のトランザクションは、バッチ処理を通じてチャンネルから Retail Headquarters に取り込まれます。 サード パーティのアプリケーションを使用すると、トランザクションは統合によって Retail Headquarters に取り込まれます。 どちらの場合も、トランザクションを Retail Headquarters に取り込んでから、トランザクションに対して複数の検証を実行する整合性チェック プロセスを実行します。そうすると、正常に検証されたトランザクションのみが Retail Headquarters に転記される明細書に取り込まれます。 

さまざまな理由で小売トランザクションの検証が失敗することがあります。 たとえば、統合コードまたは POS のアプリケーションのバグにより、矛盾したデータが発生したり、製品をチャネルと同期してから削除したり、その期間の小売トランザクションを転記せずに会計年度期間を決算したりするなどのユーザー エラーが発生することがあります。

これらのトランザクションにフラグが設定され明細書から除外されますが、トランザクションは、お客様が小売売上を財務に転記する日々のプロセスを妨害する可能性があります。

Retail では、すべての変更の監査を管理しながら、検証に合格しなかった特定の小売トランザクションを編集できます。 

## <a name="edit-and-audit-transactions"></a>トランザクションの編集と監査

Retail バージョン 10.0.5 では、売上や返品のような現金売りトランザクションのみ編集できます。 顧客注文やオンライン注文の編集はサポートされていません。 Retail バージョン 10.0.6 では、現金管理トランザクションの編集もサポートされています。

1. Dynamics Excel アドインをインストールします。

2. **小売店舗の財務** ワークスペースに移動します。 **"トランザクションの検証エラー"** タイルでは、1 つ以上の検証ルールに当てはまらなかった、"小売トランザクション フォーム" の事前にフィルターされたビューが使用できます。
 
3. フォームを開きます。 検証に失敗したレコード、**Office アドイン**、**選択したトランザクションの編集**の順にクリックします。 選択したトランザクションの詳細を含む Excel ファイルを開くと、次のワークシートが表示されます。

    - 行: このワークシートでは、トランザクションのヘッダーや製品行、関連データが表示されます。
    - 支払: このワークシートでは、トランザクションの支払行の詳細が表示されます。
    - 割引: このワークシートでは、トランザクションの割引に関する詳細が表示されます。
    - 税金: このワークシートでは、トランザクションの税金に関する詳細が表示されます。
    - 諸費用: このワークシートでは、トランザクションの諸費用に関する詳細が表示されます。

4. Excel ファイルでは、適切なフィールドを変更してから Dynamics Excel アドインの発行機能を使用して、データを Retail Headquarters に戻すことができます。 公開後、変更はシステムに反映されます。 公開時には、ユーザーが行った変更に対する検証は行われません。

5. 変更の完全な監査証跡を表示するには、ヘッダーレベル変更用の **小売トランザクション** のヘッダー、および適切なトランザクション ページの該当するセクションやレコードにある **監査追跡の表示** をクリックします。 たとえば、販売行に関するすべての変更が **販売トランザクション** ページに表示され、支払に関連する変更は、**支払トランザクション** ページに表示されます。変更用に管理されている監査の詳細は次のとおりです。

   - 変更日時
   - フィールド 
   - 元の値
   - 新しい値
   - 変更者

6. 変更して公開した後、**店舗トランザクションの検証** オプションを再度実行して、実行した変更に一貫性があり有効であるかを検証します。

> [!NOTE]
> 検証に失敗したトランザクションのみを編集できます。 検証に合格したトランザクションを編集する場合は、変更するトランザクションの検証状態を **エラー** または **なし** に変更します。 


## <a name="bulk-edit-transactions"></a>トランザクションの一括編集

Retail バージョン 10.0.6 およびそれ以降のバージョンでは、明細書レベルで小売トランザクションを一括編集できるオプションがサポートされています。 

1. Excel アドインを使用して変更するトランザクションを含む明細書を開くには、上記のステップ 1 から 3 を実行します。

2. 以下のいずれかのオプションを選択します。

    - **現金売りトランザクションの編集**。 このオプションを使用すると、明細書にあるすべての現金売りトランザクションを編集できます。 次の Excel ワークシートは使用可能です。
    
       - **トランザクション**: このワークシートでは、販売トランザクションのヘッダーレベルの情報がすべて表示されます。
       - **販売トランザクション**: このワークシートでは、販売トランザクションの行レベルの情報がすべて表示されます。
       - **支払トランザクション**: このワークシートでは、販売トランザクションの支払行レベルの情報がすべて表示されます。
       - **割引トランザクション**: このワークシートでは、販売トランザクションの割引行レベルの情報がすべて表示されます。
       - **税金トランザクション**: このワークシートでは、販売トランザクションの税金行レベルの情報がすべて表示されます。
       - **諸費用トランザクション**: このワークシートでは、販売トランザクションの諸費用行レベルの情報がすべて表示されます。

    - **現金管理トランザクションの編集**。 このオプションを使用すると、明細書にあるすべての現金管理トランザクションを編集できます。 次の Excel ワークシートは使用可能です。
     
       - **トランザクション**: このワークシートでは、現金管理トランザクションのヘッダーレベルの情報がすべて表示されます。
       - **銀行支払/入金トランザクション**: このワークシートでは、すべての銀行入金トランザクションの詳細が表示されます。
       - **金庫保管支払/入金トランザクション**: このワークシートでは、すべての金庫保管入金トランザクションの詳細が表示されます。
       - **支払/入金申告**: このワークシートでは、すべての支払/入金申告トランザクションの詳細が表示されます。
       - **収入および経費トランザクション**: このワークシートでは、すべての収入および経費トランザクションの明細行の詳細が表示されます。
       - **支払トランザクション**: このワークシートでは、**請求書の支払** 処理と収入および経費トランザクションの支払いに関連する情報が表示されます。

3.  編集されたトランザクションを一括公開する場合、検証は実行されません。 すべての編集が正確であることを確認し、ワークシート全体のデータの忠実性を維持する必要があります。 たとえば、未処理の小売トランザクションの会計期間または在庫期間が終了するシナリオを管理するためにトランザクションの日付を変更する場合は、**営業日** 列を含むすべての Excel ワークシートの日付を変更する必要があります。 **小売明細書** ページにある **再検証トランザクション** から編集されたトランザクションを検証できます。
